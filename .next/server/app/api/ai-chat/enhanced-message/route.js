/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai-chat/enhanced-message/route";
exports.ids = ["app/api/ai-chat/enhanced-message/route"];
exports.modules = {

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&page=%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-chat%2Fenhanced-message%2Froute.ts&appDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&page=%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-chat%2Fenhanced-message%2Froute.ts&appDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_rodrigodibernardo33gmail_com_Documents_App_Development_Proyects_Intellego_Platform_src_app_api_ai_chat_enhanced_message_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/ai-chat/enhanced-message/route.ts */ \"(rsc)/./src/app/api/ai-chat/enhanced-message/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai-chat/enhanced-message/route\",\n        pathname: \"/api/ai-chat/enhanced-message\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai-chat/enhanced-message/route\"\n    },\n    resolvedPagePath: \"/Users/rodrigodibernardo33gmail.com/Documents/App Development Proyects/Intellego Platform/src/app/api/ai-chat/enhanced-message/route.ts\",\n    nextConfigOutput,\n    userland: _Users_rodrigodibernardo33gmail_com_Documents_App_Development_Proyects_Intellego_Platform_src_app_api_ai_chat_enhanced_message_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIvaW5kZXguanM/bmFtZT1hcHAlMkZhcGklMkZhaS1jaGF0JTJGZW5oYW5jZWQtbWVzc2FnZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWktY2hhdCUyRmVuaGFuY2VkLW1lc3NhZ2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhaS1jaGF0JTJGZW5oYW5jZWQtbWVzc2FnZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnJvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20lMkZEb2N1bWVudHMlMkZBcHAlMjBEZXZlbG9wbWVudCUyMFByb3llY3RzJTJGSW50ZWxsZWdvJTIwUGxhdGZvcm0lMkZzcmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbSUyRkRvY3VtZW50cyUyRkFwcCUyMERldmVsb3BtZW50JTIwUHJveWVjdHMlMkZJbnRlbGxlZ28lMjBQbGF0Zm9ybSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBK0Y7QUFDdkM7QUFDcUI7QUFDdUY7QUFDcEs7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHlHQUFtQjtBQUMzQztBQUNBLGNBQWMsa0VBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxzREFBc0Q7QUFDOUQ7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDMEY7O0FBRTFGIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9hcHAvYXBpL2FpLWNoYXQvZW5oYW5jZWQtbWVzc2FnZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWktY2hhdC9lbmhhbmNlZC1tZXNzYWdlL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWktY2hhdC9lbmhhbmNlZC1tZXNzYWdlXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9haS1jaGF0L2VuaGFuY2VkLW1lc3NhZ2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvYXBwL2FwaS9haS1jaGF0L2VuaGFuY2VkLW1lc3NhZ2Uvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyB3b3JrQXN5bmNTdG9yYWdlLCB3b3JrVW5pdEFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICB3b3JrQXN5bmNTdG9yYWdlLFxuICAgICAgICB3b3JrVW5pdEFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&page=%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-chat%2Fenhanced-message%2Froute.ts&appDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/ai-calendar/create-event/route.ts":
/*!*******************************************************!*\
  !*** ./src/app/api/ai-calendar/create-event/route.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_calendar_data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n\n\n\n\nasync function POST(request) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Authentication required',\n                success: false\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { title, type, subject, date, startTime, endTime, duration, location, description, priority } = body;\n        // Validaciones básicas\n        if (!title || !type || !date) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Missing required fields: title, type, date',\n                success: false\n            }, {\n                status: 400\n            });\n        }\n        // Validar tipo de evento\n        const validTypes = [\n            'exam',\n            'study_session',\n            'class',\n            'personal',\n            'extracurricular'\n        ];\n        if (!validTypes.includes(type)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: `Invalid event type. Must be one of: ${validTypes.join(', ')}`,\n                success: false\n            }, {\n                status: 400\n            });\n        }\n        // Procesar fecha\n        let eventDate;\n        try {\n            eventDate = new Date(date);\n            if (isNaN(eventDate.getTime())) {\n                throw new Error('Invalid date');\n            }\n        } catch (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Invalid date format',\n                success: false\n            }, {\n                status: 400\n            });\n        }\n        // Calcular endTime si no se proporciona pero se tiene duration\n        let finalEndTime = endTime;\n        if (!endTime && startTime && duration) {\n            const start = new Date(`2000-01-01T${startTime}:00`);\n            const end = new Date(start.getTime() + duration * 60000);\n            finalEndTime = end.toTimeString().substring(0, 5);\n        }\n        // Crear el evento\n        const event = {\n            id: `ai-event-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,\n            title: title.trim(),\n            date: eventDate,\n            startTime: startTime || '15:00',\n            endTime: finalEndTime || '16:00',\n            type: type,\n            color: (0,_lib_calendar_data__WEBPACK_IMPORTED_MODULE_3__.getEventTypeColor)(type),\n            subject: subject || undefined,\n            location: location || undefined,\n            description: description || 'Creado automáticamente por IA Tutora',\n            priority: priority || 'medium',\n            duration: duration || 60\n        };\n        // Intentar agregar el evento al calendario del usuario\n        const userId = session.user.id;\n        const success = (0,_lib_calendar_data__WEBPACK_IMPORTED_MODULE_3__.addCalendarEvent)(userId, event);\n        if (!success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Failed to create event in calendar',\n                success: false\n            }, {\n                status: 500\n            });\n        }\n        // Verificar que el evento se guardó correctamente\n        const userData = (0,_lib_calendar_data__WEBPACK_IMPORTED_MODULE_3__.getUserCalendarData)(userId);\n        const savedEvent = userData?.events.find((e)=>e.id === event.id);\n        if (!savedEvent) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Event was not saved correctly',\n                success: false\n            }, {\n                status: 500\n            });\n        }\n        console.log(`🤖 IA creó evento: ${event.title} para ${userId}`);\n        // Disparar evento global para notificar a los componentes frontend\n        if (typeof globalThis !== 'undefined') {\n            // Usar setTimeout para evitar problemas de timing\n            setTimeout(()=>{\n                if (false) {}\n            }, 100);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            event: savedEvent,\n            message: `Evento \"${event.title}\" creado exitosamente`,\n            totalEvents: userData?.events.length || 0\n        });\n    } catch (error) {\n        console.error('❌ Error in AI calendar creation:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Internal server error while creating event',\n            success: false\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9haS1jYWxlbmRhci9jcmVhdGUtZXZlbnQvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQTBDO0FBQ0U7QUFDSjtBQU1aO0FBRXJCLGVBQWVNLEtBQUtDLE9BQWdCO0lBQ3pDLElBQUk7UUFDRixNQUFNQyxVQUFVLE1BQU1QLDJEQUFnQkEsQ0FBQ0Msa0RBQVdBO1FBRWxELElBQUksQ0FBQ00sU0FBUztZQUNaLE9BQU9SLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO2dCQUFFQyxPQUFPO2dCQUEyQkMsU0FBUztZQUFNLEdBQ25EO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxPQUFPLE1BQU1OLFFBQVFFLElBQUk7UUFDL0IsTUFBTSxFQUNKSyxLQUFLLEVBQ0xDLElBQUksRUFDSkMsT0FBTyxFQUNQQyxJQUFJLEVBQ0pDLFNBQVMsRUFDVEMsT0FBTyxFQUNQQyxRQUFRLEVBQ1JDLFFBQVEsRUFDUkMsV0FBVyxFQUNYQyxRQUFRLEVBQ1QsR0FBR1Y7UUFFSix1QkFBdUI7UUFDdkIsSUFBSSxDQUFDQyxTQUFTLENBQUNDLFFBQVEsQ0FBQ0UsTUFBTTtZQUM1QixPQUFPakIscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU87Z0JBQ1BDLFNBQVM7WUFDWCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSx5QkFBeUI7UUFDekIsTUFBTVksYUFBYTtZQUFDO1lBQVE7WUFBaUI7WUFBUztZQUFZO1NBQWtCO1FBQ3BGLElBQUksQ0FBQ0EsV0FBV0MsUUFBUSxDQUFDVixPQUFPO1lBQzlCLE9BQU9mLHFEQUFZQSxDQUFDUyxJQUFJLENBQ3RCO2dCQUNFQyxPQUFPLENBQUMsb0NBQW9DLEVBQUVjLFdBQVdFLElBQUksQ0FBQyxPQUFPO2dCQUNyRWYsU0FBUztZQUNYLEdBQ0E7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGlCQUFpQjtRQUNqQixJQUFJZTtRQUNKLElBQUk7WUFDRkEsWUFBWSxJQUFJQyxLQUFLWDtZQUNyQixJQUFJWSxNQUFNRixVQUFVRyxPQUFPLEtBQUs7Z0JBQzlCLE1BQU0sSUFBSUMsTUFBTTtZQUNsQjtRQUNGLEVBQUUsT0FBT3JCLE9BQU87WUFDZCxPQUFPVixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztnQkFBdUJDLFNBQVM7WUFBTSxHQUMvQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsK0RBQStEO1FBQy9ELElBQUlvQixlQUFlYjtRQUNuQixJQUFJLENBQUNBLFdBQVdELGFBQWFFLFVBQVU7WUFDckMsTUFBTWEsUUFBUSxJQUFJTCxLQUFLLENBQUMsV0FBVyxFQUFFVixVQUFVLEdBQUcsQ0FBQztZQUNuRCxNQUFNZ0IsTUFBTSxJQUFJTixLQUFLSyxNQUFNSCxPQUFPLEtBQUtWLFdBQVc7WUFDbERZLGVBQWVFLElBQUlDLFlBQVksR0FBR0MsU0FBUyxDQUFDLEdBQUc7UUFDakQ7UUFFQSxrQkFBa0I7UUFDbEIsTUFBTUMsUUFBdUI7WUFDM0JDLElBQUksQ0FBQyxTQUFTLEVBQUVWLEtBQUtXLEdBQUcsR0FBRyxDQUFDLEVBQUVDLEtBQUtDLE1BQU0sR0FBR0MsUUFBUSxDQUFDLElBQUlDLE1BQU0sQ0FBQyxHQUFHLElBQUk7WUFDdkU3QixPQUFPQSxNQUFNOEIsSUFBSTtZQUNqQjNCLE1BQU1VO1lBQ05ULFdBQVdBLGFBQWE7WUFDeEJDLFNBQVNhLGdCQUFnQjtZQUN6QmpCLE1BQU1BO1lBQ044QixPQUFPekMscUVBQWlCQSxDQUFDVztZQUN6QkMsU0FBU0EsV0FBVzhCO1lBQ3BCekIsVUFBVUEsWUFBWXlCO1lBQ3RCeEIsYUFBYUEsZUFBZTtZQUM1QkMsVUFBVUEsWUFBWTtZQUN0QkgsVUFBVUEsWUFBWTtRQUN4QjtRQUVBLHVEQUF1RDtRQUN2RCxNQUFNMkIsU0FBU3ZDLFFBQVF3QyxJQUFJLENBQUNWLEVBQUU7UUFDOUIsTUFBTTNCLFVBQVVSLG9FQUFnQkEsQ0FBQzRDLFFBQVFWO1FBRXpDLElBQUksQ0FBQzFCLFNBQVM7WUFDWixPQUFPWCxxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtnQkFDRUMsT0FBTztnQkFDUEMsU0FBUztZQUNYLEdBQ0E7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGtEQUFrRDtRQUNsRCxNQUFNcUMsV0FBVzVDLHVFQUFtQkEsQ0FBQzBDO1FBQ3JDLE1BQU1HLGFBQWFELFVBQVVFLE9BQU9DLEtBQUtDLENBQUFBLElBQUtBLEVBQUVmLEVBQUUsS0FBS0QsTUFBTUMsRUFBRTtRQUUvRCxJQUFJLENBQUNZLFlBQVk7WUFDZixPQUFPbEQscURBQVlBLENBQUNTLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU87Z0JBQ1BDLFNBQVM7WUFDWCxHQUNBO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQTBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFbEIsTUFBTXZCLEtBQUssQ0FBQyxNQUFNLEVBQUVpQyxRQUFRO1FBRTlELG1FQUFtRTtRQUNuRSxJQUFJLE9BQU9TLGVBQWUsYUFBYTtZQUNyQyxrREFBa0Q7WUFDbERDLFdBQVc7Z0JBQ1QsSUFBSSxLQUE2QixFQUFFLEVBSWxDO1lBQ0gsR0FBRztRQUNMO1FBRUEsT0FBT3pELHFEQUFZQSxDQUFDUyxJQUFJLENBQUM7WUFDdkJFLFNBQVM7WUFDVDBCLE9BQU9hO1lBQ1BZLFNBQVMsQ0FBQyxRQUFRLEVBQUV6QixNQUFNdkIsS0FBSyxDQUFDLHFCQUFxQixDQUFDO1lBQ3REaUQsYUFBYWQsVUFBVUUsT0FBT2EsVUFBVTtRQUMxQztJQUVGLEVBQUUsT0FBT3RELE9BQU87UUFDZDRDLFFBQVE1QyxLQUFLLENBQUMsb0NBQW9DQTtRQUVsRCxPQUFPVixxREFBWUEsQ0FBQ1MsSUFBSSxDQUN0QjtZQUNFQyxPQUFPO1lBQ1BDLFNBQVM7UUFDWCxHQUNBO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvYXBwL2FwaS9haS1jYWxlbmRhci9jcmVhdGUtZXZlbnQvcm91dGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBnZXRTZXJ2ZXJTZXNzaW9uIH0gZnJvbSAnbmV4dC1hdXRoJ1xuaW1wb3J0IHsgYXV0aE9wdGlvbnMgfSBmcm9tICdAL2xpYi9hdXRoJ1xuaW1wb3J0IHsgXG4gIGFkZENhbGVuZGFyRXZlbnQsIFxuICBDYWxlbmRhckV2ZW50LCBcbiAgZ2V0RXZlbnRUeXBlQ29sb3IsXG4gIGdldFVzZXJDYWxlbmRhckRhdGEgXG59IGZyb20gJ0AvbGliL2NhbGVuZGFyLWRhdGEnXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2VydmVyU2Vzc2lvbihhdXRoT3B0aW9ucylcbiAgICBcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ0F1dGhlbnRpY2F0aW9uIHJlcXVpcmVkJywgc3VjY2VzczogZmFsc2UgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyBcbiAgICAgIHRpdGxlLCBcbiAgICAgIHR5cGUsIFxuICAgICAgc3ViamVjdCwgXG4gICAgICBkYXRlLCBcbiAgICAgIHN0YXJ0VGltZSwgXG4gICAgICBlbmRUaW1lLCBcbiAgICAgIGR1cmF0aW9uLCBcbiAgICAgIGxvY2F0aW9uLCBcbiAgICAgIGRlc2NyaXB0aW9uLCBcbiAgICAgIHByaW9yaXR5IFxuICAgIH0gPSBib2R5XG5cbiAgICAvLyBWYWxpZGFjaW9uZXMgYsOhc2ljYXNcbiAgICBpZiAoIXRpdGxlIHx8ICF0eXBlIHx8ICFkYXRlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgXG4gICAgICAgICAgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkczogdGl0bGUsIHR5cGUsIGRhdGUnLCBcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSBcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gVmFsaWRhciB0aXBvIGRlIGV2ZW50b1xuICAgIGNvbnN0IHZhbGlkVHlwZXMgPSBbJ2V4YW0nLCAnc3R1ZHlfc2Vzc2lvbicsICdjbGFzcycsICdwZXJzb25hbCcsICdleHRyYWN1cnJpY3VsYXInXVxuICAgIGlmICghdmFsaWRUeXBlcy5pbmNsdWRlcyh0eXBlKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IFxuICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBldmVudCB0eXBlLiBNdXN0IGJlIG9uZSBvZjogJHt2YWxpZFR5cGVzLmpvaW4oJywgJyl9YCwgXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UgXG4gICAgICAgIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIFByb2Nlc2FyIGZlY2hhXG4gICAgbGV0IGV2ZW50RGF0ZTogRGF0ZVxuICAgIHRyeSB7XG4gICAgICBldmVudERhdGUgPSBuZXcgRGF0ZShkYXRlKVxuICAgICAgaWYgKGlzTmFOKGV2ZW50RGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBkYXRlJylcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnSW52YWxpZCBkYXRlIGZvcm1hdCcsIHN1Y2Nlc3M6IGZhbHNlIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENhbGN1bGFyIGVuZFRpbWUgc2kgbm8gc2UgcHJvcG9yY2lvbmEgcGVybyBzZSB0aWVuZSBkdXJhdGlvblxuICAgIGxldCBmaW5hbEVuZFRpbWUgPSBlbmRUaW1lXG4gICAgaWYgKCFlbmRUaW1lICYmIHN0YXJ0VGltZSAmJiBkdXJhdGlvbikge1xuICAgICAgY29uc3Qgc3RhcnQgPSBuZXcgRGF0ZShgMjAwMC0wMS0wMVQke3N0YXJ0VGltZX06MDBgKVxuICAgICAgY29uc3QgZW5kID0gbmV3IERhdGUoc3RhcnQuZ2V0VGltZSgpICsgZHVyYXRpb24gKiA2MDAwMClcbiAgICAgIGZpbmFsRW5kVGltZSA9IGVuZC50b1RpbWVTdHJpbmcoKS5zdWJzdHJpbmcoMCwgNSlcbiAgICB9XG5cbiAgICAvLyBDcmVhciBlbCBldmVudG9cbiAgICBjb25zdCBldmVudDogQ2FsZW5kYXJFdmVudCA9IHtcbiAgICAgIGlkOiBgYWktZXZlbnQtJHtEYXRlLm5vdygpfS0ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgdGl0bGU6IHRpdGxlLnRyaW0oKSxcbiAgICAgIGRhdGU6IGV2ZW50RGF0ZSxcbiAgICAgIHN0YXJ0VGltZTogc3RhcnRUaW1lIHx8ICcxNTowMCcsXG4gICAgICBlbmRUaW1lOiBmaW5hbEVuZFRpbWUgfHwgJzE2OjAwJyxcbiAgICAgIHR5cGU6IHR5cGUgYXMgQ2FsZW5kYXJFdmVudFsndHlwZSddLFxuICAgICAgY29sb3I6IGdldEV2ZW50VHlwZUNvbG9yKHR5cGUgYXMgQ2FsZW5kYXJFdmVudFsndHlwZSddKSxcbiAgICAgIHN1YmplY3Q6IHN1YmplY3QgfHwgdW5kZWZpbmVkLFxuICAgICAgbG9jYXRpb246IGxvY2F0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCAnQ3JlYWRvIGF1dG9tw6F0aWNhbWVudGUgcG9yIElBIFR1dG9yYScsXG4gICAgICBwcmlvcml0eTogcHJpb3JpdHkgfHwgJ21lZGl1bScsXG4gICAgICBkdXJhdGlvbjogZHVyYXRpb24gfHwgNjBcbiAgICB9XG5cbiAgICAvLyBJbnRlbnRhciBhZ3JlZ2FyIGVsIGV2ZW50byBhbCBjYWxlbmRhcmlvIGRlbCB1c3VhcmlvXG4gICAgY29uc3QgdXNlcklkID0gc2Vzc2lvbi51c2VyLmlkXG4gICAgY29uc3Qgc3VjY2VzcyA9IGFkZENhbGVuZGFyRXZlbnQodXNlcklkLCBldmVudClcblxuICAgIGlmICghc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IFxuICAgICAgICAgIGVycm9yOiAnRmFpbGVkIHRvIGNyZWF0ZSBldmVudCBpbiBjYWxlbmRhcicsIFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlIFxuICAgICAgICB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBWZXJpZmljYXIgcXVlIGVsIGV2ZW50byBzZSBndWFyZMOzIGNvcnJlY3RhbWVudGVcbiAgICBjb25zdCB1c2VyRGF0YSA9IGdldFVzZXJDYWxlbmRhckRhdGEodXNlcklkKVxuICAgIGNvbnN0IHNhdmVkRXZlbnQgPSB1c2VyRGF0YT8uZXZlbnRzLmZpbmQoZSA9PiBlLmlkID09PSBldmVudC5pZClcblxuICAgIGlmICghc2F2ZWRFdmVudCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IFxuICAgICAgICAgIGVycm9yOiAnRXZlbnQgd2FzIG5vdCBzYXZlZCBjb3JyZWN0bHknLCBcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSBcbiAgICAgICAgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYPCfpJYgSUEgY3Jlw7MgZXZlbnRvOiAke2V2ZW50LnRpdGxlfSBwYXJhICR7dXNlcklkfWApXG5cbiAgICAvLyBEaXNwYXJhciBldmVudG8gZ2xvYmFsIHBhcmEgbm90aWZpY2FyIGEgbG9zIGNvbXBvbmVudGVzIGZyb250ZW5kXG4gICAgaWYgKHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gVXNhciBzZXRUaW1lb3V0IHBhcmEgZXZpdGFyIHByb2JsZW1hcyBkZSB0aW1pbmdcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2NhbGVuZGFyRXZlbnRDcmVhdGVkJywge1xuICAgICAgICAgICAgZGV0YWlsOiB7IGV2ZW50OiBzYXZlZEV2ZW50LCB1c2VySWQgfVxuICAgICAgICAgIH0pKVxuICAgICAgICB9XG4gICAgICB9LCAxMDApXG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBldmVudDogc2F2ZWRFdmVudCxcbiAgICAgIG1lc3NhZ2U6IGBFdmVudG8gXCIke2V2ZW50LnRpdGxlfVwiIGNyZWFkbyBleGl0b3NhbWVudGVgLFxuICAgICAgdG90YWxFdmVudHM6IHVzZXJEYXRhPy5ldmVudHMubGVuZ3RoIHx8IDBcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEVycm9yIGluIEFJIGNhbGVuZGFyIGNyZWF0aW9uOicsIGVycm9yKVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgXG4gICAgICAgIGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yIHdoaWxlIGNyZWF0aW5nIGV2ZW50JywgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlIFxuICAgICAgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgIClcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJhZGRDYWxlbmRhckV2ZW50IiwiZ2V0RXZlbnRUeXBlQ29sb3IiLCJnZXRVc2VyQ2FsZW5kYXJEYXRhIiwiUE9TVCIsInJlcXVlc3QiLCJzZXNzaW9uIiwianNvbiIsImVycm9yIiwic3VjY2VzcyIsInN0YXR1cyIsImJvZHkiLCJ0aXRsZSIsInR5cGUiLCJzdWJqZWN0IiwiZGF0ZSIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJkdXJhdGlvbiIsImxvY2F0aW9uIiwiZGVzY3JpcHRpb24iLCJwcmlvcml0eSIsInZhbGlkVHlwZXMiLCJpbmNsdWRlcyIsImpvaW4iLCJldmVudERhdGUiLCJEYXRlIiwiaXNOYU4iLCJnZXRUaW1lIiwiRXJyb3IiLCJmaW5hbEVuZFRpbWUiLCJzdGFydCIsImVuZCIsInRvVGltZVN0cmluZyIsInN1YnN0cmluZyIsImV2ZW50IiwiaWQiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJ0cmltIiwiY29sb3IiLCJ1bmRlZmluZWQiLCJ1c2VySWQiLCJ1c2VyIiwidXNlckRhdGEiLCJzYXZlZEV2ZW50IiwiZXZlbnRzIiwiZmluZCIsImUiLCJjb25zb2xlIiwibG9nIiwiZ2xvYmFsVGhpcyIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJtZXNzYWdlIiwidG90YWxFdmVudHMiLCJsZW5ndGgiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/ai-calendar/create-event/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/app/api/ai-chat/enhanced-message/route.ts":
/*!*******************************************************!*\
  !*** ./src/app/api/ai-chat/enhanced-message/route.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./src/lib/auth.ts\");\n/* harmony import */ var _lib_advanced_command_processor__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/advanced-command-processor */ \"(rsc)/./src/lib/advanced-command-processor.ts\");\n/* harmony import */ var _lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/advanced-intent-engine */ \"(rsc)/./src/lib/advanced-intent-engine.ts\");\n/* harmony import */ var _lib_sara_personality__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/lib/sara-personality */ \"(rsc)/./src/lib/sara-personality.ts\");\n/* harmony import */ var _lib_ai_providers__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/lib/ai-providers */ \"(rsc)/./src/lib/ai-providers.ts\");\n/* harmony import */ var _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/lib/conversation-memory */ \"(rsc)/./src/lib/conversation-memory.ts\");\n// API Endpoint para Mensajes Avanzados con Sara\n// Integra todos los sistemas avanzados para procesamiento inteligente\n\n\n\n\n\n\n\n\nasync function POST(request) {\n    try {\n        const session = await (0,next_auth__WEBPACK_IMPORTED_MODULE_1__.getServerSession)(_lib_auth__WEBPACK_IMPORTED_MODULE_2__.authOptions);\n        if (!session?.user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'No autorizado'\n            }, {\n                status: 401\n            });\n        }\n        const body = await request.json();\n        const { message, userId, userName, sessionId, currentMode, conversationHistory = [] } = body;\n        if (!message || !userId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Mensaje y userId son requeridos'\n            }, {\n                status: 400\n            });\n        }\n        // Use provided sessionId or generate a stable one\n        const actualSessionId = sessionId || `session_${userId}_${Date.now().toString(36)}`;\n        console.log('🎯 Processing message with stable sessionId:', actualSessionId);\n        // Procesar comando con el sistema avanzado\n        const commandContext = {\n            userId,\n            userName,\n            conversationHistory,\n            currentMode: currentMode || _lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING,\n            lastCommands: []\n        };\n        const commandResult = await _lib_advanced_command_processor__WEBPACK_IMPORTED_MODULE_3__.AdvancedCommandProcessor.processCommand(message, commandContext);\n        // 🎯 PRIORIDAD: Usar mi sistema de conversación contextual mejorado\n        console.log('🤖 Using enhanced contextual conversation manager');\n        try {\n            const { ContextualConversationManager } = __webpack_require__(/*! @/lib/contextual-conversation-manager */ \"(rsc)/./src/lib/contextual-conversation-manager.ts\");\n            const contextualResponse = await ContextualConversationManager.processContextualMessage(userId, message, actualSessionId, userName);\n            console.log('✅ Contextual response generated:', {\n                contentLength: contextualResponse.content.length,\n                personalizations: contextualResponse.personalizations,\n                continuityScore: contextualResponse.continuityScore,\n                hasVisualRecommendation: !!contextualResponse.visualRecommendation\n            });\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                response: contextualResponse.content,\n                detectedIntent: contextualResponse.personalizations.includes('calendar_task_executed') ? 'calendar_management' : 'contextual_conversation',\n                suggestedActions: contextualResponse.suggestedFollowups,\n                followUpQuestions: [],\n                visualizations: contextualResponse.visualRecommendation ? [\n                    {\n                        type: contextualResponse.visualRecommendation.type,\n                        data: contextualResponse.visualRecommendation.reason\n                    }\n                ] : [],\n                priority: contextualResponse.personalizations.includes('calendar_task_executed') ? 'high' : 'medium',\n                resources: [],\n                continuityScore: contextualResponse.continuityScore,\n                personalizations: contextualResponse.personalizations\n            });\n        } catch (contextualError) {\n            console.error('⚠️ Contextual conversation manager failed, using command processor fallback:', contextualError);\n            // Fallback to original command processing\n            if (commandResult.success && commandResult.type !== 'error') {\n                const saraResponse = await _lib_sara_personality__WEBPACK_IMPORTED_MODULE_5__.SaraPersonalityEngine.generateContextualResponse(message, commandResult, userId, currentMode, actualSessionId);\n                const suggestedMode = currentMode // Temporal: mantener el modo actual\n                ;\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    response: saraResponse || commandResult.message,\n                    detectedIntent: commandResult.type,\n                    suggestedMode: suggestedMode !== currentMode ? suggestedMode : undefined,\n                    suggestedActions: commandResult.suggestedActions || [],\n                    followUpQuestions: commandResult.followUpQuestions || [],\n                    visualizations: commandResult.visualizations || [],\n                    priority: commandResult.data?.priority || 'medium',\n                    resources: commandResult.data?.resources || [],\n                    commandResult: commandResult\n                });\n            }\n        }\n        // Fallback: usar AI providers para respuesta general con memoria\n        const fallbackResponse = await generateFallbackResponse(message, conversationHistory, currentMode, userName, userId, actualSessionId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: fallbackResponse.content,\n            detectedIntent: 'general_conversation',\n            suggestedActions: generateModeSuggestions(currentMode),\n            followUpQuestions: generateFollowUpQuestions(currentMode),\n            priority: 'low'\n        });\n    } catch (error) {\n        console.error('Error in enhanced-message endpoint:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: 'Lo siento, hubo un problema procesando tu mensaje. ¿Podrías intentar reformularlo?',\n            detectedIntent: 'error',\n            error: error instanceof Error ? error.message : 'Error desconocido'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function generateFallbackResponse(message, conversationHistory, currentMode, userName, userId, sessionId) {\n    // Construir prompt contextual basado en el modo y memoria\n    const modeContext = getModeContext(currentMode);\n    // Integrar memoria conversacional si está disponible\n    let memoryContext = \"\";\n    if (userId) {\n        const contextualSummary = _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__.ConversationMemoryManager.generateContextualSummary(userId, sessionId);\n        const personalizedSuggestions = _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__.ConversationMemoryManager.getPersonalizedSuggestions(userId, sessionId);\n        memoryContext = `\nCONTEXTO DE MEMORIA CONVERSACIONAL:\n${contextualSummary}\n\nSUGERENCIAS PERSONALIZADAS DISPONIBLES:\n${personalizedSuggestions.length > 0 ? personalizedSuggestions.map((s)=>`• ${s}`).join('\\n') : '• Esta es una nueva conversación'}\n`;\n    }\n    const prompt = `${modeContext}\n${memoryContext}\n\nUsuario: ${userName || 'Estudiante'}\nMensaje: ${message}\n\nResponde como Sara, un asistente personal académico amigable y proactivo. \nMantén el foco en el modo actual: ${currentMode}.\nUsa la memoria conversacional para personalizar tu respuesta y dar continuidad.\nProporciona una respuesta útil y sugiere acciones específicas.`;\n    try {\n        // Intentar con proveedores AI\n        const response = await _lib_ai_providers__WEBPACK_IMPORTED_MODULE_6__.aiService.generateExercise(prompt);\n        // Verificar si necesitamos usar template fallback\n        if (response === 'TEMPLATE_FALLBACK') {\n            const templateResponse = getTemplateResponse(currentMode, message);\n            // Guardar respuesta template en memoria\n            if (userId) {\n                _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__.ConversationMemoryManager.saveConversationTurn(userId, message, templateResponse, currentMode.toString(), 'template_fallback', sessionId);\n            }\n            return {\n                content: templateResponse\n            };\n        }\n        // Guardar en memoria conversacional si está disponible\n        if (userId) {\n            _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__.ConversationMemoryManager.saveConversationTurn(userId, message, response, currentMode.toString(), 'ai_conversation', sessionId);\n        }\n        return {\n            content: response\n        };\n    } catch (error) {\n        console.error('Error with AI providers:', error);\n        // Respuesta template por modo\n        const templateResponse = getTemplateResponse(currentMode, message);\n        // Guardar respuesta template en memoria también\n        if (userId) {\n            _lib_conversation_memory__WEBPACK_IMPORTED_MODULE_7__.ConversationMemoryManager.saveConversationTurn(userId, message, templateResponse, currentMode.toString(), 'template_fallback', sessionId);\n        }\n        return {\n            content: templateResponse\n        };\n    }\n}\nfunction getModeContext(mode) {\n    const contexts = {\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.PLANNING]: 'Estás ayudando con planificación y organización de estudios. Enfócate en horarios, calendarios y planes de estudio.',\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.TUTORING]: 'Estás en modo tutoría. Ayuda con conceptos académicos, ejercicios y explicaciones detalladas.',\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.ORGANIZING]: 'Estás ayudando con organización de materiales y recursos de estudio.',\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.REVIEWING]: 'Estás analizando progreso y rendimiento académico del estudiante.',\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING]: 'Estás en conversación casual, proporcionando apoyo motivacional y respuestas generales.'\n    };\n    return contexts[mode] || contexts[_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING];\n}\nfunction getTemplateResponse(mode, message) {\n    const templates = {\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.PLANNING]: `Entiendo que necesitas ayuda con planificación. Como Sara, puedo ayudarte a:\n\n• Organizar tu horario de estudio\n• Crear planes personalizados\n• Optimizar tu tiempo\n• Programar sesiones efectivas\n\n¿Qué aspecto específico de la planificación te gustaría abordar?`,\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.TUTORING]: `Como tu tutor personal, estoy aquí para ayudarte con:\n\n• Explicaciones de conceptos\n• Resolución de ejercicios paso a paso\n• Práctica dirigida\n• Aclaración de dudas\n\n¿En qué materia o tema específico necesitas ayuda?`,\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.ORGANIZING]: `Te ayudo a organizar tus recursos de estudio:\n\n• Gestión de materiales\n• Organización de apuntes\n• Búsqueda de recursos\n• Estructuración de contenido\n\n¿Qué necesitas organizar específicamente?`,\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.REVIEWING]: `Analicemos tu progreso académico:\n\n• Revisión de calificaciones\n• Análisis de tendencias\n• Identificación de áreas de mejora\n• Recomendaciones personalizadas\n\n¿Qué aspecto de tu rendimiento quieres revisar?`,\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING]: `¡Hola! Soy Sara, tu asistente académico personal. \n\nEstoy aquí para apoyarte en tu camino educativo. Puedo ayudarte con organización, planificación, tutoría y mucho más.\n\n¿En qué puedo ayudarte hoy?`\n    };\n    return templates[mode] || templates[_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING];\n}\nfunction generateModeSuggestions(mode) {\n    const suggestions = {\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.PLANNING]: [\n            'Crear plan de estudio semanal',\n            'Optimizar mi horario',\n            'Programar sesiones de repaso',\n            'Analizar tiempo disponible'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.TUTORING]: [\n            'Explicar concepto de matemáticas',\n            'Resolver ejercicio paso a paso',\n            'Practicar problemas',\n            'Aclarar dudas'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.ORGANIZING]: [\n            'Organizar mis materiales',\n            'Buscar recursos de estudio',\n            'Estructurar mis apuntes',\n            'Gestionar archivos'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.REVIEWING]: [\n            'Analizar mi progreso',\n            'Ver tendencias de calificaciones',\n            'Revisar objetivos',\n            'Identificar áreas de mejora'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING]: [\n            'Planificar mi semana',\n            'Necesito motivación',\n            'Ayuda con organización',\n            'Analizar mi rendimiento'\n        ]\n    };\n    return suggestions[mode] || suggestions[_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING];\n}\nfunction generateFollowUpQuestions(mode) {\n    const questions = {\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.PLANNING]: [\n            '¿Para qué período quieres planificar?',\n            '¿Hay alguna materia que requiere atención especial?'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.TUTORING]: [\n            '¿En qué materia tienes más dificultades?',\n            '¿Prefieres explicaciones teóricas o ejercicios prácticos?'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.ORGANIZING]: [\n            '¿Qué tipo de materiales necesitas organizar?',\n            '¿Para qué materias buscas recursos adicionales?'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.REVIEWING]: [\n            '¿Qué período quieres analizar?',\n            '¿Hay alguna materia específica que te preocupa?'\n        ],\n        [_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING]: [\n            '¿Cómo te sientes con tus estudios actualmente?',\n            '¿En qué área académica puedo apoyarte más?'\n        ]\n    };\n    return questions[mode] || questions[_lib_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_4__.ConversationMode.CHATTING];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9haS1jaGF0L2VuaGFuY2VkLW1lc3NhZ2Uvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBLGdEQUFnRDtBQUNoRCxzRUFBc0U7QUFFZjtBQUNYO0FBQ0o7QUFDbUM7QUFDVTtBQUN2QjtBQUNoQjtBQUN1QjtBQUU5RCxlQUFlUSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsVUFBVSxNQUFNVCwyREFBZ0JBLENBQUNDLGtEQUFXQTtRQUVsRCxJQUFJLENBQUNRLFNBQVNDLE1BQU07WUFDbEIsT0FBT1gscURBQVlBLENBQUNZLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBZ0IsR0FDekI7Z0JBQUVDLFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1DLE9BQU8sTUFBTU4sUUFBUUcsSUFBSTtRQUMvQixNQUFNLEVBQ0pJLE9BQU8sRUFDUEMsTUFBTSxFQUNOQyxRQUFRLEVBQ1JDLFNBQVMsRUFDVEMsV0FBVyxFQUNYQyxzQkFBc0IsRUFBRSxFQUN6QixHQUFHTjtRQUVKLElBQUksQ0FBQ0MsV0FBVyxDQUFDQyxRQUFRO1lBQ3ZCLE9BQU9qQixxREFBWUEsQ0FBQ1ksSUFBSSxDQUN0QjtnQkFBRUMsT0FBTztZQUFrQyxHQUMzQztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsa0RBQWtEO1FBQ2xELE1BQU1RLGtCQUFrQkgsYUFBYSxDQUFDLFFBQVEsRUFBRUYsT0FBTyxDQUFDLEVBQUVNLEtBQUtDLEdBQUcsR0FBR0MsUUFBUSxDQUFDLEtBQUs7UUFDbkZDLFFBQVFDLEdBQUcsQ0FBQyxnREFBZ0RMO1FBRTVELDJDQUEyQztRQUMzQyxNQUFNTSxpQkFBaUI7WUFDckJYO1lBQ0FDO1lBQ0FHO1lBQ0FELGFBQWFBLGVBQWVoQix5RUFBZ0JBLENBQUN5QixRQUFRO1lBQ3JEQyxjQUFjLEVBQUU7UUFDbEI7UUFFQSxNQUFNQyxnQkFBZ0IsTUFBTTVCLHFGQUF3QkEsQ0FBQzZCLGNBQWMsQ0FDakVo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Q0QsQ0FBQ2hGLHlFQUFnQkEsQ0FBQ2lGLFFBQVEsQ0FBQyxFQUFFO1lBQzNCO1lBQ0E7U0FDRDtRQUNELENBQUNqRix5RUFBZ0JBLENBQUNrRixVQUFVLENBQUMsRUFBRTtZQUM3QjtZQUNBO1NBQ0Q7UUFDRCxDQUFDbEYseUVBQWdCQSxDQUFDbUYsU0FBUyxDQUFDLEVBQUU7WUFDNUI7WUFDQTtTQUNEO1FBQ0QsQ0FBQ25GLHlFQUFnQkEsQ0FBQ3lCLFFBQVEsQ0FBQyxFQUFFO1lBQzNCO1lBQ0E7U0FDRDtJQUNIO0lBRUEsT0FBTzZELFNBQVMsQ0FBQ1IsS0FBSyxJQUFJUSxTQUFTLENBQUN0Rix5RUFBZ0JBLENBQUN5QixRQUFRLENBQUM7QUFDaEUiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9hcHAvYXBpL2FpLWNoYXQvZW5oYW5jZWQtbWVzc2FnZS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBUEkgRW5kcG9pbnQgcGFyYSBNZW5zYWplcyBBdmFuemFkb3MgY29uIFNhcmFcbi8vIEludGVncmEgdG9kb3MgbG9zIHNpc3RlbWFzIGF2YW56YWRvcyBwYXJhIHByb2Nlc2FtaWVudG8gaW50ZWxpZ2VudGVcblxuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgZ2V0U2VydmVyU2Vzc2lvbiB9IGZyb20gJ25leHQtYXV0aCdcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSAnQC9saWIvYXV0aCdcbmltcG9ydCB7IEFkdmFuY2VkQ29tbWFuZFByb2Nlc3NvciB9IGZyb20gJ0AvbGliL2FkdmFuY2VkLWNvbW1hbmQtcHJvY2Vzc29yJ1xuaW1wb3J0IHsgQWR2YW5jZWRJbnRlbnRFbmdpbmUsIENvbnZlcnNhdGlvbk1vZGUgfSBmcm9tICdAL2xpYi9hZHZhbmNlZC1pbnRlbnQtZW5naW5lJ1xuaW1wb3J0IHsgU2FyYVBlcnNvbmFsaXR5RW5naW5lIH0gZnJvbSAnQC9saWIvc2FyYS1wZXJzb25hbGl0eSdcbmltcG9ydCB7IGFpU2VydmljZSB9IGZyb20gJ0AvbGliL2FpLXByb3ZpZGVycydcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIgfSBmcm9tICdAL2xpYi9jb252ZXJzYXRpb24tbWVtb3J5J1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXJ2ZXJTZXNzaW9uKGF1dGhPcHRpb25zKVxuICAgIFxuICAgIGlmICghc2Vzc2lvbj8udXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnTm8gYXV0b3JpemFkbycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApXG4gICAgfVxuXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgY29uc3QgeyBcbiAgICAgIG1lc3NhZ2UsIFxuICAgICAgdXNlcklkLCBcbiAgICAgIHVzZXJOYW1lLCBcbiAgICAgIHNlc3Npb25JZCxcbiAgICAgIGN1cnJlbnRNb2RlLCBcbiAgICAgIGNvbnZlcnNhdGlvbkhpc3RvcnkgPSBbXSBcbiAgICB9ID0gYm9keVxuXG4gICAgaWYgKCFtZXNzYWdlIHx8ICF1c2VySWQpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ01lbnNhamUgeSB1c2VySWQgc29uIHJlcXVlcmlkb3MnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIC8vIFVzZSBwcm92aWRlZCBzZXNzaW9uSWQgb3IgZ2VuZXJhdGUgYSBzdGFibGUgb25lXG4gICAgY29uc3QgYWN0dWFsU2Vzc2lvbklkID0gc2Vzc2lvbklkIHx8IGBzZXNzaW9uXyR7dXNlcklkfV8ke0RhdGUubm93KCkudG9TdHJpbmcoMzYpfWBcbiAgICBjb25zb2xlLmxvZygn8J+OryBQcm9jZXNzaW5nIG1lc3NhZ2Ugd2l0aCBzdGFibGUgc2Vzc2lvbklkOicsIGFjdHVhbFNlc3Npb25JZClcblxuICAgIC8vIFByb2Nlc2FyIGNvbWFuZG8gY29uIGVsIHNpc3RlbWEgYXZhbnphZG9cbiAgICBjb25zdCBjb21tYW5kQ29udGV4dCA9IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHVzZXJOYW1lLFxuICAgICAgY29udmVyc2F0aW9uSGlzdG9yeSxcbiAgICAgIGN1cnJlbnRNb2RlOiBjdXJyZW50TW9kZSB8fCBDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HLFxuICAgICAgbGFzdENvbW1hbmRzOiBbXVxuICAgIH1cblxuICAgIGNvbnN0IGNvbW1hbmRSZXN1bHQgPSBhd2FpdCBBZHZhbmNlZENvbW1hbmRQcm9jZXNzb3IucHJvY2Vzc0NvbW1hbmQoXG4gICAgICBtZXNzYWdlLFxuICAgICAgY29tbWFuZENvbnRleHRcbiAgICApXG5cbiAgICAvLyDwn46vIFBSSU9SSURBRDogVXNhciBtaSBzaXN0ZW1hIGRlIGNvbnZlcnNhY2nDs24gY29udGV4dHVhbCBtZWpvcmFkb1xuICAgIGNvbnNvbGUubG9nKCfwn6SWIFVzaW5nIGVuaGFuY2VkIGNvbnRleHR1YWwgY29udmVyc2F0aW9uIG1hbmFnZXInKVxuICAgIFxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IENvbnRleHR1YWxDb252ZXJzYXRpb25NYW5hZ2VyIH0gPSByZXF1aXJlKCdAL2xpYi9jb250ZXh0dWFsLWNvbnZlcnNhdGlvbi1tYW5hZ2VyJylcbiAgICAgIGNvbnN0IGNvbnRleHR1YWxSZXNwb25zZSA9IGF3YWl0IENvbnRleHR1YWxDb252ZXJzYXRpb25NYW5hZ2VyLnByb2Nlc3NDb250ZXh0dWFsTWVzc2FnZShcbiAgICAgICAgdXNlcklkLCBcbiAgICAgICAgbWVzc2FnZSwgXG4gICAgICAgIGFjdHVhbFNlc3Npb25JZCwgXG4gICAgICAgIHVzZXJOYW1lXG4gICAgICApXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgQ29udGV4dHVhbCByZXNwb25zZSBnZW5lcmF0ZWQ6Jywge1xuICAgICAgICBjb250ZW50TGVuZ3RoOiBjb250ZXh0dWFsUmVzcG9uc2UuY29udGVudC5sZW5ndGgsXG4gICAgICAgIHBlcnNvbmFsaXphdGlvbnM6IGNvbnRleHR1YWxSZXNwb25zZS5wZXJzb25hbGl6YXRpb25zLFxuICAgICAgICBjb250aW51aXR5U2NvcmU6IGNvbnRleHR1YWxSZXNwb25zZS5jb250aW51aXR5U2NvcmUsXG4gICAgICAgIGhhc1Zpc3VhbFJlY29tbWVuZGF0aW9uOiAhIWNvbnRleHR1YWxSZXNwb25zZS52aXN1YWxSZWNvbW1lbmRhdGlvblxuICAgICAgfSlcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgcmVzcG9uc2U6IGNvbnRleHR1YWxSZXNwb25zZS5jb250ZW50LFxuICAgICAgICBkZXRlY3RlZEludGVudDogY29udGV4dHVhbFJlc3BvbnNlLnBlcnNvbmFsaXphdGlvbnMuaW5jbHVkZXMoJ2NhbGVuZGFyX3Rhc2tfZXhlY3V0ZWQnKSA/ICdjYWxlbmRhcl9tYW5hZ2VtZW50JyA6ICdjb250ZXh0dWFsX2NvbnZlcnNhdGlvbicsXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGNvbnRleHR1YWxSZXNwb25zZS5zdWdnZXN0ZWRGb2xsb3d1cHMsXG4gICAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBbXSxcbiAgICAgICAgdmlzdWFsaXphdGlvbnM6IGNvbnRleHR1YWxSZXNwb25zZS52aXN1YWxSZWNvbW1lbmRhdGlvbiA/IFt7IFxuICAgICAgICAgIHR5cGU6IGNvbnRleHR1YWxSZXNwb25zZS52aXN1YWxSZWNvbW1lbmRhdGlvbi50eXBlLCBcbiAgICAgICAgICBkYXRhOiBjb250ZXh0dWFsUmVzcG9uc2UudmlzdWFsUmVjb21tZW5kYXRpb24ucmVhc29uIFxuICAgICAgICB9XSA6IFtdLFxuICAgICAgICBwcmlvcml0eTogY29udGV4dHVhbFJlc3BvbnNlLnBlcnNvbmFsaXphdGlvbnMuaW5jbHVkZXMoJ2NhbGVuZGFyX3Rhc2tfZXhlY3V0ZWQnKSA/ICdoaWdoJyA6ICdtZWRpdW0nLFxuICAgICAgICByZXNvdXJjZXM6IFtdLFxuICAgICAgICBjb250aW51aXR5U2NvcmU6IGNvbnRleHR1YWxSZXNwb25zZS5jb250aW51aXR5U2NvcmUsXG4gICAgICAgIHBlcnNvbmFsaXphdGlvbnM6IGNvbnRleHR1YWxSZXNwb25zZS5wZXJzb25hbGl6YXRpb25zXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGNvbnRleHR1YWxFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcign4pqg77iPIENvbnRleHR1YWwgY29udmVyc2F0aW9uIG1hbmFnZXIgZmFpbGVkLCB1c2luZyBjb21tYW5kIHByb2Nlc3NvciBmYWxsYmFjazonLCBjb250ZXh0dWFsRXJyb3IpXG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGNvbW1hbmQgcHJvY2Vzc2luZ1xuICAgICAgaWYgKGNvbW1hbmRSZXN1bHQuc3VjY2VzcyAmJiBjb21tYW5kUmVzdWx0LnR5cGUgIT09ICdlcnJvcicpIHtcbiAgICAgICAgY29uc3Qgc2FyYVJlc3BvbnNlID0gYXdhaXQgU2FyYVBlcnNvbmFsaXR5RW5naW5lLmdlbmVyYXRlQ29udGV4dHVhbFJlc3BvbnNlKFxuICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgY29tbWFuZFJlc3VsdCxcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgY3VycmVudE1vZGUsXG4gICAgICAgICAgYWN0dWFsU2Vzc2lvbklkXG4gICAgICAgIClcblxuICAgICAgICBjb25zdCBzdWdnZXN0ZWRNb2RlID0gY3VycmVudE1vZGUgLy8gVGVtcG9yYWw6IG1hbnRlbmVyIGVsIG1vZG8gYWN0dWFsXG5cbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgICByZXNwb25zZTogc2FyYVJlc3BvbnNlIHx8IGNvbW1hbmRSZXN1bHQubWVzc2FnZSxcbiAgICAgICAgICBkZXRlY3RlZEludGVudDogY29tbWFuZFJlc3VsdC50eXBlLFxuICAgICAgICAgIHN1Z2dlc3RlZE1vZGU6IHN1Z2dlc3RlZE1vZGUgIT09IGN1cnJlbnRNb2RlID8gc3VnZ2VzdGVkTW9kZSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBjb21tYW5kUmVzdWx0LnN1Z2dlc3RlZEFjdGlvbnMgfHwgW10sXG4gICAgICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IGNvbW1hbmRSZXN1bHQuZm9sbG93VXBRdWVzdGlvbnMgfHwgW10sXG4gICAgICAgICAgdmlzdWFsaXphdGlvbnM6IGNvbW1hbmRSZXN1bHQudmlzdWFsaXphdGlvbnMgfHwgW10sXG4gICAgICAgICAgcHJpb3JpdHk6IGNvbW1hbmRSZXN1bHQuZGF0YT8ucHJpb3JpdHkgfHwgJ21lZGl1bScsXG4gICAgICAgICAgcmVzb3VyY2VzOiBjb21tYW5kUmVzdWx0LmRhdGE/LnJlc291cmNlcyB8fCBbXSxcbiAgICAgICAgICBjb21tYW5kUmVzdWx0OiBjb21tYW5kUmVzdWx0XG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IHVzYXIgQUkgcHJvdmlkZXJzIHBhcmEgcmVzcHVlc3RhIGdlbmVyYWwgY29uIG1lbW9yaWFcbiAgICBjb25zdCBmYWxsYmFja1Jlc3BvbnNlID0gYXdhaXQgZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlKFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGNvbnZlcnNhdGlvbkhpc3RvcnksXG4gICAgICBjdXJyZW50TW9kZSxcbiAgICAgIHVzZXJOYW1lLFxuICAgICAgdXNlcklkLFxuICAgICAgYWN0dWFsU2Vzc2lvbklkXG4gICAgKVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHJlc3BvbnNlOiBmYWxsYmFja1Jlc3BvbnNlLmNvbnRlbnQsXG4gICAgICBkZXRlY3RlZEludGVudDogJ2dlbmVyYWxfY29udmVyc2F0aW9uJyxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGdlbmVyYXRlTW9kZVN1Z2dlc3Rpb25zKGN1cnJlbnRNb2RlKSxcbiAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBnZW5lcmF0ZUZvbGxvd1VwUXVlc3Rpb25zKGN1cnJlbnRNb2RlKSxcbiAgICAgIHByaW9yaXR5OiAnbG93J1xuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBlbmhhbmNlZC1tZXNzYWdlIGVuZHBvaW50OicsIGVycm9yKVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICByZXNwb25zZTogJ0xvIHNpZW50bywgaHVibyB1biBwcm9ibGVtYSBwcm9jZXNhbmRvIHR1IG1lbnNhamUuIMK/UG9kcsOtYXMgaW50ZW50YXIgcmVmb3JtdWxhcmxvPycsXG4gICAgICBkZXRlY3RlZEludGVudDogJ2Vycm9yJyxcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdFcnJvciBkZXNjb25vY2lkbydcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pXG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlKFxuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGNvbnZlcnNhdGlvbkhpc3Rvcnk6IGFueVtdLFxuICBjdXJyZW50TW9kZTogQ29udmVyc2F0aW9uTW9kZSxcbiAgdXNlck5hbWU/OiBzdHJpbmcsXG4gIHVzZXJJZD86IHN0cmluZyxcbiAgc2Vzc2lvbklkPzogc3RyaW5nXG4pOiBQcm9taXNlPHsgY29udGVudDogc3RyaW5nIH0+IHtcbiAgXG4gIC8vIENvbnN0cnVpciBwcm9tcHQgY29udGV4dHVhbCBiYXNhZG8gZW4gZWwgbW9kbyB5IG1lbW9yaWFcbiAgY29uc3QgbW9kZUNvbnRleHQgPSBnZXRNb2RlQ29udGV4dChjdXJyZW50TW9kZSlcbiAgXG4gIC8vIEludGVncmFyIG1lbW9yaWEgY29udmVyc2FjaW9uYWwgc2kgZXN0w6EgZGlzcG9uaWJsZVxuICBsZXQgbWVtb3J5Q29udGV4dCA9IFwiXCJcbiAgaWYgKHVzZXJJZCkge1xuICAgIGNvbnN0IGNvbnRleHR1YWxTdW1tYXJ5ID0gQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5nZW5lcmF0ZUNvbnRleHR1YWxTdW1tYXJ5KHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgIGNvbnN0IHBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zID0gQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5nZXRQZXJzb25hbGl6ZWRTdWdnZXN0aW9ucyh1c2VySWQsIHNlc3Npb25JZClcbiAgICBcbiAgICBtZW1vcnlDb250ZXh0ID0gYFxuQ09OVEVYVE8gREUgTUVNT1JJQSBDT05WRVJTQUNJT05BTDpcbiR7Y29udGV4dHVhbFN1bW1hcnl9XG5cblNVR0VSRU5DSUFTIFBFUlNPTkFMSVpBREFTIERJU1BPTklCTEVTOlxuJHtwZXJzb25hbGl6ZWRTdWdnZXN0aW9ucy5sZW5ndGggPiAwID8gcGVyc29uYWxpemVkU3VnZ2VzdGlvbnMubWFwKHMgPT4gYOKAoiAke3N9YCkuam9pbignXFxuJykgOiAn4oCiIEVzdGEgZXMgdW5hIG51ZXZhIGNvbnZlcnNhY2nDs24nfVxuYFxuICB9XG4gIFxuICBjb25zdCBwcm9tcHQgPSBgJHttb2RlQ29udGV4dH1cbiR7bWVtb3J5Q29udGV4dH1cblxuVXN1YXJpbzogJHt1c2VyTmFtZSB8fCAnRXN0dWRpYW50ZSd9XG5NZW5zYWplOiAke21lc3NhZ2V9XG5cblJlc3BvbmRlIGNvbW8gU2FyYSwgdW4gYXNpc3RlbnRlIHBlcnNvbmFsIGFjYWTDqW1pY28gYW1pZ2FibGUgeSBwcm9hY3Rpdm8uIFxuTWFudMOpbiBlbCBmb2NvIGVuIGVsIG1vZG8gYWN0dWFsOiAke2N1cnJlbnRNb2RlfS5cblVzYSBsYSBtZW1vcmlhIGNvbnZlcnNhY2lvbmFsIHBhcmEgcGVyc29uYWxpemFyIHR1IHJlc3B1ZXN0YSB5IGRhciBjb250aW51aWRhZC5cblByb3BvcmNpb25hIHVuYSByZXNwdWVzdGEgw7p0aWwgeSBzdWdpZXJlIGFjY2lvbmVzIGVzcGVjw61maWNhcy5gXG5cbiAgdHJ5IHtcbiAgICAvLyBJbnRlbnRhciBjb24gcHJvdmVlZG9yZXMgQUlcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGFpU2VydmljZS5nZW5lcmF0ZUV4ZXJjaXNlKHByb21wdClcbiAgICBcbiAgICAvLyBWZXJpZmljYXIgc2kgbmVjZXNpdGFtb3MgdXNhciB0ZW1wbGF0ZSBmYWxsYmFja1xuICAgIGlmIChyZXNwb25zZSA9PT0gJ1RFTVBMQVRFX0ZBTExCQUNLJykge1xuICAgICAgY29uc3QgdGVtcGxhdGVSZXNwb25zZSA9IGdldFRlbXBsYXRlUmVzcG9uc2UoY3VycmVudE1vZGUsIG1lc3NhZ2UpXG4gICAgICBcbiAgICAgIC8vIEd1YXJkYXIgcmVzcHVlc3RhIHRlbXBsYXRlIGVuIG1lbW9yaWFcbiAgICAgIGlmICh1c2VySWQpIHtcbiAgICAgICAgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5zYXZlQ29udmVyc2F0aW9uVHVybihcbiAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICB0ZW1wbGF0ZVJlc3BvbnNlLFxuICAgICAgICAgIGN1cnJlbnRNb2RlLnRvU3RyaW5nKCksXG4gICAgICAgICAgJ3RlbXBsYXRlX2ZhbGxiYWNrJyxcbiAgICAgICAgICBzZXNzaW9uSWRcbiAgICAgICAgKVxuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4geyBjb250ZW50OiB0ZW1wbGF0ZVJlc3BvbnNlIH1cbiAgICB9XG4gICAgXG4gICAgLy8gR3VhcmRhciBlbiBtZW1vcmlhIGNvbnZlcnNhY2lvbmFsIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyLnNhdmVDb252ZXJzYXRpb25UdXJuKFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIHJlc3BvbnNlLFxuICAgICAgICBjdXJyZW50TW9kZS50b1N0cmluZygpLFxuICAgICAgICAnYWlfY29udmVyc2F0aW9uJyxcbiAgICAgICAgc2Vzc2lvbklkXG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IGNvbnRlbnQ6IHJlc3BvbnNlIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3aXRoIEFJIHByb3ZpZGVyczonLCBlcnJvcilcbiAgICBcbiAgICAvLyBSZXNwdWVzdGEgdGVtcGxhdGUgcG9yIG1vZG9cbiAgICBjb25zdCB0ZW1wbGF0ZVJlc3BvbnNlID0gZ2V0VGVtcGxhdGVSZXNwb25zZShjdXJyZW50TW9kZSwgbWVzc2FnZSlcbiAgICBcbiAgICAvLyBHdWFyZGFyIHJlc3B1ZXN0YSB0ZW1wbGF0ZSBlbiBtZW1vcmlhIHRhbWJpw6luXG4gICAgaWYgKHVzZXJJZCkge1xuICAgICAgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5zYXZlQ29udmVyc2F0aW9uVHVybihcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICB0ZW1wbGF0ZVJlc3BvbnNlLFxuICAgICAgICBjdXJyZW50TW9kZS50b1N0cmluZygpLFxuICAgICAgICAndGVtcGxhdGVfZmFsbGJhY2snLFxuICAgICAgICBzZXNzaW9uSWRcbiAgICAgIClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHsgY29udGVudDogdGVtcGxhdGVSZXNwb25zZSB9XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0TW9kZUNvbnRleHQobW9kZTogQ29udmVyc2F0aW9uTW9kZSk6IHN0cmluZyB7XG4gIGNvbnN0IGNvbnRleHRzID0ge1xuICAgIFtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HXTogJ0VzdMOhcyBheXVkYW5kbyBjb24gcGxhbmlmaWNhY2nDs24geSBvcmdhbml6YWNpw7NuIGRlIGVzdHVkaW9zLiBFbmbDs2NhdGUgZW4gaG9yYXJpb3MsIGNhbGVuZGFyaW9zIHkgcGxhbmVzIGRlIGVzdHVkaW8uJyxcbiAgICBbQ29udmVyc2F0aW9uTW9kZS5UVVRPUklOR106ICdFc3TDoXMgZW4gbW9kbyB0dXRvcsOtYS4gQXl1ZGEgY29uIGNvbmNlcHRvcyBhY2Fkw6ltaWNvcywgZWplcmNpY2lvcyB5IGV4cGxpY2FjaW9uZXMgZGV0YWxsYWRhcy4nLFxuICAgIFtDb252ZXJzYXRpb25Nb2RlLk9SR0FOSVpJTkddOiAnRXN0w6FzIGF5dWRhbmRvIGNvbiBvcmdhbml6YWNpw7NuIGRlIG1hdGVyaWFsZXMgeSByZWN1cnNvcyBkZSBlc3R1ZGlvLicsXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXTogJ0VzdMOhcyBhbmFsaXphbmRvIHByb2dyZXNvIHkgcmVuZGltaWVudG8gYWNhZMOpbWljbyBkZWwgZXN0dWRpYW50ZS4nLFxuICAgIFtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXTogJ0VzdMOhcyBlbiBjb252ZXJzYWNpw7NuIGNhc3VhbCwgcHJvcG9yY2lvbmFuZG8gYXBveW8gbW90aXZhY2lvbmFsIHkgcmVzcHVlc3RhcyBnZW5lcmFsZXMuJ1xuICB9XG4gIFxuICByZXR1cm4gY29udGV4dHNbbW9kZV0gfHwgY29udGV4dHNbQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR11cbn1cblxuZnVuY3Rpb24gZ2V0VGVtcGxhdGVSZXNwb25zZShtb2RlOiBDb252ZXJzYXRpb25Nb2RlLCBtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmcge1xuICBjb25zdCB0ZW1wbGF0ZXMgPSB7XG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiBgRW50aWVuZG8gcXVlIG5lY2VzaXRhcyBheXVkYSBjb24gcGxhbmlmaWNhY2nDs24uIENvbW8gU2FyYSwgcHVlZG8gYXl1ZGFydGUgYTpcblxu4oCiIE9yZ2FuaXphciB0dSBob3JhcmlvIGRlIGVzdHVkaW9cbuKAoiBDcmVhciBwbGFuZXMgcGVyc29uYWxpemFkb3NcbuKAoiBPcHRpbWl6YXIgdHUgdGllbXBvXG7igKIgUHJvZ3JhbWFyIHNlc2lvbmVzIGVmZWN0aXZhc1xuXG7Cv1F1w6kgYXNwZWN0byBlc3BlY8OtZmljbyBkZSBsYSBwbGFuaWZpY2FjacOzbiB0ZSBndXN0YXLDrWEgYWJvcmRhcj9gLFxuXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkddOiBgQ29tbyB0dSB0dXRvciBwZXJzb25hbCwgZXN0b3kgYXF1w60gcGFyYSBheXVkYXJ0ZSBjb246XG5cbuKAoiBFeHBsaWNhY2lvbmVzIGRlIGNvbmNlcHRvc1xu4oCiIFJlc29sdWNpw7NuIGRlIGVqZXJjaWNpb3MgcGFzbyBhIHBhc29cbuKAoiBQcsOhY3RpY2EgZGlyaWdpZGFcbuKAoiBBY2xhcmFjacOzbiBkZSBkdWRhc1xuXG7Cv0VuIHF1w6kgbWF0ZXJpYSBvIHRlbWEgZXNwZWPDrWZpY28gbmVjZXNpdGFzIGF5dWRhP2AsXG5cbiAgICBbQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXTogYFRlIGF5dWRvIGEgb3JnYW5pemFyIHR1cyByZWN1cnNvcyBkZSBlc3R1ZGlvOlxuXG7igKIgR2VzdGnDs24gZGUgbWF0ZXJpYWxlc1xu4oCiIE9yZ2FuaXphY2nDs24gZGUgYXB1bnRlc1xu4oCiIELDunNxdWVkYSBkZSByZWN1cnNvc1xu4oCiIEVzdHJ1Y3R1cmFjacOzbiBkZSBjb250ZW5pZG9cblxuwr9RdcOpIG5lY2VzaXRhcyBvcmdhbml6YXIgZXNwZWPDrWZpY2FtZW50ZT9gLFxuXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXTogYEFuYWxpY2Vtb3MgdHUgcHJvZ3Jlc28gYWNhZMOpbWljbzpcblxu4oCiIFJldmlzacOzbiBkZSBjYWxpZmljYWNpb25lc1xu4oCiIEFuw6FsaXNpcyBkZSB0ZW5kZW5jaWFzXG7igKIgSWRlbnRpZmljYWNpw7NuIGRlIMOhcmVhcyBkZSBtZWpvcmFcbuKAoiBSZWNvbWVuZGFjaW9uZXMgcGVyc29uYWxpemFkYXNcblxuwr9RdcOpIGFzcGVjdG8gZGUgdHUgcmVuZGltaWVudG8gcXVpZXJlcyByZXZpc2FyP2AsXG5cbiAgICBbQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR106IGDCoUhvbGEhIFNveSBTYXJhLCB0dSBhc2lzdGVudGUgYWNhZMOpbWljbyBwZXJzb25hbC4gXG5cbkVzdG95IGFxdcOtIHBhcmEgYXBveWFydGUgZW4gdHUgY2FtaW5vIGVkdWNhdGl2by4gUHVlZG8gYXl1ZGFydGUgY29uIG9yZ2FuaXphY2nDs24sIHBsYW5pZmljYWNpw7NuLCB0dXRvcsOtYSB5IG11Y2hvIG3DoXMuXG5cbsK/RW4gcXXDqSBwdWVkbyBheXVkYXJ0ZSBob3k/YFxuICB9XG5cbiAgcmV0dXJuIHRlbXBsYXRlc1ttb2RlXSB8fCB0ZW1wbGF0ZXNbQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR11cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVNb2RlU3VnZ2VzdGlvbnMobW9kZTogQ29udmVyc2F0aW9uTW9kZSk6IHN0cmluZ1tdIHtcbiAgY29uc3Qgc3VnZ2VzdGlvbnMgPSB7XG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiBbXG4gICAgICAnQ3JlYXIgcGxhbiBkZSBlc3R1ZGlvIHNlbWFuYWwnLFxuICAgICAgJ09wdGltaXphciBtaSBob3JhcmlvJyxcbiAgICAgICdQcm9ncmFtYXIgc2VzaW9uZXMgZGUgcmVwYXNvJyxcbiAgICAgICdBbmFsaXphciB0aWVtcG8gZGlzcG9uaWJsZSdcbiAgICBdLFxuICAgIFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HXTogW1xuICAgICAgJ0V4cGxpY2FyIGNvbmNlcHRvIGRlIG1hdGVtw6F0aWNhcycsXG4gICAgICAnUmVzb2x2ZXIgZWplcmNpY2lvIHBhc28gYSBwYXNvJyxcbiAgICAgICdQcmFjdGljYXIgcHJvYmxlbWFzJyxcbiAgICAgICdBY2xhcmFyIGR1ZGFzJ1xuICAgIF0sXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuT1JHQU5JWklOR106IFtcbiAgICAgICdPcmdhbml6YXIgbWlzIG1hdGVyaWFsZXMnLFxuICAgICAgJ0J1c2NhciByZWN1cnNvcyBkZSBlc3R1ZGlvJyxcbiAgICAgICdFc3RydWN0dXJhciBtaXMgYXB1bnRlcycsXG4gICAgICAnR2VzdGlvbmFyIGFyY2hpdm9zJ1xuICAgIF0sXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXTogW1xuICAgICAgJ0FuYWxpemFyIG1pIHByb2dyZXNvJyxcbiAgICAgICdWZXIgdGVuZGVuY2lhcyBkZSBjYWxpZmljYWNpb25lcycsXG4gICAgICAnUmV2aXNhciBvYmpldGl2b3MnLFxuICAgICAgJ0lkZW50aWZpY2FyIMOhcmVhcyBkZSBtZWpvcmEnXG4gICAgXSxcbiAgICBbQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR106IFtcbiAgICAgICdQbGFuaWZpY2FyIG1pIHNlbWFuYScsXG4gICAgICAnTmVjZXNpdG8gbW90aXZhY2nDs24nLFxuICAgICAgJ0F5dWRhIGNvbiBvcmdhbml6YWNpw7NuJyxcbiAgICAgICdBbmFsaXphciBtaSByZW5kaW1pZW50bydcbiAgICBdXG4gIH1cblxuICByZXR1cm4gc3VnZ2VzdGlvbnNbbW9kZV0gfHwgc3VnZ2VzdGlvbnNbQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR11cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVGb2xsb3dVcFF1ZXN0aW9ucyhtb2RlOiBDb252ZXJzYXRpb25Nb2RlKTogc3RyaW5nW10ge1xuICBjb25zdCBxdWVzdGlvbnMgPSB7XG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiBbXG4gICAgICAnwr9QYXJhIHF1w6kgcGVyw61vZG8gcXVpZXJlcyBwbGFuaWZpY2FyPycsXG4gICAgICAnwr9IYXkgYWxndW5hIG1hdGVyaWEgcXVlIHJlcXVpZXJlIGF0ZW5jacOzbiBlc3BlY2lhbD8nXG4gICAgXSxcbiAgICBbQ29udmVyc2F0aW9uTW9kZS5UVVRPUklOR106IFtcbiAgICAgICfCv0VuIHF1w6kgbWF0ZXJpYSB0aWVuZXMgbcOhcyBkaWZpY3VsdGFkZXM/JyxcbiAgICAgICfCv1ByZWZpZXJlcyBleHBsaWNhY2lvbmVzIHRlw7NyaWNhcyBvIGVqZXJjaWNpb3MgcHLDoWN0aWNvcz8nXG4gICAgXSxcbiAgICBbQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXTogW1xuICAgICAgJ8K/UXXDqSB0aXBvIGRlIG1hdGVyaWFsZXMgbmVjZXNpdGFzIG9yZ2FuaXphcj8nLFxuICAgICAgJ8K/UGFyYSBxdcOpIG1hdGVyaWFzIGJ1c2NhcyByZWN1cnNvcyBhZGljaW9uYWxlcz8nXG4gICAgXSxcbiAgICBbQ29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkddOiBbXG4gICAgICAnwr9RdcOpIHBlcsOtb2RvIHF1aWVyZXMgYW5hbGl6YXI/JyxcbiAgICAgICfCv0hheSBhbGd1bmEgbWF0ZXJpYSBlc3BlY8OtZmljYSBxdWUgdGUgcHJlb2N1cGE/J1xuICAgIF0sXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkddOiBbXG4gICAgICAnwr9Dw7NtbyB0ZSBzaWVudGVzIGNvbiB0dXMgZXN0dWRpb3MgYWN0dWFsbWVudGU/JyxcbiAgICAgICfCv0VuIHF1w6kgw6FyZWEgYWNhZMOpbWljYSBwdWVkbyBhcG95YXJ0ZSBtw6FzPydcbiAgICBdXG4gIH1cblxuICByZXR1cm4gcXVlc3Rpb25zW21vZGVdIHx8IHF1ZXN0aW9uc1tDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTZXJ2ZXJTZXNzaW9uIiwiYXV0aE9wdGlvbnMiLCJBZHZhbmNlZENvbW1hbmRQcm9jZXNzb3IiLCJDb252ZXJzYXRpb25Nb2RlIiwiU2FyYVBlcnNvbmFsaXR5RW5naW5lIiwiYWlTZXJ2aWNlIiwiQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlciIsIlBPU1QiLCJyZXF1ZXN0Iiwic2Vzc2lvbiIsInVzZXIiLCJqc29uIiwiZXJyb3IiLCJzdGF0dXMiLCJib2R5IiwibWVzc2FnZSIsInVzZXJJZCIsInVzZXJOYW1lIiwic2Vzc2lvbklkIiwiY3VycmVudE1vZGUiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwiYWN0dWFsU2Vzc2lvbklkIiwiRGF0ZSIsIm5vdyIsInRvU3RyaW5nIiwiY29uc29sZSIsImxvZyIsImNvbW1hbmRDb250ZXh0IiwiQ0hBVFRJTkciLCJsYXN0Q29tbWFuZHMiLCJjb21tYW5kUmVzdWx0IiwicHJvY2Vzc0NvbW1hbmQiLCJDb250ZXh0dWFsQ29udmVyc2F0aW9uTWFuYWdlciIsInJlcXVpcmUiLCJjb250ZXh0dWFsUmVzcG9uc2UiLCJwcm9jZXNzQ29udGV4dHVhbE1lc3NhZ2UiLCJjb250ZW50TGVuZ3RoIiwiY29udGVudCIsImxlbmd0aCIsInBlcnNvbmFsaXphdGlvbnMiLCJjb250aW51aXR5U2NvcmUiLCJoYXNWaXN1YWxSZWNvbW1lbmRhdGlvbiIsInZpc3VhbFJlY29tbWVuZGF0aW9uIiwicmVzcG9uc2UiLCJkZXRlY3RlZEludGVudCIsImluY2x1ZGVzIiwic3VnZ2VzdGVkQWN0aW9ucyIsInN1Z2dlc3RlZEZvbGxvd3VwcyIsImZvbGxvd1VwUXVlc3Rpb25zIiwidmlzdWFsaXphdGlvbnMiLCJ0eXBlIiwiZGF0YSIsInJlYXNvbiIsInByaW9yaXR5IiwicmVzb3VyY2VzIiwiY29udGV4dHVhbEVycm9yIiwic3VjY2VzcyIsInNhcmFSZXNwb25zZSIsImdlbmVyYXRlQ29udGV4dHVhbFJlc3BvbnNlIiwic3VnZ2VzdGVkTW9kZSIsInVuZGVmaW5lZCIsImZhbGxiYWNrUmVzcG9uc2UiLCJnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UiLCJnZW5lcmF0ZU1vZGVTdWdnZXN0aW9ucyIsImdlbmVyYXRlRm9sbG93VXBRdWVzdGlvbnMiLCJFcnJvciIsIm1vZGVDb250ZXh0IiwiZ2V0TW9kZUNvbnRleHQiLCJtZW1vcnlDb250ZXh0IiwiY29udGV4dHVhbFN1bW1hcnkiLCJnZW5lcmF0ZUNvbnRleHR1YWxTdW1tYXJ5IiwicGVyc29uYWxpemVkU3VnZ2VzdGlvbnMiLCJnZXRQZXJzb25hbGl6ZWRTdWdnZXN0aW9ucyIsIm1hcCIsInMiLCJqb2luIiwicHJvbXB0IiwiZ2VuZXJhdGVFeGVyY2lzZSIsInRlbXBsYXRlUmVzcG9uc2UiLCJnZXRUZW1wbGF0ZVJlc3BvbnNlIiwic2F2ZUNvbnZlcnNhdGlvblR1cm4iLCJtb2RlIiwiY29udGV4dHMiLCJQTEFOTklORyIsIlRVVE9SSU5HIiwiT1JHQU5JWklORyIsIlJFVklFV0lORyIsInRlbXBsYXRlcyIsInN1Z2dlc3Rpb25zIiwicXVlc3Rpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/ai-chat/enhanced-message/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/academic-analyzer.ts":
/*!**************************************!*\
  !*** ./src/lib/academic-analyzer.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AcademicAnalyzer: () => (/* binding */ AcademicAnalyzer),\n/* harmony export */   AcademicSubject: () => (/* binding */ AcademicSubject),\n/* harmony export */   DifficultyLevel: () => (/* binding */ DifficultyLevel),\n/* harmony export */   SUBJECT_TOPICS: () => (/* binding */ SUBJECT_TOPICS)\n/* harmony export */ });\n/* harmony import */ var _temp_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n\n// Definición de materias académicas\nvar AcademicSubject = /*#__PURE__*/ function(AcademicSubject) {\n    AcademicSubject[\"MATHEMATICS\"] = \"mathematics\";\n    AcademicSubject[\"PHYSICS\"] = \"physics\";\n    AcademicSubject[\"CHEMISTRY\"] = \"chemistry\";\n    AcademicSubject[\"BIOLOGY\"] = \"biology\";\n    AcademicSubject[\"SPANISH\"] = \"spanish\";\n    AcademicSubject[\"ENGLISH\"] = \"english\";\n    AcademicSubject[\"HISTORY\"] = \"history\";\n    AcademicSubject[\"GEOGRAPHY\"] = \"geography\";\n    AcademicSubject[\"GENERAL\"] = \"general\";\n    return AcademicSubject;\n}({});\n// Nivel de dificultad detectado\nvar DifficultyLevel = /*#__PURE__*/ function(DifficultyLevel) {\n    DifficultyLevel[\"BASIC\"] = \"basic\";\n    DifficultyLevel[\"INTERMEDIATE\"] = \"intermediate\";\n    DifficultyLevel[\"ADVANCED\"] = \"advanced\";\n    DifficultyLevel[\"REVIEW_NEEDED\"] = \"review_needed\";\n    return DifficultyLevel;\n}({});\n// Temas específicos por materia\nconst SUBJECT_TOPICS = {\n    [\"mathematics\"]: [\n        'algebra',\n        'geometria',\n        'trigonometria',\n        'calculo',\n        'estadistica',\n        'probabilidad',\n        'ecuaciones',\n        'funciones',\n        'logaritmos',\n        'matrices',\n        'derivadas',\n        'integrales'\n    ],\n    [\"physics\"]: [\n        'cinematica',\n        'dinamica',\n        'energia',\n        'ondas',\n        'termodinamica',\n        'electricidad',\n        'magnetismo',\n        'optica',\n        'mecanica',\n        'fluidos',\n        'movimiento',\n        'fuerza',\n        'velocidad'\n    ],\n    [\"chemistry\"]: [\n        'atomos',\n        'moleculas',\n        'enlaces',\n        'reacciones',\n        'estequiometria',\n        'acidos',\n        'bases',\n        'oxidacion',\n        'reduccion',\n        'equilibrio',\n        'cinetica',\n        'termoquimica'\n    ]\n};\n// Palabras clave que indican dificultades\nconst DIFFICULTY_INDICATORS = {\n    high: [\n        'muy difícil',\n        'no entiendo',\n        'confuso',\n        'complicado',\n        'imposible',\n        'no puedo'\n    ],\n    medium: [\n        'difícil',\n        'complicado',\n        'no comprendo',\n        'me cuesta',\n        'problema'\n    ],\n    low: [\n        'un poco difícil',\n        'necesito ayuda',\n        'no está claro',\n        'dudas'\n    ]\n};\n// Palabras clave que indican progreso positivo\nconst PROGRESS_INDICATORS = {\n    excellent: [\n        'excelente',\n        'perfecto',\n        'domino',\n        'fácil',\n        'entiendo todo'\n    ],\n    good: [\n        'bien',\n        'entiendo',\n        'comprendo',\n        'logré',\n        'mejorando'\n    ],\n    fair: [\n        'más o menos',\n        'regular',\n        'algunas veces',\n        'avanzando'\n    ]\n};\nclass AcademicAnalyzer {\n    /**\n   * Analiza los reportes académicos de un estudiante\n   */ static async analyzeStudent(userId) {\n        const reports = _temp_storage__WEBPACK_IMPORTED_MODULE_0__.tempWeeklyReports.filter((report)=>report.userId === userId);\n        if (reports.length === 0) {\n            return this.createDefaultAnalysis(userId);\n        }\n        // Analizar reportes recientes (últimas 8 semanas)\n        const recentReports = reports.sort((a, b)=>new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime()).slice(0, 8);\n        // Extraer todo el texto de las respuestas\n        const allResponseText = recentReports.flatMap((report)=>Object.values(report.responses || {})).filter(Boolean).join(' ').toLowerCase();\n        // Analizar por materias\n        const subjectAnalyses = this.analyzeSubjects(allResponseText, recentReports);\n        // Análisis general\n        const overallPerformance = this.calculateOverallPerformance(subjectAnalyses);\n        const strugglingAreas = this.identifyStrugglingAreas(subjectAnalyses, allResponseText);\n        const strengths = this.identifyStrengths(subjectAnalyses, allResponseText);\n        const recommendedTopics = this.generateRecommendations(subjectAnalyses);\n        const learningPattern = this.identifyLearningPattern(allResponseText);\n        return {\n            userId,\n            subjects: subjectAnalyses,\n            overallPerformance,\n            strugglingAreas,\n            strengths,\n            recommendedTopics,\n            learningPattern,\n            lastReportDate: new Date(recentReports[0]?.createdAt || Date.now())\n        };\n    }\n    /**\n   * Analiza materias específicas mencionadas en los reportes\n   */ static analyzeSubjects(text, reports) {\n        const analyses = [];\n        // Palabras clave para identificar materias\n        const subjectKeywords = {\n            [\"mathematics\"]: [\n                'matemática',\n                'matemáticas',\n                'mate',\n                'álgebra',\n                'geometría',\n                'cálculo',\n                'números'\n            ],\n            [\"physics\"]: [\n                'física',\n                'mecánica',\n                'energía',\n                'fuerza',\n                'movimiento',\n                'velocidad'\n            ],\n            [\"chemistry\"]: [\n                'química',\n                'átomos',\n                'moléculas',\n                'reacciones',\n                'elementos',\n                'laboratorio'\n            ],\n            [\"biology\"]: [\n                'biología',\n                'células',\n                'organismos',\n                'evolución',\n                'ecosistema'\n            ],\n            [\"spanish\"]: [\n                'lengua',\n                'español',\n                'literatura',\n                'redacción',\n                'gramática'\n            ],\n            [\"english\"]: [\n                'inglés',\n                'english',\n                'grammar',\n                'vocabulary'\n            ],\n            [\"history\"]: [\n                'historia',\n                'civilización',\n                'época',\n                'guerra',\n                'revolución'\n            ],\n            [\"geography\"]: [\n                'geografía',\n                'países',\n                'continentes',\n                'clima',\n                'población'\n            ]\n        };\n        Object.entries(subjectKeywords).forEach(([subject, keywords])=>{\n            const mentions = keywords.filter((keyword)=>text.includes(keyword)).length;\n            if (mentions > 0) {\n                const analysis = this.analyzeSpecificSubject(subject, text, reports, mentions);\n                analyses.push(analysis);\n            }\n        });\n        // Si no se encontraron materias específicas, agregar análisis general\n        if (analyses.length === 0) {\n            analyses.push(this.createGeneralSubjectAnalysis(text, reports));\n        }\n        return analyses;\n    }\n    /**\n   * Analiza una materia específica\n   */ static analyzeSpecificSubject(subject, text, reports, mentions) {\n        const subjectName = this.getSubjectDisplayName(subject);\n        const topics = SUBJECT_TOPICS[subject] || [];\n        // Detectar temas mencionados\n        const mentionedTopics = topics.filter((topic)=>text.includes(topic));\n        // Analizar dificultades específicas\n        const specificChallenges = this.extractSpecificChallenges(text, subject);\n        // Calcular rendimiento basado en indicadores\n        const performance = this.calculateSubjectPerformance(text, specificChallenges.length);\n        // Determinar nivel de dificultad\n        const difficultyLevel = this.determineDifficultyLevel(performance, specificChallenges.length);\n        // Determinar si necesita atención\n        const needsAttention = performance < 60 || specificChallenges.length > 2;\n        return {\n            subject,\n            subjectName,\n            performance,\n            difficultyLevel,\n            strugglingTopics: mentionedTopics.slice(0, 3),\n            masteredTopics: performance > 75 ? mentionedTopics.slice(0, 2) : [],\n            recentMentions: mentions,\n            needsAttention,\n            specificChallenges\n        };\n    }\n    /**\n   * Extrae desafíos específicos mencionados por el estudiante\n   */ static extractSpecificChallenges(text, subject) {\n        const challenges = [];\n        // Buscar patrones de dificultad\n        const difficultyPatterns = [\n            /no entiendo (.*?)(?:\\.|,|$)/g,\n            /me cuesta (.*?)(?:\\.|,|$)/g,\n            /difícil (.*?)(?:\\.|,|$)/g,\n            /problema con (.*?)(?:\\.|,|$)/g,\n            /confuso (.*?)(?:\\.|,|$)/g\n        ];\n        difficultyPatterns.forEach((pattern)=>{\n            let match;\n            while((match = pattern.exec(text)) !== null){\n                if (match[1] && match[1].length < 50) {\n                    challenges.push(match[1].trim());\n                }\n            }\n        });\n        return challenges.slice(0, 3) // Máximo 3 desafíos específicos\n        ;\n    }\n    /**\n   * Calcula el rendimiento de una materia\n   */ static calculateSubjectPerformance(text, challengesCount) {\n        let score = 70 // Base score\n        ;\n        // Indicadores positivos\n        Object.entries(PROGRESS_INDICATORS).forEach(([level, indicators])=>{\n            const multiplier = level === 'excellent' ? 10 : level === 'good' ? 5 : 2;\n            indicators.forEach((indicator)=>{\n                if (text.includes(indicator)) {\n                    score += multiplier;\n                }\n            });\n        });\n        // Indicadores negativos\n        Object.entries(DIFFICULTY_INDICATORS).forEach(([level, indicators])=>{\n            const penalty = level === 'high' ? 15 : level === 'medium' ? 10 : 5;\n            indicators.forEach((indicator)=>{\n                if (text.includes(indicator)) {\n                    score -= penalty;\n                }\n            });\n        });\n        // Penalizar por número de desafíos específicos\n        score -= challengesCount * 8;\n        return Math.max(0, Math.min(100, score));\n    }\n    /**\n   * Determina el nivel de dificultad basado en el rendimiento\n   */ static determineDifficultyLevel(performance, challengesCount) {\n        if (performance < 40 || challengesCount > 3) return \"review_needed\";\n        if (performance < 60) return \"basic\";\n        if (performance < 80) return \"intermediate\";\n        return \"advanced\";\n    }\n    /**\n   * Crea análisis por defecto para estudiantes sin reportes\n   */ static createDefaultAnalysis(userId) {\n        return {\n            userId,\n            subjects: [\n                this.createGeneralSubjectAnalysis('', [])\n            ],\n            overallPerformance: 50,\n            strugglingAreas: [\n                'Falta de datos históricos'\n            ],\n            strengths: [\n                'Nuevo estudiante con potencial'\n            ],\n            recommendedTopics: [\n                'Evaluación inicial',\n                'Fundamentos'\n            ],\n            learningPattern: 'mixed',\n            lastReportDate: new Date()\n        };\n    }\n    /**\n   * Crea análisis general cuando no se detectan materias específicas\n   */ static createGeneralSubjectAnalysis(text, reports) {\n        const performance = text.length > 0 ? this.calculateSubjectPerformance(text, 0) : 50;\n        return {\n            subject: \"general\",\n            subjectName: 'Análisis General',\n            performance,\n            difficultyLevel: this.determineDifficultyLevel(performance, 0),\n            strugglingTopics: [],\n            masteredTopics: [],\n            recentMentions: reports.length,\n            needsAttention: performance < 60,\n            specificChallenges: this.extractSpecificChallenges(text, \"general\")\n        };\n    }\n    /**\n   * Calcula el rendimiento general\n   */ static calculateOverallPerformance(subjects) {\n        if (subjects.length === 0) return 50;\n        const average = subjects.reduce((sum, subject)=>sum + subject.performance, 0) / subjects.length;\n        return Math.round(average);\n    }\n    /**\n   * Identifica áreas con dificultades\n   */ static identifyStrugglingAreas(subjects, text) {\n        const areas = [];\n        // Agregar materias con bajo rendimiento\n        subjects.filter((subject)=>subject.needsAttention).forEach((subject)=>{\n            areas.push(`${subject.subjectName}: ${subject.specificChallenges.join(', ')}`);\n        });\n        // Si no hay áreas específicas, buscar patrones generales\n        if (areas.length === 0 && text.length > 0) {\n            if (text.includes('tiempo')) areas.push('Gestión del tiempo');\n            if (text.includes('concentr')) areas.push('Concentración');\n            if (text.includes('motiv')) areas.push('Motivación');\n        }\n        return areas.slice(0, 3);\n    }\n    /**\n   * Identifica fortalezas del estudiante\n   */ static identifyStrengths(subjects, text) {\n        const strengths = [];\n        // Agregar materias con buen rendimiento\n        subjects.filter((subject)=>subject.performance > 75).forEach((subject)=>{\n            strengths.push(`Dominio en ${subject.subjectName}`);\n        });\n        // Patrones de fortaleza general\n        if (text.includes('organiz')) strengths.push('Capacidad de organización');\n        if (text.includes('persever') || text.includes('persist')) strengths.push('Perseverancia');\n        if (text.includes('creativ')) strengths.push('Pensamiento creativo');\n        return strengths.length > 0 ? strengths.slice(0, 3) : [\n            'Dedicación al aprendizaje'\n        ];\n    }\n    /**\n   * Genera recomendaciones de temas\n   */ static generateRecommendations(subjects) {\n        const recommendations = [];\n        subjects.forEach((subject)=>{\n            if (subject.needsAttention) {\n                recommendations.push(`Reforzar conceptos básicos de ${subject.subjectName}`);\n                if (subject.strugglingTopics.length > 0) {\n                    recommendations.push(`Practicar: ${subject.strugglingTopics.join(', ')}`);\n                }\n            }\n        });\n        return recommendations.slice(0, 4);\n    }\n    /**\n   * Identifica el patrón de aprendizaje\n   */ static identifyLearningPattern(text) {\n        const visualKeywords = [\n            'gráfico',\n            'diagrama',\n            'imagen',\n            'visual',\n            'dibujo'\n        ];\n        const analyticalKeywords = [\n            'análisis',\n            'lógica',\n            'razonamiento',\n            'teoría'\n        ];\n        const practicalKeywords = [\n            'práctica',\n            'ejercicio',\n            'aplicar',\n            'hacer'\n        ];\n        const visualCount = visualKeywords.reduce((count, word)=>count + (text.includes(word) ? 1 : 0), 0);\n        const analyticalCount = analyticalKeywords.reduce((count, word)=>count + (text.includes(word) ? 1 : 0), 0);\n        const practicalCount = practicalKeywords.reduce((count, word)=>count + (text.includes(word) ? 1 : 0), 0);\n        if (visualCount > analyticalCount && visualCount > practicalCount) return 'visual';\n        if (analyticalCount > practicalCount) return 'analytical';\n        if (practicalCount > 0) return 'practical';\n        return 'mixed';\n    }\n    /**\n   * Obtiene el nombre de visualización de una materia\n   */ static getSubjectDisplayName(subject) {\n        const names = {\n            [\"mathematics\"]: 'Matemáticas',\n            [\"physics\"]: 'Física',\n            [\"chemistry\"]: 'Química',\n            [\"biology\"]: 'Biología',\n            [\"spanish\"]: 'Lengua y Literatura',\n            [\"english\"]: 'Inglés',\n            [\"history\"]: 'Historia',\n            [\"geography\"]: 'Geografía',\n            [\"general\"]: 'General'\n        };\n        return names[subject] || 'Materia';\n    }\n    /**\n   * Obtiene un resumen contextual para generar ejercicios\n   */ static getExerciseContext(analysis, subject) {\n        const targetSubject = subject || analysis.subjects[0]?.subject || \"general\";\n        const subjectAnalysis = analysis.subjects.find((s)=>s.subject === targetSubject);\n        if (!subjectAnalysis) {\n            return `Estudiante: nivel intermedio, necesita evaluación inicial en ${targetSubject}`;\n        }\n        const context = [\n            `Materia: ${subjectAnalysis.subjectName}`,\n            `Nivel: ${subjectAnalysis.difficultyLevel}`,\n            `Rendimiento actual: ${subjectAnalysis.performance}%`,\n            subjectAnalysis.specificChallenges.length > 0 ? `Dificultades específicas: ${subjectAnalysis.specificChallenges.join(', ')}` : null,\n            subjectAnalysis.strugglingTopics.length > 0 ? `Temas a reforzar: ${subjectAnalysis.strugglingTopics.join(', ')}` : null,\n            `Patrón de aprendizaje: ${analysis.learningPattern}`\n        ].filter(Boolean).join('. ');\n        return context;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FjYWRlbWljLWFuYWx5emVyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWtEO0FBRWxELG9DQUFvQztBQUM3Qiw2Q0FBS0M7Ozs7Ozs7Ozs7V0FBQUE7TUFVWDtBQUVELGdDQUFnQztBQUN6Qiw2Q0FBS0M7Ozs7O1dBQUFBO01BS1g7QUFFRCxnQ0FBZ0M7QUFDekIsTUFBTUMsaUJBQWlCO0lBQzVCLGVBQTZCLEVBQUU7UUFDN0I7UUFBVztRQUFhO1FBQWlCO1FBQVc7UUFBZTtRQUNuRTtRQUFjO1FBQWE7UUFBYztRQUFZO1FBQWE7S0FDbkU7SUFDRCxXQUF5QixFQUFFO1FBQ3pCO1FBQWM7UUFBWTtRQUFXO1FBQVM7UUFBaUI7UUFDL0Q7UUFBYztRQUFVO1FBQVk7UUFBVztRQUFjO1FBQVU7S0FDeEU7SUFDRCxhQUEyQixFQUFFO1FBQzNCO1FBQVU7UUFBYTtRQUFXO1FBQWM7UUFBa0I7UUFDbEU7UUFBUztRQUFhO1FBQWE7UUFBYztRQUFZO0tBQzlEO0FBQ0gsRUFBQztBQUVELDBDQUEwQztBQUMxQyxNQUFNQyx3QkFBd0I7SUFDNUJDLE1BQU07UUFBQztRQUFlO1FBQWU7UUFBVztRQUFjO1FBQWE7S0FBVztJQUN0RkMsUUFBUTtRQUFDO1FBQVc7UUFBYztRQUFnQjtRQUFhO0tBQVc7SUFDMUVDLEtBQUs7UUFBQztRQUFtQjtRQUFrQjtRQUFpQjtLQUFRO0FBQ3RFO0FBRUEsK0NBQStDO0FBQy9DLE1BQU1DLHNCQUFzQjtJQUMxQkMsV0FBVztRQUFDO1FBQWE7UUFBWTtRQUFVO1FBQVM7S0FBZ0I7SUFDeEVDLE1BQU07UUFBQztRQUFRO1FBQVk7UUFBYTtRQUFTO0tBQVk7SUFDN0RDLE1BQU07UUFBQztRQUFlO1FBQVc7UUFBaUI7S0FBWTtBQUNoRTtBQTBCTyxNQUFNQztJQUVYOztHQUVDLEdBQ0QsYUFBYUMsZUFBZUMsTUFBYyxFQUE2QjtRQUNyRSxNQUFNQyxVQUFVZiw0REFBaUJBLENBQUNnQixNQUFNLENBQUNDLENBQUFBLFNBQVVBLE9BQU9ILE1BQU0sS0FBS0E7UUFFckUsSUFBSUMsUUFBUUcsTUFBTSxLQUFLLEdBQUc7WUFDeEIsT0FBTyxJQUFJLENBQUNDLHFCQUFxQixDQUFDTDtRQUNwQztRQUVBLGtEQUFrRDtRQUNsRCxNQUFNTSxnQkFBZ0JMLFFBQ25CTSxJQUFJLENBQUMsQ0FBQ0MsR0FBR0MsSUFBTSxJQUFJQyxLQUFLRCxFQUFFRSxTQUFTLEVBQUVDLE9BQU8sS0FBSyxJQUFJRixLQUFLRixFQUFFRyxTQUFTLEVBQUVDLE9BQU8sSUFDOUVDLEtBQUssQ0FBQyxHQUFHO1FBRVosMENBQTBDO1FBQzFDLE1BQU1DLGtCQUFrQlIsY0FDckJTLE9BQU8sQ0FBQ1osQ0FBQUEsU0FBVWEsT0FBT0MsTUFBTSxDQUFDZCxPQUFPZSxTQUFTLElBQUksQ0FBQyxJQUNyRGhCLE1BQU0sQ0FBQ2lCLFNBQ1BDLElBQUksQ0FBQyxLQUNMQyxXQUFXO1FBRWQsd0JBQXdCO1FBQ3hCLE1BQU1DLGtCQUFrQixJQUFJLENBQUNDLGVBQWUsQ0FBQ1QsaUJBQWlCUjtRQUU5RCxtQkFBbUI7UUFDbkIsTUFBTWtCLHFCQUFxQixJQUFJLENBQUNDLDJCQUEyQixDQUFDSDtRQUM1RCxNQUFNSSxrQkFBa0IsSUFBSSxDQUFDQyx1QkFBdUIsQ0FBQ0wsaUJBQWlCUjtRQUN0RSxNQUFNYyxZQUFZLElBQUksQ0FBQ0MsaUJBQWlCLENBQUNQLGlCQUFpQlI7UUFDMUQsTUFBTWdCLG9CQUFvQixJQUFJLENBQUNDLHVCQUF1QixDQUFDVDtRQUN2RCxNQUFNVSxrQkFBa0IsSUFBSSxDQUFDQyx1QkFBdUIsQ0FBQ25CO1FBRXJELE9BQU87WUFDTGQ7WUFDQWtDLFVBQVVaO1lBQ1ZFO1lBQ0FFO1lBQ0FFO1lBQ0FFO1lBQ0FFO1lBQ0FHLGdCQUFnQixJQUFJekIsS0FBS0osYUFBYSxDQUFDLEVBQUUsRUFBRUssYUFBYUQsS0FBSzBCLEdBQUc7UUFDbEU7SUFDRjtJQUVBOztHQUVDLEdBQ0QsT0FBZWIsZ0JBQWdCYyxJQUFZLEVBQUVwQyxPQUFjLEVBQXFCO1FBQzlFLE1BQU1xQyxXQUE4QixFQUFFO1FBRXRDLDJDQUEyQztRQUMzQyxNQUFNQyxrQkFBa0I7WUFDdEIsZUFBNkIsRUFBRTtnQkFBQztnQkFBYztnQkFBZTtnQkFBUTtnQkFBVztnQkFBYTtnQkFBVzthQUFVO1lBQ2xILFdBQXlCLEVBQUU7Z0JBQUM7Z0JBQVU7Z0JBQVk7Z0JBQVc7Z0JBQVU7Z0JBQWM7YUFBWTtZQUNqRyxhQUEyQixFQUFFO2dCQUFDO2dCQUFXO2dCQUFVO2dCQUFhO2dCQUFjO2dCQUFhO2FBQWM7WUFDekcsV0FBeUIsRUFBRTtnQkFBQztnQkFBWTtnQkFBVztnQkFBYztnQkFBYTthQUFhO1lBQzNGLFdBQXlCLEVBQUU7Z0JBQUM7Z0JBQVU7Z0JBQVc7Z0JBQWM7Z0JBQWE7YUFBWTtZQUN4RixXQUF5QixFQUFFO2dCQUFDO2dCQUFVO2dCQUFXO2dCQUFXO2FBQWE7WUFDekUsV0FBeUIsRUFBRTtnQkFBQztnQkFBWTtnQkFBZ0I7Z0JBQVM7Z0JBQVU7YUFBYTtZQUN4RixhQUEyQixFQUFFO2dCQUFDO2dCQUFhO2dCQUFVO2dCQUFlO2dCQUFTO2FBQVk7UUFDM0Y7UUFFQXZCLE9BQU93QixPQUFPLENBQUNELGlCQUFpQkUsT0FBTyxDQUFDLENBQUMsQ0FBQ0MsU0FBU0MsU0FBUztZQUMxRCxNQUFNQyxXQUFXRCxTQUFTekMsTUFBTSxDQUFDMkMsQ0FBQUEsVUFBV1IsS0FBS1MsUUFBUSxDQUFDRCxVQUFVekMsTUFBTTtZQUUxRSxJQUFJd0MsV0FBVyxHQUFHO2dCQUNoQixNQUFNRyxXQUFXLElBQUksQ0FBQ0Msc0JBQXNCLENBQUNOLFNBQTRCTCxNQUFNcEMsU0FBUzJDO2dCQUN4Rk4sU0FBU1csSUFBSSxDQUFDRjtZQUNoQjtRQUNGO1FBRUEsc0VBQXNFO1FBQ3RFLElBQUlULFNBQVNsQyxNQUFNLEtBQUssR0FBRztZQUN6QmtDLFNBQVNXLElBQUksQ0FBQyxJQUFJLENBQUNDLDRCQUE0QixDQUFDYixNQUFNcEM7UUFDeEQ7UUFFQSxPQUFPcUM7SUFDVDtJQUVBOztHQUVDLEdBQ0QsT0FBZVUsdUJBQ2JOLE9BQXdCLEVBQ3hCTCxJQUFZLEVBQ1pwQyxPQUFjLEVBQ2QyQyxRQUFnQixFQUNDO1FBRWpCLE1BQU1PLGNBQWMsSUFBSSxDQUFDQyxxQkFBcUIsQ0FBQ1Y7UUFDL0MsTUFBTVcsU0FBU2hFLGNBQWMsQ0FBQ3FELFFBQVEsSUFBSSxFQUFFO1FBRTVDLDZCQUE2QjtRQUM3QixNQUFNWSxrQkFBa0JELE9BQU9uRCxNQUFNLENBQUNxRCxDQUFBQSxRQUFTbEIsS0FBS1MsUUFBUSxDQUFDUztRQUU3RCxvQ0FBb0M7UUFDcEMsTUFBTUMscUJBQXFCLElBQUksQ0FBQ0MseUJBQXlCLENBQUNwQixNQUFNSztRQUVoRSw2Q0FBNkM7UUFDN0MsTUFBTWdCLGNBQWMsSUFBSSxDQUFDQywyQkFBMkIsQ0FBQ3RCLE1BQU1tQixtQkFBbUJwRCxNQUFNO1FBRXBGLGlDQUFpQztRQUNqQyxNQUFNd0Qsa0JBQWtCLElBQUksQ0FBQ0Msd0JBQXdCLENBQUNILGFBQWFGLG1CQUFtQnBELE1BQU07UUFFNUYsa0NBQWtDO1FBQ2xDLE1BQU0wRCxpQkFBaUJKLGNBQWMsTUFBTUYsbUJBQW1CcEQsTUFBTSxHQUFHO1FBRXZFLE9BQU87WUFDTHNDO1lBQ0FTO1lBQ0FPO1lBQ0FFO1lBQ0FHLGtCQUFrQlQsZ0JBQWdCekMsS0FBSyxDQUFDLEdBQUc7WUFDM0NtRCxnQkFBZ0JOLGNBQWMsS0FBS0osZ0JBQWdCekMsS0FBSyxDQUFDLEdBQUcsS0FBSyxFQUFFO1lBQ25Fb0QsZ0JBQWdCckI7WUFDaEJrQjtZQUNBTjtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE9BQWVDLDBCQUEwQnBCLElBQVksRUFBRUssT0FBd0IsRUFBWTtRQUN6RixNQUFNd0IsYUFBdUIsRUFBRTtRQUUvQixnQ0FBZ0M7UUFDaEMsTUFBTUMscUJBQXFCO1lBQ3pCO1lBQ0E7WUFDQTtZQUNBO1lBQ0E7U0FDRDtRQUVEQSxtQkFBbUIxQixPQUFPLENBQUMyQixDQUFBQTtZQUN6QixJQUFJQztZQUNKLE1BQU8sQ0FBQ0EsUUFBUUQsUUFBUUUsSUFBSSxDQUFDakMsS0FBSSxNQUFPLEtBQU07Z0JBQzVDLElBQUlnQyxLQUFLLENBQUMsRUFBRSxJQUFJQSxLQUFLLENBQUMsRUFBRSxDQUFDakUsTUFBTSxHQUFHLElBQUk7b0JBQ3BDOEQsV0FBV2pCLElBQUksQ0FBQ29CLEtBQUssQ0FBQyxFQUFFLENBQUNFLElBQUk7Z0JBQy9CO1lBQ0Y7UUFDRjtRQUVBLE9BQU9MLFdBQVdyRCxLQUFLLENBQUMsR0FBRyxHQUFHLGdDQUFnQzs7SUFDaEU7SUFFQTs7R0FFQyxHQUNELE9BQWU4Qyw0QkFBNEJ0QixJQUFZLEVBQUVtQyxlQUF1QixFQUFVO1FBQ3hGLElBQUlDLFFBQVEsR0FBRyxhQUFhOztRQUU1Qix3QkFBd0I7UUFDeEJ6RCxPQUFPd0IsT0FBTyxDQUFDOUMscUJBQXFCK0MsT0FBTyxDQUFDLENBQUMsQ0FBQ2lDLE9BQU9DLFdBQVc7WUFDOUQsTUFBTUMsYUFBYUYsVUFBVSxjQUFjLEtBQUtBLFVBQVUsU0FBUyxJQUFJO1lBQ3ZFQyxXQUFXbEMsT0FBTyxDQUFDb0MsQ0FBQUE7Z0JBQ2pCLElBQUl4QyxLQUFLUyxRQUFRLENBQUMrQixZQUFZO29CQUM1QkosU0FBU0c7Z0JBQ1g7WUFDRjtRQUNGO1FBRUEsd0JBQXdCO1FBQ3hCNUQsT0FBT3dCLE9BQU8sQ0FBQ2xELHVCQUF1Qm1ELE9BQU8sQ0FBQyxDQUFDLENBQUNpQyxPQUFPQyxXQUFXO1lBQ2hFLE1BQU1HLFVBQVVKLFVBQVUsU0FBUyxLQUFLQSxVQUFVLFdBQVcsS0FBSztZQUNsRUMsV0FBV2xDLE9BQU8sQ0FBQ29DLENBQUFBO2dCQUNqQixJQUFJeEMsS0FBS1MsUUFBUSxDQUFDK0IsWUFBWTtvQkFDNUJKLFNBQVNLO2dCQUNYO1lBQ0Y7UUFDRjtRQUVBLCtDQUErQztRQUMvQ0wsU0FBU0Qsa0JBQWtCO1FBRTNCLE9BQU9PLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxHQUFHLENBQUMsS0FBS1I7SUFDbkM7SUFFQTs7R0FFQyxHQUNELE9BQWVaLHlCQUF5QkgsV0FBbUIsRUFBRWMsZUFBdUIsRUFBbUI7UUFDckcsSUFBSWQsY0FBYyxNQUFNYyxrQkFBa0IsR0FBRztRQUM3QyxJQUFJZCxjQUFjLElBQUk7UUFDdEIsSUFBSUEsY0FBYyxJQUFJO1FBQ3RCO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELE9BQWVyRCxzQkFBc0JMLE1BQWMsRUFBb0I7UUFDckUsT0FBTztZQUNMQTtZQUNBa0MsVUFBVTtnQkFBQyxJQUFJLENBQUNnQiw0QkFBNEIsQ0FBQyxJQUFJLEVBQUU7YUFBRTtZQUNyRDFCLG9CQUFvQjtZQUNwQkUsaUJBQWlCO2dCQUFDO2FBQTRCO1lBQzlDRSxXQUFXO2dCQUFDO2FBQWlDO1lBQzdDRSxtQkFBbUI7Z0JBQUM7Z0JBQXNCO2FBQWM7WUFDeERFLGlCQUFpQjtZQUNqQkcsZ0JBQWdCLElBQUl6QjtRQUN0QjtJQUNGO0lBRUE7O0dBRUMsR0FDRCxPQUFld0MsNkJBQTZCYixJQUFZLEVBQUVwQyxPQUFjLEVBQW1CO1FBQ3pGLE1BQU15RCxjQUFjckIsS0FBS2pDLE1BQU0sR0FBRyxJQUFJLElBQUksQ0FBQ3VELDJCQUEyQixDQUFDdEIsTUFBTSxLQUFLO1FBRWxGLE9BQU87WUFDTEssT0FBTztZQUNQUyxhQUFhO1lBQ2JPO1lBQ0FFLGlCQUFpQixJQUFJLENBQUNDLHdCQUF3QixDQUFDSCxhQUFhO1lBQzVESyxrQkFBa0IsRUFBRTtZQUNwQkMsZ0JBQWdCLEVBQUU7WUFDbEJDLGdCQUFnQmhFLFFBQVFHLE1BQU07WUFDOUIwRCxnQkFBZ0JKLGNBQWM7WUFDOUJGLG9CQUFvQixJQUFJLENBQUNDLHlCQUF5QixDQUFDcEI7UUFDckQ7SUFDRjtJQUVBOztHQUVDLEdBQ0QsT0FBZVosNEJBQTRCUyxRQUEyQixFQUFVO1FBQzlFLElBQUlBLFNBQVM5QixNQUFNLEtBQUssR0FBRyxPQUFPO1FBRWxDLE1BQU04RSxVQUFVaEQsU0FBU2lELE1BQU0sQ0FBQyxDQUFDQyxLQUFLMUMsVUFBWTBDLE1BQU0xQyxRQUFRZ0IsV0FBVyxFQUFFLEtBQUt4QixTQUFTOUIsTUFBTTtRQUNqRyxPQUFPMkUsS0FBS00sS0FBSyxDQUFDSDtJQUNwQjtJQUVBOztHQUVDLEdBQ0QsT0FBZXZELHdCQUF3Qk8sUUFBMkIsRUFBRUcsSUFBWSxFQUFZO1FBQzFGLE1BQU1pRCxRQUFrQixFQUFFO1FBRTFCLHdDQUF3QztRQUN4Q3BELFNBQ0doQyxNQUFNLENBQUN3QyxDQUFBQSxVQUFXQSxRQUFRb0IsY0FBYyxFQUN4Q3JCLE9BQU8sQ0FBQ0MsQ0FBQUE7WUFDUDRDLE1BQU1yQyxJQUFJLENBQUMsR0FBR1AsUUFBUVMsV0FBVyxDQUFDLEVBQUUsRUFBRVQsUUFBUWMsa0JBQWtCLENBQUNwQyxJQUFJLENBQUMsT0FBTztRQUMvRTtRQUVGLHlEQUF5RDtRQUN6RCxJQUFJa0UsTUFBTWxGLE1BQU0sS0FBSyxLQUFLaUMsS0FBS2pDLE1BQU0sR0FBRyxHQUFHO1lBQ3pDLElBQUlpQyxLQUFLUyxRQUFRLENBQUMsV0FBV3dDLE1BQU1yQyxJQUFJLENBQUM7WUFDeEMsSUFBSVosS0FBS1MsUUFBUSxDQUFDLGFBQWF3QyxNQUFNckMsSUFBSSxDQUFDO1lBQzFDLElBQUlaLEtBQUtTLFFBQVEsQ0FBQyxVQUFVd0MsTUFBTXJDLElBQUksQ0FBQztRQUN6QztRQUVBLE9BQU9xQyxNQUFNekUsS0FBSyxDQUFDLEdBQUc7SUFDeEI7SUFFQTs7R0FFQyxHQUNELE9BQWVnQixrQkFBa0JLLFFBQTJCLEVBQUVHLElBQVksRUFBWTtRQUNwRixNQUFNVCxZQUFzQixFQUFFO1FBRTlCLHdDQUF3QztRQUN4Q00sU0FDR2hDLE1BQU0sQ0FBQ3dDLENBQUFBLFVBQVdBLFFBQVFnQixXQUFXLEdBQUcsSUFDeENqQixPQUFPLENBQUNDLENBQUFBO1lBQ1BkLFVBQVVxQixJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUVQLFFBQVFTLFdBQVcsRUFBRTtRQUNwRDtRQUVGLGdDQUFnQztRQUNoQyxJQUFJZCxLQUFLUyxRQUFRLENBQUMsWUFBWWxCLFVBQVVxQixJQUFJLENBQUM7UUFDN0MsSUFBSVosS0FBS1MsUUFBUSxDQUFDLGVBQWVULEtBQUtTLFFBQVEsQ0FBQyxZQUFZbEIsVUFBVXFCLElBQUksQ0FBQztRQUMxRSxJQUFJWixLQUFLUyxRQUFRLENBQUMsWUFBWWxCLFVBQVVxQixJQUFJLENBQUM7UUFFN0MsT0FBT3JCLFVBQVV4QixNQUFNLEdBQUcsSUFBSXdCLFVBQVVmLEtBQUssQ0FBQyxHQUFHLEtBQUs7WUFBQztTQUE0QjtJQUNyRjtJQUVBOztHQUVDLEdBQ0QsT0FBZWtCLHdCQUF3QkcsUUFBMkIsRUFBWTtRQUM1RSxNQUFNcUQsa0JBQTRCLEVBQUU7UUFFcENyRCxTQUFTTyxPQUFPLENBQUNDLENBQUFBO1lBQ2YsSUFBSUEsUUFBUW9CLGNBQWMsRUFBRTtnQkFDMUJ5QixnQkFBZ0J0QyxJQUFJLENBQUMsQ0FBQyw4QkFBOEIsRUFBRVAsUUFBUVMsV0FBVyxFQUFFO2dCQUUzRSxJQUFJVCxRQUFRcUIsZ0JBQWdCLENBQUMzRCxNQUFNLEdBQUcsR0FBRztvQkFDdkNtRixnQkFBZ0J0QyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUVQLFFBQVFxQixnQkFBZ0IsQ0FBQzNDLElBQUksQ0FBQyxPQUFPO2dCQUMxRTtZQUNGO1FBQ0Y7UUFFQSxPQUFPbUUsZ0JBQWdCMUUsS0FBSyxDQUFDLEdBQUc7SUFDbEM7SUFFQTs7R0FFQyxHQUNELE9BQWVvQix3QkFBd0JJLElBQVksRUFBbUQ7UUFDcEcsTUFBTW1ELGlCQUFpQjtZQUFDO1lBQVc7WUFBWTtZQUFVO1lBQVU7U0FBUztRQUM1RSxNQUFNQyxxQkFBcUI7WUFBQztZQUFZO1lBQVU7WUFBZ0I7U0FBUztRQUMzRSxNQUFNQyxvQkFBb0I7WUFBQztZQUFZO1lBQWE7WUFBVztTQUFRO1FBRXZFLE1BQU1DLGNBQWNILGVBQWVMLE1BQU0sQ0FBQyxDQUFDUyxPQUFPQyxPQUFTRCxRQUFTdkQsQ0FBQUEsS0FBS1MsUUFBUSxDQUFDK0MsUUFBUSxJQUFJLElBQUk7UUFDbEcsTUFBTUMsa0JBQWtCTCxtQkFBbUJOLE1BQU0sQ0FBQyxDQUFDUyxPQUFPQyxPQUFTRCxRQUFTdkQsQ0FBQUEsS0FBS1MsUUFBUSxDQUFDK0MsUUFBUSxJQUFJLElBQUk7UUFDMUcsTUFBTUUsaUJBQWlCTCxrQkFBa0JQLE1BQU0sQ0FBQyxDQUFDUyxPQUFPQyxPQUFTRCxRQUFTdkQsQ0FBQUEsS0FBS1MsUUFBUSxDQUFDK0MsUUFBUSxJQUFJLElBQUk7UUFFeEcsSUFBSUYsY0FBY0csbUJBQW1CSCxjQUFjSSxnQkFBZ0IsT0FBTztRQUMxRSxJQUFJRCxrQkFBa0JDLGdCQUFnQixPQUFPO1FBQzdDLElBQUlBLGlCQUFpQixHQUFHLE9BQU87UUFDL0IsT0FBTztJQUNUO0lBRUE7O0dBRUMsR0FDRCxPQUFlM0Msc0JBQXNCVixPQUF3QixFQUFVO1FBQ3JFLE1BQU1zRCxRQUFRO1lBQ1osZUFBNkIsRUFBRTtZQUMvQixXQUF5QixFQUFFO1lBQzNCLGFBQTJCLEVBQUU7WUFDN0IsV0FBeUIsRUFBRTtZQUMzQixXQUF5QixFQUFFO1lBQzNCLFdBQXlCLEVBQUU7WUFDM0IsV0FBeUIsRUFBRTtZQUMzQixhQUEyQixFQUFFO1lBQzdCLFdBQXlCLEVBQUU7UUFDN0I7UUFDQSxPQUFPQSxLQUFLLENBQUN0RCxRQUFRLElBQUk7SUFDM0I7SUFFQTs7R0FFQyxHQUNELE9BQU91RCxtQkFBbUJsRCxRQUEwQixFQUFFTCxPQUF5QixFQUFVO1FBQ3ZGLE1BQU13RCxnQkFBZ0J4RCxXQUFXSyxTQUFTYixRQUFRLENBQUMsRUFBRSxFQUFFUTtRQUN2RCxNQUFNeUQsa0JBQWtCcEQsU0FBU2IsUUFBUSxDQUFDa0UsSUFBSSxDQUFDQyxDQUFBQSxJQUFLQSxFQUFFM0QsT0FBTyxLQUFLd0Q7UUFFbEUsSUFBSSxDQUFDQyxpQkFBaUI7WUFDcEIsT0FBTyxDQUFDLDZEQUE2RCxFQUFFRCxlQUFlO1FBQ3hGO1FBRUEsTUFBTUksVUFBVTtZQUNkLENBQUMsU0FBUyxFQUFFSCxnQkFBZ0JoRCxXQUFXLEVBQUU7WUFDekMsQ0FBQyxPQUFPLEVBQUVnRCxnQkFBZ0J2QyxlQUFlLEVBQUU7WUFDM0MsQ0FBQyxvQkFBb0IsRUFBRXVDLGdCQUFnQnpDLFdBQVcsQ0FBQyxDQUFDLENBQUM7WUFDckR5QyxnQkFBZ0IzQyxrQkFBa0IsQ0FBQ3BELE1BQU0sR0FBRyxJQUN4QyxDQUFDLDBCQUEwQixFQUFFK0YsZ0JBQWdCM0Msa0JBQWtCLENBQUNwQyxJQUFJLENBQUMsT0FBTyxHQUM1RTtZQUNKK0UsZ0JBQWdCcEMsZ0JBQWdCLENBQUMzRCxNQUFNLEdBQUcsSUFDdEMsQ0FBQyxrQkFBa0IsRUFBRStGLGdCQUFnQnBDLGdCQUFnQixDQUFDM0MsSUFBSSxDQUFDLE9BQU8sR0FDbEU7WUFDSixDQUFDLHVCQUF1QixFQUFFMkIsU0FBU2YsZUFBZSxFQUFFO1NBQ3JELENBQUM5QixNQUFNLENBQUNpQixTQUFTQyxJQUFJLENBQUM7UUFFdkIsT0FBT2tGO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9hY2FkZW1pYy1hbmFseXplci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0ZW1wV2Vla2x5UmVwb3J0cyB9IGZyb20gJy4vdGVtcC1zdG9yYWdlJ1xuXG4vLyBEZWZpbmljacOzbiBkZSBtYXRlcmlhcyBhY2Fkw6ltaWNhc1xuZXhwb3J0IGVudW0gQWNhZGVtaWNTdWJqZWN0IHtcbiAgTUFUSEVNQVRJQ1MgPSAnbWF0aGVtYXRpY3MnLFxuICBQSFlTSUNTID0gJ3BoeXNpY3MnLCBcbiAgQ0hFTUlTVFJZID0gJ2NoZW1pc3RyeScsXG4gIEJJT0xPR1kgPSAnYmlvbG9neScsXG4gIFNQQU5JU0ggPSAnc3BhbmlzaCcsXG4gIEVOR0xJU0ggPSAnZW5nbGlzaCcsXG4gIEhJU1RPUlkgPSAnaGlzdG9yeScsXG4gIEdFT0dSQVBIWSA9ICdnZW9ncmFwaHknLFxuICBHRU5FUkFMID0gJ2dlbmVyYWwnXG59XG5cbi8vIE5pdmVsIGRlIGRpZmljdWx0YWQgZGV0ZWN0YWRvXG5leHBvcnQgZW51bSBEaWZmaWN1bHR5TGV2ZWwge1xuICBCQVNJQyA9ICdiYXNpYycsXG4gIElOVEVSTUVESUFURSA9ICdpbnRlcm1lZGlhdGUnLCBcbiAgQURWQU5DRUQgPSAnYWR2YW5jZWQnLFxuICBSRVZJRVdfTkVFREVEID0gJ3Jldmlld19uZWVkZWQnXG59XG5cbi8vIFRlbWFzIGVzcGVjw61maWNvcyBwb3IgbWF0ZXJpYVxuZXhwb3J0IGNvbnN0IFNVQkpFQ1RfVE9QSUNTID0ge1xuICBbQWNhZGVtaWNTdWJqZWN0Lk1BVEhFTUFUSUNTXTogW1xuICAgICdhbGdlYnJhJywgJ2dlb21ldHJpYScsICd0cmlnb25vbWV0cmlhJywgJ2NhbGN1bG8nLCAnZXN0YWRpc3RpY2EnLCAncHJvYmFiaWxpZGFkJyxcbiAgICAnZWN1YWNpb25lcycsICdmdW5jaW9uZXMnLCAnbG9nYXJpdG1vcycsICdtYXRyaWNlcycsICdkZXJpdmFkYXMnLCAnaW50ZWdyYWxlcydcbiAgXSxcbiAgW0FjYWRlbWljU3ViamVjdC5QSFlTSUNTXTogW1xuICAgICdjaW5lbWF0aWNhJywgJ2RpbmFtaWNhJywgJ2VuZXJnaWEnLCAnb25kYXMnLCAndGVybW9kaW5hbWljYScsICdlbGVjdHJpY2lkYWQnLFxuICAgICdtYWduZXRpc21vJywgJ29wdGljYScsICdtZWNhbmljYScsICdmbHVpZG9zJywgJ21vdmltaWVudG8nLCAnZnVlcnphJywgJ3ZlbG9jaWRhZCdcbiAgXSxcbiAgW0FjYWRlbWljU3ViamVjdC5DSEVNSVNUUlldOiBbXG4gICAgJ2F0b21vcycsICdtb2xlY3VsYXMnLCAnZW5sYWNlcycsICdyZWFjY2lvbmVzJywgJ2VzdGVxdWlvbWV0cmlhJywgJ2FjaWRvcycsXG4gICAgJ2Jhc2VzJywgJ294aWRhY2lvbicsICdyZWR1Y2Npb24nLCAnZXF1aWxpYnJpbycsICdjaW5ldGljYScsICd0ZXJtb3F1aW1pY2EnXG4gIF1cbn1cblxuLy8gUGFsYWJyYXMgY2xhdmUgcXVlIGluZGljYW4gZGlmaWN1bHRhZGVzXG5jb25zdCBESUZGSUNVTFRZX0lORElDQVRPUlMgPSB7XG4gIGhpZ2g6IFsnbXV5IGRpZsOtY2lsJywgJ25vIGVudGllbmRvJywgJ2NvbmZ1c28nLCAnY29tcGxpY2FkbycsICdpbXBvc2libGUnLCAnbm8gcHVlZG8nXSxcbiAgbWVkaXVtOiBbJ2RpZsOtY2lsJywgJ2NvbXBsaWNhZG8nLCAnbm8gY29tcHJlbmRvJywgJ21lIGN1ZXN0YScsICdwcm9ibGVtYSddLFxuICBsb3c6IFsndW4gcG9jbyBkaWbDrWNpbCcsICduZWNlc2l0byBheXVkYScsICdubyBlc3TDoSBjbGFybycsICdkdWRhcyddXG59XG5cbi8vIFBhbGFicmFzIGNsYXZlIHF1ZSBpbmRpY2FuIHByb2dyZXNvIHBvc2l0aXZvXG5jb25zdCBQUk9HUkVTU19JTkRJQ0FUT1JTID0ge1xuICBleGNlbGxlbnQ6IFsnZXhjZWxlbnRlJywgJ3BlcmZlY3RvJywgJ2RvbWlubycsICdmw6FjaWwnLCAnZW50aWVuZG8gdG9kbyddLFxuICBnb29kOiBbJ2JpZW4nLCAnZW50aWVuZG8nLCAnY29tcHJlbmRvJywgJ2xvZ3LDqScsICdtZWpvcmFuZG8nXSxcbiAgZmFpcjogWydtw6FzIG8gbWVub3MnLCAncmVndWxhcicsICdhbGd1bmFzIHZlY2VzJywgJ2F2YW56YW5kbyddXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNhZGVtaWNBbmFseXNpcyB7XG4gIHVzZXJJZDogc3RyaW5nXG4gIHN0dWRlbnROYW1lPzogc3RyaW5nXG4gIHN1YmplY3RzOiBTdWJqZWN0QW5hbHlzaXNbXVxuICBvdmVyYWxsUGVyZm9ybWFuY2U6IG51bWJlclxuICBzdHJ1Z2dsaW5nQXJlYXM6IHN0cmluZ1tdXG4gIHN0cmVuZ3Roczogc3RyaW5nW11cbiAgcmVjb21tZW5kZWRUb3BpY3M6IHN0cmluZ1tdXG4gIGxlYXJuaW5nUGF0dGVybjogJ3Zpc3VhbCcgfCAnYW5hbHl0aWNhbCcgfCAncHJhY3RpY2FsJyB8ICdtaXhlZCdcbiAgbGFzdFJlcG9ydERhdGU6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdWJqZWN0QW5hbHlzaXMge1xuICBzdWJqZWN0OiBBY2FkZW1pY1N1YmplY3RcbiAgc3ViamVjdE5hbWU6IHN0cmluZ1xuICBwZXJmb3JtYW5jZTogbnVtYmVyXG4gIGRpZmZpY3VsdHlMZXZlbDogRGlmZmljdWx0eUxldmVsXG4gIHN0cnVnZ2xpbmdUb3BpY3M6IHN0cmluZ1tdXG4gIG1hc3RlcmVkVG9waWNzOiBzdHJpbmdbXVxuICByZWNlbnRNZW50aW9uczogbnVtYmVyXG4gIG5lZWRzQXR0ZW50aW9uOiBib29sZWFuXG4gIHNwZWNpZmljQ2hhbGxlbmdlczogc3RyaW5nW11cbn1cblxuZXhwb3J0IGNsYXNzIEFjYWRlbWljQW5hbHl6ZXIge1xuICBcbiAgLyoqXG4gICAqIEFuYWxpemEgbG9zIHJlcG9ydGVzIGFjYWTDqW1pY29zIGRlIHVuIGVzdHVkaWFudGVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBhbmFseXplU3R1ZGVudCh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8QWNhZGVtaWNBbmFseXNpcz4ge1xuICAgIGNvbnN0IHJlcG9ydHMgPSB0ZW1wV2Vla2x5UmVwb3J0cy5maWx0ZXIocmVwb3J0ID0+IHJlcG9ydC51c2VySWQgPT09IHVzZXJJZClcbiAgICBcbiAgICBpZiAocmVwb3J0cy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZURlZmF1bHRBbmFseXNpcyh1c2VySWQpXG4gICAgfVxuXG4gICAgLy8gQW5hbGl6YXIgcmVwb3J0ZXMgcmVjaWVudGVzICjDumx0aW1hcyA4IHNlbWFuYXMpXG4gICAgY29uc3QgcmVjZW50UmVwb3J0cyA9IHJlcG9ydHNcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBuZXcgRGF0ZShiLmNyZWF0ZWRBdCkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5jcmVhdGVkQXQpLmdldFRpbWUoKSlcbiAgICAgIC5zbGljZSgwLCA4KVxuXG4gICAgLy8gRXh0cmFlciB0b2RvIGVsIHRleHRvIGRlIGxhcyByZXNwdWVzdGFzXG4gICAgY29uc3QgYWxsUmVzcG9uc2VUZXh0ID0gcmVjZW50UmVwb3J0c1xuICAgICAgLmZsYXRNYXAocmVwb3J0ID0+IE9iamVjdC52YWx1ZXMocmVwb3J0LnJlc3BvbnNlcyB8fCB7fSkpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAuam9pbignICcpXG4gICAgICAudG9Mb3dlckNhc2UoKVxuXG4gICAgLy8gQW5hbGl6YXIgcG9yIG1hdGVyaWFzXG4gICAgY29uc3Qgc3ViamVjdEFuYWx5c2VzID0gdGhpcy5hbmFseXplU3ViamVjdHMoYWxsUmVzcG9uc2VUZXh0LCByZWNlbnRSZXBvcnRzKVxuICAgIFxuICAgIC8vIEFuw6FsaXNpcyBnZW5lcmFsXG4gICAgY29uc3Qgb3ZlcmFsbFBlcmZvcm1hbmNlID0gdGhpcy5jYWxjdWxhdGVPdmVyYWxsUGVyZm9ybWFuY2Uoc3ViamVjdEFuYWx5c2VzKVxuICAgIGNvbnN0IHN0cnVnZ2xpbmdBcmVhcyA9IHRoaXMuaWRlbnRpZnlTdHJ1Z2dsaW5nQXJlYXMoc3ViamVjdEFuYWx5c2VzLCBhbGxSZXNwb25zZVRleHQpXG4gICAgY29uc3Qgc3RyZW5ndGhzID0gdGhpcy5pZGVudGlmeVN0cmVuZ3RocyhzdWJqZWN0QW5hbHlzZXMsIGFsbFJlc3BvbnNlVGV4dClcbiAgICBjb25zdCByZWNvbW1lbmRlZFRvcGljcyA9IHRoaXMuZ2VuZXJhdGVSZWNvbW1lbmRhdGlvbnMoc3ViamVjdEFuYWx5c2VzKVxuICAgIGNvbnN0IGxlYXJuaW5nUGF0dGVybiA9IHRoaXMuaWRlbnRpZnlMZWFybmluZ1BhdHRlcm4oYWxsUmVzcG9uc2VUZXh0KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHN1YmplY3RzOiBzdWJqZWN0QW5hbHlzZXMsXG4gICAgICBvdmVyYWxsUGVyZm9ybWFuY2UsXG4gICAgICBzdHJ1Z2dsaW5nQXJlYXMsXG4gICAgICBzdHJlbmd0aHMsXG4gICAgICByZWNvbW1lbmRlZFRvcGljcyxcbiAgICAgIGxlYXJuaW5nUGF0dGVybixcbiAgICAgIGxhc3RSZXBvcnREYXRlOiBuZXcgRGF0ZShyZWNlbnRSZXBvcnRzWzBdPy5jcmVhdGVkQXQgfHwgRGF0ZS5ub3coKSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQW5hbGl6YSBtYXRlcmlhcyBlc3BlY8OtZmljYXMgbWVuY2lvbmFkYXMgZW4gbG9zIHJlcG9ydGVzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhbmFseXplU3ViamVjdHModGV4dDogc3RyaW5nLCByZXBvcnRzOiBhbnlbXSk6IFN1YmplY3RBbmFseXNpc1tdIHtcbiAgICBjb25zdCBhbmFseXNlczogU3ViamVjdEFuYWx5c2lzW10gPSBbXVxuXG4gICAgLy8gUGFsYWJyYXMgY2xhdmUgcGFyYSBpZGVudGlmaWNhciBtYXRlcmlhc1xuICAgIGNvbnN0IHN1YmplY3RLZXl3b3JkcyA9IHtcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuTUFUSEVNQVRJQ1NdOiBbJ21hdGVtw6F0aWNhJywgJ21hdGVtw6F0aWNhcycsICdtYXRlJywgJ8OhbGdlYnJhJywgJ2dlb21ldHLDrWEnLCAnY8OhbGN1bG8nLCAnbsO6bWVyb3MnXSxcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuUEhZU0lDU106IFsnZsOtc2ljYScsICdtZWPDoW5pY2EnLCAnZW5lcmfDrWEnLCAnZnVlcnphJywgJ21vdmltaWVudG8nLCAndmVsb2NpZGFkJ10sXG4gICAgICBbQWNhZGVtaWNTdWJqZWN0LkNIRU1JU1RSWV06IFsncXXDrW1pY2EnLCAnw6F0b21vcycsICdtb2zDqWN1bGFzJywgJ3JlYWNjaW9uZXMnLCAnZWxlbWVudG9zJywgJ2xhYm9yYXRvcmlvJ10sXG4gICAgICBbQWNhZGVtaWNTdWJqZWN0LkJJT0xPR1ldOiBbJ2Jpb2xvZ8OtYScsICdjw6lsdWxhcycsICdvcmdhbmlzbW9zJywgJ2V2b2x1Y2nDs24nLCAnZWNvc2lzdGVtYSddLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5TUEFOSVNIXTogWydsZW5ndWEnLCAnZXNwYcOxb2wnLCAnbGl0ZXJhdHVyYScsICdyZWRhY2Npw7NuJywgJ2dyYW3DoXRpY2EnXSxcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuRU5HTElTSF06IFsnaW5nbMOpcycsICdlbmdsaXNoJywgJ2dyYW1tYXInLCAndm9jYWJ1bGFyeSddLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5ISVNUT1JZXTogWydoaXN0b3JpYScsICdjaXZpbGl6YWNpw7NuJywgJ8OpcG9jYScsICdndWVycmEnLCAncmV2b2x1Y2nDs24nXSxcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuR0VPR1JBUEhZXTogWydnZW9ncmFmw61hJywgJ3Bhw61zZXMnLCAnY29udGluZW50ZXMnLCAnY2xpbWEnLCAncG9ibGFjacOzbiddXG4gICAgfVxuXG4gICAgT2JqZWN0LmVudHJpZXMoc3ViamVjdEtleXdvcmRzKS5mb3JFYWNoKChbc3ViamVjdCwga2V5d29yZHNdKSA9PiB7XG4gICAgICBjb25zdCBtZW50aW9ucyA9IGtleXdvcmRzLmZpbHRlcihrZXl3b3JkID0+IHRleHQuaW5jbHVkZXMoa2V5d29yZCkpLmxlbmd0aFxuICAgICAgXG4gICAgICBpZiAobWVudGlvbnMgPiAwKSB7XG4gICAgICAgIGNvbnN0IGFuYWx5c2lzID0gdGhpcy5hbmFseXplU3BlY2lmaWNTdWJqZWN0KHN1YmplY3QgYXMgQWNhZGVtaWNTdWJqZWN0LCB0ZXh0LCByZXBvcnRzLCBtZW50aW9ucylcbiAgICAgICAgYW5hbHlzZXMucHVzaChhbmFseXNpcylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gU2kgbm8gc2UgZW5jb250cmFyb24gbWF0ZXJpYXMgZXNwZWPDrWZpY2FzLCBhZ3JlZ2FyIGFuw6FsaXNpcyBnZW5lcmFsXG4gICAgaWYgKGFuYWx5c2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgYW5hbHlzZXMucHVzaCh0aGlzLmNyZWF0ZUdlbmVyYWxTdWJqZWN0QW5hbHlzaXModGV4dCwgcmVwb3J0cykpXG4gICAgfVxuXG4gICAgcmV0dXJuIGFuYWx5c2VzXG4gIH1cblxuICAvKipcbiAgICogQW5hbGl6YSB1bmEgbWF0ZXJpYSBlc3BlY8OtZmljYVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZVNwZWNpZmljU3ViamVjdChcbiAgICBzdWJqZWN0OiBBY2FkZW1pY1N1YmplY3QsIFxuICAgIHRleHQ6IHN0cmluZywgXG4gICAgcmVwb3J0czogYW55W10sIFxuICAgIG1lbnRpb25zOiBudW1iZXJcbiAgKTogU3ViamVjdEFuYWx5c2lzIHtcbiAgICBcbiAgICBjb25zdCBzdWJqZWN0TmFtZSA9IHRoaXMuZ2V0U3ViamVjdERpc3BsYXlOYW1lKHN1YmplY3QpXG4gICAgY29uc3QgdG9waWNzID0gU1VCSkVDVF9UT1BJQ1Nbc3ViamVjdF0gfHwgW11cbiAgICBcbiAgICAvLyBEZXRlY3RhciB0ZW1hcyBtZW5jaW9uYWRvc1xuICAgIGNvbnN0IG1lbnRpb25lZFRvcGljcyA9IHRvcGljcy5maWx0ZXIodG9waWMgPT4gdGV4dC5pbmNsdWRlcyh0b3BpYykpXG4gICAgXG4gICAgLy8gQW5hbGl6YXIgZGlmaWN1bHRhZGVzIGVzcGVjw61maWNhc1xuICAgIGNvbnN0IHNwZWNpZmljQ2hhbGxlbmdlcyA9IHRoaXMuZXh0cmFjdFNwZWNpZmljQ2hhbGxlbmdlcyh0ZXh0LCBzdWJqZWN0KVxuICAgIFxuICAgIC8vIENhbGN1bGFyIHJlbmRpbWllbnRvIGJhc2FkbyBlbiBpbmRpY2Fkb3Jlc1xuICAgIGNvbnN0IHBlcmZvcm1hbmNlID0gdGhpcy5jYWxjdWxhdGVTdWJqZWN0UGVyZm9ybWFuY2UodGV4dCwgc3BlY2lmaWNDaGFsbGVuZ2VzLmxlbmd0aClcbiAgICBcbiAgICAvLyBEZXRlcm1pbmFyIG5pdmVsIGRlIGRpZmljdWx0YWRcbiAgICBjb25zdCBkaWZmaWN1bHR5TGV2ZWwgPSB0aGlzLmRldGVybWluZURpZmZpY3VsdHlMZXZlbChwZXJmb3JtYW5jZSwgc3BlY2lmaWNDaGFsbGVuZ2VzLmxlbmd0aClcbiAgICBcbiAgICAvLyBEZXRlcm1pbmFyIHNpIG5lY2VzaXRhIGF0ZW5jacOzblxuICAgIGNvbnN0IG5lZWRzQXR0ZW50aW9uID0gcGVyZm9ybWFuY2UgPCA2MCB8fCBzcGVjaWZpY0NoYWxsZW5nZXMubGVuZ3RoID4gMlxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YmplY3QsXG4gICAgICBzdWJqZWN0TmFtZSxcbiAgICAgIHBlcmZvcm1hbmNlLFxuICAgICAgZGlmZmljdWx0eUxldmVsLFxuICAgICAgc3RydWdnbGluZ1RvcGljczogbWVudGlvbmVkVG9waWNzLnNsaWNlKDAsIDMpLCAvLyBQcmltZXJvcyAzIHRlbWFzIG1lbmNpb25hZG9zXG4gICAgICBtYXN0ZXJlZFRvcGljczogcGVyZm9ybWFuY2UgPiA3NSA/IG1lbnRpb25lZFRvcGljcy5zbGljZSgwLCAyKSA6IFtdLFxuICAgICAgcmVjZW50TWVudGlvbnM6IG1lbnRpb25zLFxuICAgICAgbmVlZHNBdHRlbnRpb24sXG4gICAgICBzcGVjaWZpY0NoYWxsZW5nZXNcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXh0cmFlIGRlc2Fmw61vcyBlc3BlY8OtZmljb3MgbWVuY2lvbmFkb3MgcG9yIGVsIGVzdHVkaWFudGVcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RTcGVjaWZpY0NoYWxsZW5nZXModGV4dDogc3RyaW5nLCBzdWJqZWN0OiBBY2FkZW1pY1N1YmplY3QpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgY2hhbGxlbmdlczogc3RyaW5nW10gPSBbXVxuICAgIFxuICAgIC8vIEJ1c2NhciBwYXRyb25lcyBkZSBkaWZpY3VsdGFkXG4gICAgY29uc3QgZGlmZmljdWx0eVBhdHRlcm5zID0gW1xuICAgICAgL25vIGVudGllbmRvICguKj8pKD86XFwufCx8JCkvZyxcbiAgICAgIC9tZSBjdWVzdGEgKC4qPykoPzpcXC58LHwkKS9nLFxuICAgICAgL2RpZsOtY2lsICguKj8pKD86XFwufCx8JCkvZyxcbiAgICAgIC9wcm9ibGVtYSBjb24gKC4qPykoPzpcXC58LHwkKS9nLFxuICAgICAgL2NvbmZ1c28gKC4qPykoPzpcXC58LHwkKS9nXG4gICAgXVxuXG4gICAgZGlmZmljdWx0eVBhdHRlcm5zLmZvckVhY2gocGF0dGVybiA9PiB7XG4gICAgICBsZXQgbWF0Y2hcbiAgICAgIHdoaWxlICgobWF0Y2ggPSBwYXR0ZXJuLmV4ZWModGV4dCkpICE9PSBudWxsKSB7XG4gICAgICAgIGlmIChtYXRjaFsxXSAmJiBtYXRjaFsxXS5sZW5ndGggPCA1MCkge1xuICAgICAgICAgIGNoYWxsZW5nZXMucHVzaChtYXRjaFsxXS50cmltKCkpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIGNoYWxsZW5nZXMuc2xpY2UoMCwgMykgLy8gTcOheGltbyAzIGRlc2Fmw61vcyBlc3BlY8OtZmljb3NcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGVsIHJlbmRpbWllbnRvIGRlIHVuYSBtYXRlcmlhXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVTdWJqZWN0UGVyZm9ybWFuY2UodGV4dDogc3RyaW5nLCBjaGFsbGVuZ2VzQ291bnQ6IG51bWJlcik6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gNzAgLy8gQmFzZSBzY29yZVxuXG4gICAgLy8gSW5kaWNhZG9yZXMgcG9zaXRpdm9zXG4gICAgT2JqZWN0LmVudHJpZXMoUFJPR1JFU1NfSU5ESUNBVE9SUykuZm9yRWFjaCgoW2xldmVsLCBpbmRpY2F0b3JzXSkgPT4ge1xuICAgICAgY29uc3QgbXVsdGlwbGllciA9IGxldmVsID09PSAnZXhjZWxsZW50JyA/IDEwIDogbGV2ZWwgPT09ICdnb29kJyA/IDUgOiAyXG4gICAgICBpbmRpY2F0b3JzLmZvckVhY2goaW5kaWNhdG9yID0+IHtcbiAgICAgICAgaWYgKHRleHQuaW5jbHVkZXMoaW5kaWNhdG9yKSkge1xuICAgICAgICAgIHNjb3JlICs9IG11bHRpcGxpZXJcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gSW5kaWNhZG9yZXMgbmVnYXRpdm9zXG4gICAgT2JqZWN0LmVudHJpZXMoRElGRklDVUxUWV9JTkRJQ0FUT1JTKS5mb3JFYWNoKChbbGV2ZWwsIGluZGljYXRvcnNdKSA9PiB7XG4gICAgICBjb25zdCBwZW5hbHR5ID0gbGV2ZWwgPT09ICdoaWdoJyA/IDE1IDogbGV2ZWwgPT09ICdtZWRpdW0nID8gMTAgOiA1XG4gICAgICBpbmRpY2F0b3JzLmZvckVhY2goaW5kaWNhdG9yID0+IHtcbiAgICAgICAgaWYgKHRleHQuaW5jbHVkZXMoaW5kaWNhdG9yKSkge1xuICAgICAgICAgIHNjb3JlIC09IHBlbmFsdHlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgLy8gUGVuYWxpemFyIHBvciBuw7ptZXJvIGRlIGRlc2Fmw61vcyBlc3BlY8OtZmljb3NcbiAgICBzY29yZSAtPSBjaGFsbGVuZ2VzQ291bnQgKiA4XG5cbiAgICByZXR1cm4gTWF0aC5tYXgoMCwgTWF0aC5taW4oMTAwLCBzY29yZSkpXG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5hIGVsIG5pdmVsIGRlIGRpZmljdWx0YWQgYmFzYWRvIGVuIGVsIHJlbmRpbWllbnRvXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBkZXRlcm1pbmVEaWZmaWN1bHR5TGV2ZWwocGVyZm9ybWFuY2U6IG51bWJlciwgY2hhbGxlbmdlc0NvdW50OiBudW1iZXIpOiBEaWZmaWN1bHR5TGV2ZWwge1xuICAgIGlmIChwZXJmb3JtYW5jZSA8IDQwIHx8IGNoYWxsZW5nZXNDb3VudCA+IDMpIHJldHVybiBEaWZmaWN1bHR5TGV2ZWwuUkVWSUVXX05FRURFRFxuICAgIGlmIChwZXJmb3JtYW5jZSA8IDYwKSByZXR1cm4gRGlmZmljdWx0eUxldmVsLkJBU0lDXG4gICAgaWYgKHBlcmZvcm1hbmNlIDwgODApIHJldHVybiBEaWZmaWN1bHR5TGV2ZWwuSU5URVJNRURJQVRFXG4gICAgcmV0dXJuIERpZmZpY3VsdHlMZXZlbC5BRFZBTkNFRFxuICB9XG5cbiAgLyoqXG4gICAqIENyZWEgYW7DoWxpc2lzIHBvciBkZWZlY3RvIHBhcmEgZXN0dWRpYW50ZXMgc2luIHJlcG9ydGVzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjcmVhdGVEZWZhdWx0QW5hbHlzaXModXNlcklkOiBzdHJpbmcpOiBBY2FkZW1pY0FuYWx5c2lzIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlcklkLFxuICAgICAgc3ViamVjdHM6IFt0aGlzLmNyZWF0ZUdlbmVyYWxTdWJqZWN0QW5hbHlzaXMoJycsIFtdKV0sXG4gICAgICBvdmVyYWxsUGVyZm9ybWFuY2U6IDUwLFxuICAgICAgc3RydWdnbGluZ0FyZWFzOiBbJ0ZhbHRhIGRlIGRhdG9zIGhpc3TDs3JpY29zJ10sXG4gICAgICBzdHJlbmd0aHM6IFsnTnVldm8gZXN0dWRpYW50ZSBjb24gcG90ZW5jaWFsJ10sXG4gICAgICByZWNvbW1lbmRlZFRvcGljczogWydFdmFsdWFjacOzbiBpbmljaWFsJywgJ0Z1bmRhbWVudG9zJ10sXG4gICAgICBsZWFybmluZ1BhdHRlcm46ICdtaXhlZCcsXG4gICAgICBsYXN0UmVwb3J0RGF0ZTogbmV3IERhdGUoKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhIGFuw6FsaXNpcyBnZW5lcmFsIGN1YW5kbyBubyBzZSBkZXRlY3RhbiBtYXRlcmlhcyBlc3BlY8OtZmljYXNcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGNyZWF0ZUdlbmVyYWxTdWJqZWN0QW5hbHlzaXModGV4dDogc3RyaW5nLCByZXBvcnRzOiBhbnlbXSk6IFN1YmplY3RBbmFseXNpcyB7XG4gICAgY29uc3QgcGVyZm9ybWFuY2UgPSB0ZXh0Lmxlbmd0aCA+IDAgPyB0aGlzLmNhbGN1bGF0ZVN1YmplY3RQZXJmb3JtYW5jZSh0ZXh0LCAwKSA6IDUwXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1YmplY3Q6IEFjYWRlbWljU3ViamVjdC5HRU5FUkFMLFxuICAgICAgc3ViamVjdE5hbWU6ICdBbsOhbGlzaXMgR2VuZXJhbCcsXG4gICAgICBwZXJmb3JtYW5jZSxcbiAgICAgIGRpZmZpY3VsdHlMZXZlbDogdGhpcy5kZXRlcm1pbmVEaWZmaWN1bHR5TGV2ZWwocGVyZm9ybWFuY2UsIDApLFxuICAgICAgc3RydWdnbGluZ1RvcGljczogW10sXG4gICAgICBtYXN0ZXJlZFRvcGljczogW10sXG4gICAgICByZWNlbnRNZW50aW9uczogcmVwb3J0cy5sZW5ndGgsXG4gICAgICBuZWVkc0F0dGVudGlvbjogcGVyZm9ybWFuY2UgPCA2MCxcbiAgICAgIHNwZWNpZmljQ2hhbGxlbmdlczogdGhpcy5leHRyYWN0U3BlY2lmaWNDaGFsbGVuZ2VzKHRleHQsIEFjYWRlbWljU3ViamVjdC5HRU5FUkFMKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGVsIHJlbmRpbWllbnRvIGdlbmVyYWxcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGNhbGN1bGF0ZU92ZXJhbGxQZXJmb3JtYW5jZShzdWJqZWN0czogU3ViamVjdEFuYWx5c2lzW10pOiBudW1iZXIge1xuICAgIGlmIChzdWJqZWN0cy5sZW5ndGggPT09IDApIHJldHVybiA1MFxuICAgIFxuICAgIGNvbnN0IGF2ZXJhZ2UgPSBzdWJqZWN0cy5yZWR1Y2UoKHN1bSwgc3ViamVjdCkgPT4gc3VtICsgc3ViamVjdC5wZXJmb3JtYW5jZSwgMCkgLyBzdWJqZWN0cy5sZW5ndGhcbiAgICByZXR1cm4gTWF0aC5yb3VuZChhdmVyYWdlKVxuICB9XG5cbiAgLyoqXG4gICAqIElkZW50aWZpY2Egw6FyZWFzIGNvbiBkaWZpY3VsdGFkZXNcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGlkZW50aWZ5U3RydWdnbGluZ0FyZWFzKHN1YmplY3RzOiBTdWJqZWN0QW5hbHlzaXNbXSwgdGV4dDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGFyZWFzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgLy8gQWdyZWdhciBtYXRlcmlhcyBjb24gYmFqbyByZW5kaW1pZW50b1xuICAgIHN1YmplY3RzXG4gICAgICAuZmlsdGVyKHN1YmplY3QgPT4gc3ViamVjdC5uZWVkc0F0dGVudGlvbilcbiAgICAgIC5mb3JFYWNoKHN1YmplY3QgPT4ge1xuICAgICAgICBhcmVhcy5wdXNoKGAke3N1YmplY3Quc3ViamVjdE5hbWV9OiAke3N1YmplY3Quc3BlY2lmaWNDaGFsbGVuZ2VzLmpvaW4oJywgJyl9YClcbiAgICAgIH0pXG5cbiAgICAvLyBTaSBubyBoYXkgw6FyZWFzIGVzcGVjw61maWNhcywgYnVzY2FyIHBhdHJvbmVzIGdlbmVyYWxlc1xuICAgIGlmIChhcmVhcy5sZW5ndGggPT09IDAgJiYgdGV4dC5sZW5ndGggPiAwKSB7XG4gICAgICBpZiAodGV4dC5pbmNsdWRlcygndGllbXBvJykpIGFyZWFzLnB1c2goJ0dlc3Rpw7NuIGRlbCB0aWVtcG8nKVxuICAgICAgaWYgKHRleHQuaW5jbHVkZXMoJ2NvbmNlbnRyJykpIGFyZWFzLnB1c2goJ0NvbmNlbnRyYWNpw7NuJylcbiAgICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdtb3RpdicpKSBhcmVhcy5wdXNoKCdNb3RpdmFjacOzbicpXG4gICAgfVxuXG4gICAgcmV0dXJuIGFyZWFzLnNsaWNlKDAsIDMpXG4gIH1cblxuICAvKipcbiAgICogSWRlbnRpZmljYSBmb3J0YWxlemFzIGRlbCBlc3R1ZGlhbnRlXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBpZGVudGlmeVN0cmVuZ3RocyhzdWJqZWN0czogU3ViamVjdEFuYWx5c2lzW10sIHRleHQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzdHJlbmd0aHM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBBZ3JlZ2FyIG1hdGVyaWFzIGNvbiBidWVuIHJlbmRpbWllbnRvXG4gICAgc3ViamVjdHNcbiAgICAgIC5maWx0ZXIoc3ViamVjdCA9PiBzdWJqZWN0LnBlcmZvcm1hbmNlID4gNzUpXG4gICAgICAuZm9yRWFjaChzdWJqZWN0ID0+IHtcbiAgICAgICAgc3RyZW5ndGhzLnB1c2goYERvbWluaW8gZW4gJHtzdWJqZWN0LnN1YmplY3ROYW1lfWApXG4gICAgICB9KVxuXG4gICAgLy8gUGF0cm9uZXMgZGUgZm9ydGFsZXphIGdlbmVyYWxcbiAgICBpZiAodGV4dC5pbmNsdWRlcygnb3JnYW5peicpKSBzdHJlbmd0aHMucHVzaCgnQ2FwYWNpZGFkIGRlIG9yZ2FuaXphY2nDs24nKVxuICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdwZXJzZXZlcicpIHx8IHRleHQuaW5jbHVkZXMoJ3BlcnNpc3QnKSkgc3RyZW5ndGhzLnB1c2goJ1BlcnNldmVyYW5jaWEnKVxuICAgIGlmICh0ZXh0LmluY2x1ZGVzKCdjcmVhdGl2JykpIHN0cmVuZ3Rocy5wdXNoKCdQZW5zYW1pZW50byBjcmVhdGl2bycpXG5cbiAgICByZXR1cm4gc3RyZW5ndGhzLmxlbmd0aCA+IDAgPyBzdHJlbmd0aHMuc2xpY2UoMCwgMykgOiBbJ0RlZGljYWNpw7NuIGFsIGFwcmVuZGl6YWplJ11cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmEgcmVjb21lbmRhY2lvbmVzIGRlIHRlbWFzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZVJlY29tbWVuZGF0aW9ucyhzdWJqZWN0czogU3ViamVjdEFuYWx5c2lzW10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgc3ViamVjdHMuZm9yRWFjaChzdWJqZWN0ID0+IHtcbiAgICAgIGlmIChzdWJqZWN0Lm5lZWRzQXR0ZW50aW9uKSB7XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBSZWZvcnphciBjb25jZXB0b3MgYsOhc2ljb3MgZGUgJHtzdWJqZWN0LnN1YmplY3ROYW1lfWApXG4gICAgICAgIFxuICAgICAgICBpZiAoc3ViamVjdC5zdHJ1Z2dsaW5nVG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChgUHJhY3RpY2FyOiAke3N1YmplY3Quc3RydWdnbGluZ1RvcGljcy5qb2luKCcsICcpfWApXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucy5zbGljZSgwLCA0KVxuICB9XG5cbiAgLyoqXG4gICAqIElkZW50aWZpY2EgZWwgcGF0csOzbiBkZSBhcHJlbmRpemFqZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgaWRlbnRpZnlMZWFybmluZ1BhdHRlcm4odGV4dDogc3RyaW5nKTogJ3Zpc3VhbCcgfCAnYW5hbHl0aWNhbCcgfCAncHJhY3RpY2FsJyB8ICdtaXhlZCcge1xuICAgIGNvbnN0IHZpc3VhbEtleXdvcmRzID0gWydncsOhZmljbycsICdkaWFncmFtYScsICdpbWFnZW4nLCAndmlzdWFsJywgJ2RpYnVqbyddXG4gICAgY29uc3QgYW5hbHl0aWNhbEtleXdvcmRzID0gWydhbsOhbGlzaXMnLCAnbMOzZ2ljYScsICdyYXpvbmFtaWVudG8nLCAndGVvcsOtYSddXG4gICAgY29uc3QgcHJhY3RpY2FsS2V5d29yZHMgPSBbJ3Byw6FjdGljYScsICdlamVyY2ljaW8nLCAnYXBsaWNhcicsICdoYWNlciddXG5cbiAgICBjb25zdCB2aXN1YWxDb3VudCA9IHZpc3VhbEtleXdvcmRzLnJlZHVjZSgoY291bnQsIHdvcmQpID0+IGNvdW50ICsgKHRleHQuaW5jbHVkZXMod29yZCkgPyAxIDogMCksIDApXG4gICAgY29uc3QgYW5hbHl0aWNhbENvdW50ID0gYW5hbHl0aWNhbEtleXdvcmRzLnJlZHVjZSgoY291bnQsIHdvcmQpID0+IGNvdW50ICsgKHRleHQuaW5jbHVkZXMod29yZCkgPyAxIDogMCksIDApXG4gICAgY29uc3QgcHJhY3RpY2FsQ291bnQgPSBwcmFjdGljYWxLZXl3b3Jkcy5yZWR1Y2UoKGNvdW50LCB3b3JkKSA9PiBjb3VudCArICh0ZXh0LmluY2x1ZGVzKHdvcmQpID8gMSA6IDApLCAwKVxuXG4gICAgaWYgKHZpc3VhbENvdW50ID4gYW5hbHl0aWNhbENvdW50ICYmIHZpc3VhbENvdW50ID4gcHJhY3RpY2FsQ291bnQpIHJldHVybiAndmlzdWFsJ1xuICAgIGlmIChhbmFseXRpY2FsQ291bnQgPiBwcmFjdGljYWxDb3VudCkgcmV0dXJuICdhbmFseXRpY2FsJ1xuICAgIGlmIChwcmFjdGljYWxDb3VudCA+IDApIHJldHVybiAncHJhY3RpY2FsJ1xuICAgIHJldHVybiAnbWl4ZWQnXG4gIH1cblxuICAvKipcbiAgICogT2J0aWVuZSBlbCBub21icmUgZGUgdmlzdWFsaXphY2nDs24gZGUgdW5hIG1hdGVyaWFcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldFN1YmplY3REaXNwbGF5TmFtZShzdWJqZWN0OiBBY2FkZW1pY1N1YmplY3QpOiBzdHJpbmcge1xuICAgIGNvbnN0IG5hbWVzID0ge1xuICAgICAgW0FjYWRlbWljU3ViamVjdC5NQVRIRU1BVElDU106ICdNYXRlbcOhdGljYXMnLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5QSFlTSUNTXTogJ0bDrXNpY2EnLCBcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuQ0hFTUlTVFJZXTogJ1F1w61taWNhJyxcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuQklPTE9HWV06ICdCaW9sb2fDrWEnLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5TUEFOSVNIXTogJ0xlbmd1YSB5IExpdGVyYXR1cmEnLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5FTkdMSVNIXTogJ0luZ2zDqXMnLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5ISVNUT1JZXTogJ0hpc3RvcmlhJyxcbiAgICAgIFtBY2FkZW1pY1N1YmplY3QuR0VPR1JBUEhZXTogJ0dlb2dyYWbDrWEnLFxuICAgICAgW0FjYWRlbWljU3ViamVjdC5HRU5FUkFMXTogJ0dlbmVyYWwnXG4gICAgfVxuICAgIHJldHVybiBuYW1lc1tzdWJqZWN0XSB8fCAnTWF0ZXJpYSdcbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRpZW5lIHVuIHJlc3VtZW4gY29udGV4dHVhbCBwYXJhIGdlbmVyYXIgZWplcmNpY2lvc1xuICAgKi9cbiAgc3RhdGljIGdldEV4ZXJjaXNlQ29udGV4dChhbmFseXNpczogQWNhZGVtaWNBbmFseXNpcywgc3ViamVjdD86IEFjYWRlbWljU3ViamVjdCk6IHN0cmluZyB7XG4gICAgY29uc3QgdGFyZ2V0U3ViamVjdCA9IHN1YmplY3QgfHwgYW5hbHlzaXMuc3ViamVjdHNbMF0/LnN1YmplY3QgfHwgQWNhZGVtaWNTdWJqZWN0LkdFTkVSQUxcbiAgICBjb25zdCBzdWJqZWN0QW5hbHlzaXMgPSBhbmFseXNpcy5zdWJqZWN0cy5maW5kKHMgPT4gcy5zdWJqZWN0ID09PSB0YXJnZXRTdWJqZWN0KVxuICAgIFxuICAgIGlmICghc3ViamVjdEFuYWx5c2lzKSB7XG4gICAgICByZXR1cm4gYEVzdHVkaWFudGU6IG5pdmVsIGludGVybWVkaW8sIG5lY2VzaXRhIGV2YWx1YWNpw7NuIGluaWNpYWwgZW4gJHt0YXJnZXRTdWJqZWN0fWBcbiAgICB9XG5cbiAgICBjb25zdCBjb250ZXh0ID0gW1xuICAgICAgYE1hdGVyaWE6ICR7c3ViamVjdEFuYWx5c2lzLnN1YmplY3ROYW1lfWAsXG4gICAgICBgTml2ZWw6ICR7c3ViamVjdEFuYWx5c2lzLmRpZmZpY3VsdHlMZXZlbH1gLFxuICAgICAgYFJlbmRpbWllbnRvIGFjdHVhbDogJHtzdWJqZWN0QW5hbHlzaXMucGVyZm9ybWFuY2V9JWAsXG4gICAgICBzdWJqZWN0QW5hbHlzaXMuc3BlY2lmaWNDaGFsbGVuZ2VzLmxlbmd0aCA+IDAgXG4gICAgICAgID8gYERpZmljdWx0YWRlcyBlc3BlY8OtZmljYXM6ICR7c3ViamVjdEFuYWx5c2lzLnNwZWNpZmljQ2hhbGxlbmdlcy5qb2luKCcsICcpfWBcbiAgICAgICAgOiBudWxsLFxuICAgICAgc3ViamVjdEFuYWx5c2lzLnN0cnVnZ2xpbmdUb3BpY3MubGVuZ3RoID4gMFxuICAgICAgICA/IGBUZW1hcyBhIHJlZm9yemFyOiAke3N1YmplY3RBbmFseXNpcy5zdHJ1Z2dsaW5nVG9waWNzLmpvaW4oJywgJyl9YFxuICAgICAgICA6IG51bGwsXG4gICAgICBgUGF0csOzbiBkZSBhcHJlbmRpemFqZTogJHthbmFseXNpcy5sZWFybmluZ1BhdHRlcm59YFxuICAgIF0uZmlsdGVyKEJvb2xlYW4pLmpvaW4oJy4gJylcblxuICAgIHJldHVybiBjb250ZXh0XG4gIH1cbn0iXSwibmFtZXMiOlsidGVtcFdlZWtseVJlcG9ydHMiLCJBY2FkZW1pY1N1YmplY3QiLCJEaWZmaWN1bHR5TGV2ZWwiLCJTVUJKRUNUX1RPUElDUyIsIkRJRkZJQ1VMVFlfSU5ESUNBVE9SUyIsImhpZ2giLCJtZWRpdW0iLCJsb3ciLCJQUk9HUkVTU19JTkRJQ0FUT1JTIiwiZXhjZWxsZW50IiwiZ29vZCIsImZhaXIiLCJBY2FkZW1pY0FuYWx5emVyIiwiYW5hbHl6ZVN0dWRlbnQiLCJ1c2VySWQiLCJyZXBvcnRzIiwiZmlsdGVyIiwicmVwb3J0IiwibGVuZ3RoIiwiY3JlYXRlRGVmYXVsdEFuYWx5c2lzIiwicmVjZW50UmVwb3J0cyIsInNvcnQiLCJhIiwiYiIsIkRhdGUiLCJjcmVhdGVkQXQiLCJnZXRUaW1lIiwic2xpY2UiLCJhbGxSZXNwb25zZVRleHQiLCJmbGF0TWFwIiwiT2JqZWN0IiwidmFsdWVzIiwicmVzcG9uc2VzIiwiQm9vbGVhbiIsImpvaW4iLCJ0b0xvd2VyQ2FzZSIsInN1YmplY3RBbmFseXNlcyIsImFuYWx5emVTdWJqZWN0cyIsIm92ZXJhbGxQZXJmb3JtYW5jZSIsImNhbGN1bGF0ZU92ZXJhbGxQZXJmb3JtYW5jZSIsInN0cnVnZ2xpbmdBcmVhcyIsImlkZW50aWZ5U3RydWdnbGluZ0FyZWFzIiwic3RyZW5ndGhzIiwiaWRlbnRpZnlTdHJlbmd0aHMiLCJyZWNvbW1lbmRlZFRvcGljcyIsImdlbmVyYXRlUmVjb21tZW5kYXRpb25zIiwibGVhcm5pbmdQYXR0ZXJuIiwiaWRlbnRpZnlMZWFybmluZ1BhdHRlcm4iLCJzdWJqZWN0cyIsImxhc3RSZXBvcnREYXRlIiwibm93IiwidGV4dCIsImFuYWx5c2VzIiwic3ViamVjdEtleXdvcmRzIiwiZW50cmllcyIsImZvckVhY2giLCJzdWJqZWN0Iiwia2V5d29yZHMiLCJtZW50aW9ucyIsImtleXdvcmQiLCJpbmNsdWRlcyIsImFuYWx5c2lzIiwiYW5hbHl6ZVNwZWNpZmljU3ViamVjdCIsInB1c2giLCJjcmVhdGVHZW5lcmFsU3ViamVjdEFuYWx5c2lzIiwic3ViamVjdE5hbWUiLCJnZXRTdWJqZWN0RGlzcGxheU5hbWUiLCJ0b3BpY3MiLCJtZW50aW9uZWRUb3BpY3MiLCJ0b3BpYyIsInNwZWNpZmljQ2hhbGxlbmdlcyIsImV4dHJhY3RTcGVjaWZpY0NoYWxsZW5nZXMiLCJwZXJmb3JtYW5jZSIsImNhbGN1bGF0ZVN1YmplY3RQZXJmb3JtYW5jZSIsImRpZmZpY3VsdHlMZXZlbCIsImRldGVybWluZURpZmZpY3VsdHlMZXZlbCIsIm5lZWRzQXR0ZW50aW9uIiwic3RydWdnbGluZ1RvcGljcyIsIm1hc3RlcmVkVG9waWNzIiwicmVjZW50TWVudGlvbnMiLCJjaGFsbGVuZ2VzIiwiZGlmZmljdWx0eVBhdHRlcm5zIiwicGF0dGVybiIsIm1hdGNoIiwiZXhlYyIsInRyaW0iLCJjaGFsbGVuZ2VzQ291bnQiLCJzY29yZSIsImxldmVsIiwiaW5kaWNhdG9ycyIsIm11bHRpcGxpZXIiLCJpbmRpY2F0b3IiLCJwZW5hbHR5IiwiTWF0aCIsIm1heCIsIm1pbiIsImF2ZXJhZ2UiLCJyZWR1Y2UiLCJzdW0iLCJyb3VuZCIsImFyZWFzIiwicmVjb21tZW5kYXRpb25zIiwidmlzdWFsS2V5d29yZHMiLCJhbmFseXRpY2FsS2V5d29yZHMiLCJwcmFjdGljYWxLZXl3b3JkcyIsInZpc3VhbENvdW50IiwiY291bnQiLCJ3b3JkIiwiYW5hbHl0aWNhbENvdW50IiwicHJhY3RpY2FsQ291bnQiLCJuYW1lcyIsImdldEV4ZXJjaXNlQ29udGV4dCIsInRhcmdldFN1YmplY3QiLCJzdWJqZWN0QW5hbHlzaXMiLCJmaW5kIiwicyIsImNvbnRleHQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/academic-analyzer.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/advanced-command-processor.ts":
/*!***********************************************!*\
  !*** ./src/lib/advanced-command-processor.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedCommandProcessor: () => (/* binding */ AdvancedCommandProcessor)\n/* harmony export */ });\n/* harmony import */ var _student_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./student-context */ \"(rsc)/./src/lib/student-context.ts\");\n/* harmony import */ var _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./advanced-intent-engine */ \"(rsc)/./src/lib/advanced-intent-engine.ts\");\n/* harmony import */ var _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./school-schedule-manager */ \"(rsc)/./src/lib/school-schedule-manager.ts\");\n/* harmony import */ var _study_session_planner__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./study-session-planner */ \"(rsc)/./src/lib/study-session-planner.ts\");\n/* harmony import */ var _sara_personality__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./sara-personality */ \"(rsc)/./src/lib/sara-personality.ts\");\n/* harmony import */ var _calendar_ai_integration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./calendar-ai-integration */ \"(rsc)/./src/lib/calendar-ai-integration.ts\");\n// Procesador de Comandos Naturales Avanzados para Sara\n// Integra todos los sistemas para procesamiento inteligente de comandos complejos\n\n\n\n\n\n\nclass AdvancedCommandProcessor {\n    /**\n   * Procesa un comando natural del usuario integrando todos los sistemas\n   */ static async processCommand(command, context) {\n        try {\n            // Obtener contexto del estudiante\n            const studentContext = await _student_context__WEBPACK_IMPORTED_MODULE_0__.StudentContextManager.getContext(context.userId);\n            if (!studentContext) {\n                return this.createErrorResult('No se pudo cargar el contexto del estudiante');\n            }\n            // Analizar intención del comando\n            const intentAnalysis = await _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.AdvancedIntentEngine.analyzeIntent(command, context.userId, studentContext);\n            // Procesar según la intención detectada\n            switch(intentAnalysis.intent){\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.SCHEDULE_MANAGEMENT:\n                    return await this.processScheduleManagement(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.STUDY_PLANNING:\n                    return await this.processStudyPlanning(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.CALENDAR_MANAGEMENT:\n                    return await this.processCalendarManagement(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.TIME_OPTIMIZATION:\n                    return await this.processTimeOptimization(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.MATERIAL_REQUEST:\n                    return await this.processMaterialRequest(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.PROGRESS_REVIEW:\n                    return await this.processProgressReview(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.PERFORMANCE_ANALYSIS:\n                    return await this.processPerformanceAnalysis(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.GOAL_MANAGEMENT:\n                    return await this.processGoalManagement(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.PREFERENCE_SETTING:\n                    return await this.processPreferenceSetting(command, intentAnalysis, studentContext);\n                case _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.IntentType.MOTIVATIONAL_SUPPORT:\n                    return await this.processMotivationalSupport(command, intentAnalysis, studentContext);\n                default:\n                    return await this.processGeneralQuery(command, intentAnalysis, studentContext);\n            }\n        } catch (error) {\n            console.error('Error processing command:', error);\n            return this.createErrorResult(`Error procesando comando: ${error instanceof Error ? error.message : 'Error desconocido'}`);\n        }\n    }\n    /**\n   * Procesa comandos de gestión de horarios\n   */ static async processScheduleManagement(command, analysis, context) {\n        const commandLower = command.toLowerCase();\n        // Importar horario\n        if (commandLower.includes('importa') || commandLower.includes('agrega') && commandLower.includes('horario')) {\n            return await this.handleScheduleImport(command, context);\n        }\n        // Analizar horario existente\n        if (commandLower.includes('analiza') && commandLower.includes('horario')) {\n            return await this.handleScheduleAnalysis(context);\n        }\n        // Optimizar horario\n        if (commandLower.includes('optimiza') || commandLower.includes('mejora')) {\n            return await this.handleScheduleOptimization(context);\n        }\n        // Mostrar horario\n        if (commandLower.includes('muestra') || commandLower.includes('ver') && commandLower.includes('horario')) {\n            return await this.handleShowSchedule(context);\n        }\n        return this.createInfoResult('Gestión de Horarios', 'No pude identificar la acción específica. ¿Quieres importar, analizar, optimizar o ver tu horario?', {\n            availableActions: [\n                'Importar horario escolar',\n                'Analizar horario actual',\n                'Optimizar distribución de tiempo',\n                'Ver horario completo'\n            ]\n        });\n    }\n    /**\n   * Procesa comandos de planificación de estudio\n   */ static async processStudyPlanning(command, analysis, context) {\n        const commandLower = command.toLowerCase();\n        // Crear plan de estudio\n        if (commandLower.includes('crea') || commandLower.includes('planifica') || commandLower.includes('genera')) {\n            return await this.handleCreateStudyPlan(command, analysis, context);\n        }\n        // Modificar plan existente\n        if (commandLower.includes('modifica') || commandLower.includes('ajusta') || commandLower.includes('cambia')) {\n            return await this.handleModifyStudyPlan(command, context);\n        }\n        // Sugerir sesiones\n        if (commandLower.includes('sugiere') || commandLower.includes('recomienda')) {\n            return await this.handleSuggestStudySessions(command, analysis, context);\n        }\n        return this.createInfoResult('Planificación de Estudio', 'Puedo ayudarte a crear planes de estudio personalizados. ¿Qué período quieres planificar?', {\n            suggestions: [\n                'Esta semana',\n                'Próximos 15 días',\n                'Hasta el próximo examen',\n                'Todo el mes'\n            ]\n        });\n    }\n    /**\n   * Maneja la importación de horarios\n   */ static async handleScheduleImport(command, context) {\n        try {\n            // Extraer texto del horario del comando\n            const scheduleText = this.extractScheduleText(command);\n            if (!scheduleText) {\n                return this.createInfoResult('Importar Horario', 'Por favor, proporciona los detalles de tu horario. Ejemplo: \"Lunes 8:00-9:30 Matemáticas Aula 101, Martes 10:00-11:30 Física Lab 205\"', {}, [\n                    'Proporcionar horario detallado',\n                    'Ver ejemplo de formato'\n                ]);\n            }\n            // Procesar horario\n            const parsedClasses = _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.parseNaturalLanguageSchedule(scheduleText);\n            if (parsedClasses.length === 0) {\n                return this.createErrorResult('No pude extraer clases del texto proporcionado. Verifica el formato.');\n            }\n            // Importar horario\n            const importResult = await _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.importSchedule(context.userId, {\n                classes: parsedClasses\n            }, 'manual');\n            // Detectar conflictos\n            const conflicts = _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.detectScheduleConflicts(parsedClasses);\n            const studySlots = _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.analyzeStudyTimeSlots(parsedClasses);\n            return this.createActionResult('Horario Importado Exitosamente', `✅ He importado ${parsedClasses.length} clases a tu horario.\\n\\n📊 **Análisis:**\\n- ${conflicts.length} conflicto(s) detectado(s)\\n- ${studySlots.length} slot(s) de tiempo libre encontrado(s)\\n- ${Math.round(parsedClasses.reduce((sum, cls)=>sum + cls.duration, 0) / 60)} horas semanales de clase`, {\n                importedClasses: parsedClasses.length,\n                conflicts: conflicts,\n                studySlots: studySlots,\n                totalHours: parsedClasses.reduce((sum, cls)=>sum + cls.duration, 0) / 60\n            }, conflicts.length > 0 ? [\n                'Resolver conflictos',\n                'Ver análisis completo'\n            ] : [\n                'Planificar sesiones de estudio',\n                'Ver calendario optimizado'\n            ], [\n                '¿Quieres que planifique sesiones de estudio en los tiempos libres?',\n                '¿Te ayudo a resolver los conflictos detectados?'\n            ]);\n        } catch (error) {\n            return this.createErrorResult(`Error importando horario: ${error instanceof Error ? error.message : 'Error desconocido'}`);\n        }\n    }\n    /**\n   * Maneja el análisis de horarios\n   */ static async handleScheduleAnalysis(context) {\n        if (!context.academicCalendar.schoolSchedule.length) {\n            return this.createInfoResult('Análisis de Horario', 'No tienes un horario escolar configurado. Primero importa tu horario para poder analizarlo.', {}, [\n                'Importar horario escolar',\n                'Ver formato de importación'\n            ]);\n        }\n        // Convertir a formato SchoolClass para análisis\n        const classes = context.academicCalendar.schoolSchedule.map((schedule)=>({\n                id: `class_${schedule.subject}_${schedule.day}`,\n                subject: schedule.subject,\n                teacher: schedule.teacher,\n                classroom: schedule.classroom,\n                day: schedule.day,\n                startTime: schedule.startTime,\n                endTime: schedule.endTime,\n                duration: this.calculateDuration(schedule.startTime, schedule.endTime),\n                type: 'lecture',\n                recurring: true\n            }));\n        const conflicts = _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.detectScheduleConflicts(classes);\n        const studySlots = _school_schedule_manager__WEBPACK_IMPORTED_MODULE_2__.SchoolScheduleManager.analyzeStudyTimeSlots(classes);\n        // Calcular estadísticas\n        const totalHours = classes.reduce((sum, cls)=>sum + cls.duration, 0) / 60;\n        const dailyDistribution = this.calculateDailyDistribution(classes);\n        const subjectDistribution = this.calculateSubjectDistribution(classes);\n        const analysis = {\n            totalClasses: classes.length,\n            totalHours,\n            averageHoursPerDay: totalHours / 5,\n            conflicts: conflicts.length,\n            availableStudySlots: studySlots.length,\n            freeHours: studySlots.reduce((sum, slot)=>sum + slot.duration, 0) / 60,\n            dailyDistribution,\n            subjectDistribution\n        };\n        let message = `📊 **Análisis de tu Horario Académico:**\\n\\n`;\n        message += `📚 **Resumen General:**\\n`;\n        message += `• ${analysis.totalClasses} clases semanales\\n`;\n        message += `• ${analysis.totalHours.toFixed(1)} horas académicas por semana\\n`;\n        message += `• ${analysis.averageHoursPerDay.toFixed(1)} horas promedio por día\\n\\n`;\n        if (conflicts.length > 0) {\n            message += `⚠️ **Conflictos Detectados:** ${conflicts.length}\\n`;\n            conflicts.slice(0, 3).forEach((conflict)=>{\n                message += `• ${conflict.description}\\n`;\n            });\n            message += `\\n`;\n        }\n        message += `⏰ **Tiempo Libre para Estudio:**\\n`;\n        message += `• ${analysis.availableStudySlots} slots disponibles\\n`;\n        message += `• ${analysis.freeHours.toFixed(1)} horas libres por semana\\n\\n`;\n        const recommendations = this.generateScheduleRecommendations(analysis, conflicts);\n        if (recommendations.length > 0) {\n            message += `💡 **Recomendaciones:**\\n`;\n            recommendations.forEach((rec)=>message += `• ${rec}\\n`);\n        }\n        return this.createAnalysisResult('Análisis de Horario Completo', message, analysis, [\n            'Planificar sesiones de estudio',\n            'Optimizar horario',\n            'Resolver conflictos'\n        ], [\n            '¿Quieres que cree un plan de estudio basado en tu tiempo libre?'\n        ]);\n    }\n    /**\n   * Maneja la creación de planes de estudio\n   */ static async handleCreateStudyPlan(command, analysis, context) {\n        // Extraer período de planificación del comando\n        const period = this.extractPlanningPeriod(command);\n        // Extraer materias específicas si se mencionan\n        const subjects = analysis.entities.subjects || [];\n        try {\n            // Generar plan de estudio\n            const studyPlan = await _study_session_planner__WEBPACK_IMPORTED_MODULE_3__.StudySessionPlanner.generateStudyPlan(context, period, {\n                prioritizeWeakSubjects: true,\n                includeReviewSessions: true,\n                respectEnergyLevels: true\n            });\n            let message = `📋 **Plan de Estudio Creado: \"${studyPlan.title}\"**\\n\\n`;\n            message += `📅 **Período:** ${period.startDate.toLocaleDateString('es-ES')} - ${period.endDate.toLocaleDateString('es-ES')}\\n`;\n            message += `🎯 **Sesiones Planificadas:** ${studyPlan.totalSessions}\\n`;\n            message += `⏱️ **Horas Totales:** ${studyPlan.metrics.totalPlannedHours.toFixed(1)}h\\n`;\n            message += `📚 **Materias:** ${studyPlan.subjects.join(', ')}\\n\\n`;\n            // Mostrar próximas sesiones\n            const upcomingSessions = studyPlan.sessions.filter((session)=>session.date >= new Date()).slice(0, 5).sort((a, b)=>a.date.getTime() - b.date.getTime());\n            if (upcomingSessions.length > 0) {\n                message += `📝 **Próximas Sesiones:**\\n`;\n                upcomingSessions.forEach((session)=>{\n                    message += `• ${session.date.toLocaleDateString('es-ES')} ${session.startTime} - ${session.subject}: ${session.topic} (${session.duration}min)\\n`;\n                });\n                message += `\\n`;\n            }\n            // Distribución por materia\n            message += `📊 **Distribución por Materia:**\\n`;\n            Object.entries(studyPlan.metrics.subjectBalance).forEach(([subject, hours])=>{\n                message += `• ${subject}: ${hours.toFixed(1)}h\\n`;\n            });\n            return this.createPlanningResult('Plan de Estudio Generado', message, studyPlan, [\n                'Ver calendario completo',\n                'Ajustar plan',\n                'Comenzar primera sesión'\n            ], [\n                '¿Quieres que ajuste alguna sesión específica?',\n                '¿Te parece bien la distribución de materias?'\n            ]);\n        } catch (error) {\n            return this.createErrorResult(`Error creando plan de estudio: ${error instanceof Error ? error.message : 'Error desconocido'}`);\n        }\n    }\n    /**\n   * Maneja la revisión de progreso\n   */ static async processProgressReview(command, analysis, context) {\n        const progressData = this.calculateProgressMetrics(context);\n        const insights = this.generateProgressInsights(progressData, context);\n        let message = `📈 **Revisión de tu Progreso Académico:**\\n\\n`;\n        // Progreso general\n        message += `🎯 **Objetivos Activos:**\\n`;\n        if (context.currentGoals.length > 0) {\n            context.currentGoals.slice(0, 5).forEach((goal)=>{\n                message += `• ${goal.title}: ${goal.progress}% completado\\n`;\n            });\n        } else {\n            message += `• No tienes objetivos definidos actualmente\\n`;\n        }\n        message += `\\n`;\n        // Rendimiento por materia\n        if (context.subjectPerformances.length > 0) {\n            message += `📚 **Rendimiento por Materia:**\\n`;\n            const sortedSubjects = context.subjectPerformances.sort((a, b)=>b.averageGrade - a.averageGrade).slice(0, 5);\n            sortedSubjects.forEach((subject)=>{\n                const emoji = subject.averageGrade >= 85 ? '🟢' : subject.averageGrade >= 70 ? '🟡' : '🔴';\n                message += `${emoji} ${subject.subject}: ${subject.averageGrade}% promedio\\n`;\n            });\n            message += `\\n`;\n        }\n        // Patrones de estudio\n        message += `⏱️ **Patrones de Estudio:**\\n`;\n        message += `• Horas semanales: ${context.studyPatterns.weeklyStats.totalStudyHours.toFixed(1)}h\\n`;\n        message += `• Nivel de enfoque promedio: ${context.studyPatterns.weeklyStats.averageFocusScore}/10\\n`;\n        message += `• Momentos más productivos: ${context.studyPatterns.patterns.mostProductiveHours.slice(0, 3).join(', ')}\\n\\n`;\n        // Insights y recomendaciones\n        if (insights.recommendations.length > 0) {\n            message += `💡 **Recomendaciones:**\\n`;\n            insights.recommendations.slice(0, 4).forEach((rec)=>{\n                message += `• ${rec}\\n`;\n            });\n        }\n        return this.createAnalysisResult('Análisis de Progreso', message, progressData, [\n            'Establecer nuevos objetivos',\n            'Ajustar plan de estudio',\n            'Ver análisis detallado'\n        ], [\n            '¿En qué área específica te gustaría mejorar?',\n            '¿Quieres que ajuste tu plan de estudio actual?'\n        ]);\n    }\n    // Funciones auxiliares\n    static extractScheduleText(command) {\n        // Extraer texto después de palabras clave como \"importa\", \"horario:\", etc.\n        const patterns = [\n            /horario[:\\s]+(.+)/i,\n            /importa[:\\s]+(.+)/i,\n            /clases[:\\s]+(.+)/i\n        ];\n        for (const pattern of patterns){\n            const match = command.match(pattern);\n            if (match && match[1]) {\n                return match[1].trim();\n            }\n        }\n        // Si no hay patrones específicos, asumir que todo el comando es el horario\n        const keywords = [\n            'importa',\n            'agrega',\n            'horario',\n            'clases'\n        ];\n        const hasKeyword = keywords.some((keyword)=>command.toLowerCase().includes(keyword));\n        if (hasKeyword) {\n            // Remover palabras clave y retornar el resto\n            let cleanCommand = command;\n            keywords.forEach((keyword)=>{\n                cleanCommand = cleanCommand.replace(new RegExp(keyword, 'gi'), '');\n            });\n            return cleanCommand.trim();\n        }\n        return command;\n    }\n    static extractPlanningPeriod(command) {\n        const today = new Date();\n        const commandLower = command.toLowerCase();\n        if (commandLower.includes('semana')) {\n            const endDate = new Date(today);\n            endDate.setDate(today.getDate() + 7);\n            return {\n                startDate: today,\n                endDate\n            };\n        }\n        if (commandLower.includes('mes')) {\n            const endDate = new Date(today);\n            endDate.setMonth(today.getMonth() + 1);\n            return {\n                startDate: today,\n                endDate\n            };\n        }\n        if (commandLower.includes('15') || commandLower.includes('quince')) {\n            const endDate = new Date(today);\n            endDate.setDate(today.getDate() + 15);\n            return {\n                startDate: today,\n                endDate\n            };\n        }\n        // Por defecto: una semana\n        const endDate = new Date(today);\n        endDate.setDate(today.getDate() + 7);\n        return {\n            startDate: today,\n            endDate\n        };\n    }\n    static calculateDuration(startTime, endTime) {\n        const start = this.timeToMinutes(startTime);\n        const end = this.timeToMinutes(endTime);\n        return end - start;\n    }\n    static timeToMinutes(time) {\n        const [hours, minutes] = time.split(':').map(Number);\n        return hours * 60 + minutes;\n    }\n    static calculateDailyDistribution(classes) {\n        return classes.reduce((acc, cls)=>{\n            acc[cls.day] = (acc[cls.day] || 0) + cls.duration / 60;\n            return acc;\n        }, {});\n    }\n    static calculateSubjectDistribution(classes) {\n        return classes.reduce((acc, cls)=>{\n            acc[cls.subject] = (acc[cls.subject] || 0) + cls.duration / 60;\n            return acc;\n        }, {});\n    }\n    static generateScheduleRecommendations(analysis, conflicts) {\n        const recommendations = [];\n        if (conflicts.length > 0) {\n            recommendations.push('Resolver conflictos de horario detectados');\n        }\n        if (analysis.averageHoursPerDay > 7) {\n            recommendations.push('Considerar reducir la carga académica diaria');\n        }\n        if (analysis.freeHours < 10) {\n            recommendations.push('Buscar más tiempo libre para estudio personal');\n        }\n        if (analysis.freeHours > 25) {\n            recommendations.push('Aprovechar el tiempo libre abundante para actividades extracurriculares');\n        }\n        return recommendations;\n    }\n    static calculateProgressMetrics(context) {\n        const totalGoals = context.currentGoals.length;\n        const completedGoals = context.currentGoals.filter((g)=>g.progress >= 100).length;\n        const avgGoalProgress = totalGoals > 0 ? context.currentGoals.reduce((sum, g)=>sum + g.progress, 0) / totalGoals : 0;\n        const avgGrade = context.subjectPerformances.length > 0 ? context.subjectPerformances.reduce((sum, s)=>sum + s.averageGrade, 0) / context.subjectPerformances.length : 0;\n        return {\n            goalCompletionRate: completedGoals / Math.max(totalGoals, 1) * 100,\n            averageGoalProgress: avgGoalProgress,\n            averageGrade: avgGrade,\n            totalStudyHours: context.studyPatterns.weeklyStats.totalStudyHours,\n            focusScore: context.studyPatterns.weeklyStats.averageFocusScore\n        };\n    }\n    static generateProgressInsights(progressData, context) {\n        const recommendations = [];\n        if (progressData.goalCompletionRate < 50) {\n            recommendations.push('Revisar y ajustar objetivos para que sean más alcanzables');\n        }\n        if (progressData.averageGrade < 75) {\n            recommendations.push('Incrementar tiempo de estudio en materias con menor rendimiento');\n        }\n        if (progressData.totalStudyHours < 10) {\n            recommendations.push('Aumentar gradualmente las horas de estudio semanales');\n        }\n        if (progressData.focusScore < 6) {\n            recommendations.push('Implementar técnicas de mejora de concentración');\n        }\n        return {\n            recommendations\n        };\n    }\n    // Métodos auxiliares para crear resultados\n    static createInfoResult(title, message, data, actions, questions) {\n        return {\n            success: true,\n            type: 'information',\n            title,\n            message,\n            data,\n            suggestedActions: actions,\n            followUpQuestions: questions\n        };\n    }\n    static createActionResult(title, message, data, actions, questions) {\n        return {\n            success: true,\n            type: 'action',\n            title,\n            message,\n            data,\n            suggestedActions: actions,\n            followUpQuestions: questions\n        };\n    }\n    static createPlanningResult(title, message, data, actions, questions) {\n        return {\n            success: true,\n            type: 'planning',\n            title,\n            message,\n            data,\n            suggestedActions: actions,\n            followUpQuestions: questions\n        };\n    }\n    static createAnalysisResult(title, message, data, actions, questions) {\n        return {\n            success: true,\n            type: 'analysis',\n            title,\n            message,\n            data,\n            suggestedActions: actions,\n            followUpQuestions: questions\n        };\n    }\n    static createErrorResult(message) {\n        return {\n            success: false,\n            type: 'error',\n            title: 'Error',\n            message\n        };\n    }\n    // Métodos de procesamiento adicionales (implementación básica)\n    static async processCalendarManagement(command, analysis, context) {\n        console.log('📅 Processing calendar management command:', command);\n        // Integrar con AICalendarIntegration existente\n        const calendarIntegration = new _calendar_ai_integration__WEBPACK_IMPORTED_MODULE_5__.AICalendarIntegration(context.userId);\n        const result = await calendarIntegration.processMessage(command, []);\n        console.log('📅 Calendar integration result:', {\n            needsEventCreation: result.needsEventCreation,\n            eventCreated: !!result.event,\n            response: result.response?.substring(0, 100)\n        });\n        if (result.needsEventCreation || result.event) {\n            // Si se creó un evento o se necesita crear uno, considerarlo éxito\n            return this.createActionResult('Gestión de Calendario', result.response || 'Evento de calendario procesado exitosamente', result.event, result.event ? [\n                'Ver en calendario',\n                'Editar evento',\n                'Eliminar evento'\n            ] : [\n                'Ver calendario',\n                'Agregar más eventos'\n            ], result.event ? [\n                '¿Necesitas modificar algún detalle del evento?'\n            ] : [\n                '¿Necesitas programar algún evento adicional?'\n            ]);\n        }\n        // Si no se detectó una acción de calendario, devolver el resultado tal como está\n        return this.createInfoResult('Información de Calendario', result.response || 'No se detectó una acción específica de calendario', {}, [\n            'Ver próximos eventos',\n            'Agregar evento'\n        ], [\n            '¿Qué evento te gustaría agendar?',\n            '¿Necesitas ver tu calendario?'\n        ]);\n    }\n    static async processTimeOptimization(command, analysis, context) {\n        return this.createInfoResult('Optimización de Tiempo', 'Analizando tu horario para encontrar las mejores oportunidades de optimización...', {}, [\n            'Analizar horario actual',\n            'Sugerir mejoras'\n        ], [\n            '¿En qué área específica quieres optimizar tu tiempo?'\n        ]);\n    }\n    static async processMaterialRequest(command, analysis, context) {\n        return this.createInfoResult('Gestión de Materiales', 'Te ayudo a organizar y encontrar materiales de estudio.', {}, [\n            'Buscar recursos',\n            'Organizar materiales'\n        ], [\n            '¿Para qué materia necesitas materiales?'\n        ]);\n    }\n    static async processPerformanceAnalysis(command, analysis, context) {\n        return this.createAnalysisResult('Análisis de Rendimiento', 'Analizando tu rendimiento académico...', {}, [\n            'Ver detalles por materia',\n            'Generar reporte'\n        ], [\n            '¿Quieres enfocarnos en alguna materia específica?'\n        ]);\n    }\n    static async processGoalManagement(command, analysis, context) {\n        return this.createPlanningResult('Gestión de Objetivos', 'Te ayudo a establecer y seguir tus objetivos académicos.', {}, [\n            'Crear nuevo objetivo',\n            'Revisar progreso'\n        ], [\n            '¿Qué objetivo académico quieres establecer?'\n        ]);\n    }\n    static async processPreferenceSetting(command, analysis, context) {\n        return this.createInfoResult('Configuración de Preferencias', 'Configurando tus preferencias de estudio y aprendizaje.', {}, [\n            'Actualizar preferencias',\n            'Ver configuración actual'\n        ], [\n            '¿Qué aspecto de tus preferencias quieres modificar?'\n        ]);\n    }\n    static async processMotivationalSupport(command, analysis, context) {\n        const supportMessage = _sara_personality__WEBPACK_IMPORTED_MODULE_4__.SaraPersonalityEngine.selectResponse('motivation', context);\n        return this.createInfoResult('Apoyo Motivacional', supportMessage, {}, [\n            'Planificar sesión de estudio',\n            'Establecer objetivos pequeños'\n        ], [\n            '¿Hay algo específico que te está preocupando?',\n            '¿Quieres que planifiquemos juntos tu próxima sesión de estudio?'\n        ]);\n    }\n    static async processGeneralQuery(command, analysis, context) {\n        return this.createInfoResult('Consulta General', 'Entiendo tu consulta. ¿Podrías ser más específico sobre cómo puedo ayudarte?', {}, [\n            'Gestionar horario',\n            'Planificar estudio',\n            'Analizar progreso'\n        ], [\n            '¿Necesitas ayuda con organización, planificación o análisis académico?'\n        ]);\n    }\n    static async handleScheduleOptimization(context) {\n        return this.createPlanningResult('Optimización de Horario', 'Analizando tu horario para sugerir optimizaciones...', {}, [\n            'Aplicar optimizaciones',\n            'Ver análisis detallado'\n        ], [\n            '¿Prefieres optimizar para más tiempo libre o mejor distribución de materias?'\n        ]);\n    }\n    static async handleShowSchedule(context) {\n        return this.createInfoResult('Tu Horario Académico', 'Mostrando tu horario completo...', {\n            schedule: context.academicCalendar.schoolSchedule\n        }, [\n            'Analizar horario',\n            'Optimizar tiempo'\n        ], [\n            '¿Quieres que analice tu horario o que planifique sesiones de estudio?'\n        ]);\n    }\n    static async handleModifyStudyPlan(command, context) {\n        return this.createPlanningResult('Modificar Plan de Estudio', 'Te ayudo a ajustar tu plan de estudio actual.', {}, [\n            'Ver plan actual',\n            'Hacer cambios específicos'\n        ], [\n            '¿Qué aspecto del plan quieres modificar?'\n        ]);\n    }\n    static async handleSuggestStudySessions(command, analysis, context) {\n        return this.createPlanningResult('Sugerencias de Sesiones', 'Basándome en tu contexto, te sugiero estas sesiones de estudio...', {}, [\n            'Programar sesiones',\n            'Ajustar sugerencias'\n        ], [\n            '¿Quieres que programe estas sesiones en tu calendario?'\n        ]);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FkdmFuY2VkLWNvbW1hbmQtcHJvY2Vzc29yLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQSx1REFBdUQ7QUFDdkQsa0ZBQWtGO0FBRVQ7QUFDb0I7QUFDNUI7QUFDTztBQUNkO0FBQ087QUF3QjFELE1BQU1PO0lBRVg7O0dBRUMsR0FDRCxhQUFhQyxlQUNYQyxPQUFlLEVBQ2ZDLE9BQXVCLEVBQ0M7UUFFeEIsSUFBSTtZQUNGLGtDQUFrQztZQUNsQyxNQUFNQyxpQkFBaUIsTUFBTVgsbUVBQXFCQSxDQUFDWSxVQUFVLENBQUNGLFFBQVFHLE1BQU07WUFDNUUsSUFBSSxDQUFDRixnQkFBZ0I7Z0JBQ25CLE9BQU8sSUFBSSxDQUFDRyxpQkFBaUIsQ0FBQztZQUNoQztZQUVBLGlDQUFpQztZQUNqQyxNQUFNQyxpQkFBaUIsTUFBTWQseUVBQW9CQSxDQUFDZSxhQUFhLENBQzdEUCxTQUNBQyxRQUFRRyxNQUFNLEVBQ2RGO1lBR0Ysd0NBQXdDO1lBQ3hDLE9BQVFJLGVBQWVFLE1BQU07Z0JBQzNCLEtBQUtmLCtEQUFVQSxDQUFDZ0IsbUJBQW1CO29CQUNqQyxPQUFPLE1BQU0sSUFBSSxDQUFDQyx5QkFBeUIsQ0FBQ1YsU0FBU00sZ0JBQWdCSjtnQkFFdkUsS0FBS1QsK0RBQVVBLENBQUNrQixjQUFjO29CQUM1QixPQUFPLE1BQU0sSUFBSSxDQUFDQyxvQkFBb0IsQ0FBQ1osU0FBU00sZ0JBQWdCSjtnQkFFbEUsS0FBS1QsK0RBQVVBLENBQUNvQixtQkFBbUI7b0JBQ2pDLE9BQU8sTUFBTSxJQUFJLENBQUNDLHlCQUF5QixDQUFDZCxTQUFTTSxnQkFBZ0JKO2dCQUV2RSxLQUFLVCwrREFBVUEsQ0FBQ3NCLGlCQUFpQjtvQkFDL0IsT0FBTyxNQUFNLElBQUksQ0FBQ0MsdUJBQXVCLENBQUNoQixTQUFTTSxnQkFBZ0JKO2dCQUVyRSxLQUFLVCwrREFBVUEsQ0FBQ3dCLGdCQUFnQjtvQkFDOUIsT0FBTyxNQUFNLElBQUksQ0FBQ0Msc0JB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ZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL2FkdmFuY2VkLWNvbW1hbmQtcHJvY2Vzc29yLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFByb2Nlc2Fkb3IgZGUgQ29tYW5kb3MgTmF0dXJhbGVzIEF2YW56YWRvcyBwYXJhIFNhcmFcbi8vIEludGVncmEgdG9kb3MgbG9zIHNpc3RlbWFzIHBhcmEgcHJvY2VzYW1pZW50byBpbnRlbGlnZW50ZSBkZSBjb21hbmRvcyBjb21wbGVqb3NcblxuaW1wb3J0IHsgU3R1ZGVudENvbnRleHQsIFN0dWRlbnRDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vc3R1ZGVudC1jb250ZXh0J1xuaW1wb3J0IHsgQWR2YW5jZWRJbnRlbnRFbmdpbmUsIEludGVudFR5cGUsIENvbnZlcnNhdGlvbk1vZGUgfSBmcm9tICcuL2FkdmFuY2VkLWludGVudC1lbmdpbmUnXG5pbXBvcnQgeyBTY2hvb2xTY2hlZHVsZU1hbmFnZXIgfSBmcm9tICcuL3NjaG9vbC1zY2hlZHVsZS1tYW5hZ2VyJ1xuaW1wb3J0IHsgU3R1ZHlTZXNzaW9uUGxhbm5lciwgU3R1ZHlQbGFuIH0gZnJvbSAnLi9zdHVkeS1zZXNzaW9uLXBsYW5uZXInXG5pbXBvcnQgeyBTYXJhUGVyc29uYWxpdHlFbmdpbmUgfSBmcm9tICcuL3NhcmEtcGVyc29uYWxpdHknXG5pbXBvcnQgeyBBSUNhbGVuZGFySW50ZWdyYXRpb24gfSBmcm9tICcuL2NhbGVuZGFyLWFpLWludGVncmF0aW9uJ1xuXG5leHBvcnQgaW50ZXJmYWNlIENvbW1hbmRSZXN1bHQge1xuICBzdWNjZXNzOiBib29sZWFuXG4gIHR5cGU6ICdpbmZvcm1hdGlvbicgfCAnYWN0aW9uJyB8ICdwbGFubmluZycgfCAnYW5hbHlzaXMnIHwgJ2Vycm9yJ1xuICB0aXRsZTogc3RyaW5nXG4gIG1lc3NhZ2U6IHN0cmluZ1xuICBkYXRhPzogYW55XG4gIHN1Z2dlc3RlZEFjdGlvbnM/OiBzdHJpbmdbXVxuICBmb2xsb3dVcFF1ZXN0aW9ucz86IHN0cmluZ1tdXG4gIHZpc3VhbGl6YXRpb25zPzoge1xuICAgIHR5cGU6ICdjaGFydCcgfCAnY2FsZW5kYXInIHwgJ3RpbWVsaW5lJyB8ICd0YWJsZSdcbiAgICBkYXRhOiBhbnlcbiAgfVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29tbWFuZENvbnRleHQge1xuICB1c2VySWQ6IHN0cmluZ1xuICB1c2VyTmFtZT86IHN0cmluZ1xuICBjb252ZXJzYXRpb25IaXN0b3J5OiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnLCBjb250ZW50OiBzdHJpbmcgfT5cbiAgY3VycmVudE1vZGU6IENvbnZlcnNhdGlvbk1vZGVcbiAgbGFzdENvbW1hbmRzOiBzdHJpbmdbXVxufVxuXG5leHBvcnQgY2xhc3MgQWR2YW5jZWRDb21tYW5kUHJvY2Vzc29yIHtcblxuICAvKipcbiAgICogUHJvY2VzYSB1biBjb21hbmRvIG5hdHVyYWwgZGVsIHVzdWFyaW8gaW50ZWdyYW5kbyB0b2RvcyBsb3Mgc2lzdGVtYXNcbiAgICovXG4gIHN0YXRpYyBhc3luYyBwcm9jZXNzQ29tbWFuZChcbiAgICBjb21tYW5kOiBzdHJpbmcsIFxuICAgIGNvbnRleHQ6IENvbW1hbmRDb250ZXh0XG4gICk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBPYnRlbmVyIGNvbnRleHRvIGRlbCBlc3R1ZGlhbnRlXG4gICAgICBjb25zdCBzdHVkZW50Q29udGV4dCA9IGF3YWl0IFN0dWRlbnRDb250ZXh0TWFuYWdlci5nZXRDb250ZXh0KGNvbnRleHQudXNlcklkKVxuICAgICAgaWYgKCFzdHVkZW50Q29udGV4dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVFcnJvclJlc3VsdCgnTm8gc2UgcHVkbyBjYXJnYXIgZWwgY29udGV4dG8gZGVsIGVzdHVkaWFudGUnKVxuICAgICAgfVxuXG4gICAgICAvLyBBbmFsaXphciBpbnRlbmNpw7NuIGRlbCBjb21hbmRvXG4gICAgICBjb25zdCBpbnRlbnRBbmFseXNpcyA9IGF3YWl0IEFkdmFuY2VkSW50ZW50RW5naW5lLmFuYWx5emVJbnRlbnQoXG4gICAgICAgIGNvbW1hbmQsIFxuICAgICAgICBjb250ZXh0LnVzZXJJZCwgXG4gICAgICAgIHN0dWRlbnRDb250ZXh0XG4gICAgICApXG5cbiAgICAgIC8vIFByb2Nlc2FyIHNlZ8O6biBsYSBpbnRlbmNpw7NuIGRldGVjdGFkYVxuICAgICAgc3dpdGNoIChpbnRlbnRBbmFseXNpcy5pbnRlbnQpIHtcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLlNDSEVEVUxFX01BTkFHRU1FTlQ6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1NjaGVkdWxlTWFuYWdlbWVudChjb21tYW5kLCBpbnRlbnRBbmFseXNpcywgc3R1ZGVudENvbnRleHQpXG4gICAgICAgIFxuICAgICAgICBjYXNlIEludGVudFR5cGUuU1RVRFlfUExBTk5JTkc6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1N0dWR5UGxhbm5pbmcoY29tbWFuZCwgaW50ZW50QW5hbHlzaXMsIHN0dWRlbnRDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLkNBTEVOREFSX01BTkFHRU1FTlQ6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc0NhbGVuZGFyTWFuYWdlbWVudChjb21tYW5kLCBpbnRlbnRBbmFseXNpcywgc3R1ZGVudENvbnRleHQpXG4gICAgICAgIFxuICAgICAgICBjYXNlIEludGVudFR5cGUuVElNRV9PUFRJTUlaQVRJT046XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1RpbWVPcHRpbWl6YXRpb24oY29tbWFuZCwgaW50ZW50QW5hbHlzaXMsIHN0dWRlbnRDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLk1BVEVSSUFMX1JFUVVFU1Q6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc01hdGVyaWFsUmVxdWVzdChjb21tYW5kLCBpbnRlbnRBbmFseXNpcywgc3R1ZGVudENvbnRleHQpXG4gICAgICAgIFxuICAgICAgICBjYXNlIEludGVudFR5cGUuUFJPR1JFU1NfUkVWSUVXOlxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByb2Nlc3NQcm9ncmVzc1Jldmlldyhjb21tYW5kLCBpbnRlbnRBbmFseXNpcywgc3R1ZGVudENvbnRleHQpXG4gICAgICAgIFxuICAgICAgICBjYXNlIEludGVudFR5cGUuUEVSRk9STUFOQ0VfQU5BTFlTSVM6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc1BlcmZvcm1hbmNlQW5hbHlzaXMoY29tbWFuZCwgaW50ZW50QW5hbHlzaXMsIHN0dWRlbnRDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLkdPQUxfTUFOQUdFTUVOVDpcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcm9jZXNzR29hbE1hbmFnZW1lbnQoY29tbWFuZCwgaW50ZW50QW5hbHlzaXMsIHN0dWRlbnRDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLlBSRUZFUkVOQ0VfU0VUVElORzpcbiAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcm9jZXNzUHJlZmVyZW5jZVNldHRpbmcoY29tbWFuZCwgaW50ZW50QW5hbHlzaXMsIHN0dWRlbnRDb250ZXh0KVxuICAgICAgICBcbiAgICAgICAgY2FzZSBJbnRlbnRUeXBlLk1PVElWQVRJT05BTF9TVVBQT1JUOlxuICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByb2Nlc3NNb3RpdmF0aW9uYWxTdXBwb3J0KGNvbW1hbmQsIGludGVudEFuYWx5c2lzLCBzdHVkZW50Q29udGV4dClcbiAgICAgICAgXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJvY2Vzc0dlbmVyYWxRdWVyeShjb21tYW5kLCBpbnRlbnRBbmFseXNpcywgc3R1ZGVudENvbnRleHQpXG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcHJvY2Vzc2luZyBjb21tYW5kOicsIGVycm9yKVxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlRXJyb3JSZXN1bHQoYEVycm9yIHByb2Nlc2FuZG8gY29tYW5kbzogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdFcnJvciBkZXNjb25vY2lkbyd9YClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUHJvY2VzYSBjb21hbmRvcyBkZSBnZXN0acOzbiBkZSBob3Jhcmlvc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgcHJvY2Vzc1NjaGVkdWxlTWFuYWdlbWVudChcbiAgICBjb21tYW5kOiBzdHJpbmcsXG4gICAgYW5hbHlzaXM6IGFueSxcbiAgICBjb250ZXh0OiBTdHVkZW50Q29udGV4dFxuICApOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICBcbiAgICBjb25zdCBjb21tYW5kTG93ZXIgPSBjb21tYW5kLnRvTG93ZXJDYXNlKClcblxuICAgIC8vIEltcG9ydGFyIGhvcmFyaW9cbiAgICBpZiAoY29tbWFuZExvd2VyLmluY2x1ZGVzKCdpbXBvcnRhJykgfHwgY29tbWFuZExvd2VyLmluY2x1ZGVzKCdhZ3JlZ2EnKSAmJiBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ2hvcmFyaW8nKSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlU2NoZWR1bGVJbXBvcnQoY29tbWFuZCwgY29udGV4dClcbiAgICB9XG5cbiAgICAvLyBBbmFsaXphciBob3JhcmlvIGV4aXN0ZW50ZVxuICAgIGlmIChjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ2FuYWxpemEnKSAmJiBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ2hvcmFyaW8nKSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlU2NoZWR1bGVBbmFseXNpcyhjb250ZXh0KVxuICAgIH1cblxuICAgIC8vIE9wdGltaXphciBob3JhcmlvXG4gICAgaWYgKGNvbW1hbmRMb3dlci5pbmNsdWRlcygnb3B0aW1pemEnKSB8fCBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ21lam9yYScpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVTY2hlZHVsZU9wdGltaXphdGlvbihjb250ZXh0KVxuICAgIH1cblxuICAgIC8vIE1vc3RyYXIgaG9yYXJpb1xuICAgIGlmIChjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ211ZXN0cmEnKSB8fCBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ3ZlcicpICYmIGNvbW1hbmRMb3dlci5pbmNsdWRlcygnaG9yYXJpbycpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVTaG93U2NoZWR1bGUoY29udGV4dClcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGVJbmZvUmVzdWx0KFxuICAgICAgJ0dlc3Rpw7NuIGRlIEhvcmFyaW9zJyxcbiAgICAgICdObyBwdWRlIGlkZW50aWZpY2FyIGxhIGFjY2nDs24gZXNwZWPDrWZpY2EuIMK/UXVpZXJlcyBpbXBvcnRhciwgYW5hbGl6YXIsIG9wdGltaXphciBvIHZlciB0dSBob3JhcmlvPycsXG4gICAgICB7XG4gICAgICAgIGF2YWlsYWJsZUFjdGlvbnM6IFtcbiAgICAgICAgICAnSW1wb3J0YXIgaG9yYXJpbyBlc2NvbGFyJyxcbiAgICAgICAgICAnQW5hbGl6YXIgaG9yYXJpbyBhY3R1YWwnLFxuICAgICAgICAgICdPcHRpbWl6YXIgZGlzdHJpYnVjacOzbiBkZSB0aWVtcG8nLFxuICAgICAgICAgICdWZXIgaG9yYXJpbyBjb21wbGV0bydcbiAgICAgICAgXVxuICAgICAgfVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNhIGNvbWFuZG9zIGRlIHBsYW5pZmljYWNpw7NuIGRlIGVzdHVkaW9cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIHByb2Nlc3NTdHVkeVBsYW5uaW5nKFxuICAgIGNvbW1hbmQ6IHN0cmluZyxcbiAgICBhbmFseXNpczogYW55LFxuICAgIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0XG4gICk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgIFxuICAgIGNvbnN0IGNvbW1hbmRMb3dlciA9IGNvbW1hbmQudG9Mb3dlckNhc2UoKVxuXG4gICAgLy8gQ3JlYXIgcGxhbiBkZSBlc3R1ZGlvXG4gICAgaWYgKGNvbW1hbmRMb3dlci5pbmNsdWRlcygnY3JlYScpIHx8IGNvbW1hbmRMb3dlci5pbmNsdWRlcygncGxhbmlmaWNhJykgfHwgY29tbWFuZExvd2VyLmluY2x1ZGVzKCdnZW5lcmEnKSkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuaGFuZGxlQ3JlYXRlU3R1ZHlQbGFuKGNvbW1hbmQsIGFuYWx5c2lzLCBjb250ZXh0KVxuICAgIH1cblxuICAgIC8vIE1vZGlmaWNhciBwbGFuIGV4aXN0ZW50ZVxuICAgIGlmIChjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ21vZGlmaWNhJykgfHwgY29tbWFuZExvd2VyLmluY2x1ZGVzKCdhanVzdGEnKSB8fCBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ2NhbWJpYScpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVNb2RpZnlTdHVkeVBsYW4oY29tbWFuZCwgY29udGV4dClcbiAgICB9XG5cbiAgICAvLyBTdWdlcmlyIHNlc2lvbmVzXG4gICAgaWYgKGNvbW1hbmRMb3dlci5pbmNsdWRlcygnc3VnaWVyZScpIHx8IGNvbW1hbmRMb3dlci5pbmNsdWRlcygncmVjb21pZW5kYScpKSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5oYW5kbGVTdWdnZXN0U3R1ZHlTZXNzaW9ucyhjb21tYW5kLCBhbmFseXNpcywgY29udGV4dClcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGVJbmZvUmVzdWx0KFxuICAgICAgJ1BsYW5pZmljYWNpw7NuIGRlIEVzdHVkaW8nLFxuICAgICAgJ1B1ZWRvIGF5dWRhcnRlIGEgY3JlYXIgcGxhbmVzIGRlIGVzdHVkaW8gcGVyc29uYWxpemFkb3MuIMK/UXXDqSBwZXLDrW9kbyBxdWllcmVzIHBsYW5pZmljYXI/JyxcbiAgICAgIHtcbiAgICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgICAnRXN0YSBzZW1hbmEnLFxuICAgICAgICAgICdQcsOzeGltb3MgMTUgZMOtYXMnLFxuICAgICAgICAgICdIYXN0YSBlbCBwcsOzeGltbyBleGFtZW4nLFxuICAgICAgICAgICdUb2RvIGVsIG1lcydcbiAgICAgICAgXVxuICAgICAgfVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW5lamEgbGEgaW1wb3J0YWNpw7NuIGRlIGhvcmFyaW9zXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhc3luYyBoYW5kbGVTY2hlZHVsZUltcG9ydChjb21tYW5kOiBzdHJpbmcsIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogUHJvbWlzZTxDb21tYW5kUmVzdWx0PiB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEV4dHJhZXIgdGV4dG8gZGVsIGhvcmFyaW8gZGVsIGNvbWFuZG9cbiAgICAgIGNvbnN0IHNjaGVkdWxlVGV4dCA9IHRoaXMuZXh0cmFjdFNjaGVkdWxlVGV4dChjb21tYW5kKVxuICAgICAgXG4gICAgICBpZiAoIXNjaGVkdWxlVGV4dCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVJbmZvUmVzdWx0KFxuICAgICAgICAgICdJbXBvcnRhciBIb3JhcmlvJyxcbiAgICAgICAgICAnUG9yIGZhdm9yLCBwcm9wb3JjaW9uYSBsb3MgZGV0YWxsZXMgZGUgdHUgaG9yYXJpby4gRWplbXBsbzogXCJMdW5lcyA4OjAwLTk6MzAgTWF0ZW3DoXRpY2FzIEF1bGEgMTAxLCBNYXJ0ZXMgMTA6MDAtMTE6MzAgRsOtc2ljYSBMYWIgMjA1XCInLFxuICAgICAgICAgIHt9LFxuICAgICAgICAgIFsnUHJvcG9yY2lvbmFyIGhvcmFyaW8gZGV0YWxsYWRvJywgJ1ZlciBlamVtcGxvIGRlIGZvcm1hdG8nXVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIC8vIFByb2Nlc2FyIGhvcmFyaW9cbiAgICAgIGNvbnN0IHBhcnNlZENsYXNzZXMgPSBTY2hvb2xTY2hlZHVsZU1hbmFnZXIucGFyc2VOYXR1cmFsTGFuZ3VhZ2VTY2hlZHVsZShzY2hlZHVsZVRleHQpXG4gICAgICBcbiAgICAgIGlmIChwYXJzZWRDbGFzc2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcmVhdGVFcnJvclJlc3VsdCgnTm8gcHVkZSBleHRyYWVyIGNsYXNlcyBkZWwgdGV4dG8gcHJvcG9yY2lvbmFkby4gVmVyaWZpY2EgZWwgZm9ybWF0by4nKVxuICAgICAgfVxuXG4gICAgICAvLyBJbXBvcnRhciBob3JhcmlvXG4gICAgICBjb25zdCBpbXBvcnRSZXN1bHQgPSBhd2FpdCBTY2hvb2xTY2hlZHVsZU1hbmFnZXIuaW1wb3J0U2NoZWR1bGUoXG4gICAgICAgIGNvbnRleHQudXNlcklkLFxuICAgICAgICB7IGNsYXNzZXM6IHBhcnNlZENsYXNzZXMgfSxcbiAgICAgICAgJ21hbnVhbCdcbiAgICAgIClcblxuICAgICAgLy8gRGV0ZWN0YXIgY29uZmxpY3Rvc1xuICAgICAgY29uc3QgY29uZmxpY3RzID0gU2Nob29sU2NoZWR1bGVNYW5hZ2VyLmRldGVjdFNjaGVkdWxlQ29uZmxpY3RzKHBhcnNlZENsYXNzZXMpXG4gICAgICBjb25zdCBzdHVkeVNsb3RzID0gU2Nob29sU2NoZWR1bGVNYW5hZ2VyLmFuYWx5emVTdHVkeVRpbWVTbG90cyhwYXJzZWRDbGFzc2VzKVxuXG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVBY3Rpb25SZXN1bHQoXG4gICAgICAgICdIb3JhcmlvIEltcG9ydGFkbyBFeGl0b3NhbWVudGUnLFxuICAgICAgICBg4pyFIEhlIGltcG9ydGFkbyAke3BhcnNlZENsYXNzZXMubGVuZ3RofSBjbGFzZXMgYSB0dSBob3JhcmlvLlxcblxcbvCfk4ogKipBbsOhbGlzaXM6KipcXG4tICR7Y29uZmxpY3RzLmxlbmd0aH0gY29uZmxpY3RvKHMpIGRldGVjdGFkbyhzKVxcbi0gJHtzdHVkeVNsb3RzLmxlbmd0aH0gc2xvdChzKSBkZSB0aWVtcG8gbGlicmUgZW5jb250cmFkbyhzKVxcbi0gJHtNYXRoLnJvdW5kKHBhcnNlZENsYXNzZXMucmVkdWNlKChzdW0sIGNscykgPT4gc3VtICsgY2xzLmR1cmF0aW9uLCAwKSAvIDYwKX0gaG9yYXMgc2VtYW5hbGVzIGRlIGNsYXNlYCxcbiAgICAgICAge1xuICAgICAgICAgIGltcG9ydGVkQ2xhc3NlczogcGFyc2VkQ2xhc3Nlcy5sZW5ndGgsXG4gICAgICAgICAgY29uZmxpY3RzOiBjb25mbGljdHMsXG4gICAgICAgICAgc3R1ZHlTbG90czogc3R1ZHlTbG90cyxcbiAgICAgICAgICB0b3RhbEhvdXJzOiBwYXJzZWRDbGFzc2VzLnJlZHVjZSgoc3VtLCBjbHMpID0+IHN1bSArIGNscy5kdXJhdGlvbiwgMCkgLyA2MFxuICAgICAgICB9LFxuICAgICAgICBjb25mbGljdHMubGVuZ3RoID4gMCA/IFsnUmVzb2x2ZXIgY29uZmxpY3RvcycsICdWZXIgYW7DoWxpc2lzIGNvbXBsZXRvJ10gOiBbJ1BsYW5pZmljYXIgc2VzaW9uZXMgZGUgZXN0dWRpbycsICdWZXIgY2FsZW5kYXJpbyBvcHRpbWl6YWRvJ10sXG4gICAgICAgIFsnwr9RdWllcmVzIHF1ZSBwbGFuaWZpcXVlIHNlc2lvbmVzIGRlIGVzdHVkaW8gZW4gbG9zIHRpZW1wb3MgbGlicmVzPycsICfCv1RlIGF5dWRvIGEgcmVzb2x2ZXIgbG9zIGNvbmZsaWN0b3MgZGV0ZWN0YWRvcz8nXVxuICAgICAgKVxuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUVycm9yUmVzdWx0KGBFcnJvciBpbXBvcnRhbmRvIGhvcmFyaW86ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJyb3IgZGVzY29ub2NpZG8nfWApXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1hbmVqYSBlbCBhbsOhbGlzaXMgZGUgaG9yYXJpb3NcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIGhhbmRsZVNjaGVkdWxlQW5hbHlzaXMoY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICBpZiAoIWNvbnRleHQuYWNhZGVtaWNDYWxlbmRhci5zY2hvb2xTY2hlZHVsZS5sZW5ndGgpIHtcbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUluZm9SZXN1bHQoXG4gICAgICAgICdBbsOhbGlzaXMgZGUgSG9yYXJpbycsXG4gICAgICAgICdObyB0aWVuZXMgdW4gaG9yYXJpbyBlc2NvbGFyIGNvbmZpZ3VyYWRvLiBQcmltZXJvIGltcG9ydGEgdHUgaG9yYXJpbyBwYXJhIHBvZGVyIGFuYWxpemFybG8uJyxcbiAgICAgICAge30sXG4gICAgICAgIFsnSW1wb3J0YXIgaG9yYXJpbyBlc2NvbGFyJywgJ1ZlciBmb3JtYXRvIGRlIGltcG9ydGFjacOzbiddXG4gICAgICApXG4gICAgfVxuXG4gICAgLy8gQ29udmVydGlyIGEgZm9ybWF0byBTY2hvb2xDbGFzcyBwYXJhIGFuw6FsaXNpc1xuICAgIGNvbnN0IGNsYXNzZXMgPSBjb250ZXh0LmFjYWRlbWljQ2FsZW5kYXIuc2Nob29sU2NoZWR1bGUubWFwKHNjaGVkdWxlID0+ICh7XG4gICAgICBpZDogYGNsYXNzXyR7c2NoZWR1bGUuc3ViamVjdH1fJHtzY2hlZHVsZS5kYXl9YCxcbiAgICAgIHN1YmplY3Q6IHNjaGVkdWxlLnN1YmplY3QsXG4gICAgICB0ZWFjaGVyOiBzY2hlZHVsZS50ZWFjaGVyLFxuICAgICAgY2xhc3Nyb29tOiBzY2hlZHVsZS5jbGFzc3Jvb20sXG4gICAgICBkYXk6IHNjaGVkdWxlLmRheSBhcyBhbnksXG4gICAgICBzdGFydFRpbWU6IHNjaGVkdWxlLnN0YXJ0VGltZSxcbiAgICAgIGVuZFRpbWU6IHNjaGVkdWxlLmVuZFRpbWUsXG4gICAgICBkdXJhdGlvbjogdGhpcy5jYWxjdWxhdGVEdXJhdGlvbihzY2hlZHVsZS5zdGFydFRpbWUsIHNjaGVkdWxlLmVuZFRpbWUpLFxuICAgICAgdHlwZTogJ2xlY3R1cmUnIGFzIGNvbnN0LFxuICAgICAgcmVjdXJyaW5nOiB0cnVlXG4gICAgfSkpXG5cbiAgICBjb25zdCBjb25mbGljdHMgPSBTY2hvb2xTY2hlZHVsZU1hbmFnZXIuZGV0ZWN0U2NoZWR1bGVDb25mbGljdHMoY2xhc3NlcylcbiAgICBjb25zdCBzdHVkeVNsb3RzID0gU2Nob29sU2NoZWR1bGVNYW5hZ2VyLmFuYWx5emVTdHVkeVRpbWVTbG90cyhjbGFzc2VzKVxuICAgIFxuICAgIC8vIENhbGN1bGFyIGVzdGFkw61zdGljYXNcbiAgICBjb25zdCB0b3RhbEhvdXJzID0gY2xhc3Nlcy5yZWR1Y2UoKHN1bSwgY2xzKSA9PiBzdW0gKyBjbHMuZHVyYXRpb24sIDApIC8gNjBcbiAgICBjb25zdCBkYWlseURpc3RyaWJ1dGlvbiA9IHRoaXMuY2FsY3VsYXRlRGFpbHlEaXN0cmlidXRpb24oY2xhc3NlcylcbiAgICBjb25zdCBzdWJqZWN0RGlzdHJpYnV0aW9uID0gdGhpcy5jYWxjdWxhdGVTdWJqZWN0RGlzdHJpYnV0aW9uKGNsYXNzZXMpXG5cbiAgICBjb25zdCBhbmFseXNpcyA9IHtcbiAgICAgIHRvdGFsQ2xhc3NlczogY2xhc3Nlcy5sZW5ndGgsXG4gICAgICB0b3RhbEhvdXJzLFxuICAgICAgYXZlcmFnZUhvdXJzUGVyRGF5OiB0b3RhbEhvdXJzIC8gNSxcbiAgICAgIGNvbmZsaWN0czogY29uZmxpY3RzLmxlbmd0aCxcbiAgICAgIGF2YWlsYWJsZVN0dWR5U2xvdHM6IHN0dWR5U2xvdHMubGVuZ3RoLFxuICAgICAgZnJlZUhvdXJzOiBzdHVkeVNsb3RzLnJlZHVjZSgoc3VtLCBzbG90KSA9PiBzdW0gKyBzbG90LmR1cmF0aW9uLCAwKSAvIDYwLFxuICAgICAgZGFpbHlEaXN0cmlidXRpb24sXG4gICAgICBzdWJqZWN0RGlzdHJpYnV0aW9uXG4gICAgfVxuXG4gICAgbGV0IG1lc3NhZ2UgPSBg8J+TiiAqKkFuw6FsaXNpcyBkZSB0dSBIb3JhcmlvIEFjYWTDqW1pY286KipcXG5cXG5gXG4gICAgbWVzc2FnZSArPSBg8J+TmiAqKlJlc3VtZW4gR2VuZXJhbDoqKlxcbmBcbiAgICBtZXNzYWdlICs9IGDigKIgJHthbmFseXNpcy50b3RhbENsYXNzZXN9IGNsYXNlcyBzZW1hbmFsZXNcXG5gXG4gICAgbWVzc2FnZSArPSBg4oCiICR7YW5hbHlzaXMudG90YWxIb3Vycy50b0ZpeGVkKDEpfSBob3JhcyBhY2Fkw6ltaWNhcyBwb3Igc2VtYW5hXFxuYFxuICAgIG1lc3NhZ2UgKz0gYOKAoiAke2FuYWx5c2lzLmF2ZXJhZ2VIb3Vyc1BlckRheS50b0ZpeGVkKDEpfSBob3JhcyBwcm9tZWRpbyBwb3IgZMOtYVxcblxcbmBcblxuICAgIGlmIChjb25mbGljdHMubGVuZ3RoID4gMCkge1xuICAgICAgbWVzc2FnZSArPSBg4pqg77iPICoqQ29uZmxpY3RvcyBEZXRlY3RhZG9zOioqICR7Y29uZmxpY3RzLmxlbmd0aH1cXG5gXG4gICAgICBjb25mbGljdHMuc2xpY2UoMCwgMykuZm9yRWFjaChjb25mbGljdCA9PiB7XG4gICAgICAgIG1lc3NhZ2UgKz0gYOKAoiAke2NvbmZsaWN0LmRlc2NyaXB0aW9ufVxcbmBcbiAgICAgIH0pXG4gICAgICBtZXNzYWdlICs9IGBcXG5gXG4gICAgfVxuXG4gICAgbWVzc2FnZSArPSBg4o+wICoqVGllbXBvIExpYnJlIHBhcmEgRXN0dWRpbzoqKlxcbmBcbiAgICBtZXNzYWdlICs9IGDigKIgJHthbmFseXNpcy5hdmFpbGFibGVTdHVkeVNsb3RzfSBzbG90cyBkaXNwb25pYmxlc1xcbmBcbiAgICBtZXNzYWdlICs9IGDigKIgJHthbmFseXNpcy5mcmVlSG91cnMudG9GaXhlZCgxKX0gaG9yYXMgbGlicmVzIHBvciBzZW1hbmFcXG5cXG5gXG5cbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnMgPSB0aGlzLmdlbmVyYXRlU2NoZWR1bGVSZWNvbW1lbmRhdGlvbnMoYW5hbHlzaXMsIGNvbmZsaWN0cylcbiAgICBpZiAocmVjb21tZW5kYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIG1lc3NhZ2UgKz0gYPCfkqEgKipSZWNvbWVuZGFjaW9uZXM6KipcXG5gXG4gICAgICByZWNvbW1lbmRhdGlvbnMuZm9yRWFjaChyZWMgPT4gbWVzc2FnZSArPSBg4oCiICR7cmVjfVxcbmApXG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlQW5hbHlzaXNSZXN1bHQoXG4gICAgICAnQW7DoWxpc2lzIGRlIEhvcmFyaW8gQ29tcGxldG8nLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGFuYWx5c2lzLFxuICAgICAgWydQbGFuaWZpY2FyIHNlc2lvbmVzIGRlIGVzdHVkaW8nLCAnT3B0aW1pemFyIGhvcmFyaW8nLCAnUmVzb2x2ZXIgY29uZmxpY3RvcyddLFxuICAgICAgWyfCv1F1aWVyZXMgcXVlIGNyZWUgdW4gcGxhbiBkZSBlc3R1ZGlvIGJhc2FkbyBlbiB0dSB0aWVtcG8gbGlicmU/J11cbiAgICApXG4gIH1cblxuICAvKipcbiAgICogTWFuZWphIGxhIGNyZWFjacOzbiBkZSBwbGFuZXMgZGUgZXN0dWRpb1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgaGFuZGxlQ3JlYXRlU3R1ZHlQbGFuKFxuICAgIGNvbW1hbmQ6IHN0cmluZyxcbiAgICBhbmFseXNpczogYW55LFxuICAgIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0XG4gICk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgIFxuICAgIC8vIEV4dHJhZXIgcGVyw61vZG8gZGUgcGxhbmlmaWNhY2nDs24gZGVsIGNvbWFuZG9cbiAgICBjb25zdCBwZXJpb2QgPSB0aGlzLmV4dHJhY3RQbGFubmluZ1BlcmlvZChjb21tYW5kKVxuICAgIFxuICAgIC8vIEV4dHJhZXIgbWF0ZXJpYXMgZXNwZWPDrWZpY2FzIHNpIHNlIG1lbmNpb25hblxuICAgIGNvbnN0IHN1YmplY3RzID0gYW5hbHlzaXMuZW50aXRpZXMuc3ViamVjdHMgfHwgW11cbiAgICBcbiAgICB0cnkge1xuICAgICAgLy8gR2VuZXJhciBwbGFuIGRlIGVzdHVkaW9cbiAgICAgIGNvbnN0IHN0dWR5UGxhbiA9IGF3YWl0IFN0dWR5U2Vzc2lvblBsYW5uZXIuZ2VuZXJhdGVTdHVkeVBsYW4oXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIHBlcmlvZCxcbiAgICAgICAge1xuICAgICAgICAgIHByaW9yaXRpemVXZWFrU3ViamVjdHM6IHRydWUsXG4gICAgICAgICAgaW5jbHVkZVJldmlld1Nlc3Npb25zOiB0cnVlLFxuICAgICAgICAgIHJlc3BlY3RFbmVyZ3lMZXZlbHM6IHRydWVcbiAgICAgICAgfVxuICAgICAgKVxuXG4gICAgICBsZXQgbWVzc2FnZSA9IGDwn5OLICoqUGxhbiBkZSBFc3R1ZGlvIENyZWFkbzogXCIke3N0dWR5UGxhbi50aXRsZX1cIioqXFxuXFxuYFxuICAgICAgbWVzc2FnZSArPSBg8J+ThSAqKlBlcsOtb2RvOioqICR7cGVyaW9kLnN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VzLUVTJyl9IC0gJHtwZXJpb2QuZW5kRGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VzLUVTJyl9XFxuYFxuICAgICAgbWVzc2FnZSArPSBg8J+OryAqKlNlc2lvbmVzIFBsYW5pZmljYWRhczoqKiAke3N0dWR5UGxhbi50b3RhbFNlc3Npb25zfVxcbmBcbiAgICAgIG1lc3NhZ2UgKz0gYOKPse+4jyAqKkhvcmFzIFRvdGFsZXM6KiogJHtzdHVkeVBsYW4ubWV0cmljcy50b3RhbFBsYW5uZWRIb3Vycy50b0ZpeGVkKDEpfWhcXG5gXG4gICAgICBtZXNzYWdlICs9IGDwn5OaICoqTWF0ZXJpYXM6KiogJHtzdHVkeVBsYW4uc3ViamVjdHMuam9pbignLCAnKX1cXG5cXG5gXG5cbiAgICAgIC8vIE1vc3RyYXIgcHLDs3hpbWFzIHNlc2lvbmVzXG4gICAgICBjb25zdCB1cGNvbWluZ1Nlc3Npb25zID0gc3R1ZHlQbGFuLnNlc3Npb25zXG4gICAgICAgIC5maWx0ZXIoc2Vzc2lvbiA9PiBzZXNzaW9uLmRhdGUgPj0gbmV3IERhdGUoKSlcbiAgICAgICAgLnNsaWNlKDAsIDUpXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmRhdGUuZ2V0VGltZSgpIC0gYi5kYXRlLmdldFRpbWUoKSlcblxuICAgICAgaWYgKHVwY29taW5nU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBtZXNzYWdlICs9IGDwn5OdICoqUHLDs3hpbWFzIFNlc2lvbmVzOioqXFxuYFxuICAgICAgICB1cGNvbWluZ1Nlc3Npb25zLmZvckVhY2goc2Vzc2lvbiA9PiB7XG4gICAgICAgICAgbWVzc2FnZSArPSBg4oCiICR7c2Vzc2lvbi5kYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygnZXMtRVMnKX0gJHtzZXNzaW9uLnN0YXJ0VGltZX0gLSAke3Nlc3Npb24uc3ViamVjdH06ICR7c2Vzc2lvbi50b3BpY30gKCR7c2Vzc2lvbi5kdXJhdGlvbn1taW4pXFxuYFxuICAgICAgICB9KVxuICAgICAgICBtZXNzYWdlICs9IGBcXG5gXG4gICAgICB9XG5cbiAgICAgIC8vIERpc3RyaWJ1Y2nDs24gcG9yIG1hdGVyaWFcbiAgICAgIG1lc3NhZ2UgKz0gYPCfk4ogKipEaXN0cmlidWNpw7NuIHBvciBNYXRlcmlhOioqXFxuYFxuICAgICAgT2JqZWN0LmVudHJpZXMoc3R1ZHlQbGFuLm1ldHJpY3Muc3ViamVjdEJhbGFuY2UpLmZvckVhY2goKFtzdWJqZWN0LCBob3Vyc10pID0+IHtcbiAgICAgICAgbWVzc2FnZSArPSBg4oCiICR7c3ViamVjdH06ICR7KGhvdXJzIGFzIG51bWJlcikudG9GaXhlZCgxKX1oXFxuYFxuICAgICAgfSlcblxuICAgICAgcmV0dXJuIHRoaXMuY3JlYXRlUGxhbm5pbmdSZXN1bHQoXG4gICAgICAgICdQbGFuIGRlIEVzdHVkaW8gR2VuZXJhZG8nLFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICBzdHVkeVBsYW4sXG4gICAgICAgIFsnVmVyIGNhbGVuZGFyaW8gY29tcGxldG8nLCAnQWp1c3RhciBwbGFuJywgJ0NvbWVuemFyIHByaW1lcmEgc2VzacOzbiddLFxuICAgICAgICBbJ8K/UXVpZXJlcyBxdWUgYWp1c3RlIGFsZ3VuYSBzZXNpw7NuIGVzcGVjw61maWNhPycsICfCv1RlIHBhcmVjZSBiaWVuIGxhIGRpc3RyaWJ1Y2nDs24gZGUgbWF0ZXJpYXM/J11cbiAgICAgIClcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gdGhpcy5jcmVhdGVFcnJvclJlc3VsdChgRXJyb3IgY3JlYW5kbyBwbGFuIGRlIGVzdHVkaW86ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnRXJyb3IgZGVzY29ub2NpZG8nfWApXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE1hbmVqYSBsYSByZXZpc2nDs24gZGUgcHJvZ3Jlc29cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIHByb2Nlc3NQcm9ncmVzc1JldmlldyhcbiAgICBjb21tYW5kOiBzdHJpbmcsXG4gICAgYW5hbHlzaXM6IGFueSxcbiAgICBjb250ZXh0OiBTdHVkZW50Q29udGV4dFxuICApOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICBcbiAgICBjb25zdCBwcm9ncmVzc0RhdGEgPSB0aGlzLmNhbGN1bGF0ZVByb2dyZXNzTWV0cmljcyhjb250ZXh0KVxuICAgIGNvbnN0IGluc2lnaHRzID0gdGhpcy5nZW5lcmF0ZVByb2dyZXNzSW5zaWdodHMocHJvZ3Jlc3NEYXRhLCBjb250ZXh0KVxuICAgIFxuICAgIGxldCBtZXNzYWdlID0gYPCfk4ggKipSZXZpc2nDs24gZGUgdHUgUHJvZ3Jlc28gQWNhZMOpbWljbzoqKlxcblxcbmBcbiAgICBcbiAgICAvLyBQcm9ncmVzbyBnZW5lcmFsXG4gICAgbWVzc2FnZSArPSBg8J+OryAqKk9iamV0aXZvcyBBY3Rpdm9zOioqXFxuYFxuICAgIGlmIChjb250ZXh0LmN1cnJlbnRHb2Fscy5sZW5ndGggPiAwKSB7XG4gICAgICBjb250ZXh0LmN1cnJlbnRHb2Fscy5zbGljZSgwLCA1KS5mb3JFYWNoKGdvYWwgPT4ge1xuICAgICAgICBtZXNzYWdlICs9IGDigKIgJHtnb2FsLnRpdGxlfTogJHtnb2FsLnByb2dyZXNzfSUgY29tcGxldGFkb1xcbmBcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIG1lc3NhZ2UgKz0gYOKAoiBObyB0aWVuZXMgb2JqZXRpdm9zIGRlZmluaWRvcyBhY3R1YWxtZW50ZVxcbmBcbiAgICB9XG4gICAgbWVzc2FnZSArPSBgXFxuYFxuXG4gICAgLy8gUmVuZGltaWVudG8gcG9yIG1hdGVyaWFcbiAgICBpZiAoY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgIG1lc3NhZ2UgKz0gYPCfk5ogKipSZW5kaW1pZW50byBwb3IgTWF0ZXJpYToqKlxcbmBcbiAgICAgIGNvbnN0IHNvcnRlZFN1YmplY3RzID0gY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLmF2ZXJhZ2VHcmFkZSAtIGEuYXZlcmFnZUdyYWRlKVxuICAgICAgICAuc2xpY2UoMCwgNSlcbiAgICAgIFxuICAgICAgc29ydGVkU3ViamVjdHMuZm9yRWFjaChzdWJqZWN0ID0+IHtcbiAgICAgICAgY29uc3QgZW1vamkgPSBzdWJqZWN0LmF2ZXJhZ2VHcmFkZSA+PSA4NSA/ICfwn5+iJyA6IHN1YmplY3QuYXZlcmFnZUdyYWRlID49IDcwID8gJ/Cfn6EnIDogJ/CflLQnXG4gICAgICAgIG1lc3NhZ2UgKz0gYCR7ZW1vaml9ICR7c3ViamVjdC5zdWJqZWN0fTogJHtzdWJqZWN0LmF2ZXJhZ2VHcmFkZX0lIHByb21lZGlvXFxuYFxuICAgICAgfSlcbiAgICAgIG1lc3NhZ2UgKz0gYFxcbmBcbiAgICB9XG5cbiAgICAvLyBQYXRyb25lcyBkZSBlc3R1ZGlvXG4gICAgbWVzc2FnZSArPSBg4o+x77iPICoqUGF0cm9uZXMgZGUgRXN0dWRpbzoqKlxcbmBcbiAgICBtZXNzYWdlICs9IGDigKIgSG9yYXMgc2VtYW5hbGVzOiAke2NvbnRleHQuc3R1ZHlQYXR0ZXJucy53ZWVrbHlTdGF0cy50b3RhbFN0dWR5SG91cnMudG9GaXhlZCgxKX1oXFxuYFxuICAgIG1lc3NhZ2UgKz0gYOKAoiBOaXZlbCBkZSBlbmZvcXVlIHByb21lZGlvOiAke2NvbnRleHQuc3R1ZHlQYXR0ZXJucy53ZWVrbHlTdGF0cy5hdmVyYWdlRm9jdXNTY29yZX0vMTBcXG5gXG4gICAgbWVzc2FnZSArPSBg4oCiIE1vbWVudG9zIG3DoXMgcHJvZHVjdGl2b3M6ICR7Y29udGV4dC5zdHVkeVBhdHRlcm5zLnBhdHRlcm5zLm1vc3RQcm9kdWN0aXZlSG91cnMuc2xpY2UoMCwgMykuam9pbignLCAnKX1cXG5cXG5gXG5cbiAgICAvLyBJbnNpZ2h0cyB5IHJlY29tZW5kYWNpb25lc1xuICAgIGlmIChpbnNpZ2h0cy5yZWNvbW1lbmRhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgbWVzc2FnZSArPSBg8J+SoSAqKlJlY29tZW5kYWNpb25lczoqKlxcbmBcbiAgICAgIGluc2lnaHRzLnJlY29tbWVuZGF0aW9ucy5zbGljZSgwLCA0KS5mb3JFYWNoKHJlYyA9PiB7XG4gICAgICAgIG1lc3NhZ2UgKz0gYOKAoiAke3JlY31cXG5gXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNyZWF0ZUFuYWx5c2lzUmVzdWx0KFxuICAgICAgJ0Fuw6FsaXNpcyBkZSBQcm9ncmVzbycsXG4gICAgICBtZXNzYWdlLFxuICAgICAgcHJvZ3Jlc3NEYXRhLFxuICAgICAgWydFc3RhYmxlY2VyIG51ZXZvcyBvYmpldGl2b3MnLCAnQWp1c3RhciBwbGFuIGRlIGVzdHVkaW8nLCAnVmVyIGFuw6FsaXNpcyBkZXRhbGxhZG8nXSxcbiAgICAgIFsnwr9FbiBxdcOpIMOhcmVhIGVzcGVjw61maWNhIHRlIGd1c3RhcsOtYSBtZWpvcmFyPycsICfCv1F1aWVyZXMgcXVlIGFqdXN0ZSB0dSBwbGFuIGRlIGVzdHVkaW8gYWN0dWFsPyddXG4gICAgKVxuICB9XG5cbiAgLy8gRnVuY2lvbmVzIGF1eGlsaWFyZXNcblxuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0U2NoZWR1bGVUZXh0KGNvbW1hbmQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gRXh0cmFlciB0ZXh0byBkZXNwdcOpcyBkZSBwYWxhYnJhcyBjbGF2ZSBjb21vIFwiaW1wb3J0YVwiLCBcImhvcmFyaW86XCIsIGV0Yy5cbiAgICBjb25zdCBwYXR0ZXJucyA9IFtcbiAgICAgIC9ob3JhcmlvWzpcXHNdKyguKykvaSxcbiAgICAgIC9pbXBvcnRhWzpcXHNdKyguKykvaSxcbiAgICAgIC9jbGFzZXNbOlxcc10rKC4rKS9pXG4gICAgXVxuXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IGNvbW1hbmQubWF0Y2gocGF0dGVybilcbiAgICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgICByZXR1cm4gbWF0Y2hbMV0udHJpbSgpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gU2kgbm8gaGF5IHBhdHJvbmVzIGVzcGVjw61maWNvcywgYXN1bWlyIHF1ZSB0b2RvIGVsIGNvbWFuZG8gZXMgZWwgaG9yYXJpb1xuICAgIGNvbnN0IGtleXdvcmRzID0gWydpbXBvcnRhJywgJ2FncmVnYScsICdob3JhcmlvJywgJ2NsYXNlcyddXG4gICAgY29uc3QgaGFzS2V5d29yZCA9IGtleXdvcmRzLnNvbWUoa2V5d29yZCA9PiBjb21tYW5kLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa2V5d29yZCkpXG4gICAgXG4gICAgaWYgKGhhc0tleXdvcmQpIHtcbiAgICAgIC8vIFJlbW92ZXIgcGFsYWJyYXMgY2xhdmUgeSByZXRvcm5hciBlbCByZXN0b1xuICAgICAgbGV0IGNsZWFuQ29tbWFuZCA9IGNvbW1hbmRcbiAgICAgIGtleXdvcmRzLmZvckVhY2goa2V5d29yZCA9PiB7XG4gICAgICAgIGNsZWFuQ29tbWFuZCA9IGNsZWFuQ29tbWFuZC5yZXBsYWNlKG5ldyBSZWdFeHAoa2V5d29yZCwgJ2dpJyksICcnKVxuICAgICAgfSlcbiAgICAgIHJldHVybiBjbGVhbkNvbW1hbmQudHJpbSgpXG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbW1hbmRcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RQbGFubmluZ1BlcmlvZChjb21tYW5kOiBzdHJpbmcpOiB7IHN0YXJ0RGF0ZTogRGF0ZSwgZW5kRGF0ZTogRGF0ZSB9IHtcbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBjb21tYW5kTG93ZXIgPSBjb21tYW5kLnRvTG93ZXJDYXNlKClcblxuICAgIGlmIChjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ3NlbWFuYScpKSB7XG4gICAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUodG9kYXkpXG4gICAgICBlbmREYXRlLnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpICsgNylcbiAgICAgIHJldHVybiB7IHN0YXJ0RGF0ZTogdG9kYXksIGVuZERhdGUgfVxuICAgIH1cblxuICAgIGlmIChjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ21lcycpKSB7XG4gICAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUodG9kYXkpXG4gICAgICBlbmREYXRlLnNldE1vbnRoKHRvZGF5LmdldE1vbnRoKCkgKyAxKVxuICAgICAgcmV0dXJuIHsgc3RhcnREYXRlOiB0b2RheSwgZW5kRGF0ZSB9XG4gICAgfVxuXG4gICAgaWYgKGNvbW1hbmRMb3dlci5pbmNsdWRlcygnMTUnKSB8fCBjb21tYW5kTG93ZXIuaW5jbHVkZXMoJ3F1aW5jZScpKSB7XG4gICAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUodG9kYXkpXG4gICAgICBlbmREYXRlLnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpICsgMTUpXG4gICAgICByZXR1cm4geyBzdGFydERhdGU6IHRvZGF5LCBlbmREYXRlIH1cbiAgICB9XG5cbiAgICAvLyBQb3IgZGVmZWN0bzogdW5hIHNlbWFuYVxuICAgIGNvbnN0IGVuZERhdGUgPSBuZXcgRGF0ZSh0b2RheSlcbiAgICBlbmREYXRlLnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpICsgNylcbiAgICByZXR1cm4geyBzdGFydERhdGU6IHRvZGF5LCBlbmREYXRlIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNhbGN1bGF0ZUR1cmF0aW9uKHN0YXJ0VGltZTogc3RyaW5nLCBlbmRUaW1lOiBzdHJpbmcpOiBudW1iZXIge1xuICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy50aW1lVG9NaW51dGVzKHN0YXJ0VGltZSlcbiAgICBjb25zdCBlbmQgPSB0aGlzLnRpbWVUb01pbnV0ZXMoZW5kVGltZSlcbiAgICByZXR1cm4gZW5kIC0gc3RhcnRcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIHRpbWVUb01pbnV0ZXModGltZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBbaG91cnMsIG1pbnV0ZXNdID0gdGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpXG4gICAgcmV0dXJuIGhvdXJzICogNjAgKyBtaW51dGVzXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVEYWlseURpc3RyaWJ1dGlvbihjbGFzc2VzOiBhbnlbXSk6IHsgW2RheTogc3RyaW5nXTogbnVtYmVyIH0ge1xuICAgIHJldHVybiBjbGFzc2VzLnJlZHVjZSgoYWNjLCBjbHMpID0+IHtcbiAgICAgIGFjY1tjbHMuZGF5XSA9IChhY2NbY2xzLmRheV0gfHwgMCkgKyBjbHMuZHVyYXRpb24gLyA2MFxuICAgICAgcmV0dXJuIGFjY1xuICAgIH0sIHt9IGFzIHsgW2RheTogc3RyaW5nXTogbnVtYmVyIH0pXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVTdWJqZWN0RGlzdHJpYnV0aW9uKGNsYXNzZXM6IGFueVtdKTogeyBbc3ViamVjdDogc3RyaW5nXTogbnVtYmVyIH0ge1xuICAgIHJldHVybiBjbGFzc2VzLnJlZHVjZSgoYWNjLCBjbHMpID0+IHtcbiAgICAgIGFjY1tjbHMuc3ViamVjdF0gPSAoYWNjW2Nscy5zdWJqZWN0XSB8fCAwKSArIGNscy5kdXJhdGlvbiAvIDYwXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30gYXMgeyBbc3ViamVjdDogc3RyaW5nXTogbnVtYmVyIH0pXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZVNjaGVkdWxlUmVjb21tZW5kYXRpb25zKGFuYWx5c2lzOiBhbnksIGNvbmZsaWN0czogYW55W10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zOiBzdHJpbmdbXSA9IFtdXG5cbiAgICBpZiAoY29uZmxpY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdSZXNvbHZlciBjb25mbGljdG9zIGRlIGhvcmFyaW8gZGV0ZWN0YWRvcycpXG4gICAgfVxuXG4gICAgaWYgKGFuYWx5c2lzLmF2ZXJhZ2VIb3Vyc1BlckRheSA+IDcpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdDb25zaWRlcmFyIHJlZHVjaXIgbGEgY2FyZ2EgYWNhZMOpbWljYSBkaWFyaWEnKVxuICAgIH1cblxuICAgIGlmIChhbmFseXNpcy5mcmVlSG91cnMgPCAxMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0J1c2NhciBtw6FzIHRpZW1wbyBsaWJyZSBwYXJhIGVzdHVkaW8gcGVyc29uYWwnKVxuICAgIH1cblxuICAgIGlmIChhbmFseXNpcy5mcmVlSG91cnMgPiAyNSkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ0Fwcm92ZWNoYXIgZWwgdGllbXBvIGxpYnJlIGFidW5kYW50ZSBwYXJhIGFjdGl2aWRhZGVzIGV4dHJhY3VycmljdWxhcmVzJylcbiAgICB9XG5cbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVQcm9ncmVzc01ldHJpY3MoY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBhbnkge1xuICAgIGNvbnN0IHRvdGFsR29hbHMgPSBjb250ZXh0LmN1cnJlbnRHb2Fscy5sZW5ndGhcbiAgICBjb25zdCBjb21wbGV0ZWRHb2FscyA9IGNvbnRleHQuY3VycmVudEdvYWxzLmZpbHRlcihnID0+IGcucHJvZ3Jlc3MgPj0gMTAwKS5sZW5ndGhcbiAgICBjb25zdCBhdmdHb2FsUHJvZ3Jlc3MgPSB0b3RhbEdvYWxzID4gMCBcbiAgICAgID8gY29udGV4dC5jdXJyZW50R29hbHMucmVkdWNlKChzdW0sIGcpID0+IHN1bSArIGcucHJvZ3Jlc3MsIDApIC8gdG90YWxHb2FscyBcbiAgICAgIDogMFxuXG4gICAgY29uc3QgYXZnR3JhZGUgPSBjb250ZXh0LnN1YmplY3RQZXJmb3JtYW5jZXMubGVuZ3RoID4gMFxuICAgICAgPyBjb250ZXh0LnN1YmplY3RQZXJmb3JtYW5jZXMucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuYXZlcmFnZUdyYWRlLCAwKSAvIGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlcy5sZW5ndGhcbiAgICAgIDogMFxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGdvYWxDb21wbGV0aW9uUmF0ZTogY29tcGxldGVkR29hbHMgLyBNYXRoLm1heCh0b3RhbEdvYWxzLCAxKSAqIDEwMCxcbiAgICAgIGF2ZXJhZ2VHb2FsUHJvZ3Jlc3M6IGF2Z0dvYWxQcm9ncmVzcyxcbiAgICAgIGF2ZXJhZ2VHcmFkZTogYXZnR3JhZGUsXG4gICAgICB0b3RhbFN0dWR5SG91cnM6IGNvbnRleHQuc3R1ZHlQYXR0ZXJucy53ZWVrbHlTdGF0cy50b3RhbFN0dWR5SG91cnMsXG4gICAgICBmb2N1c1Njb3JlOiBjb250ZXh0LnN0dWR5UGF0dGVybnMud2Vla2x5U3RhdHMuYXZlcmFnZUZvY3VzU2NvcmVcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZVByb2dyZXNzSW5zaWdodHMocHJvZ3Jlc3NEYXRhOiBhbnksIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogeyByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdIH0ge1xuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9uczogc3RyaW5nW10gPSBbXVxuXG4gICAgaWYgKHByb2dyZXNzRGF0YS5nb2FsQ29tcGxldGlvblJhdGUgPCA1MCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goJ1JldmlzYXIgeSBhanVzdGFyIG9iamV0aXZvcyBwYXJhIHF1ZSBzZWFuIG3DoXMgYWxjYW56YWJsZXMnKVxuICAgIH1cblxuICAgIGlmIChwcm9ncmVzc0RhdGEuYXZlcmFnZUdyYWRlIDwgNzUpIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdJbmNyZW1lbnRhciB0aWVtcG8gZGUgZXN0dWRpbyBlbiBtYXRlcmlhcyBjb24gbWVub3IgcmVuZGltaWVudG8nKVxuICAgIH1cblxuICAgIGlmIChwcm9ncmVzc0RhdGEudG90YWxTdHVkeUhvdXJzIDwgMTApIHtcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdBdW1lbnRhciBncmFkdWFsbWVudGUgbGFzIGhvcmFzIGRlIGVzdHVkaW8gc2VtYW5hbGVzJylcbiAgICB9XG5cbiAgICBpZiAocHJvZ3Jlc3NEYXRhLmZvY3VzU2NvcmUgPCA2KSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaCgnSW1wbGVtZW50YXIgdMOpY25pY2FzIGRlIG1lam9yYSBkZSBjb25jZW50cmFjacOzbicpXG4gICAgfVxuXG4gICAgcmV0dXJuIHsgcmVjb21tZW5kYXRpb25zIH1cbiAgfVxuXG4gIC8vIE3DqXRvZG9zIGF1eGlsaWFyZXMgcGFyYSBjcmVhciByZXN1bHRhZG9zXG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSW5mb1Jlc3VsdChcbiAgICB0aXRsZTogc3RyaW5nLCBcbiAgICBtZXNzYWdlOiBzdHJpbmcsIFxuICAgIGRhdGE/OiBhbnksIFxuICAgIGFjdGlvbnM/OiBzdHJpbmdbXSwgXG4gICAgcXVlc3Rpb25zPzogc3RyaW5nW11cbiAgKTogQ29tbWFuZFJlc3VsdCB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICB0eXBlOiAnaW5mb3JtYXRpb24nLFxuICAgICAgdGl0bGUsXG4gICAgICBtZXNzYWdlLFxuICAgICAgZGF0YSxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGFjdGlvbnMsXG4gICAgICBmb2xsb3dVcFF1ZXN0aW9uczogcXVlc3Rpb25zXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlQWN0aW9uUmVzdWx0KFxuICAgIHRpdGxlOiBzdHJpbmcsIFxuICAgIG1lc3NhZ2U6IHN0cmluZywgXG4gICAgZGF0YT86IGFueSwgXG4gICAgYWN0aW9ucz86IHN0cmluZ1tdLCBcbiAgICBxdWVzdGlvbnM/OiBzdHJpbmdbXVxuICApOiBDb21tYW5kUmVzdWx0IHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHR5cGU6ICdhY3Rpb24nLFxuICAgICAgdGl0bGUsXG4gICAgICBtZXNzYWdlLFxuICAgICAgZGF0YSxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGFjdGlvbnMsXG4gICAgICBmb2xsb3dVcFF1ZXN0aW9uczogcXVlc3Rpb25zXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlUGxhbm5pbmdSZXN1bHQoXG4gICAgdGl0bGU6IHN0cmluZywgXG4gICAgbWVzc2FnZTogc3RyaW5nLCBcbiAgICBkYXRhPzogYW55LCBcbiAgICBhY3Rpb25zPzogc3RyaW5nW10sIFxuICAgIHF1ZXN0aW9ucz86IHN0cmluZ1tdXG4gICk6IENvbW1hbmRSZXN1bHQge1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdHlwZTogJ3BsYW5uaW5nJyxcbiAgICAgIHRpdGxlLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGRhdGEsXG4gICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBhY3Rpb25zLFxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IHF1ZXN0aW9uc1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGNyZWF0ZUFuYWx5c2lzUmVzdWx0KFxuICAgIHRpdGxlOiBzdHJpbmcsIFxuICAgIG1lc3NhZ2U6IHN0cmluZywgXG4gICAgZGF0YT86IGFueSwgXG4gICAgYWN0aW9ucz86IHN0cmluZ1tdLCBcbiAgICBxdWVzdGlvbnM/OiBzdHJpbmdbXVxuICApOiBDb21tYW5kUmVzdWx0IHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHR5cGU6ICdhbmFseXNpcycsXG4gICAgICB0aXRsZSxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBkYXRhLFxuICAgICAgc3VnZ2VzdGVkQWN0aW9uczogYWN0aW9ucyxcbiAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBxdWVzdGlvbnNcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjcmVhdGVFcnJvclJlc3VsdChtZXNzYWdlOiBzdHJpbmcpOiBDb21tYW5kUmVzdWx0IHtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICB0eXBlOiAnZXJyb3InLFxuICAgICAgdGl0bGU6ICdFcnJvcicsXG4gICAgICBtZXNzYWdlXG4gICAgfVxuICB9XG5cbiAgLy8gTcOpdG9kb3MgZGUgcHJvY2VzYW1pZW50byBhZGljaW9uYWxlcyAoaW1wbGVtZW50YWNpw7NuIGLDoXNpY2EpXG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgcHJvY2Vzc0NhbGVuZGFyTWFuYWdlbWVudChjb21tYW5kOiBzdHJpbmcsIGFuYWx5c2lzOiBhbnksIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogUHJvbWlzZTxDb21tYW5kUmVzdWx0PiB7XG4gICAgY29uc29sZS5sb2coJ/Cfk4UgUHJvY2Vzc2luZyBjYWxlbmRhciBtYW5hZ2VtZW50IGNvbW1hbmQ6JywgY29tbWFuZClcbiAgICBcbiAgICAvLyBJbnRlZ3JhciBjb24gQUlDYWxlbmRhckludGVncmF0aW9uIGV4aXN0ZW50ZVxuICAgIGNvbnN0IGNhbGVuZGFySW50ZWdyYXRpb24gPSBuZXcgQUlDYWxlbmRhckludGVncmF0aW9uKGNvbnRleHQudXNlcklkKVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhbGVuZGFySW50ZWdyYXRpb24ucHJvY2Vzc01lc3NhZ2UoY29tbWFuZCwgW10pXG4gICAgXG4gICAgY29uc29sZS5sb2coJ/Cfk4UgQ2FsZW5kYXIgaW50ZWdyYXRpb24gcmVzdWx0OicsIHsgXG4gICAgICBuZWVkc0V2ZW50Q3JlYXRpb246IHJlc3VsdC5uZWVkc0V2ZW50Q3JlYXRpb24sIFxuICAgICAgZXZlbnRDcmVhdGVkOiAhIXJlc3VsdC5ldmVudCxcbiAgICAgIHJlc3BvbnNlOiByZXN1bHQucmVzcG9uc2U/LnN1YnN0cmluZygwLCAxMDApIFxuICAgIH0pXG4gICAgXG4gICAgaWYgKHJlc3VsdC5uZWVkc0V2ZW50Q3JlYXRpb24gfHwgcmVzdWx0LmV2ZW50KSB7XG4gICAgICAvLyBTaSBzZSBjcmXDsyB1biBldmVudG8gbyBzZSBuZWNlc2l0YSBjcmVhciB1bm8sIGNvbnNpZGVyYXJsbyDDqXhpdG9cbiAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUFjdGlvblJlc3VsdChcbiAgICAgICAgJ0dlc3Rpw7NuIGRlIENhbGVuZGFyaW8nLFxuICAgICAgICByZXN1bHQucmVzcG9uc2UgfHwgJ0V2ZW50byBkZSBjYWxlbmRhcmlvIHByb2Nlc2FkbyBleGl0b3NhbWVudGUnLFxuICAgICAgICByZXN1bHQuZXZlbnQsXG4gICAgICAgIHJlc3VsdC5ldmVudCA/IFsnVmVyIGVuIGNhbGVuZGFyaW8nLCAnRWRpdGFyIGV2ZW50bycsICdFbGltaW5hciBldmVudG8nXSA6IFsnVmVyIGNhbGVuZGFyaW8nLCAnQWdyZWdhciBtw6FzIGV2ZW50b3MnXSxcbiAgICAgICAgcmVzdWx0LmV2ZW50ID8gWyfCv05lY2VzaXRhcyBtb2RpZmljYXIgYWxnw7puIGRldGFsbGUgZGVsIGV2ZW50bz8nXSA6IFsnwr9OZWNlc2l0YXMgcHJvZ3JhbWFyIGFsZ8O6biBldmVudG8gYWRpY2lvbmFsPyddXG4gICAgICApXG4gICAgfVxuICAgIFxuICAgIC8vIFNpIG5vIHNlIGRldGVjdMOzIHVuYSBhY2Npw7NuIGRlIGNhbGVuZGFyaW8sIGRldm9sdmVyIGVsIHJlc3VsdGFkbyB0YWwgY29tbyBlc3TDoVxuICAgIHJldHVybiB0aGlzLmNyZWF0ZUluZm9SZXN1bHQoXG4gICAgICAnSW5mb3JtYWNpw7NuIGRlIENhbGVuZGFyaW8nLFxuICAgICAgcmVzdWx0LnJlc3BvbnNlIHx8ICdObyBzZSBkZXRlY3TDsyB1bmEgYWNjacOzbiBlc3BlY8OtZmljYSBkZSBjYWxlbmRhcmlvJyxcbiAgICAgIHt9LFxuICAgICAgWydWZXIgcHLDs3hpbW9zIGV2ZW50b3MnLCAnQWdyZWdhciBldmVudG8nXSxcbiAgICAgIFsnwr9RdcOpIGV2ZW50byB0ZSBndXN0YXLDrWEgYWdlbmRhcj8nLCAnwr9OZWNlc2l0YXMgdmVyIHR1IGNhbGVuZGFyaW8/J11cbiAgICApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBwcm9jZXNzVGltZU9wdGltaXphdGlvbihjb21tYW5kOiBzdHJpbmcsIGFuYWx5c2lzOiBhbnksIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogUHJvbWlzZTxDb21tYW5kUmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlSW5mb1Jlc3VsdChcbiAgICAgICdPcHRpbWl6YWNpw7NuIGRlIFRpZW1wbycsXG4gICAgICAnQW5hbGl6YW5kbyB0dSBob3JhcmlvIHBhcmEgZW5jb250cmFyIGxhcyBtZWpvcmVzIG9wb3J0dW5pZGFkZXMgZGUgb3B0aW1pemFjacOzbi4uLicsXG4gICAgICB7fSxcbiAgICAgIFsnQW5hbGl6YXIgaG9yYXJpbyBhY3R1YWwnLCAnU3VnZXJpciBtZWpvcmFzJ10sXG4gICAgICBbJ8K/RW4gcXXDqSDDoXJlYSBlc3BlY8OtZmljYSBxdWllcmVzIG9wdGltaXphciB0dSB0aWVtcG8/J11cbiAgICApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBwcm9jZXNzTWF0ZXJpYWxSZXF1ZXN0KGNvbW1hbmQ6IHN0cmluZywgYW5hbHlzaXM6IGFueSwgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVJbmZvUmVzdWx0KFxuICAgICAgJ0dlc3Rpw7NuIGRlIE1hdGVyaWFsZXMnLFxuICAgICAgJ1RlIGF5dWRvIGEgb3JnYW5pemFyIHkgZW5jb250cmFyIG1hdGVyaWFsZXMgZGUgZXN0dWRpby4nLFxuICAgICAge30sXG4gICAgICBbJ0J1c2NhciByZWN1cnNvcycsICdPcmdhbml6YXIgbWF0ZXJpYWxlcyddLFxuICAgICAgWyfCv1BhcmEgcXXDqSBtYXRlcmlhIG5lY2VzaXRhcyBtYXRlcmlhbGVzPyddXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgcHJvY2Vzc1BlcmZvcm1hbmNlQW5hbHlzaXMoY29tbWFuZDogc3RyaW5nLCBhbmFseXNpczogYW55LCBjb250ZXh0OiBTdHVkZW50Q29udGV4dCk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUFuYWx5c2lzUmVzdWx0KFxuICAgICAgJ0Fuw6FsaXNpcyBkZSBSZW5kaW1pZW50bycsXG4gICAgICAnQW5hbGl6YW5kbyB0dSByZW5kaW1pZW50byBhY2Fkw6ltaWNvLi4uJyxcbiAgICAgIHt9LFxuICAgICAgWydWZXIgZGV0YWxsZXMgcG9yIG1hdGVyaWEnLCAnR2VuZXJhciByZXBvcnRlJ10sXG4gICAgICBbJ8K/UXVpZXJlcyBlbmZvY2Fybm9zIGVuIGFsZ3VuYSBtYXRlcmlhIGVzcGVjw61maWNhPyddXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgcHJvY2Vzc0dvYWxNYW5hZ2VtZW50KGNvbW1hbmQ6IHN0cmluZywgYW5hbHlzaXM6IGFueSwgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVQbGFubmluZ1Jlc3VsdChcbiAgICAgICdHZXN0acOzbiBkZSBPYmpldGl2b3MnLFxuICAgICAgJ1RlIGF5dWRvIGEgZXN0YWJsZWNlciB5IHNlZ3VpciB0dXMgb2JqZXRpdm9zIGFjYWTDqW1pY29zLicsXG4gICAgICB7fSxcbiAgICAgIFsnQ3JlYXIgbnVldm8gb2JqZXRpdm8nLCAnUmV2aXNhciBwcm9ncmVzbyddLFxuICAgICAgWyfCv1F1w6kgb2JqZXRpdm8gYWNhZMOpbWljbyBxdWllcmVzIGVzdGFibGVjZXI/J11cbiAgICApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBwcm9jZXNzUHJlZmVyZW5jZVNldHRpbmcoY29tbWFuZDogc3RyaW5nLCBhbmFseXNpczogYW55LCBjb250ZXh0OiBTdHVkZW50Q29udGV4dCk6IFByb21pc2U8Q29tbWFuZFJlc3VsdD4ge1xuICAgIHJldHVybiB0aGlzLmNyZWF0ZUluZm9SZXN1bHQoXG4gICAgICAnQ29uZmlndXJhY2nDs24gZGUgUHJlZmVyZW5jaWFzJyxcbiAgICAgICdDb25maWd1cmFuZG8gdHVzIHByZWZlcmVuY2lhcyBkZSBlc3R1ZGlvIHkgYXByZW5kaXphamUuJyxcbiAgICAgIHt9LFxuICAgICAgWydBY3R1YWxpemFyIHByZWZlcmVuY2lhcycsICdWZXIgY29uZmlndXJhY2nDs24gYWN0dWFsJ10sXG4gICAgICBbJ8K/UXXDqSBhc3BlY3RvIGRlIHR1cyBwcmVmZXJlbmNpYXMgcXVpZXJlcyBtb2RpZmljYXI/J11cbiAgICApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBwcm9jZXNzTW90aXZhdGlvbmFsU3VwcG9ydChjb21tYW5kOiBzdHJpbmcsIGFuYWx5c2lzOiBhbnksIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogUHJvbWlzZTxDb21tYW5kUmVzdWx0PiB7XG4gICAgY29uc3Qgc3VwcG9ydE1lc3NhZ2UgPSBTYXJhUGVyc29uYWxpdHlFbmdpbmUuc2VsZWN0UmVzcG9uc2UoJ21vdGl2YXRpb24nLCBjb250ZXh0KVxuICAgIFxuICAgIHJldHVybiB0aGlzLmNyZWF0ZUluZm9SZXN1bHQoXG4gICAgICAnQXBveW8gTW90aXZhY2lvbmFsJyxcbiAgICAgIHN1cHBvcnRNZXNzYWdlLFxuICAgICAge30sXG4gICAgICBbJ1BsYW5pZmljYXIgc2VzacOzbiBkZSBlc3R1ZGlvJywgJ0VzdGFibGVjZXIgb2JqZXRpdm9zIHBlcXVlw7FvcyddLFxuICAgICAgWyfCv0hheSBhbGdvIGVzcGVjw61maWNvIHF1ZSB0ZSBlc3TDoSBwcmVvY3VwYW5kbz8nLCAnwr9RdWllcmVzIHF1ZSBwbGFuaWZpcXVlbW9zIGp1bnRvcyB0dSBwcsOzeGltYSBzZXNpw7NuIGRlIGVzdHVkaW8/J11cbiAgICApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBwcm9jZXNzR2VuZXJhbFF1ZXJ5KGNvbW1hbmQ6IHN0cmluZywgYW5hbHlzaXM6IGFueSwgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVJbmZvUmVzdWx0KFxuICAgICAgJ0NvbnN1bHRhIEdlbmVyYWwnLFxuICAgICAgJ0VudGllbmRvIHR1IGNvbnN1bHRhLiDCv1BvZHLDrWFzIHNlciBtw6FzIGVzcGVjw61maWNvIHNvYnJlIGPDs21vIHB1ZWRvIGF5dWRhcnRlPycsXG4gICAgICB7fSxcbiAgICAgIFsnR2VzdGlvbmFyIGhvcmFyaW8nLCAnUGxhbmlmaWNhciBlc3R1ZGlvJywgJ0FuYWxpemFyIHByb2dyZXNvJ10sXG4gICAgICBbJ8K/TmVjZXNpdGFzIGF5dWRhIGNvbiBvcmdhbml6YWNpw7NuLCBwbGFuaWZpY2FjacOzbiBvIGFuw6FsaXNpcyBhY2Fkw6ltaWNvPyddXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgaGFuZGxlU2NoZWR1bGVPcHRpbWl6YXRpb24oY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVQbGFubmluZ1Jlc3VsdChcbiAgICAgICdPcHRpbWl6YWNpw7NuIGRlIEhvcmFyaW8nLFxuICAgICAgJ0FuYWxpemFuZG8gdHUgaG9yYXJpbyBwYXJhIHN1Z2VyaXIgb3B0aW1pemFjaW9uZXMuLi4nLFxuICAgICAge30sXG4gICAgICBbJ0FwbGljYXIgb3B0aW1pemFjaW9uZXMnLCAnVmVyIGFuw6FsaXNpcyBkZXRhbGxhZG8nXSxcbiAgICAgIFsnwr9QcmVmaWVyZXMgb3B0aW1pemFyIHBhcmEgbcOhcyB0aWVtcG8gbGlicmUgbyBtZWpvciBkaXN0cmlidWNpw7NuIGRlIG1hdGVyaWFzPyddXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgaGFuZGxlU2hvd1NjaGVkdWxlKGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogUHJvbWlzZTxDb21tYW5kUmVzdWx0PiB7XG4gICAgcmV0dXJuIHRoaXMuY3JlYXRlSW5mb1Jlc3VsdChcbiAgICAgICdUdSBIb3JhcmlvIEFjYWTDqW1pY28nLFxuICAgICAgJ01vc3RyYW5kbyB0dSBob3JhcmlvIGNvbXBsZXRvLi4uJyxcbiAgICAgIHsgc2NoZWR1bGU6IGNvbnRleHQuYWNhZGVtaWNDYWxlbmRhci5zY2hvb2xTY2hlZHVsZSB9LFxuICAgICAgWydBbmFsaXphciBob3JhcmlvJywgJ09wdGltaXphciB0aWVtcG8nXSxcbiAgICAgIFsnwr9RdWllcmVzIHF1ZSBhbmFsaWNlIHR1IGhvcmFyaW8gbyBxdWUgcGxhbmlmaXF1ZSBzZXNpb25lcyBkZSBlc3R1ZGlvPyddXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgaGFuZGxlTW9kaWZ5U3R1ZHlQbGFuKGNvbW1hbmQ6IHN0cmluZywgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVQbGFubmluZ1Jlc3VsdChcbiAgICAgICdNb2RpZmljYXIgUGxhbiBkZSBFc3R1ZGlvJyxcbiAgICAgICdUZSBheXVkbyBhIGFqdXN0YXIgdHUgcGxhbiBkZSBlc3R1ZGlvIGFjdHVhbC4nLFxuICAgICAge30sXG4gICAgICBbJ1ZlciBwbGFuIGFjdHVhbCcsICdIYWNlciBjYW1iaW9zIGVzcGVjw61maWNvcyddLFxuICAgICAgWyfCv1F1w6kgYXNwZWN0byBkZWwgcGxhbiBxdWllcmVzIG1vZGlmaWNhcj8nXVxuICAgIClcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIGhhbmRsZVN1Z2dlc3RTdHVkeVNlc3Npb25zKGNvbW1hbmQ6IHN0cmluZywgYW5hbHlzaXM6IGFueSwgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBQcm9taXNlPENvbW1hbmRSZXN1bHQ+IHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVQbGFubmluZ1Jlc3VsdChcbiAgICAgICdTdWdlcmVuY2lhcyBkZSBTZXNpb25lcycsXG4gICAgICAnQmFzw6FuZG9tZSBlbiB0dSBjb250ZXh0bywgdGUgc3VnaWVybyBlc3RhcyBzZXNpb25lcyBkZSBlc3R1ZGlvLi4uJyxcbiAgICAgIHt9LFxuICAgICAgWydQcm9ncmFtYXIgc2VzaW9uZXMnLCAnQWp1c3RhciBzdWdlcmVuY2lhcyddLFxuICAgICAgWyfCv1F1aWVyZXMgcXVlIHByb2dyYW1lIGVzdGFzIHNlc2lvbmVzIGVuIHR1IGNhbGVuZGFyaW8/J11cbiAgICApXG4gIH1cbn0iXSwibmFtZXMiOlsiU3R1ZGVudENvbnRleHRNYW5hZ2VyIiwiQWR2YW5jZWRJbnRlbnRFbmdpbmUiLCJJbnRlbnRUeXBlIiwiU2Nob29sU2NoZWR1bGVNYW5hZ2VyIiwiU3R1ZHlTZXNzaW9uUGxhbm5lciIsIlNhcmFQZXJzb25hbGl0eUVuZ2luZSIsIkFJQ2FsZW5kYXJJbnRlZ3JhdGlvbiIsIkFkdmFuY2VkQ29tbWFuZFByb2Nlc3NvciIsInByb2Nlc3NDb21tYW5kIiwiY29tbWFuZCIsImNvbnRleHQiLCJzdHVkZW50Q29udGV4dCIsImdldENvbnRleHQiLCJ1c2VySWQiLCJjcmVhdGVFcnJvclJlc3VsdCIsImludGVudEFuYWx5c2lzIiwiYW5hbHl6ZUludGVudCIsImludGVudCIsIlNDSEVEVUxFX01BTkFHRU1FTlQiLCJwcm9jZXNzU2NoZWR1bGVNYW5hZ2VtZW50IiwiU1RVRFlfUExBTk5JTkciLCJwcm9jZXNzU3R1ZHlQbGFubmluZyIsIkNBTEVOREFSX01BTkFHRU1FTlQiLCJwcm9jZXNzQ2FsZW5kYXJNYW5hZ2VtZW50IiwiVElNRV9PUFRJTUlaQVRJT04iLCJwcm9jZXNzVGltZU9wdGltaXphdGlvbiIsIk1BVEVSSUFMX1JFUVVFU1QiLCJwcm9jZXNzTWF0ZXJpYWxSZXF1ZXN0IiwiUFJPR1JFU1NfUkVWSUVXIiwicHJvY2Vzc1Byb2dyZXNzUmV2aWV3IiwiUEVSRk9STUFOQ0VfQU5BTFlTSVMiLCJwcm9jZXNzUGVyZm9ybWFuY2VBbmFseXNpcyIsIkdPQUxfTUFOQUdFTUVOVCIsInByb2Nlc3NHb2FsTWFuYWdlbWVudCIsIlBSRUZFUkVOQ0VfU0VUVElORyIsInByb2Nlc3NQcmVmZXJlbmNlU2V0dGluZyIsIk1PVElWQVRJT05BTF9TVVBQT1JUIiwicHJvY2Vzc01vdGl2YXRpb25hbFN1cHBvcnQiLCJwcm9jZXNzR2VuZXJhbFF1ZXJ5IiwiZXJyb3IiLCJjb25zb2xlIiwiRXJyb3IiLCJtZXNzYWdlIiwiYW5hbHlzaXMiLCJjb21tYW5kTG93ZXIiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiaGFuZGxlU2NoZWR1bGVJbXBvcnQiLCJoYW5kbGVTY2hlZHVsZUFuYWx5c2lzIiwiaGFuZGxlU2NoZWR1bGVPcHRpbWl6YXRpb24iLCJoYW5kbGVTaG93U2NoZWR1bGUiLCJjcmVhdGVJbmZvUmVzdWx0IiwiYXZhaWxhYmxlQWN0aW9ucyIsImhhbmRsZUNyZWF0ZVN0dWR5UGxhbiIsImhhbmRsZU1vZGlmeVN0dWR5UGxhbiIsImhhbmRsZVN1Z2dlc3RTdHVkeVNlc3Npb25zIiwic3VnZ2VzdGlvbnMiLCJzY2hlZHVsZVRleHQiLCJleHRyYWN0U2NoZWR1bGVUZXh0IiwicGFyc2VkQ2xhc3NlcyIsInBhcnNlTmF0dXJhbExhbmd1YWdlU2NoZWR1bGUiLCJsZW5ndGgiLCJpbXBvcnRSZXN1bHQiLCJpbXBvcnRTY2hlZHVsZSIsImNsYXNzZXMiLCJjb25mbGljdHMiLCJkZXRlY3RTY2hlZHVsZUNvbmZsaWN0cyIsInN0dWR5U2xvdHMiLCJhbmFseXplU3R1ZHlUaW1lU2xvdHMiLCJjcmVhdGVBY3Rpb25SZXN1bHQiLCJNYXRoIiwicm91bmQiLCJyZWR1Y2UiLCJzdW0iLCJjbHMiLCJkdXJhdGlvbiIsImltcG9ydGVkQ2xhc3NlcyIsInRvdGFsSG91cnMiLCJhY2FkZW1pY0NhbGVuZGFyIiwic2Nob29sU2NoZWR1bGUiLCJtYXAiLCJzY2hlZHVsZSIsImlkIiwic3ViamVjdCIsImRheSIsInRlYWNoZXIiLCJjbGFzc3Jvb20iLCJzdGFydFRpbWUiLCJlbmRUaW1lIiwiY2FsY3VsYXRlRHVyYXRpb24iLCJ0eXBlIiwicmVjdXJyaW5nIiwiZGFpbHlEaXN0cmlidXRpb24iLCJjYWxjdWxhdGVEYWlseURpc3RyaWJ1dGlvbiIsInN1YmplY3REaXN0cmlidXRpb24iLCJjYWxjdWxhdGVTdWJqZWN0RGlzdHJpYnV0aW9uIiwidG90YWxDbGFzc2VzIiwiYXZlcmFnZUhvdXJzUGVyRGF5IiwiYXZhaWxhYmxlU3R1ZHlTbG90cyIsImZyZWVIb3VycyIsInNsb3QiLCJ0b0ZpeGVkIiwic2xpY2UiLCJmb3JFYWNoIiwiY29uZmxpY3QiLCJkZXNjcmlwdGlvbiIsInJlY29tbWVuZGF0aW9ucyIsImdlbmVyYXRlU2NoZWR1bGVSZWNvbW1lbmRhdGlvbnMiLCJyZWMiLCJjcmVhdGVBbmFseXNpc1Jlc3VsdCIsInBlcmlvZCIsImV4dHJhY3RQbGFubmluZ1BlcmlvZCIsInN1YmplY3RzIiwiZW50aXRpZXMiLCJzdHVkeVBsYW4iLCJnZW5lcmF0ZVN0dWR5UGxhbiIsInByaW9yaXRpemVXZWFrU3ViamVjdHMiLCJpbmNsdWRlUmV2aWV3U2Vzc2lvbnMiLCJyZXNwZWN0RW5lcmd5TGV2ZWxzIiwidGl0bGUiLCJzdGFydERhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJlbmREYXRlIiwidG90YWxTZXNzaW9ucyIsIm1ldHJpY3MiLCJ0b3RhbFBsYW5uZWRIb3VycyIsImpvaW4iLCJ1cGNvbWluZ1Nlc3Npb25zIiwic2Vzc2lvbnMiLCJmaWx0ZXIiLCJzZXNzaW9uIiwiZGF0ZSIsIkRhdGUiLCJzb3J0IiwiYSIsImIiLCJnZXRUaW1lIiwidG9waWMiLCJPYmplY3QiLCJlbnRyaWVzIiwic3ViamVjdEJhbGFuY2UiLCJob3VycyIsImNyZWF0ZVBsYW5uaW5nUmVzdWx0IiwicHJvZ3Jlc3NEYXRhIiwiY2FsY3VsYXRlUHJvZ3Jlc3NNZXRyaWNzIiwiaW5zaWdodHMiLCJnZW5lcmF0ZVByb2dyZXNzSW5zaWdodHMiLCJjdXJyZW50R29hbHMiLCJnb2FsIiwicHJvZ3Jlc3MiLCJzdWJqZWN0UGVyZm9ybWFuY2VzIiwic29ydGVkU3ViamVjdHMiLCJhdmVyYWdlR3JhZGUiLCJlbW9qaSIsInN0dWR5UGF0dGVybnMiLCJ3ZWVrbHlTdGF0cyIsInRvdGFsU3R1ZHlIb3VycyIsImF2ZXJhZ2VGb2N1c1Njb3JlIiwicGF0dGVybnMiLCJtb3N0UHJvZHVjdGl2ZUhvdXJzIiwicGF0dGVybiIsIm1hdGNoIiwidHJpbSIsImtleXdvcmRzIiwiaGFzS2V5d29yZCIsInNvbWUiLCJrZXl3b3JkIiwiY2xlYW5Db21tYW5kIiwicmVwbGFjZSIsIlJlZ0V4cCIsInRvZGF5Iiwic2V0RGF0ZSIsImdldERhdGUiLCJzZXRNb250aCIsImdldE1vbnRoIiwic3RhcnQiLCJ0aW1lVG9NaW51dGVzIiwiZW5kIiwidGltZSIsIm1pbnV0ZXMiLCJzcGxpdCIsIk51bWJlciIsImFjYyIsInB1c2giLCJ0b3RhbEdvYWxzIiwiY29tcGxldGVkR29hbHMiLCJnIiwiYXZnR29hbFByb2dyZXNzIiwiYXZnR3JhZGUiLCJzIiwiZ29hbENvbXBsZXRpb25SYXRlIiwibWF4IiwiYXZlcmFnZUdvYWxQcm9ncmVzcyIsImZvY3VzU2NvcmUiLCJkYXRhIiwiYWN0aW9ucyIsInF1ZXN0aW9ucyIsInN1Y2Nlc3MiLCJzdWdnZXN0ZWRBY3Rpb25zIiwiZm9sbG93VXBRdWVzdGlvbnMiLCJsb2ciLCJjYWxlbmRhckludGVncmF0aW9uIiwicmVzdWx0IiwicHJvY2Vzc01lc3NhZ2UiLCJuZWVkc0V2ZW50Q3JlYXRpb24iLCJldmVudENyZWF0ZWQiLCJldmVudCIsInJlc3BvbnNlIiwic3Vic3RyaW5nIiwic3VwcG9ydE1lc3NhZ2UiLCJzZWxlY3RSZXNwb25zZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/advanced-command-processor.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/advanced-intent-engine.ts":
/*!*******************************************!*\
  !*** ./src/lib/advanced-intent-engine.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedIntentEngine: () => (/* binding */ AdvancedIntentEngine),\n/* harmony export */   ConversationMode: () => (/* binding */ ConversationMode),\n/* harmony export */   IntentType: () => (/* binding */ IntentType)\n/* harmony export */ });\n/* harmony import */ var _student_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./student-context */ \"(rsc)/./src/lib/student-context.ts\");\n/* harmony import */ var _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./academic-analyzer */ \"(rsc)/./src/lib/academic-analyzer.ts\");\n// Motor de Intenciones Avanzado para Asistente Personal Académico\n// Detecta y clasifica las intenciones del usuario para proporcionar respuestas más precisas\n\n\nvar IntentType = /*#__PURE__*/ function(IntentType) {\n    // Intenciones Académicas Básicas\n    IntentType[\"SOLVE_EXERCISE\"] = \"solve_exercise\";\n    IntentType[\"REQUEST_ASSESSMENT\"] = \"request_assessment\";\n    IntentType[\"ASK_QUESTION\"] = \"ask_question\";\n    IntentType[\"REQUEST_HELP\"] = \"request_help\";\n    // Intenciones de Gestión de Tiempo y Organización\n    IntentType[\"SCHEDULE_MANAGEMENT\"] = \"schedule_management\";\n    IntentType[\"STUDY_PLANNING\"] = \"study_planning\";\n    IntentType[\"CALENDAR_MANAGEMENT\"] = \"calendar_management\";\n    IntentType[\"TIME_OPTIMIZATION\"] = \"time_optimization\";\n    // Intenciones de Gestión de Materiales\n    IntentType[\"MATERIAL_REQUEST\"] = \"material_request\";\n    IntentType[\"RESOURCE_RECOMMENDATION\"] = \"resource_recommendation\";\n    IntentType[\"CONTENT_ORGANIZATION\"] = \"content_organization\";\n    // Intenciones de Seguimiento y Análisis\n    IntentType[\"PROGRESS_REVIEW\"] = \"progress_review\";\n    IntentType[\"PERFORMANCE_ANALYSIS\"] = \"performance_analysis\";\n    IntentType[\"GOAL_MANAGEMENT\"] = \"goal_management\";\n    // Intenciones de Configuración y Personalización\n    IntentType[\"PREFERENCE_SETTING\"] = \"preference_setting\";\n    IntentType[\"LEARNING_STYLE_UPDATE\"] = \"learning_style_update\";\n    IntentType[\"SCHEDULE_PREFERENCE\"] = \"schedule_preference\";\n    // Intenciones Conversacionales\n    IntentType[\"CASUAL_CHAT\"] = \"casual_chat\";\n    IntentType[\"MOTIVATIONAL_SUPPORT\"] = \"motivational_support\";\n    IntentType[\"CLARIFICATION\"] = \"clarification\";\n    // General\n    IntentType[\"GENERAL\"] = \"general\";\n    return IntentType;\n}({});\nvar ConversationMode = /*#__PURE__*/ function(ConversationMode) {\n    ConversationMode[\"PLANNING\"] = \"planning\";\n    ConversationMode[\"TUTORING\"] = \"tutoring\";\n    ConversationMode[\"ORGANIZING\"] = \"organizing\";\n    ConversationMode[\"REVIEWING\"] = \"reviewing\";\n    ConversationMode[\"CHATTING\"] = \"chatting\"; // Conversación general\n    return ConversationMode;\n}({});\nclass AdvancedIntentEngine {\n    static{\n        // Patrones para diferentes tipos de intenciones\n        this.INTENT_PATTERNS = {\n            // Gestión de Horarios y Planificación\n            [\"schedule_management\"]: [\n                /organiza?\\s*(mi|el)?\\s*horario/i,\n                /planifica?\\s*(mi|la)?\\s*semana/i,\n                /agenda?\\s*(una|la)?\\s*sesión/i,\n                /programa?\\s*(una|mi)?\\s*(clase|estudio)/i,\n                /cuando\\s*(debo|puedo)\\s*estudiar/i,\n                /horario.*estudio/i,\n                /sesion.*estudio/i\n            ],\n            [\"study_planning\"]: [\n                /plan.*estudio/i,\n                /como.*estudiar.*para/i,\n                /planifica.*sesion/i,\n                /organiza.*material/i,\n                /estrategia.*estudio/i,\n                /metodo.*estudio/i,\n                /como.*prepararme/i\n            ],\n            [\"calendar_management\"]: [\n                /agrega.*calendario/i,\n                /añade.*evento/i,\n                /programa.*examen/i,\n                /calendario.*eventos/i,\n                /proxim.*evento/i,\n                /eventos.*semana/i,\n                /agenda.*tarea/i\n            ],\n            [\"time_optimization\"]: [\n                /optimiza.*tiempo/i,\n                /mejor.*horario/i,\n                /eficien.*estudio/i,\n                /aprovechar.*tiempo/i,\n                /productiv.*sesion/i,\n                /maximiza.*rendimiento/i\n            ],\n            // Gestión de Materiales\n            [\"material_request\"]: [\n                /necesito.*material/i,\n                /donde.*encuentro/i,\n                /recomienda.*libro/i,\n                /recursos.*para/i,\n                /material.*estudio/i,\n                /libros.*sobre/i,\n                /videos.*de/i\n            ],\n            [\"resource_recommendation\"]: [\n                /recomienda/i,\n                /sugiere/i,\n                /que.*materiales/i,\n                /recursos.*utiles/i,\n                /bibliografia/i,\n                /fuentes.*informacion/i\n            ],\n            // Seguimiento y Análisis\n            [\"progress_review\"]: [\n                /como.*voy/i,\n                /mi.*progreso/i,\n                /avance.*en/i,\n                /revision.*progreso/i,\n                /que.*tal.*estoy/i,\n                /rendimiento.*en/i\n            ],\n            [\"performance_analysis\"]: [\n                /analiza.*rendimiento/i,\n                /estadisticas.*estudio/i,\n                /como.*mejoro/i,\n                /debilidades.*en/i,\n                /fortalezas.*en/i,\n                /areas.*mejorar/i\n            ],\n            [\"goal_management\"]: [\n                /objetivo.*para/i,\n                /meta.*en/i,\n                /quiero.*lograr/i,\n                /establecer.*meta/i,\n                /crear.*objetivo/i,\n                /seguimiento.*objetivo/i\n            ],\n            // Configuración y Personalización\n            [\"preference_setting\"]: [\n                /prefiero.*estudiar/i,\n                /me.*gusta.*estudiar/i,\n                /configura/i,\n                /establece.*preferencia/i,\n                /cambiar.*configuracion/i\n            ],\n            [\"learning_style_update\"]: [\n                /estilo.*aprendizaje/i,\n                /como.*aprendo/i,\n                /mejor.*manera.*aprender/i,\n                /tipo.*estudiante/i,\n                /metodo.*aprendizaje/i\n            ],\n            // Motivacional y Conversacional\n            [\"motivational_support\"]: [\n                /me.*siento.*desmotivado/i,\n                /no.*puedo.*concentrarme/i,\n                /ayuda.*motivacion/i,\n                /estoy.*cansado/i,\n                /no.*tengo.*ganas/i,\n                /animo/i,\n                /motiva/i\n            ],\n            [\"casual_chat\"]: [\n                /hola/i,\n                /buenos.*dias/i,\n                /como.*estas/i,\n                /que.*tal/i,\n                /gracias/i,\n                /de.*nada/i\n            ]\n        };\n    }\n    static{\n        // Patrones para detectar entidades\n        this.ENTITY_PATTERNS = {\n            dates: [\n                /(\\d{1,2})\\s*de\\s*(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,\n                /(lunes|martes|miercoles|jueves|viernes|sabado|domingo)/i,\n                /(hoy|mañana|pasado\\s*mañana|esta\\s*semana|proxima\\s*semana)/i,\n                /\\d{1,2}\\/\\d{1,2}/,\n                /\\d{4}-\\d{2}-\\d{2}/\n            ],\n            times: [\n                /\\d{1,2}:\\d{2}/,\n                /\\d{1,2}\\s*(am|pm)/i,\n                /(mañana|tarde|noche)/i,\n                /a\\s*las\\s*\\d{1,2}/i\n            ],\n            subjects: [\n                /(matematicas?|algebra|calculo|geometria)/i,\n                /(fisica|mecanica|termodinamica|electromagnetismo)/i,\n                /(quimica|organica|inorganica|bioquimica)/i,\n                /(biologia|anatomia|botanica|zoologia)/i,\n                /(historia|geografia|filosofia|literatura)/i,\n                /(ingles|frances|aleman|portugues)/i\n            ],\n            durations: [\n                /\\d+\\s*(minutos?|horas?|dias?|semanas?)/i,\n                /(media\\s*hora|una\\s*hora|dos\\s*horas)/i,\n                /(corto|mediano|largo)\\s*plazo/i\n            ],\n            priorities: [\n                /(urgente|importante|prioritario|critico)/i,\n                /(bajo|medio|alto)\\s*(prioridad|importancia)/i,\n                /(muy\\s*)?(importante|urgente)/i\n            ]\n        };\n    }\n    static async analyzeIntent(message, userId, context) {\n        // Obtener contexto del estudiante si no se proporciona\n        if (!context) {\n            context = await _student_context__WEBPACK_IMPORTED_MODULE_0__.StudentContextManager.getContext(userId) || await _student_context__WEBPACK_IMPORTED_MODULE_0__.StudentContextManager.createDefaultContext(userId);\n        }\n        const msgLower = message.toLowerCase();\n        let bestMatch = {\n            intent: \"general\",\n            confidence: 0\n        };\n        // Analizar patrones de intención\n        for (const [intentType, patterns] of Object.entries(this.INTENT_PATTERNS)){\n            const intent = intentType;\n            let maxConfidence = 0;\n            for (const pattern of patterns){\n                if (pattern.test(message)) {\n                    const confidence = this.calculatePatternConfidence(message, pattern);\n                    maxConfidence = Math.max(maxConfidence, confidence);\n                }\n            }\n            if (maxConfidence > bestMatch.confidence) {\n                bestMatch = {\n                    intent,\n                    confidence: maxConfidence\n                };\n            }\n        }\n        // Detectar entidades\n        const entities = this.extractEntities(message);\n        // Detectar sujeto académico\n        const subject = this.detectAcademicSubject(message);\n        // Detectar temas específicos\n        const topics = this.extractTopics(message, subject);\n        // Analizar contexto (urgencia, scope, complejidad)\n        const contextAnalysis = this.analyzeMessageContext(message, context);\n        // Determinar modo conversacional sugerido\n        const suggestedMode = this.determineSuggestedMode(bestMatch.intent, contextAnalysis);\n        // Generar acciones de seguimiento\n        const followUpActions = this.generateFollowUpActions(bestMatch.intent, entities, context);\n        return {\n            intent: bestMatch.intent,\n            confidence: bestMatch.confidence,\n            subject,\n            topics,\n            entities,\n            context: contextAnalysis,\n            suggestedMode,\n            followUpActions\n        };\n    }\n    static calculatePatternConfidence(message, pattern) {\n        const match = message.match(pattern);\n        if (!match) return 0;\n        // Base confidence por match\n        let confidence = 0.7;\n        // Bonus por longitud del match\n        const matchLength = match[0].length;\n        const messageLength = message.length;\n        const lengthRatio = matchLength / messageLength;\n        confidence += lengthRatio * 0.2;\n        // Bonus por palabras clave adicionales\n        const keywordBonus = this.countRelatedKeywords(message, pattern);\n        confidence += keywordBonus * 0.1;\n        return Math.min(confidence, 1.0);\n    }\n    static countRelatedKeywords(message, pattern) {\n        const relatedKeywords = {\n            'study': [\n                'estudiar',\n                'aprender',\n                'repasar',\n                'practicar'\n            ],\n            'time': [\n                'tiempo',\n                'horario',\n                'cuando',\n                'programar'\n            ],\n            'help': [\n                'ayuda',\n                'ayudar',\n                'explicar',\n                'entender'\n            ],\n            'schedule': [\n                'agenda',\n                'calendario',\n                'planificar',\n                'organizar'\n            ]\n        };\n        let count = 0;\n        for (const keywords of Object.values(relatedKeywords)){\n            for (const keyword of keywords){\n                if (message.toLowerCase().includes(keyword)) {\n                    count++;\n                }\n            }\n        }\n        return Math.min(count, 3) // Max 3 bonus points\n        ;\n    }\n    static extractEntities(message) {\n        const entities = {};\n        // Extraer fechas\n        entities.dates = this.extractDates(message);\n        // Extraer horas\n        entities.times = this.extractTimes(message);\n        // Extraer materias\n        entities.subjects = this.extractSubjects(message);\n        // Extraer duraciones\n        entities.durations = this.extractDurations(message);\n        // Extraer prioridades\n        entities.priorities = this.extractPriorities(message);\n        return entities;\n    }\n    static extractDates(message) {\n        const dates = [];\n        const now = new Date();\n        // Fechas relativas\n        if (/\\bhoy\\b/i.test(message)) {\n            dates.push(new Date());\n        }\n        if (/\\bmañana\\b/i.test(message)) {\n            const tomorrow = new Date();\n            tomorrow.setDate(tomorrow.getDate() + 1);\n            dates.push(tomorrow);\n        }\n        // Días de la semana\n        const daysOfWeek = [\n            'domingo',\n            'lunes',\n            'martes',\n            'miércoles',\n            'jueves',\n            'viernes',\n            'sábado'\n        ];\n        daysOfWeek.forEach((day, index)=>{\n            if (message.toLowerCase().includes(day)) {\n                const targetDate = new Date();\n                const currentDay = targetDate.getDay();\n                const daysToAdd = (index - currentDay + 7) % 7;\n                targetDate.setDate(targetDate.getDate() + daysToAdd);\n                dates.push(targetDate);\n            }\n        });\n        return dates;\n    }\n    static extractTimes(message) {\n        const times = [];\n        // Patrones de hora\n        const timePatterns = [\n            /\\b(\\d{1,2}):(\\d{2})\\b/g,\n            /\\b(\\d{1,2})\\s*(am|pm)\\b/gi,\n            /\\ba\\s*las\\s*(\\d{1,2})/gi\n        ];\n        timePatterns.forEach((pattern)=>{\n            const matches = message.match(pattern);\n            if (matches) {\n                times.push(...matches);\n            }\n        });\n        return times;\n    }\n    static extractSubjects(message) {\n        const subjects = [];\n        const subjectPatterns = this.ENTITY_PATTERNS.subjects;\n        subjectPatterns.forEach((pattern)=>{\n            const match = message.match(pattern);\n            if (match) {\n                subjects.push(match[0]);\n            }\n        });\n        return subjects;\n    }\n    static extractDurations(message) {\n        const durations = [];\n        const durationPatterns = this.ENTITY_PATTERNS.durations;\n        durationPatterns.forEach((pattern)=>{\n            const match = message.match(pattern);\n            if (match) {\n                durations.push(match[0]);\n            }\n        });\n        return durations;\n    }\n    static extractPriorities(message) {\n        const priorities = [];\n        const priorityPatterns = this.ENTITY_PATTERNS.priorities;\n        priorityPatterns.forEach((pattern)=>{\n            const match = message.match(pattern);\n            if (match) {\n                priorities.push(match[0]);\n            }\n        });\n        return priorities;\n    }\n    static detectAcademicSubject(message) {\n        const msgLower = message.toLowerCase();\n        if (/matemáticas?|álgebra|cálculo|geometría/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.MATHEMATICS;\n        }\n        if (/física|mecánica|termodinámica/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.PHYSICS;\n        }\n        if (/química|orgánica|inorgánica/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.CHEMISTRY;\n        }\n        if (/biología|anatomía|botánica/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.BIOLOGY;\n        }\n        if (/historia|geografía|filosofía/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.SOCIAL_STUDIES;\n        }\n        if (/inglés|francés|alemán|literatura/i.test(msgLower)) {\n            return _academic_analyzer__WEBPACK_IMPORTED_MODULE_1__.AcademicSubject.LANGUAGE_ARTS;\n        }\n        return undefined;\n    }\n    static extractTopics(message, subject) {\n        const topics = [];\n        // Extraer temas basados en palabras clave después de \"sobre\", \"de\", \"para\"\n        const topicPatterns = [\n            /sobre\\s+([^,.!?]+)/gi,\n            /de\\s+([^,.!?]+)/gi,\n            /para\\s+([^,.!?]+)/gi,\n            /tema\\s*:?\\s*([^,.!?]+)/gi\n        ];\n        topicPatterns.forEach((pattern)=>{\n            const matches = [\n                ...message.matchAll(pattern)\n            ];\n            matches.forEach((match)=>{\n                if (match[1] && match[1].trim().length > 3) {\n                    topics.push(match[1].trim());\n                }\n            });\n        });\n        return topics;\n    }\n    static analyzeMessageContext(message, context) {\n        const msgLower = message.toLowerCase();\n        // Analizar urgencia\n        let urgency = 'medium';\n        if (/urgente|ya|ahora|inmediato|pronto/i.test(msgLower)) {\n            urgency = 'urgent';\n        } else if (/importante|necesito|debo/i.test(msgLower)) {\n            urgency = 'high';\n        } else if (/cuando\\s*pueda|algun\\s*momento|mas\\s*tarde/i.test(msgLower)) {\n            urgency = 'low';\n        }\n        // Analizar scope temporal\n        let scope = 'short_term';\n        if (/hoy|ahora|ya|inmediato/i.test(msgLower)) {\n            scope = 'immediate';\n        } else if (/semana|mes|semestre|año/i.test(msgLower)) {\n            scope = 'long_term';\n        }\n        // Analizar complejidad\n        let complexity = 'moderate';\n        const questionWords = (msgLower.match(/\\b(qué|cómo|cuándo|dónde|por qué|para qué)\\b/g) || []).length;\n        const subjectMentions = (msgLower.match(/(matemáticas?|física|química|biología|historia)/g) || []).length;\n        if (questionWords <= 1 && subjectMentions <= 1) {\n            complexity = 'simple';\n        } else if (questionWords > 2 || subjectMentions > 2 || message.length > 200) {\n            complexity = 'complex';\n        }\n        return {\n            urgency,\n            scope,\n            complexity\n        };\n    }\n    static determineSuggestedMode(intent, context) {\n        switch(intent){\n            case \"schedule_management\":\n            case \"study_planning\":\n            case \"time_optimization\":\n                return \"planning\";\n            case \"solve_exercise\":\n            case \"request_assessment\":\n            case \"ask_question\":\n            case \"request_help\":\n                return \"tutoring\";\n            case \"calendar_management\":\n            case \"material_request\":\n            case \"content_organization\":\n                return \"organizing\";\n            case \"progress_review\":\n            case \"performance_analysis\":\n            case \"goal_management\":\n                return \"reviewing\";\n            default:\n                return \"chatting\";\n        }\n    }\n    static generateFollowUpActions(intent, entities, context) {\n        const actions = [];\n        switch(intent){\n            case \"schedule_management\":\n                actions.push('Ver calendario completo', 'Optimizar horario', 'Configurar recordatorios');\n                break;\n            case \"study_planning\":\n                actions.push('Crear plan semanal', 'Configurar sesiones', 'Ver materiales');\n                break;\n            case \"calendar_management\":\n                actions.push('Agregar evento', 'Ver próximos eventos', 'Editar calendario');\n                break;\n            case \"material_request\":\n                actions.push('Buscar recursos', 'Organizar materiales', 'Crear lista de estudio');\n                break;\n            case \"progress_review\":\n                actions.push('Ver estadísticas', 'Analizar rendimiento', 'Establecer metas');\n                break;\n            default:\n                actions.push('Continuar conversación', 'Cambiar tema', 'Ver opciones');\n        }\n        return actions;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FkdmFuY2VkLWludGVudC1lbmdpbmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQSxrRUFBa0U7QUFDbEUsNEZBQTRGO0FBRW5CO0FBQ3BCO0FBRTlDLHdDQUFLRTtJQUNWLGlDQUFpQzs7Ozs7SUFNakMsa0RBQWtEOzs7OztJQU1sRCx1Q0FBdUM7Ozs7SUFLdkMsd0NBQXdDOzs7O0lBS3hDLGlEQUFpRDs7OztJQUtqRCwrQkFBK0I7Ozs7SUFLL0IsVUFBVTs7V0FqQ0FBO01BbUNYO0FBRU0sOENBQUtDOzs7OzsrQ0FLa0IsdUJBQXVCO1dBTHpDQTtNQU1YO0FBeUJNLE1BQU1DOztRQUVYLGdEQUFnRDthQUN4QkMsa0JBQWtCO1lBQ3hDLHNDQUFzQztZQUN0Qyx1QkFBZ0MsRUFBRTtnQkFDaEM7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUVELGtCQUEyQixFQUFFO2dCQUMzQjtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTthQUNEO1lBRUQsdUJBQWdDLEVBQUU7Z0JBQ2hDO2dCQUNBO2dCQUNBO2dCQUNBO2dCQUNBO2dCQUNBO2dCQUNBO2FBQ0Q7WUFFRCxxQkFBOEIsRUFBRTtnQkFDOUI7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUVELHdCQUF3QjtZQUN4QixvQkFBNkIsRUFBRTtnQkFDN0I7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7Z0JBQ0E7YUFDRDtZQUVELDJCQUFvQyxFQUFFO2dCQUNwQztnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTthQUNEO1lBRUQseUJBQXlCO1lBQ3pCLG1CQUE0QixFQUFFO2dCQUM1QjtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTtnQkFDQTthQUNEO1lBRUQsd0JBQWlDLEVBQUU7Z0JBQ2pDO2dCQUNBO2dCQUNBO2dCQUNBO2dCQUNBO2dCQUNBO2FBQ0Q7WUFFRCxtQkFBNEIsRUFBRTtnQkFDNUI7Z0JB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WUFDQTtnQkFDRTtZQUVGO1lBQ0E7WUFDQTtnQkFDRTtZQUVGO1lBQ0E7WUFDQTtnQkFDRTtZQUVGO2dCQUNFO1FBQ0o7SUFDRjtJQUVBLE9BQWV1Qix3QkFDYnZCLE1BQWtCLEVBQ2xCWSxRQUFvQyxFQUNwQ2xCLE9BQXVCLEVBQ2I7UUFDVixNQUFNbUYsVUFBb0IsRUFBRTtRQUU1QixPQUFRN0U7WUFDTjtnQkFDRTZFLFFBQVFoQyxJQUFJLENBQUMsMkJBQTJCLHFCQUFxQjtnQkFDN0Q7WUFFRjtnQkFDRWdDLFFBQVFoQyxJQUFJLENBQUMsc0JBQXNCLHVCQUF1QjtnQkFDMUQ7WUFFRjtnQkFDRWdDLFFBQVFoQyxJQUFJLENBQUMsa0JBQWtCLHdCQUF3QjtnQkFDdkQ7WUFFRjtnQkFDRWdDLFFBQVFoQyxJQUFJLENBQUMsbUJBQW1CLHdCQUF3QjtnQkFDeEQ7WUFFRjtnQkFDRWdDLFFBQVFoQyxJQUFJLENBQUMsb0JBQW9CLHdCQUF3QjtnQkFDekQ7WUFFRjtnQkFDRWdDLFFBQVFoQyxJQUFJLENBQUMsMEJBQTBCLGdCQUFnQjtRQUMzRDtRQUVBLE9BQU9nQztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvYWR2YW5jZWQtaW50ZW50LWVuZ2luZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNb3RvciBkZSBJbnRlbmNpb25lcyBBdmFuemFkbyBwYXJhIEFzaXN0ZW50ZSBQZXJzb25hbCBBY2Fkw6ltaWNvXG4vLyBEZXRlY3RhIHkgY2xhc2lmaWNhIGxhcyBpbnRlbmNpb25lcyBkZWwgdXN1YXJpbyBwYXJhIHByb3BvcmNpb25hciByZXNwdWVzdGFzIG3DoXMgcHJlY2lzYXNcblxuaW1wb3J0IHsgU3R1ZGVudENvbnRleHQsIFN0dWRlbnRDb250ZXh0TWFuYWdlciB9IGZyb20gJy4vc3R1ZGVudC1jb250ZXh0J1xuaW1wb3J0IHsgQWNhZGVtaWNTdWJqZWN0IH0gZnJvbSAnLi9hY2FkZW1pYy1hbmFseXplcidcblxuZXhwb3J0IGVudW0gSW50ZW50VHlwZSB7XG4gIC8vIEludGVuY2lvbmVzIEFjYWTDqW1pY2FzIELDoXNpY2FzXG4gIFNPTFZFX0VYRVJDSVNFID0gJ3NvbHZlX2V4ZXJjaXNlJyxcbiAgUkVRVUVTVF9BU1NFU1NNRU5UID0gJ3JlcXVlc3RfYXNzZXNzbWVudCcsXG4gIEFTS19RVUVTVElPTiA9ICdhc2tfcXVlc3Rpb24nLFxuICBSRVFVRVNUX0hFTFAgPSAncmVxdWVzdF9oZWxwJyxcbiAgXG4gIC8vIEludGVuY2lvbmVzIGRlIEdlc3Rpw7NuIGRlIFRpZW1wbyB5IE9yZ2FuaXphY2nDs25cbiAgU0NIRURVTEVfTUFOQUdFTUVOVCA9ICdzY2hlZHVsZV9tYW5hZ2VtZW50JyxcbiAgU1RVRFlfUExBTk5JTkcgPSAnc3R1ZHlfcGxhbm5pbmcnLFxuICBDQUxFTkRBUl9NQU5BR0VNRU5UID0gJ2NhbGVuZGFyX21hbmFnZW1lbnQnLFxuICBUSU1FX09QVElNSVpBVElPTiA9ICd0aW1lX29wdGltaXphdGlvbicsXG4gIFxuICAvLyBJbnRlbmNpb25lcyBkZSBHZXN0acOzbiBkZSBNYXRlcmlhbGVzXG4gIE1BVEVSSUFMX1JFUVVFU1QgPSAnbWF0ZXJpYWxfcmVxdWVzdCcsXG4gIFJFU09VUkNFX1JFQ09NTUVOREFUSU9OID0gJ3Jlc291cmNlX3JlY29tbWVuZGF0aW9uJyxcbiAgQ09OVEVOVF9PUkdBTklaQVRJT04gPSAnY29udGVudF9vcmdhbml6YXRpb24nLFxuICBcbiAgLy8gSW50ZW5jaW9uZXMgZGUgU2VndWltaWVudG8geSBBbsOhbGlzaXNcbiAgUFJPR1JFU1NfUkVWSUVXID0gJ3Byb2dyZXNzX3JldmlldycsXG4gIFBFUkZPUk1BTkNFX0FOQUxZU0lTID0gJ3BlcmZvcm1hbmNlX2FuYWx5c2lzJyxcbiAgR09BTF9NQU5BR0VNRU5UID0gJ2dvYWxfbWFuYWdlbWVudCcsXG4gIFxuICAvLyBJbnRlbmNpb25lcyBkZSBDb25maWd1cmFjacOzbiB5IFBlcnNvbmFsaXphY2nDs25cbiAgUFJFRkVSRU5DRV9TRVRUSU5HID0gJ3ByZWZlcmVuY2Vfc2V0dGluZycsXG4gIExFQVJOSU5HX1NUWUxFX1VQREFURSA9ICdsZWFybmluZ19zdHlsZV91cGRhdGUnLFxuICBTQ0hFRFVMRV9QUkVGRVJFTkNFID0gJ3NjaGVkdWxlX3ByZWZlcmVuY2UnLFxuICBcbiAgLy8gSW50ZW5jaW9uZXMgQ29udmVyc2FjaW9uYWxlc1xuICBDQVNVQUxfQ0hBVCA9ICdjYXN1YWxfY2hhdCcsXG4gIE1PVElWQVRJT05BTF9TVVBQT1JUID0gJ21vdGl2YXRpb25hbF9zdXBwb3J0JyxcbiAgQ0xBUklGSUNBVElPTiA9ICdjbGFyaWZpY2F0aW9uJyxcbiAgXG4gIC8vIEdlbmVyYWxcbiAgR0VORVJBTCA9ICdnZW5lcmFsJ1xufVxuXG5leHBvcnQgZW51bSBDb252ZXJzYXRpb25Nb2RlIHtcbiAgUExBTk5JTkcgPSAncGxhbm5pbmcnLCAgICAgIC8vIFBsYW5pZmljYWNpw7NuIGRlIGVzdHVkaW9cbiAgVFVUT1JJTkcgPSAndHV0b3JpbmcnLCAgICAgIC8vIEF5dWRhIGFjYWTDqW1pY2FcbiAgT1JHQU5JWklORyA9ICdvcmdhbml6aW5nJywgICAvLyBPcmdhbml6YWNpw7NuIGRlIGNhbGVuZGFyaW9cbiAgUkVWSUVXSU5HID0gJ3Jldmlld2luZycsICAgICAvLyBSZXZpc2nDs24gZGUgcHJvZ3Jlc29cbiAgQ0hBVFRJTkcgPSAnY2hhdHRpbmcnICAgICAgIC8vIENvbnZlcnNhY2nDs24gZ2VuZXJhbFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEludGVudEFuYWx5c2lzIHtcbiAgaW50ZW50OiBJbnRlbnRUeXBlXG4gIGNvbmZpZGVuY2U6IG51bWJlclxuICBzdWJqZWN0PzogQWNhZGVtaWNTdWJqZWN0XG4gIHRvcGljcz86IHN0cmluZ1tdXG4gIGVudGl0aWVzOiB7XG4gICAgZGF0ZXM/OiBEYXRlW11cbiAgICB0aW1lcz86IHN0cmluZ1tdXG4gICAgc3ViamVjdHM/OiBzdHJpbmdbXVxuICAgIGR1cmF0aW9ucz86IHN0cmluZ1tdXG4gICAgcHJpb3JpdGllcz86IHN0cmluZ1tdXG4gICAgZ29hbHM/OiBzdHJpbmdbXVxuICAgIG1hdGVyaWFscz86IHN0cmluZ1tdXG4gIH1cbiAgY29udGV4dDoge1xuICAgIHVyZ2VuY3k6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAndXJnZW50J1xuICAgIHNjb3BlOiAnaW1tZWRpYXRlJyB8ICdzaG9ydF90ZXJtJyB8ICdsb25nX3Rlcm0nXG4gICAgY29tcGxleGl0eTogJ3NpbXBsZScgfCAnbW9kZXJhdGUnIHwgJ2NvbXBsZXgnXG4gIH1cbiAgc3VnZ2VzdGVkTW9kZTogQ29udmVyc2F0aW9uTW9kZVxuICBmb2xsb3dVcEFjdGlvbnM/OiBzdHJpbmdbXVxufVxuXG5leHBvcnQgY2xhc3MgQWR2YW5jZWRJbnRlbnRFbmdpbmUge1xuICBcbiAgLy8gUGF0cm9uZXMgcGFyYSBkaWZlcmVudGVzIHRpcG9zIGRlIGludGVuY2lvbmVzXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IElOVEVOVF9QQVRURVJOUyA9IHtcbiAgICAvLyBHZXN0acOzbiBkZSBIb3JhcmlvcyB5IFBsYW5pZmljYWNpw7NuXG4gICAgW0ludGVudFR5cGUuU0NIRURVTEVfTUFOQUdFTUVOVF06IFtcbiAgICAgIC9vcmdhbml6YT9cXHMqKG1pfGVsKT9cXHMqaG9yYXJpby9pLFxuICAgICAgL3BsYW5pZmljYT9cXHMqKG1pfGxhKT9cXHMqc2VtYW5hL2ksXG4gICAgICAvYWdlbmRhP1xccyoodW5hfGxhKT9cXHMqc2VzacOzbi9pLFxuICAgICAgL3Byb2dyYW1hP1xccyoodW5hfG1pKT9cXHMqKGNsYXNlfGVzdHVkaW8pL2ksXG4gICAgICAvY3VhbmRvXFxzKihkZWJvfHB1ZWRvKVxccyplc3R1ZGlhci9pLFxuICAgICAgL2hvcmFyaW8uKmVzdHVkaW8vaSxcbiAgICAgIC9zZXNpb24uKmVzdHVkaW8vaVxuICAgIF0sXG4gICAgXG4gICAgW0ludGVudFR5cGUuU1RVRFlfUExBTk5JTkddOiBbXG4gICAgICAvcGxhbi4qZXN0dWRpby9pLFxuICAgICAgL2NvbW8uKmVzdHVkaWFyLipwYXJhL2ksXG4gICAgICAvcGxhbmlmaWNhLipzZXNpb24vaSxcbiAgICAgIC9vcmdhbml6YS4qbWF0ZXJpYWwvaSxcbiAgICAgIC9lc3RyYXRlZ2lhLiplc3R1ZGlvL2ksXG4gICAgICAvbWV0b2RvLiplc3R1ZGlvL2ksXG4gICAgICAvY29tby4qcHJlcGFyYXJtZS9pXG4gICAgXSxcbiAgICBcbiAgICBbSW50ZW50VHlwZS5DQUxFTkRBUl9NQU5BR0VNRU5UXTogW1xuICAgICAgL2FncmVnYS4qY2FsZW5kYXJpby9pLFxuICAgICAgL2HDsWFkZS4qZXZlbnRvL2ksXG4gICAgICAvcHJvZ3JhbWEuKmV4YW1lbi9pLFxuICAgICAgL2NhbGVuZGFyaW8uKmV2ZW50b3MvaSxcbiAgICAgIC9wcm94aW0uKmV2ZW50by9pLFxuICAgICAgL2V2ZW50b3MuKnNlbWFuYS9pLFxuICAgICAgL2FnZW5kYS4qdGFyZWEvaVxuICAgIF0sXG4gICAgXG4gICAgW0ludGVudFR5cGUuVElNRV9PUFRJTUlaQVRJT05dOiBbXG4gICAgICAvb3B0aW1pemEuKnRpZW1wby9pLFxuICAgICAgL21lam9yLipob3JhcmlvL2ksXG4gICAgICAvZWZpY2llbi4qZXN0dWRpby9pLFxuICAgICAgL2Fwcm92ZWNoYXIuKnRpZW1wby9pLFxuICAgICAgL3Byb2R1Y3Rpdi4qc2VzaW9uL2ksXG4gICAgICAvbWF4aW1pemEuKnJlbmRpbWllbnRvL2lcbiAgICBdLFxuICAgIFxuICAgIC8vIEdlc3Rpw7NuIGRlIE1hdGVyaWFsZXNcbiAgICBbSW50ZW50VHlwZS5NQVRFUklBTF9SRVFVRVNUXTogW1xuICAgICAgL25lY2VzaXRvLiptYXRlcmlhbC9pLFxuICAgICAgL2RvbmRlLiplbmN1ZW50cm8vaSxcbiAgICAgIC9yZWNvbWllbmRhLipsaWJyby9pLFxuICAgICAgL3JlY3Vyc29zLipwYXJhL2ksXG4gICAgICAvbWF0ZXJpYWwuKmVzdHVkaW8vaSxcbiAgICAgIC9saWJyb3MuKnNvYnJlL2ksXG4gICAgICAvdmlkZW9zLipkZS9pXG4gICAgXSxcbiAgICBcbiAgICBbSW50ZW50VHlwZS5SRVNPVVJDRV9SRUNPTU1FTkRBVElPTl06IFtcbiAgICAgIC9yZWNvbWllbmRhL2ksXG4gICAgICAvc3VnaWVyZS9pLFxuICAgICAgL3F1ZS4qbWF0ZXJpYWxlcy9pLFxuICAgICAgL3JlY3Vyc29zLip1dGlsZXMvaSxcbiAgICAgIC9iaWJsaW9ncmFmaWEvaSxcbiAgICAgIC9mdWVudGVzLippbmZvcm1hY2lvbi9pXG4gICAgXSxcbiAgICBcbiAgICAvLyBTZWd1aW1pZW50byB5IEFuw6FsaXNpc1xuICAgIFtJbnRlbnRUeXBlLlBST0dSRVNTX1JFVklFV106IFtcbiAgICAgIC9jb21vLip2b3kvaSxcbiAgICAgIC9taS4qcHJvZ3Jlc28vaSxcbiAgICAgIC9hdmFuY2UuKmVuL2ksXG4gICAgICAvcmV2aXNpb24uKnByb2dyZXNvL2ksXG4gICAgICAvcXVlLip0YWwuKmVzdG95L2ksXG4gICAgICAvcmVuZGltaWVudG8uKmVuL2lcbiAgICBdLFxuICAgIFxuICAgIFtJbnRlbnRUeXBlLlBFUkZPUk1BTkNFX0FOQUxZU0lTXTogW1xuICAgICAgL2FuYWxpemEuKnJlbmRpbWllbnRvL2ksXG4gICAgICAvZXN0YWRpc3RpY2FzLiplc3R1ZGlvL2ksXG4gICAgICAvY29tby4qbWVqb3JvL2ksXG4gICAgICAvZGViaWxpZGFkZXMuKmVuL2ksXG4gICAgICAvZm9ydGFsZXphcy4qZW4vaSxcbiAgICAgIC9hcmVhcy4qbWVqb3Jhci9pXG4gICAgXSxcbiAgICBcbiAgICBbSW50ZW50VHlwZS5HT0FMX01BTkFHRU1FTlRdOiBbXG4gICAgICAvb2JqZXRpdm8uKnBhcmEvaSxcbiAgICAgIC9tZXRhLiplbi9pLFxuICAgICAgL3F1aWVyby4qbG9ncmFyL2ksXG4gICAgICAvZXN0YWJsZWNlci4qbWV0YS9pLFxuICAgICAgL2NyZWFyLipvYmpldGl2by9pLFxuICAgICAgL3NlZ3VpbWllbnRvLipvYmpldGl2by9pXG4gICAgXSxcbiAgICBcbiAgICAvLyBDb25maWd1cmFjacOzbiB5IFBlcnNvbmFsaXphY2nDs25cbiAgICBbSW50ZW50VHlwZS5QUkVGRVJFTkNFX1NFVFRJTkddOiBbXG4gICAgICAvcHJlZmllcm8uKmVzdHVkaWFyL2ksXG4gICAgICAvbWUuKmd1c3RhLiplc3R1ZGlhci9pLFxuICAgICAgL2NvbmZpZ3VyYS9pLFxuICAgICAgL2VzdGFibGVjZS4qcHJlZmVyZW5jaWEvaSxcbiAgICAgIC9jYW1iaWFyLipjb25maWd1cmFjaW9uL2lcbiAgICBdLFxuICAgIFxuICAgIFtJbnRlbnRUeXBlLkxFQVJOSU5HX1NUWUxFX1VQREFURV06IFtcbiAgICAgIC9lc3RpbG8uKmFwcmVuZGl6YWplL2ksXG4gICAgICAvY29tby4qYXByZW5kby9pLFxuICAgICAgL21lam9yLiptYW5lcmEuKmFwcmVuZGVyL2ksXG4gICAgICAvdGlwby4qZXN0dWRpYW50ZS9pLFxuICAgICAgL21ldG9kby4qYXByZW5kaXphamUvaVxuICAgIF0sXG4gICAgXG4gICAgLy8gTW90aXZhY2lvbmFsIHkgQ29udmVyc2FjaW9uYWxcbiAgICBbSW50ZW50VHlwZS5NT1RJVkFUSU9OQUxfU1VQUE9SVF06IFtcbiAgICAgIC9tZS4qc2llbnRvLipkZXNtb3RpdmFkby9pLFxuICAgICAgL25vLipwdWVkby4qY29uY2VudHJhcm1lL2ksXG4gICAgICAvYXl1ZGEuKm1vdGl2YWNpb24vaSxcbiAgICAgIC9lc3RveS4qY2Fuc2Fkby9pLFxuICAgICAgL25vLip0ZW5nby4qZ2FuYXMvaSxcbiAgICAgIC9hbmltby9pLFxuICAgICAgL21vdGl2YS9pXG4gICAgXSxcbiAgICBcbiAgICBbSW50ZW50VHlwZS5DQVNVQUxfQ0hBVF06IFtcbiAgICAgIC9ob2xhL2ksXG4gICAgICAvYnVlbm9zLipkaWFzL2ksXG4gICAgICAvY29tby4qZXN0YXMvaSxcbiAgICAgIC9xdWUuKnRhbC9pLFxuICAgICAgL2dyYWNpYXMvaSxcbiAgICAgIC9kZS4qbmFkYS9pXG4gICAgXVxuICB9XG4gIFxuICAvLyBQYXRyb25lcyBwYXJhIGRldGVjdGFyIGVudGlkYWRlc1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBFTlRJVFlfUEFUVEVSTlMgPSB7XG4gICAgZGF0ZXM6IFtcbiAgICAgIC8oXFxkezEsMn0pXFxzKmRlXFxzKihlbmVyb3xmZWJyZXJvfG1hcnpvfGFicmlsfG1heW98anVuaW98anVsaW98YWdvc3RvfHNlcHRpZW1icmV8b2N0dWJyZXxub3ZpZW1icmV8ZGljaWVtYnJlKS9pLFxuICAgICAgLyhsdW5lc3xtYXJ0ZXN8bWllcmNvbGVzfGp1ZXZlc3x2aWVybmVzfHNhYmFkb3xkb21pbmdvKS9pLFxuICAgICAgLyhob3l8bWHDsWFuYXxwYXNhZG9cXHMqbWHDsWFuYXxlc3RhXFxzKnNlbWFuYXxwcm94aW1hXFxzKnNlbWFuYSkvaSxcbiAgICAgIC9cXGR7MSwyfVxcL1xcZHsxLDJ9LyxcbiAgICAgIC9cXGR7NH0tXFxkezJ9LVxcZHsyfS9cbiAgICBdLFxuICAgIHRpbWVzOiBbXG4gICAgICAvXFxkezEsMn06XFxkezJ9LyxcbiAgICAgIC9cXGR7MSwyfVxccyooYW18cG0pL2ksXG4gICAgICAvKG1hw7FhbmF8dGFyZGV8bm9jaGUpL2ksXG4gICAgICAvYVxccypsYXNcXHMqXFxkezEsMn0vaVxuICAgIF0sXG4gICAgc3ViamVjdHM6IFtcbiAgICAgIC8obWF0ZW1hdGljYXM/fGFsZ2VicmF8Y2FsY3Vsb3xnZW9tZXRyaWEpL2ksXG4gICAgICAvKGZpc2ljYXxtZWNhbmljYXx0ZXJtb2RpbmFtaWNhfGVsZWN0cm9tYWduZXRpc21vKS9pLFxuICAgICAgLyhxdWltaWNhfG9yZ2FuaWNhfGlub3JnYW5pY2F8YmlvcXVpbWljYSkvaSxcbiAgICAgIC8oYmlvbG9naWF8YW5hdG9taWF8Ym90YW5pY2F8em9vbG9naWEpL2ksXG4gICAgICAvKGhpc3RvcmlhfGdlb2dyYWZpYXxmaWxvc29maWF8bGl0ZXJhdHVyYSkvaSxcbiAgICAgIC8oaW5nbGVzfGZyYW5jZXN8YWxlbWFufHBvcnR1Z3VlcykvaVxuICAgIF0sXG4gICAgZHVyYXRpb25zOiBbXG4gICAgICAvXFxkK1xccyoobWludXRvcz98aG9yYXM/fGRpYXM/fHNlbWFuYXM/KS9pLFxuICAgICAgLyhtZWRpYVxccypob3JhfHVuYVxccypob3JhfGRvc1xccypob3JhcykvaSxcbiAgICAgIC8oY29ydG98bWVkaWFub3xsYXJnbylcXHMqcGxhem8vaVxuICAgIF0sXG4gICAgcHJpb3JpdGllczogW1xuICAgICAgLyh1cmdlbnRlfGltcG9ydGFudGV8cHJpb3JpdGFyaW98Y3JpdGljbykvaSxcbiAgICAgIC8oYmFqb3xtZWRpb3xhbHRvKVxccyoocHJpb3JpZGFkfGltcG9ydGFuY2lhKS9pLFxuICAgICAgLyhtdXlcXHMqKT8oaW1wb3J0YW50ZXx1cmdlbnRlKS9pXG4gICAgXVxuICB9XG5cbiAgc3RhdGljIGFzeW5jIGFuYWx5emVJbnRlbnQoXG4gICAgbWVzc2FnZTogc3RyaW5nLCBcbiAgICB1c2VySWQ6IHN0cmluZywgXG4gICAgY29udGV4dD86IFN0dWRlbnRDb250ZXh0XG4gICk6IFByb21pc2U8SW50ZW50QW5hbHlzaXM+IHtcbiAgICBcbiAgICAvLyBPYnRlbmVyIGNvbnRleHRvIGRlbCBlc3R1ZGlhbnRlIHNpIG5vIHNlIHByb3BvcmNpb25hXG4gICAgaWYgKCFjb250ZXh0KSB7XG4gICAgICBjb250ZXh0ID0gYXdhaXQgU3R1ZGVudENvbnRleHRNYW5hZ2VyLmdldENvbnRleHQodXNlcklkKSB8fCBcbiAgICAgICAgICAgICAgICBhd2FpdCBTdHVkZW50Q29udGV4dE1hbmFnZXIuY3JlYXRlRGVmYXVsdENvbnRleHQodXNlcklkKVxuICAgIH1cblxuICAgIGNvbnN0IG1zZ0xvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpXG4gICAgbGV0IGJlc3RNYXRjaDogeyBpbnRlbnQ6IEludGVudFR5cGUsIGNvbmZpZGVuY2U6IG51bWJlciB9ID0geyBcbiAgICAgIGludGVudDogSW50ZW50VHlwZS5HRU5FUkFMLCBcbiAgICAgIGNvbmZpZGVuY2U6IDAgXG4gICAgfVxuXG4gICAgLy8gQW5hbGl6YXIgcGF0cm9uZXMgZGUgaW50ZW5jacOzblxuICAgIGZvciAoY29uc3QgW2ludGVudFR5cGUsIHBhdHRlcm5zXSBvZiBPYmplY3QuZW50cmllcyh0aGlzLklOVEVOVF9QQVRURVJOUykpIHtcbiAgICAgIGNvbnN0IGludGVudCA9IGludGVudFR5cGUgYXMgSW50ZW50VHlwZVxuICAgICAgbGV0IG1heENvbmZpZGVuY2UgPSAwXG5cbiAgICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBwYXR0ZXJucykge1xuICAgICAgICBpZiAocGF0dGVybi50ZXN0KG1lc3NhZ2UpKSB7XG4gICAgICAgICAgY29uc3QgY29uZmlkZW5jZSA9IHRoaXMuY2FsY3VsYXRlUGF0dGVybkNvbmZpZGVuY2UobWVzc2FnZSwgcGF0dGVybilcbiAgICAgICAgICBtYXhDb25maWRlbmNlID0gTWF0aC5tYXgobWF4Q29uZmlkZW5jZSwgY29uZmlkZW5jZSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAobWF4Q29uZmlkZW5jZSA+IGJlc3RNYXRjaC5jb25maWRlbmNlKSB7XG4gICAgICAgIGJlc3RNYXRjaCA9IHsgaW50ZW50LCBjb25maWRlbmNlOiBtYXhDb25maWRlbmNlIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZXRlY3RhciBlbnRpZGFkZXNcbiAgICBjb25zdCBlbnRpdGllcyA9IHRoaXMuZXh0cmFjdEVudGl0aWVzKG1lc3NhZ2UpXG5cbiAgICAvLyBEZXRlY3RhciBzdWpldG8gYWNhZMOpbWljb1xuICAgIGNvbnN0IHN1YmplY3QgPSB0aGlzLmRldGVjdEFjYWRlbWljU3ViamVjdChtZXNzYWdlKVxuXG4gICAgLy8gRGV0ZWN0YXIgdGVtYXMgZXNwZWPDrWZpY29zXG4gICAgY29uc3QgdG9waWNzID0gdGhpcy5leHRyYWN0VG9waWNzKG1lc3NhZ2UsIHN1YmplY3QpXG5cbiAgICAvLyBBbmFsaXphciBjb250ZXh0byAodXJnZW5jaWEsIHNjb3BlLCBjb21wbGVqaWRhZClcbiAgICBjb25zdCBjb250ZXh0QW5hbHlzaXMgPSB0aGlzLmFuYWx5emVNZXNzYWdlQ29udGV4dChtZXNzYWdlLCBjb250ZXh0KVxuXG4gICAgLy8gRGV0ZXJtaW5hciBtb2RvIGNvbnZlcnNhY2lvbmFsIHN1Z2VyaWRvXG4gICAgY29uc3Qgc3VnZ2VzdGVkTW9kZSA9IHRoaXMuZGV0ZXJtaW5lU3VnZ2VzdGVkTW9kZShiZXN0TWF0Y2guaW50ZW50LCBjb250ZXh0QW5hbHlzaXMpXG5cbiAgICAvLyBHZW5lcmFyIGFjY2lvbmVzIGRlIHNlZ3VpbWllbnRvXG4gICAgY29uc3QgZm9sbG93VXBBY3Rpb25zID0gdGhpcy5nZW5lcmF0ZUZvbGxvd1VwQWN0aW9ucyhiZXN0TWF0Y2guaW50ZW50LCBlbnRpdGllcywgY29udGV4dClcblxuICAgIHJldHVybiB7XG4gICAgICBpbnRlbnQ6IGJlc3RNYXRjaC5pbnRlbnQsXG4gICAgICBjb25maWRlbmNlOiBiZXN0TWF0Y2guY29uZmlkZW5jZSxcbiAgICAgIHN1YmplY3QsXG4gICAgICB0b3BpY3MsXG4gICAgICBlbnRpdGllcyxcbiAgICAgIGNvbnRleHQ6IGNvbnRleHRBbmFseXNpcyxcbiAgICAgIHN1Z2dlc3RlZE1vZGUsXG4gICAgICBmb2xsb3dVcEFjdGlvbnNcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVQYXR0ZXJuQ29uZmlkZW5jZShtZXNzYWdlOiBzdHJpbmcsIHBhdHRlcm46IFJlZ0V4cCk6IG51bWJlciB7XG4gICAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlLm1hdGNoKHBhdHRlcm4pXG4gICAgaWYgKCFtYXRjaCkgcmV0dXJuIDBcblxuICAgIC8vIEJhc2UgY29uZmlkZW5jZSBwb3IgbWF0Y2hcbiAgICBsZXQgY29uZmlkZW5jZSA9IDAuN1xuXG4gICAgLy8gQm9udXMgcG9yIGxvbmdpdHVkIGRlbCBtYXRjaFxuICAgIGNvbnN0IG1hdGNoTGVuZ3RoID0gbWF0Y2hbMF0ubGVuZ3RoXG4gICAgY29uc3QgbWVzc2FnZUxlbmd0aCA9IG1lc3NhZ2UubGVuZ3RoXG4gICAgY29uc3QgbGVuZ3RoUmF0aW8gPSBtYXRjaExlbmd0aCAvIG1lc3NhZ2VMZW5ndGhcbiAgICBjb25maWRlbmNlICs9IGxlbmd0aFJhdGlvICogMC4yXG5cbiAgICAvLyBCb251cyBwb3IgcGFsYWJyYXMgY2xhdmUgYWRpY2lvbmFsZXNcbiAgICBjb25zdCBrZXl3b3JkQm9udXMgPSB0aGlzLmNvdW50UmVsYXRlZEtleXdvcmRzKG1lc3NhZ2UsIHBhdHRlcm4pXG4gICAgY29uZmlkZW5jZSArPSBrZXl3b3JkQm9udXMgKiAwLjFcblxuICAgIHJldHVybiBNYXRoLm1pbihjb25maWRlbmNlLCAxLjApXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBjb3VudFJlbGF0ZWRLZXl3b3JkcyhtZXNzYWdlOiBzdHJpbmcsIHBhdHRlcm46IFJlZ0V4cCk6IG51bWJlciB7XG4gICAgY29uc3QgcmVsYXRlZEtleXdvcmRzID0ge1xuICAgICAgJ3N0dWR5JzogWydlc3R1ZGlhcicsICdhcHJlbmRlcicsICdyZXBhc2FyJywgJ3ByYWN0aWNhciddLFxuICAgICAgJ3RpbWUnOiBbJ3RpZW1wbycsICdob3JhcmlvJywgJ2N1YW5kbycsICdwcm9ncmFtYXInXSxcbiAgICAgICdoZWxwJzogWydheXVkYScsICdheXVkYXInLCAnZXhwbGljYXInLCAnZW50ZW5kZXInXSxcbiAgICAgICdzY2hlZHVsZSc6IFsnYWdlbmRhJywgJ2NhbGVuZGFyaW8nLCAncGxhbmlmaWNhcicsICdvcmdhbml6YXInXVxuICAgIH1cblxuICAgIGxldCBjb3VudCA9IDBcbiAgICBmb3IgKGNvbnN0IGtleXdvcmRzIG9mIE9iamVjdC52YWx1ZXMocmVsYXRlZEtleXdvcmRzKSkge1xuICAgICAgZm9yIChjb25zdCBrZXl3b3JkIG9mIGtleXdvcmRzKSB7XG4gICAgICAgIGlmIChtZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoa2V5d29yZCkpIHtcbiAgICAgICAgICBjb3VudCsrXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIE1hdGgubWluKGNvdW50LCAzKSAvLyBNYXggMyBib251cyBwb2ludHNcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RFbnRpdGllcyhtZXNzYWdlOiBzdHJpbmcpOiBJbnRlbnRBbmFseXNpc1snZW50aXRpZXMnXSB7XG4gICAgY29uc3QgZW50aXRpZXM6IEludGVudEFuYWx5c2lzWydlbnRpdGllcyddID0ge31cblxuICAgIC8vIEV4dHJhZXIgZmVjaGFzXG4gICAgZW50aXRpZXMuZGF0ZXMgPSB0aGlzLmV4dHJhY3REYXRlcyhtZXNzYWdlKVxuICAgIFxuICAgIC8vIEV4dHJhZXIgaG9yYXNcbiAgICBlbnRpdGllcy50aW1lcyA9IHRoaXMuZXh0cmFjdFRpbWVzKG1lc3NhZ2UpXG4gICAgXG4gICAgLy8gRXh0cmFlciBtYXRlcmlhc1xuICAgIGVudGl0aWVzLnN1YmplY3RzID0gdGhpcy5leHRyYWN0U3ViamVjdHMobWVzc2FnZSlcbiAgICBcbiAgICAvLyBFeHRyYWVyIGR1cmFjaW9uZXNcbiAgICBlbnRpdGllcy5kdXJhdGlvbnMgPSB0aGlzLmV4dHJhY3REdXJhdGlvbnMobWVzc2FnZSlcbiAgICBcbiAgICAvLyBFeHRyYWVyIHByaW9yaWRhZGVzXG4gICAgZW50aXRpZXMucHJpb3JpdGllcyA9IHRoaXMuZXh0cmFjdFByaW9yaXRpZXMobWVzc2FnZSlcblxuICAgIHJldHVybiBlbnRpdGllc1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdERhdGVzKG1lc3NhZ2U6IHN0cmluZyk6IERhdGVbXSB7XG4gICAgY29uc3QgZGF0ZXM6IERhdGVbXSA9IFtdXG4gICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuXG4gICAgLy8gRmVjaGFzIHJlbGF0aXZhc1xuICAgIGlmICgvXFxiaG95XFxiL2kudGVzdChtZXNzYWdlKSkge1xuICAgICAgZGF0ZXMucHVzaChuZXcgRGF0ZSgpKVxuICAgIH1cbiAgICBpZiAoL1xcYm1hw7FhbmFcXGIvaS50ZXN0KG1lc3NhZ2UpKSB7XG4gICAgICBjb25zdCB0b21vcnJvdyA9IG5ldyBEYXRlKClcbiAgICAgIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpICsgMSlcbiAgICAgIGRhdGVzLnB1c2godG9tb3Jyb3cpXG4gICAgfVxuXG4gICAgLy8gRMOtYXMgZGUgbGEgc2VtYW5hXG4gICAgY29uc3QgZGF5c09mV2VlayA9IFsnZG9taW5nbycsICdsdW5lcycsICdtYXJ0ZXMnLCAnbWnDqXJjb2xlcycsICdqdWV2ZXMnLCAndmllcm5lcycsICdzw6FiYWRvJ11cbiAgICBkYXlzT2ZXZWVrLmZvckVhY2goKGRheSwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChtZXNzYWdlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoZGF5KSkge1xuICAgICAgICBjb25zdCB0YXJnZXREYXRlID0gbmV3IERhdGUoKVxuICAgICAgICBjb25zdCBjdXJyZW50RGF5ID0gdGFyZ2V0RGF0ZS5nZXREYXkoKVxuICAgICAgICBjb25zdCBkYXlzVG9BZGQgPSAoaW5kZXggLSBjdXJyZW50RGF5ICsgNykgJSA3XG4gICAgICAgIHRhcmdldERhdGUuc2V0RGF0ZSh0YXJnZXREYXRlLmdldERhdGUoKSArIGRheXNUb0FkZClcbiAgICAgICAgZGF0ZXMucHVzaCh0YXJnZXREYXRlKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gZGF0ZXNcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RUaW1lcyhtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdGltZXM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBQYXRyb25lcyBkZSBob3JhXG4gICAgY29uc3QgdGltZVBhdHRlcm5zID0gW1xuICAgICAgL1xcYihcXGR7MSwyfSk6KFxcZHsyfSlcXGIvZyxcbiAgICAgIC9cXGIoXFxkezEsMn0pXFxzKihhbXxwbSlcXGIvZ2ksXG4gICAgICAvXFxiYVxccypsYXNcXHMqKFxcZHsxLDJ9KS9naVxuICAgIF1cblxuICAgIHRpbWVQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgY29uc3QgbWF0Y2hlcyA9IG1lc3NhZ2UubWF0Y2gocGF0dGVybilcbiAgICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgIHRpbWVzLnB1c2goLi4ubWF0Y2hlcylcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHRpbWVzXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0U3ViamVjdHMobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1YmplY3RzOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3Qgc3ViamVjdFBhdHRlcm5zID0gdGhpcy5FTlRJVFlfUEFUVEVSTlMuc3ViamVjdHNcbiAgICBcbiAgICBzdWJqZWN0UGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoID0gbWVzc2FnZS5tYXRjaChwYXR0ZXJuKVxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIHN1YmplY3RzLnB1c2gobWF0Y2hbMF0pXG4gICAgICB9XG4gICAgfSlcblxuICAgIHJldHVybiBzdWJqZWN0c1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdER1cmF0aW9ucyhtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgZHVyYXRpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3QgZHVyYXRpb25QYXR0ZXJucyA9IHRoaXMuRU5USVRZX1BBVFRFUk5TLmR1cmF0aW9uc1xuICAgIFxuICAgIGR1cmF0aW9uUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoID0gbWVzc2FnZS5tYXRjaChwYXR0ZXJuKVxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIGR1cmF0aW9ucy5wdXNoKG1hdGNoWzBdKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gZHVyYXRpb25zXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0UHJpb3JpdGllcyhtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgcHJpb3JpdGllczogc3RyaW5nW10gPSBbXVxuICAgIGNvbnN0IHByaW9yaXR5UGF0dGVybnMgPSB0aGlzLkVOVElUWV9QQVRURVJOUy5wcmlvcml0aWVzXG4gICAgXG4gICAgcHJpb3JpdHlQYXR0ZXJucy5mb3JFYWNoKHBhdHRlcm4gPT4ge1xuICAgICAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlLm1hdGNoKHBhdHRlcm4pXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgcHJpb3JpdGllcy5wdXNoKG1hdGNoWzBdKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICByZXR1cm4gcHJpb3JpdGllc1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZGV0ZWN0QWNhZGVtaWNTdWJqZWN0KG1lc3NhZ2U6IHN0cmluZyk6IEFjYWRlbWljU3ViamVjdCB8IHVuZGVmaW5lZCB7XG4gICAgY29uc3QgbXNnTG93ZXIgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgICBcbiAgICBpZiAoL21hdGVtw6F0aWNhcz98w6FsZ2VicmF8Y8OhbGN1bG98Z2VvbWV0csOtYS9pLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICByZXR1cm4gQWNhZGVtaWNTdWJqZWN0Lk1BVEhFTUFUSUNTXG4gICAgfVxuICAgIGlmICgvZsOtc2ljYXxtZWPDoW5pY2F8dGVybW9kaW7DoW1pY2EvaS50ZXN0KG1zZ0xvd2VyKSkge1xuICAgICAgcmV0dXJuIEFjYWRlbWljU3ViamVjdC5QSFlTSUNTXG4gICAgfVxuICAgIGlmICgvcXXDrW1pY2F8b3Jnw6FuaWNhfGlub3Jnw6FuaWNhL2kudGVzdChtc2dMb3dlcikpIHtcbiAgICAgIHJldHVybiBBY2FkZW1pY1N1YmplY3QuQ0hFTUlTVFJZXG4gICAgfVxuICAgIGlmICgvYmlvbG9nw61hfGFuYXRvbcOtYXxib3TDoW5pY2EvaS50ZXN0KG1zZ0xvd2VyKSkge1xuICAgICAgcmV0dXJuIEFjYWRlbWljU3ViamVjdC5CSU9MT0dZXG4gICAgfVxuICAgIGlmICgvaGlzdG9yaWF8Z2VvZ3JhZsOtYXxmaWxvc29mw61hL2kudGVzdChtc2dMb3dlcikpIHtcbiAgICAgIHJldHVybiBBY2FkZW1pY1N1YmplY3QuU09DSUFMX1NUVURJRVNcbiAgICB9XG4gICAgaWYgKC9pbmdsw6lzfGZyYW5jw6lzfGFsZW3DoW58bGl0ZXJhdHVyYS9pLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICByZXR1cm4gQWNhZGVtaWNTdWJqZWN0LkxBTkdVQUdFX0FSVFNcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0VG9waWNzKG1lc3NhZ2U6IHN0cmluZywgc3ViamVjdD86IEFjYWRlbWljU3ViamVjdCk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0b3BpY3M6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBFeHRyYWVyIHRlbWFzIGJhc2Fkb3MgZW4gcGFsYWJyYXMgY2xhdmUgZGVzcHXDqXMgZGUgXCJzb2JyZVwiLCBcImRlXCIsIFwicGFyYVwiXG4gICAgY29uc3QgdG9waWNQYXR0ZXJucyA9IFtcbiAgICAgIC9zb2JyZVxccysoW14sLiE/XSspL2dpLFxuICAgICAgL2RlXFxzKyhbXiwuIT9dKykvZ2ksXG4gICAgICAvcGFyYVxccysoW14sLiE/XSspL2dpLFxuICAgICAgL3RlbWFcXHMqOj9cXHMqKFteLC4hP10rKS9naVxuICAgIF1cblxuICAgIHRvcGljUGF0dGVybnMuZm9yRWFjaChwYXR0ZXJuID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4ubWVzc2FnZS5tYXRjaEFsbChwYXR0ZXJuKV1cbiAgICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgIGlmIChtYXRjaFsxXSAmJiBtYXRjaFsxXS50cmltKCkubGVuZ3RoID4gMykge1xuICAgICAgICAgIHRvcGljcy5wdXNoKG1hdGNoWzFdLnRyaW0oKSlcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgcmV0dXJuIHRvcGljc1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZU1lc3NhZ2VDb250ZXh0KG1lc3NhZ2U6IHN0cmluZywgY29udGV4dDogU3R1ZGVudENvbnRleHQpOiB7XG4gICAgdXJnZW5jeTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJyB8ICd1cmdlbnQnXG4gICAgc2NvcGU6ICdpbW1lZGlhdGUnIHwgJ3Nob3J0X3Rlcm0nIHwgJ2xvbmdfdGVybSdcbiAgICBjb21wbGV4aXR5OiAnc2ltcGxlJyB8ICdtb2RlcmF0ZScgfCAnY29tcGxleCdcbiAgfSB7XG4gICAgY29uc3QgbXNnTG93ZXIgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgICBcbiAgICAvLyBBbmFsaXphciB1cmdlbmNpYVxuICAgIGxldCB1cmdlbmN5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ3VyZ2VudCcgPSAnbWVkaXVtJ1xuICAgIGlmICgvdXJnZW50ZXx5YXxhaG9yYXxpbm1lZGlhdG98cHJvbnRvL2kudGVzdChtc2dMb3dlcikpIHtcbiAgICAgIHVyZ2VuY3kgPSAndXJnZW50J1xuICAgIH0gZWxzZSBpZiAoL2ltcG9ydGFudGV8bmVjZXNpdG98ZGViby9pLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICB1cmdlbmN5ID0gJ2hpZ2gnXG4gICAgfSBlbHNlIGlmICgvY3VhbmRvXFxzKnB1ZWRhfGFsZ3VuXFxzKm1vbWVudG98bWFzXFxzKnRhcmRlL2kudGVzdChtc2dMb3dlcikpIHtcbiAgICAgIHVyZ2VuY3kgPSAnbG93J1xuICAgIH1cblxuICAgIC8vIEFuYWxpemFyIHNjb3BlIHRlbXBvcmFsXG4gICAgbGV0IHNjb3BlOiAnaW1tZWRpYXRlJyB8ICdzaG9ydF90ZXJtJyB8ICdsb25nX3Rlcm0nID0gJ3Nob3J0X3Rlcm0nXG4gICAgaWYgKC9ob3l8YWhvcmF8eWF8aW5tZWRpYXRvL2kudGVzdChtc2dMb3dlcikpIHtcbiAgICAgIHNjb3BlID0gJ2ltbWVkaWF0ZSdcbiAgICB9IGVsc2UgaWYgKC9zZW1hbmF8bWVzfHNlbWVzdHJlfGHDsW8vaS50ZXN0KG1zZ0xvd2VyKSkge1xuICAgICAgc2NvcGUgPSAnbG9uZ190ZXJtJ1xuICAgIH1cblxuICAgIC8vIEFuYWxpemFyIGNvbXBsZWppZGFkXG4gICAgbGV0IGNvbXBsZXhpdHk6ICdzaW1wbGUnIHwgJ21vZGVyYXRlJyB8ICdjb21wbGV4JyA9ICdtb2RlcmF0ZSdcbiAgICBjb25zdCBxdWVzdGlvbldvcmRzID0gKG1zZ0xvd2VyLm1hdGNoKC9cXGIocXXDqXxjw7Ntb3xjdcOhbmRvfGTDs25kZXxwb3IgcXXDqXxwYXJhIHF1w6kpXFxiL2cpIHx8IFtdKS5sZW5ndGhcbiAgICBjb25zdCBzdWJqZWN0TWVudGlvbnMgPSAobXNnTG93ZXIubWF0Y2goLyhtYXRlbcOhdGljYXM/fGbDrXNpY2F8cXXDrW1pY2F8YmlvbG9nw61hfGhpc3RvcmlhKS9nKSB8fCBbXSkubGVuZ3RoXG4gICAgXG4gICAgaWYgKHF1ZXN0aW9uV29yZHMgPD0gMSAmJiBzdWJqZWN0TWVudGlvbnMgPD0gMSkge1xuICAgICAgY29tcGxleGl0eSA9ICdzaW1wbGUnXG4gICAgfSBlbHNlIGlmIChxdWVzdGlvbldvcmRzID4gMiB8fCBzdWJqZWN0TWVudGlvbnMgPiAyIHx8IG1lc3NhZ2UubGVuZ3RoID4gMjAwKSB7XG4gICAgICBjb21wbGV4aXR5ID0gJ2NvbXBsZXgnXG4gICAgfVxuXG4gICAgcmV0dXJuIHsgdXJnZW5jeSwgc2NvcGUsIGNvbXBsZXhpdHkgfVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZGV0ZXJtaW5lU3VnZ2VzdGVkTW9kZShpbnRlbnQ6IEludGVudFR5cGUsIGNvbnRleHQ6IGFueSk6IENvbnZlcnNhdGlvbk1vZGUge1xuICAgIHN3aXRjaCAoaW50ZW50KSB7XG4gICAgICBjYXNlIEludGVudFR5cGUuU0NIRURVTEVfTUFOQUdFTUVOVDpcbiAgICAgIGNhc2UgSW50ZW50VHlwZS5TVFVEWV9QTEFOTklORzpcbiAgICAgIGNhc2UgSW50ZW50VHlwZS5USU1FX09QVElNSVpBVElPTjpcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkdcblxuICAgICAgY2FzZSBJbnRlbnRUeXBlLlNPTFZFX0VYRVJDSVNFOlxuICAgICAgY2FzZSBJbnRlbnRUeXBlLlJFUVVFU1RfQVNTRVNTTUVOVDpcbiAgICAgIGNhc2UgSW50ZW50VHlwZS5BU0tfUVVFU1RJT046XG4gICAgICBjYXNlIEludGVudFR5cGUuUkVRVUVTVF9IRUxQOlxuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uTW9kZS5UVVRPUklOR1xuXG4gICAgICBjYXNlIEludGVudFR5cGUuQ0FMRU5EQVJfTUFOQUdFTUVOVDpcbiAgICAgIGNhc2UgSW50ZW50VHlwZS5NQVRFUklBTF9SRVFVRVNUOlxuICAgICAgY2FzZSBJbnRlbnRUeXBlLkNPTlRFTlRfT1JHQU5JWkFUSU9OOlxuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXG5cbiAgICAgIGNhc2UgSW50ZW50VHlwZS5QUk9HUkVTU19SRVZJRVc6XG4gICAgICBjYXNlIEludGVudFR5cGUuUEVSRk9STUFOQ0VfQU5BTFlTSVM6XG4gICAgICBjYXNlIEludGVudFR5cGUuR09BTF9NQU5BR0VNRU5UOlxuICAgICAgICByZXR1cm4gQ29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkdcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIENvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkdcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZUZvbGxvd1VwQWN0aW9ucyhcbiAgICBpbnRlbnQ6IEludGVudFR5cGUsIFxuICAgIGVudGl0aWVzOiBJbnRlbnRBbmFseXNpc1snZW50aXRpZXMnXSwgXG4gICAgY29udGV4dDogU3R1ZGVudENvbnRleHRcbiAgKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGFjdGlvbnM6IHN0cmluZ1tdID0gW11cblxuICAgIHN3aXRjaCAoaW50ZW50KSB7XG4gICAgICBjYXNlIEludGVudFR5cGUuU0NIRURVTEVfTUFOQUdFTUVOVDpcbiAgICAgICAgYWN0aW9ucy5wdXNoKCdWZXIgY2FsZW5kYXJpbyBjb21wbGV0bycsICdPcHRpbWl6YXIgaG9yYXJpbycsICdDb25maWd1cmFyIHJlY29yZGF0b3Jpb3MnKVxuICAgICAgICBicmVha1xuICAgICAgXG4gICAgICBjYXNlIEludGVudFR5cGUuU1RVRFlfUExBTk5JTkc6XG4gICAgICAgIGFjdGlvbnMucHVzaCgnQ3JlYXIgcGxhbiBzZW1hbmFsJywgJ0NvbmZpZ3VyYXIgc2VzaW9uZXMnLCAnVmVyIG1hdGVyaWFsZXMnKVxuICAgICAgICBicmVha1xuICAgICAgXG4gICAgICBjYXNlIEludGVudFR5cGUuQ0FMRU5EQVJfTUFOQUdFTUVOVDpcbiAgICAgICAgYWN0aW9ucy5wdXNoKCdBZ3JlZ2FyIGV2ZW50bycsICdWZXIgcHLDs3hpbW9zIGV2ZW50b3MnLCAnRWRpdGFyIGNhbGVuZGFyaW8nKVxuICAgICAgICBicmVha1xuICAgICAgXG4gICAgICBjYXNlIEludGVudFR5cGUuTUFURVJJQUxfUkVRVUVTVDpcbiAgICAgICAgYWN0aW9ucy5wdXNoKCdCdXNjYXIgcmVjdXJzb3MnLCAnT3JnYW5pemFyIG1hdGVyaWFsZXMnLCAnQ3JlYXIgbGlzdGEgZGUgZXN0dWRpbycpXG4gICAgICAgIGJyZWFrXG4gICAgICBcbiAgICAgIGNhc2UgSW50ZW50VHlwZS5QUk9HUkVTU19SRVZJRVc6XG4gICAgICAgIGFjdGlvbnMucHVzaCgnVmVyIGVzdGFkw61zdGljYXMnLCAnQW5hbGl6YXIgcmVuZGltaWVudG8nLCAnRXN0YWJsZWNlciBtZXRhcycpXG4gICAgICAgIGJyZWFrXG4gICAgICBcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGFjdGlvbnMucHVzaCgnQ29udGludWFyIGNvbnZlcnNhY2nDs24nLCAnQ2FtYmlhciB0ZW1hJywgJ1ZlciBvcGNpb25lcycpXG4gICAgfVxuXG4gICAgcmV0dXJuIGFjdGlvbnNcbiAgfVxufSJdLCJuYW1lcyI6WyJTdHVkZW50Q29udGV4dE1hbmFnZXIiLCJBY2FkZW1pY1N1YmplY3QiLCJJbnRlbnRUeXBlIiwiQ29udmVyc2F0aW9uTW9kZSIsIkFkdmFuY2VkSW50ZW50RW5naW5lIiwiSU5URU5UX1BBVFRFUk5TIiwiRU5USVRZX1BBVFRFUk5TIiwiZGF0ZXMiLCJ0aW1lcyIsInN1YmplY3RzIiwiZHVyYXRpb25zIiwicHJpb3JpdGllcyIsImFuYWx5emVJbnRlbnQiLCJtZXNzYWdlIiwidXNlcklkIiwiY29udGV4dCIsImdldENvbnRleHQiLCJjcmVhdGVEZWZhdWx0Q29udGV4dCIsIm1zZ0xvd2VyIiwidG9Mb3dlckNhc2UiLCJiZXN0TWF0Y2giLCJpbnRlbnQiLCJjb25maWRlbmNlIiwiaW50ZW50VHlwZSIsInBhdHRlcm5zIiwiT2JqZWN0IiwiZW50cmllcyIsIm1heENvbmZpZGVuY2UiLCJwYXR0ZXJuIiwidGVzdCIsImNhbGN1bGF0ZVBhdHRlcm5Db25maWRlbmNlIiwiTWF0aCIsIm1heCIsImVudGl0aWVzIiwiZXh0cmFjdEVudGl0aWVzIiwic3ViamVjdCIsImRldGVjdEFjYWRlbWljU3ViamVjdCIsInRvcGljcyIsImV4dHJhY3RUb3BpY3MiLCJjb250ZXh0QW5hbHlzaXMiLCJhbmFseXplTWVzc2FnZUNvbnRleHQiLCJzdWdnZXN0ZWRNb2RlIiwiZGV0ZXJtaW5lU3VnZ2VzdGVkTW9kZSIsImZvbGxvd1VwQWN0aW9ucyIsImdlbmVyYXRlRm9sbG93VXBBY3Rpb25zIiwibWF0Y2giLCJtYXRjaExlbmd0aCIsImxlbmd0aCIsIm1lc3NhZ2VMZW5ndGgiLCJsZW5ndGhSYXRpbyIsImtleXdvcmRCb251cyIsImNvdW50UmVsYXRlZEtleXdvcmRzIiwibWluIiwicmVsYXRlZEtleXdvcmRzIiwiY291bnQiLCJrZXl3b3JkcyIsInZhbHVlcyIsImtleXdvcmQiLCJpbmNsdWRlcyIsImV4dHJhY3REYXRlcyIsImV4dHJhY3RUaW1lcyIsImV4dHJhY3RTdWJqZWN0cyIsImV4dHJhY3REdXJhdGlvbnMiLCJleHRyYWN0UHJpb3JpdGllcyIsIm5vdyIsIkRhdGUiLCJwdXNoIiwidG9tb3Jyb3ciLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRheXNPZldlZWsiLCJmb3JFYWNoIiwiZGF5IiwiaW5kZXgiLCJ0YXJnZXREYXRlIiwiY3VycmVudERheSIsImdldERheSIsImRheXNUb0FkZCIsInRpbWVQYXR0ZXJucyIsIm1hdGNoZXMiLCJzdWJqZWN0UGF0dGVybnMiLCJkdXJhdGlvblBhdHRlcm5zIiwicHJpb3JpdHlQYXR0ZXJucyIsIk1BVEhFTUFUSUNTIiwiUEhZU0lDUyIsIkNIRU1JU1RSWSIsIkJJT0xPR1kiLCJTT0NJQUxfU1RVRElFUyIsIkxBTkdVQUdFX0FSVFMiLCJ1bmRlZmluZWQiLCJ0b3BpY1BhdHRlcm5zIiwibWF0Y2hBbGwiLCJ0cmltIiwidXJnZW5jeSIsInNjb3BlIiwiY29tcGxleGl0eSIsInF1ZXN0aW9uV29yZHMiLCJzdWJqZWN0TWVudGlvbnMiLCJhY3Rpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/advanced-intent-engine.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/advanced-learning-profiles.ts":
/*!***********************************************!*\
  !*** ./src/lib/advanced-learning-profiles.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AdvancedLearningProfileManager: () => (/* binding */ AdvancedLearningProfileManager),\n/* harmony export */   LearningStyle: () => (/* binding */ LearningStyle)\n/* harmony export */ });\n// Advanced Learning Profiles System for Sara AI\n// Implements VARK model (Visual, Auditory, Reading/Writing, Kinesthetic) with automatic detection\nvar LearningStyle = /*#__PURE__*/ function(LearningStyle) {\n    LearningStyle[\"VISUAL\"] = \"visual\";\n    LearningStyle[\"AUDITORY\"] = \"auditory\";\n    LearningStyle[\"READING_WRITING\"] = \"reading_writing\";\n    LearningStyle[\"KINESTHETIC\"] = \"kinesthetic\";\n    LearningStyle[\"MULTIMODAL\"] = \"multimodal\";\n    return LearningStyle;\n}({});\nclass AdvancedLearningProfileManager {\n    static{\n        // Storage for learning profiles\n        this.profiles = new Map();\n    }\n    static{\n        this.behaviors = [];\n    }\n    /**\n   * Analyzes user message for learning style indicators\n   */ static analyzeMessageForLearningStyle(message, userId) {\n        const msgLower = message.toLowerCase();\n        const indicators = [];\n        // VISUAL indicators\n        const visualKeywords = [\n            'ver',\n            'mirar',\n            'mostrar',\n            'imagen',\n            'gráfico',\n            'diagrama',\n            'visual',\n            'color',\n            'mapa',\n            'esquema',\n            'dibujo',\n            'ilustración',\n            'tabla',\n            'gráfica',\n            'visualizar',\n            'observar',\n            'demostrar',\n            'ejemplo visual',\n            'claramente'\n        ];\n        const visualPhrases = [\n            'me gusta ver',\n            'muéstrame',\n            'qué aspecto tiene',\n            'cómo se ve',\n            'necesito ver',\n            'puedes mostrar',\n            'ejemplo visual',\n            'de forma gráfica'\n        ];\n        let visualScore = this.calculateKeywordScore(msgLower, visualKeywords, visualPhrases);\n        if (visualScore > 0) {\n            indicators.push({\n                style: \"visual\",\n                weight: visualScore,\n                evidence: this.extractEvidence(msgLower, [\n                    ...visualKeywords,\n                    ...visualPhrases\n                ]),\n                confidence: Math.min(visualScore * 1.2, 1.0)\n            });\n        }\n        // AUDITORY indicators\n        const auditoryKeywords = [\n            'escuchar',\n            'oír',\n            'sonido',\n            'explicar',\n            'decir',\n            'contar',\n            'discutir',\n            'hablar',\n            'verbal',\n            'audio',\n            'pronunciar',\n            'repetir',\n            'preguntar'\n        ];\n        const auditoryPhrases = [\n            'explícame',\n            'cuéntame',\n            'me puedes decir',\n            'necesito que me expliques',\n            'repítelo',\n            'en palabras',\n            'de forma verbal',\n            'hablemos de'\n        ];\n        let auditoryScore = this.calculateKeywordScore(msgLower, auditoryKeywords, auditoryPhrases);\n        if (auditoryScore > 0) {\n            indicators.push({\n                style: \"auditory\",\n                weight: auditoryScore,\n                evidence: this.extractEvidence(msgLower, [\n                    ...auditoryKeywords,\n                    ...auditoryPhrases\n                ]),\n                confidence: Math.min(auditoryScore * 1.1, 1.0)\n            });\n        }\n        // READING/WRITING indicators\n        const readWriteKeywords = [\n            'leer',\n            'escribir',\n            'texto',\n            'nota',\n            'lista',\n            'definición',\n            'resumen',\n            'apuntes',\n            'documento',\n            'artículo',\n            'párrafo',\n            'descripción',\n            'detalles'\n        ];\n        const readWritePhrases = [\n            'en texto',\n            'por escrito',\n            'dame detalles',\n            'necesito leer',\n            'quiero estudiar',\n            'información detallada',\n            'paso a paso',\n            'lista de'\n        ];\n        let readWriteScore = this.calculateKeywordScore(msgLower, readWriteKeywords, readWritePhrases);\n        if (readWriteScore > 0) {\n            indicators.push({\n                style: \"reading_writing\",\n                weight: readWriteScore,\n                evidence: this.extractEvidence(msgLower, [\n                    ...readWriteKeywords,\n                    ...readWritePhrases\n                ]),\n                confidence: Math.min(readWriteScore, 1.0)\n            });\n        }\n        // KINESTHETIC indicators\n        const kinestheticKeywords = [\n            'hacer',\n            'practicar',\n            'ejercicio',\n            'actividad',\n            'mano',\n            'tocar',\n            'mover',\n            'experimentar',\n            'probar',\n            'manipular',\n            'construir',\n            'crear',\n            'interactivo'\n        ];\n        const kinestheticPhrases = [\n            'quiero hacer',\n            'necesito practicar',\n            'hands on',\n            'de forma práctica',\n            'experimentando',\n            'probando',\n            'haciendo ejercicios',\n            'actividades'\n        ];\n        let kinestheticScore = this.calculateKeywordScore(msgLower, kinestheticKeywords, kinestheticPhrases);\n        if (kinestheticScore > 0) {\n            indicators.push({\n                style: \"kinesthetic\",\n                weight: kinestheticScore,\n                evidence: this.extractEvidence(msgLower, [\n                    ...kinestheticKeywords,\n                    ...kinestheticPhrases\n                ]),\n                confidence: Math.min(kinestheticScore * 1.3, 1.0)\n            });\n        }\n        // Record behavior pattern\n        if (indicators.length > 0) {\n            this.recordBehaviorPattern(userId, 'message_analysis', message, indicators.map((i)=>i.style));\n        }\n        return indicators.sort((a, b)=>b.weight - a.weight);\n    }\n    /**\n   * Calculates score based on keyword and phrase matches\n   */ static calculateKeywordScore(text, keywords, phrases) {\n        let score = 0;\n        // Keyword matches (lower weight)\n        for (const keyword of keywords){\n            if (text.includes(keyword)) {\n                score += 0.1;\n            }\n        }\n        // Phrase matches (higher weight)\n        for (const phrase of phrases){\n            if (text.includes(phrase)) {\n                score += 0.3;\n            }\n        }\n        return Math.min(score, 1.0);\n    }\n    /**\n   * Extracts evidence from text\n   */ static extractEvidence(text, patterns) {\n        const evidence = [];\n        for (const pattern of patterns){\n            if (text.includes(pattern)) {\n                // Extract sentence containing the pattern\n                const sentences = text.split(/[.!?]+/);\n                const matchingSentence = sentences.find((sentence)=>sentence.toLowerCase().includes(pattern));\n                if (matchingSentence) {\n                    evidence.push(matchingSentence.trim());\n                }\n            }\n        }\n        return evidence.slice(0, 3) // Limit to 3 pieces of evidence\n        ;\n    }\n    /**\n   * Records a learning behavior pattern\n   */ static recordBehaviorPattern(userId, action, context, styleIndicators) {\n        this.behaviors.push({\n            userId,\n            timestamp: new Date(),\n            action,\n            context,\n            styleIndicators\n        });\n        // Keep only recent behaviors (last 100 per user)\n        const userBehaviors = this.behaviors.filter((b)=>b.userId === userId);\n        if (userBehaviors.length > 100) {\n            this.behaviors = this.behaviors.filter((b)=>b.userId !== userId).concat(userBehaviors.slice(-100));\n        }\n    }\n    /**\n   * Updates or creates learning profile for user\n   */ static updateLearningProfile(userId, indicators, context) {\n        let profile = this.profiles.get(userId) || this.createInitialProfile(userId);\n        // Update style distribution based on new indicators\n        for (const indicator of indicators){\n            const weight = indicator.weight * indicator.confidence;\n            switch(indicator.style){\n                case \"visual\":\n                    profile.styleDistribution.visual = Math.min(profile.styleDistribution.visual + weight * 0.1, 1.0);\n                    break;\n                case \"auditory\":\n                    profile.styleDistribution.auditory = Math.min(profile.styleDistribution.auditory + weight * 0.1, 1.0);\n                    break;\n                case \"reading_writing\":\n                    profile.styleDistribution.reading_writing = Math.min(profile.styleDistribution.reading_writing + weight * 0.1, 1.0);\n                    break;\n                case \"kinesthetic\":\n                    profile.styleDistribution.kinesthetic = Math.min(profile.styleDistribution.kinesthetic + weight * 0.1, 1.0);\n                    break;\n            }\n        }\n        // Normalize distribution\n        const total = profile.styleDistribution.visual + profile.styleDistribution.auditory + profile.styleDistribution.reading_writing + profile.styleDistribution.kinesthetic;\n        if (total > 0) {\n            profile.styleDistribution.visual /= total;\n            profile.styleDistribution.auditory /= total;\n            profile.styleDistribution.reading_writing /= total;\n            profile.styleDistribution.kinesthetic /= total;\n        }\n        // Determine primary and secondary styles\n        const styles = [\n            {\n                style: \"visual\",\n                score: profile.styleDistribution.visual\n            },\n            {\n                style: \"auditory\",\n                score: profile.styleDistribution.auditory\n            },\n            {\n                style: \"reading_writing\",\n                score: profile.styleDistribution.reading_writing\n            },\n            {\n                style: \"kinesthetic\",\n                score: profile.styleDistribution.kinesthetic\n            }\n        ].sort((a, b)=>b.score - a.score);\n        profile.primaryStyle = styles[0].score > 0.35 ? styles[0].style : \"multimodal\";\n        profile.secondaryStyle = styles[1].score > 0.25 ? styles[1].style : undefined;\n        // Update adaptation preferences\n        profile.adaptationPreferences = {\n            prefersDiagrams: profile.styleDistribution.visual > 0.3,\n            prefersStepByStep: profile.styleDistribution.reading_writing > 0.3,\n            prefersExamples: profile.styleDistribution.visual > 0.25 || profile.styleDistribution.kinesthetic > 0.25,\n            prefersInteraction: profile.styleDistribution.kinesthetic > 0.3,\n            prefersVisualAids: profile.styleDistribution.visual > 0.25,\n            prefersVerbalExplanation: profile.styleDistribution.auditory > 0.3\n        };\n        profile.lastUpdated = new Date();\n        profile.interactions++;\n        this.profiles.set(userId, profile);\n        console.log(`📊 Learning profile updated for ${userId}: Primary=${profile.primaryStyle}, Secondary=${profile.secondaryStyle || 'none'}`);\n        return profile;\n    }\n    /**\n   * Creates initial learning profile\n   */ static createInitialProfile(userId) {\n        return {\n            userId,\n            primaryStyle: \"multimodal\",\n            secondaryStyle: undefined,\n            styleDistribution: {\n                visual: 0.25,\n                auditory: 0.25,\n                reading_writing: 0.25,\n                kinesthetic: 0.25\n            },\n            adaptationPreferences: {\n                prefersDiagrams: false,\n                prefersStepByStep: true,\n                prefersExamples: true,\n                prefersInteraction: false,\n                prefersVisualAids: false,\n                prefersVerbalExplanation: false\n            },\n            detectedFrom: {\n                messageAnalysis: 0,\n                behaviorPatterns: 0,\n                explicitPreferences: 0\n            },\n            lastUpdated: new Date(),\n            interactions: 0\n        };\n    }\n    /**\n   * Gets learning profile for user\n   */ static getLearningProfile(userId) {\n        return this.profiles.get(userId) || this.createInitialProfile(userId);\n    }\n    /**\n   * Adapts response content based on learning profile\n   */ static adaptResponseToLearningStyle(content, profile) {\n        let adaptedContent = content;\n        // Visual learner adaptations\n        if (profile.adaptationPreferences.prefersVisualAids) {\n            adaptedContent = this.addVisualElements(adaptedContent, profile);\n        }\n        // Auditory learner adaptations\n        if (profile.adaptationPreferences.prefersVerbalExplanation) {\n            adaptedContent = this.addAuditoryElements(adaptedContent, profile);\n        }\n        // Reading/Writing learner adaptations\n        if (profile.adaptationPreferences.prefersStepByStep) {\n            adaptedContent = this.addStructuredElements(adaptedContent, profile);\n        }\n        // Kinesthetic learner adaptations\n        if (profile.adaptationPreferences.prefersInteraction) {\n            adaptedContent = this.addInteractiveElements(adaptedContent, profile);\n        }\n        return adaptedContent;\n    }\n    /**\n   * Adds visual elements for visual learners\n   */ static addVisualElements(content, profile) {\n        let enhanced = content;\n        // Add visual cues and formatting\n        enhanced = enhanced.replace(/importante:/gi, '🔍 **IMPORTANTE:**');\n        enhanced = enhanced.replace(/nota:/gi, '📝 **NOTA:**');\n        enhanced = enhanced.replace(/ejemplo:/gi, '💡 **EJEMPLO:**');\n        enhanced = enhanced.replace(/resultado:/gi, '✅ **RESULTADO:**');\n        // Add visual separators\n        if (enhanced.includes('paso') || enhanced.includes('step')) {\n            enhanced = enhanced.replace(/paso (\\d+)/gi, '\\n📍 **PASO $1**\\n');\n        }\n        return enhanced;\n    }\n    /**\n   * Adds auditory elements for auditory learners  \n   */ static addAuditoryElements(content, profile) {\n        let enhanced = content;\n        // Add conversational phrases\n        enhanced = \"🗣️ Te voy a explicar esto paso a paso:\\n\\n\" + enhanced;\n        // Add verbal transition phrases\n        enhanced = enhanced.replace(/\\. ([A-Z])/g, '. Ahora, $1');\n        enhanced = enhanced.replace(/:\\n/g, '. Escucha bien:\\n');\n        return enhanced;\n    }\n    /**\n   * Adds structured elements for reading/writing learners\n   */ static addStructuredElements(content, profile) {\n        let enhanced = content;\n        // Add clear structure and bullet points\n        if (!enhanced.includes('**') && enhanced.length > 200) {\n            const sentences = enhanced.split('.');\n            if (sentences.length > 3) {\n                enhanced = sentences.filter((s)=>s.trim().length > 10).map((sentence, index)=>`${index + 1}. ${sentence.trim()}`).join('\\n');\n            }\n        }\n        return enhanced;\n    }\n    /**\n   * Adds interactive elements for kinesthetic learners\n   */ static addInteractiveElements(content, profile) {\n        let enhanced = content;\n        // Add action-oriented language\n        enhanced += \"\\n\\n🎯 **Prueba esto:**\";\n        enhanced += \"\\n• Aplica este concepto a un problema real\";\n        enhanced += \"\\n• Experimenta cambiando los valores\";\n        enhanced += \"\\n• Practica con ejercicios similares\";\n        return enhanced;\n    }\n    /**\n   * Analyzes behavior patterns to enhance profile\n   */ static analyzeBehaviorPatterns(userId) {\n        const userBehaviors = this.behaviors.filter((b)=>b.userId === userId);\n        const profile = this.getLearningProfile(userId);\n        if (userBehaviors.length < 5) return profile;\n        // Analyze patterns in recent behaviors\n        const recentBehaviors = userBehaviors.slice(-20);\n        const styleFrequency = new Map();\n        for (const behavior of recentBehaviors){\n            for (const style of behavior.styleIndicators){\n                styleFrequency.set(style, (styleFrequency.get(style) || 0) + 1);\n            }\n        }\n        // Update profile based on behavioral patterns\n        const indicators = [];\n        for (const [style, frequency] of styleFrequency.entries()){\n            const weight = frequency / recentBehaviors.length;\n            if (weight > 0.1) {\n                indicators.push({\n                    style,\n                    weight,\n                    evidence: [\n                        `Detectado en ${frequency} de ${recentBehaviors.length} interacciones recientes`\n                    ],\n                    confidence: Math.min(weight * 2, 1.0)\n                });\n            }\n        }\n        return this.updateLearningProfile(userId, indicators, 'behavior_analysis');\n    }\n    /**\n   * Gets profile statistics\n   */ static getProfileStatistics(userId) {\n        if (userId) {\n            const profile = this.profiles.get(userId);\n            const behaviors = this.behaviors.filter((b)=>b.userId === userId);\n            return {\n                profile: profile || null,\n                behaviorCount: behaviors.length,\n                recentInteractions: behaviors.filter((b)=>b.timestamp > new Date(Date.now() - 7 * 24 * 60 * 60 * 1000)).length\n            };\n        }\n        return {\n            totalProfiles: this.profiles.size,\n            totalBehaviors: this.behaviors.length,\n            styleDistribution: this.getGlobalStyleDistribution()\n        };\n    }\n    /**\n   * Gets global style distribution\n   */ static getGlobalStyleDistribution() {\n        const distribution = {\n            visual: 0,\n            auditory: 0,\n            reading_writing: 0,\n            kinesthetic: 0,\n            multimodal: 0\n        };\n        for (const profile of this.profiles.values()){\n            switch(profile.primaryStyle){\n                case \"visual\":\n                    distribution.visual++;\n                    break;\n                case \"auditory\":\n                    distribution.auditory++;\n                    break;\n                case \"reading_writing\":\n                    distribution.reading_writing++;\n                    break;\n                case \"kinesthetic\":\n                    distribution.kinesthetic++;\n                    break;\n                case \"multimodal\":\n                    distribution.multimodal++;\n                    break;\n            }\n        }\n        return distribution;\n    }\n    /**\n   * Process user message and update learning profile\n   */ static processUserMessage(userId, message) {\n        // Analyze message for learning style indicators\n        const indicators = this.analyzeMessageForLearningStyle(message, userId);\n        // Update learning profile if indicators found\n        if (indicators.length > 0) {\n            return this.updateLearningProfile(userId, indicators, 'message_processing');\n        }\n        // Analyze behavior patterns periodically\n        const profile = this.getLearningProfile(userId);\n        if (profile.interactions % 10 === 0) {\n            return this.analyzeBehaviorPatterns(userId);\n        }\n        return profile;\n    }\n    /**\n   * Generates learning style recommendations for Sara\n   */ static generateStyleRecommendations(profile) {\n        const recommendations = [];\n        switch(profile.primaryStyle){\n            case \"visual\":\n                recommendations.push(\"Usar diagramas y esquemas cuando explico conceptos\");\n                recommendations.push(\"Incluir ejemplos visuales y gráficos\");\n                recommendations.push(\"Estructurar información con viñetas y colores\");\n                break;\n            case \"auditory\":\n                recommendations.push(\"Explicar conceptos con lenguaje conversacional\");\n                recommendations.push(\"Usar analogías y metáforas verbales\");\n                recommendations.push(\"Incluir discusiones y preguntas abiertas\");\n                break;\n            case \"reading_writing\":\n                recommendations.push(\"Proporcionar información detallada por escrito\");\n                recommendations.push(\"Crear listas y resúmenes estructurados\");\n                recommendations.push(\"Incluir definiciones y descripciones precisas\");\n                break;\n            case \"kinesthetic\":\n                recommendations.push(\"Incluir ejercicios prácticos y actividades\");\n                recommendations.push(\"Sugerir experimentos y aplicaciones reales\");\n                recommendations.push(\"Usar ejemplos concretos y manipulables\");\n                break;\n            case \"multimodal\":\n                recommendations.push(\"Combinar múltiples enfoques de enseñanza\");\n                recommendations.push(\"Adaptar explicaciones según el contexto\");\n                recommendations.push(\"Ofrecer opciones de aprendizaje variadas\");\n                break;\n        }\n        return recommendations;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2FkdmFuY2VkLWxlYXJuaW5nLXByb2ZpbGVzLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsZ0RBQWdEO0FBQ2hELGtHQUFrRztBQUUzRiwyQ0FBS0E7Ozs7OztXQUFBQTtNQU1YO0FBNENNLE1BQU1DOztRQUVYLGdDQUFnQzthQUNqQkMsV0FBeUMsSUFBSUM7OzthQUM3Q0MsWUFBdUMsRUFBRTs7SUFFeEQ7O0dBRUMsR0FDRCxPQUFPQywrQkFBK0JDLE9BQWUsRUFBRUMsTUFBYyxFQUE0QjtRQUMvRixNQUFNQyxXQUFXRixRQUFRRyxXQUFXO1FBQ3BDLE1BQU1DLGFBQXVDLEVBQUU7UUFFL0Msb0JBQW9CO1FBQ3BCLE1BQU1DLGlCQUFpQjtZQUNyQjtZQUFPO1lBQVM7WUFBVztZQUFVO1lBQVc7WUFBWTtZQUFVO1lBQ3RFO1lBQVE7WUFBVztZQUFVO1lBQWU7WUFBUztZQUFXO1lBQ2hFO1lBQVk7WUFBYTtZQUFrQjtTQUM1QztRQUVELE1BQU1DLGdCQUFnQjtZQUNwQjtZQUFnQjtZQUFhO1lBQXFCO1lBQ2xEO1lBQWdCO1lBQWtCO1lBQWtCO1NBQ3JEO1FBRUQsSUFBSUMsY0FBYyxJQUFJLENBQUNDLHFCQUFxQixDQUFDTixVQUFVRyxnQkFBZ0JDO1FBQ3ZFLElBQUlDLGNBQWMsR0FBRztZQUNuQkgsV0FBV0ssSUFBSSxDQUFDO2dCQUNkQyxLQUFLO2dCQUNMQyxRQUFRSjtnQkFDUkssVUFBVSxJQUFJLENBQUNDLGVBQWUsQ0FBQ1gsVUFBVTt1QkFBSUc7dUJBQW1CQztpQkFBYztnQkFDOUVRLFlBQVlDLEtBQUtDLEdBQUcsQ0FBQ1QsY0FBYyxLQUFLO1lBQzFDO1FBQ0Y7UUFFQSxzQkFBc0I7UUFDdEIsTUFBTVUsbUJBQW1CO1lBQ3ZCO1lBQVk7WUFBTztZQUFVO1lBQVk7WUFBUztZQUFVO1lBQzVEO1lBQVU7WUFBVTtZQUFTO1lBQWM7WUFBVztTQUN2RDtRQUVELE1BQU1DLGtCQUFrQjtZQUN0QjtZQUFhO1lBQVk7WUFBbUI7WUFD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UUFBUVcsWUFBWTtZQUMxQjtnQkFDRW1ELGdCQUFnQi9HLElBQUksQ0FBQztnQkFDckIrRyxnQkFBZ0IvRyxJQUFJLENBQUM7Z0JBQ3JCK0csZ0JBQWdCL0csSUFBSSxDQUFDO2dCQUNyQjtZQUVGO2dCQUNFK0csZ0JBQWdCL0csSUFBSSxDQUFDO2dCQUNyQitHLGdCQUFnQi9HLElBQUksQ0FBQztnQkFDckIrRyxnQkFBZ0IvRyxJQUFJLENBQUM7Z0JBQ3JCO1lBRUY7Z0JBQ0UrRyxnQkFBZ0IvRyxJQUFJLENBQUM7Z0JBQ3JCK0csZ0JBQWdCL0csSUFBSSxDQUFDO2dCQUNyQitHLGdCQUFnQi9HLElBQUksQ0FBQztnQkFDckI7WUFFRjtnQkFDRStHLGdCQUFnQi9HLElBQUksQ0FBQztnQkFDckIrRyxnQkFBZ0IvRyxJQUFJLENBQUM7Z0JBQ3JCK0csZ0JBQWdCL0csSUFBSSxDQUFDO2dCQUNyQjtZQUVGO2dCQUNFK0csZ0JBQWdCL0csSUFBSSxDQUFDO2dCQUNyQitHLGdCQUFnQi9HLElBQUksQ0FBQztnQkFDckIrRyxnQkFBZ0IvRyxJQUFJLENBQUM7Z0JBQ3JCO1FBQ0o7UUFFQSxPQUFPK0c7SUFDVDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL2FkdmFuY2VkLWxlYXJuaW5nLXByb2ZpbGVzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEFkdmFuY2VkIExlYXJuaW5nIFByb2ZpbGVzIFN5c3RlbSBmb3IgU2FyYSBBSVxuLy8gSW1wbGVtZW50cyBWQVJLIG1vZGVsIChWaXN1YWwsIEF1ZGl0b3J5LCBSZWFkaW5nL1dyaXRpbmcsIEtpbmVzdGhldGljKSB3aXRoIGF1dG9tYXRpYyBkZXRlY3Rpb25cblxuZXhwb3J0IGVudW0gTGVhcm5pbmdTdHlsZSB7XG4gIFZJU1VBTCA9ICd2aXN1YWwnLFxuICBBVURJVE9SWSA9ICdhdWRpdG9yeScsXG4gIFJFQURJTkdfV1JJVElORyA9ICdyZWFkaW5nX3dyaXRpbmcnLCBcbiAgS0lORVNUSEVUSUMgPSAna2luZXN0aGV0aWMnLFxuICBNVUxUSU1PREFMID0gJ211bHRpbW9kYWwnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdTdHlsZUluZGljYXRvciB7XG4gIHN0eWxlOiBMZWFybmluZ1N0eWxlXG4gIHdlaWdodDogbnVtYmVyIC8vIDAuMCB0byAxLjBcbiAgZXZpZGVuY2U6IHN0cmluZ1tdXG4gIGNvbmZpZGVuY2U6IG51bWJlciAvLyAwLjAgdG8gMS4wXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdQcm9maWxlIHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgcHJpbWFyeVN0eWxlOiBMZWFybmluZ1N0eWxlXG4gIHNlY29uZGFyeVN0eWxlPzogTGVhcm5pbmdTdHlsZVxuICBzdHlsZURpc3RyaWJ1dGlvbjoge1xuICAgIHZpc3VhbDogbnVtYmVyXG4gICAgYXVkaXRvcnk6IG51bWJlclxuICAgIHJlYWRpbmdfd3JpdGluZzogbnVtYmVyXG4gICAga2luZXN0aGV0aWM6IG51bWJlclxuICB9XG4gIGFkYXB0YXRpb25QcmVmZXJlbmNlczoge1xuICAgIHByZWZlcnNEaWFncmFtczogYm9vbGVhblxuICAgIHByZWZlcnNTdGVwQnlTdGVwOiBib29sZWFuXG4gICAgcHJlZmVyc0V4YW1wbGVzOiBib29sZWFuXG4gICAgcHJlZmVyc0ludGVyYWN0aW9uOiBib29sZWFuXG4gICAgcHJlZmVyc1Zpc3VhbEFpZHM6IGJvb2xlYW5cbiAgICBwcmVmZXJzVmVyYmFsRXhwbGFuYXRpb246IGJvb2xlYW5cbiAgfVxuICBkZXRlY3RlZEZyb206IHtcbiAgICBtZXNzYWdlQW5hbHlzaXM6IG51bWJlclxuICAgIGJlaGF2aW9yUGF0dGVybnM6IG51bWJlclxuICAgIGV4cGxpY2l0UHJlZmVyZW5jZXM6IG51bWJlclxuICB9XG4gIGxhc3RVcGRhdGVkOiBEYXRlXG4gIGludGVyYWN0aW9uczogbnVtYmVyXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGVhcm5pbmdCZWhhdmlvclBhdHRlcm4ge1xuICB1c2VySWQ6IHN0cmluZ1xuICB0aW1lc3RhbXA6IERhdGVcbiAgYWN0aW9uOiBzdHJpbmdcbiAgY29udGV4dDogc3RyaW5nXG4gIHN0eWxlSW5kaWNhdG9yczogTGVhcm5pbmdTdHlsZVtdXG59XG5cbmV4cG9ydCBjbGFzcyBBZHZhbmNlZExlYXJuaW5nUHJvZmlsZU1hbmFnZXIge1xuICBcbiAgLy8gU3RvcmFnZSBmb3IgbGVhcm5pbmcgcHJvZmlsZXNcbiAgcHJpdmF0ZSBzdGF0aWMgcHJvZmlsZXM6IE1hcDxzdHJpbmcsIExlYXJuaW5nUHJvZmlsZT4gPSBuZXcgTWFwKClcbiAgcHJpdmF0ZSBzdGF0aWMgYmVoYXZpb3JzOiBMZWFybmluZ0JlaGF2aW9yUGF0dGVybltdID0gW11cblxuICAvKipcbiAgICogQW5hbHl6ZXMgdXNlciBtZXNzYWdlIGZvciBsZWFybmluZyBzdHlsZSBpbmRpY2F0b3JzXG4gICAqL1xuICBzdGF0aWMgYW5hbHl6ZU1lc3NhZ2VGb3JMZWFybmluZ1N0eWxlKG1lc3NhZ2U6IHN0cmluZywgdXNlcklkOiBzdHJpbmcpOiBMZWFybmluZ1N0eWxlSW5kaWNhdG9yW10ge1xuICAgIGNvbnN0IG1zZ0xvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgaW5kaWNhdG9yczogTGVhcm5pbmdTdHlsZUluZGljYXRvcltdID0gW11cblxuICAgIC8vIFZJU1VBTCBpbmRpY2F0b3JzXG4gICAgY29uc3QgdmlzdWFsS2V5d29yZHMgPSBbXG4gICAgICAndmVyJywgJ21pcmFyJywgJ21vc3RyYXInLCAnaW1hZ2VuJywgJ2dyw6FmaWNvJywgJ2RpYWdyYW1hJywgJ3Zpc3VhbCcsICdjb2xvcicsXG4gICAgICAnbWFwYScsICdlc3F1ZW1hJywgJ2RpYnVqbycsICdpbHVzdHJhY2nDs24nLCAndGFibGEnLCAnZ3LDoWZpY2EnLCAndmlzdWFsaXphcicsXG4gICAgICAnb2JzZXJ2YXInLCAnZGVtb3N0cmFyJywgJ2VqZW1wbG8gdmlzdWFsJywgJ2NsYXJhbWVudGUnXG4gICAgXVxuICAgIFxuICAgIGNvbnN0IHZpc3VhbFBocmFzZXMgPSBbXG4gICAgICAnbWUgZ3VzdGEgdmVyJywgJ211w6lzdHJhbWUnLCAncXXDqSBhc3BlY3RvIHRpZW5lJywgJ2PDs21vIHNlIHZlJyxcbiAgICAgICduZWNlc2l0byB2ZXInLCAncHVlZGVzIG1vc3RyYXInLCAnZWplbXBsbyB2aXN1YWwnLCAnZGUgZm9ybWEgZ3LDoWZpY2EnXG4gICAgXVxuICAgIFxuICAgIGxldCB2aXN1YWxTY29yZSA9IHRoaXMuY2FsY3VsYXRlS2V5d29yZFNjb3JlKG1zZ0xvd2VyLCB2aXN1YWxLZXl3b3JkcywgdmlzdWFsUGhyYXNlcylcbiAgICBpZiAodmlzdWFsU2NvcmUgPiAwKSB7XG4gICAgICBpbmRpY2F0b3JzLnB1c2goe1xuICAgICAgICBzdHlsZTogTGVhcm5pbmdTdHlsZS5WSVNVQUwsXG4gICAgICAgIHdlaWdodDogdmlzdWFsU2NvcmUsXG4gICAgICAgIGV2aWRlbmNlOiB0aGlzLmV4dHJhY3RFdmlkZW5jZShtc2dMb3dlciwgWy4uLnZpc3VhbEtleXdvcmRzLCAuLi52aXN1YWxQaHJhc2VzXSksXG4gICAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWluKHZpc3VhbFNjb3JlICogMS4yLCAxLjApXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIEFVRElUT1JZIGluZGljYXRvcnNcbiAgICBjb25zdCBhdWRpdG9yeUtleXdvcmRzID0gW1xuICAgICAgJ2VzY3VjaGFyJywgJ2/DrXInLCAnc29uaWRvJywgJ2V4cGxpY2FyJywgJ2RlY2lyJywgJ2NvbnRhcicsICdkaXNjdXRpcicsXG4gICAgICAnaGFibGFyJywgJ3ZlcmJhbCcsICdhdWRpbycsICdwcm9udW5jaWFyJywgJ3JlcGV0aXInLCAncHJlZ3VudGFyJ1xuICAgIF1cbiAgICBcbiAgICBjb25zdCBhdWRpdG9yeVBocmFzZXMgPSBbXG4gICAgICAnZXhwbMOtY2FtZScsICdjdcOpbnRhbWUnLCAnbWUgcHVlZGVzIGRlY2lyJywgJ25lY2VzaXRvIHF1ZSBtZSBleHBsaXF1ZXMnLFxuICAgICAgJ3JlcMOtdGVsbycsICdlbiBwYWxhYnJhcycsICdkZSBmb3JtYSB2ZXJiYWwnLCAnaGFibGVtb3MgZGUnXG4gICAgXVxuICAgIFxuICAgIGxldCBhdWRpdG9yeVNjb3JlID0gdGhpcy5jYWxjdWxhdGVLZXl3b3JkU2NvcmUobXNnTG93ZXIsIGF1ZGl0b3J5S2V5d29yZHMsIGF1ZGl0b3J5UGhyYXNlcylcbiAgICBpZiAoYXVkaXRvcnlTY29yZSA+IDApIHtcbiAgICAgIGluZGljYXRvcnMucHVzaCh7XG4gICAgICAgIHN0eWxlOiBMZWFybmluZ1N0eWxlLkFVRElUT1JZLFxuICAgICAgICB3ZWlnaHQ6IGF1ZGl0b3J5U2NvcmUsXG4gICAgICAgIGV2aWRlbmNlOiB0aGlzLmV4dHJhY3RFdmlkZW5jZShtc2dMb3dlciwgWy4uLmF1ZGl0b3J5S2V5d29yZHMsIC4uLmF1ZGl0b3J5UGhyYXNlc10pLFxuICAgICAgICBjb25maWRlbmNlOiBNYXRoLm1pbihhdWRpdG9yeVNjb3JlICogMS4xLCAxLjApXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIFJFQURJTkcvV1JJVElORyBpbmRpY2F0b3JzXG4gICAgY29uc3QgcmVhZFdyaXRlS2V5d29yZHMgPSBbXG4gICAgICAnbGVlcicsICdlc2NyaWJpcicsICd0ZXh0bycsICdub3RhJywgJ2xpc3RhJywgJ2RlZmluaWNpw7NuJywgJ3Jlc3VtZW4nLFxuICAgICAgJ2FwdW50ZXMnLCAnZG9jdW1lbnRvJywgJ2FydMOtY3VsbycsICdww6FycmFmbycsICdkZXNjcmlwY2nDs24nLCAnZGV0YWxsZXMnXG4gICAgXVxuICAgIFxuICAgIGNvbnN0IHJlYWRXcml0ZVBocmFzZXMgPSBbXG4gICAgICAnZW4gdGV4dG8nLCAncG9yIGVzY3JpdG8nLCAnZGFtZSBkZXRhbGxlcycsICduZWNlc2l0byBsZWVyJyxcbiAgICAgICdxdWllcm8gZXN0dWRpYXInLCAnaW5mb3JtYWNpw7NuIGRldGFsbGFkYScsICdwYXNvIGEgcGFzbycsICdsaXN0YSBkZSdcbiAgICBdXG4gICAgXG4gICAgbGV0IHJlYWRXcml0ZVNjb3JlID0gdGhpcy5jYWxjdWxhdGVLZXl3b3JkU2NvcmUobXNnTG93ZXIsIHJlYWRXcml0ZUtleXdvcmRzLCByZWFkV3JpdGVQaHJhc2VzKVxuICAgIGlmIChyZWFkV3JpdGVTY29yZSA+IDApIHtcbiAgICAgIGluZGljYXRvcnMucHVzaCh7XG4gICAgICAgIHN0eWxlOiBMZWFybmluZ1N0eWxlLlJFQURJTkdfV1JJVElORyxcbiAgICAgICAgd2VpZ2h0OiByZWFkV3JpdGVTY29yZSxcbiAgICAgICAgZXZpZGVuY2U6IHRoaXMuZXh0cmFjdEV2aWRlbmNlKG1zZ0xvd2VyLCBbLi4ucmVhZFdyaXRlS2V5d29yZHMsIC4uLnJlYWRXcml0ZVBocmFzZXNdKSxcbiAgICAgICAgY29uZmlkZW5jZTogTWF0aC5taW4ocmVhZFdyaXRlU2NvcmUsIDEuMClcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gS0lORVNUSEVUSUMgaW5kaWNhdG9yc1xuICAgIGNvbnN0IGtpbmVzdGhldGljS2V5d29yZHMgPSBbXG4gICAgICAnaGFjZXInLCAncHJhY3RpY2FyJywgJ2VqZXJjaWNpbycsICdhY3RpdmlkYWQnLCAnbWFubycsICd0b2NhcicsICdtb3ZlcicsXG4gICAgICAnZXhwZXJpbWVudGFyJywgJ3Byb2JhcicsICdtYW5pcHVsYXInLCAnY29uc3RydWlyJywgJ2NyZWFyJywgJ2ludGVyYWN0aXZvJ1xuICAgIF1cbiAgICBcbiAgICBjb25zdCBraW5lc3RoZXRpY1BocmFzZXMgPSBbXG4gICAgICAncXVpZXJvIGhhY2VyJywgJ25lY2VzaXRvIHByYWN0aWNhcicsICdoYW5kcyBvbicsICdkZSBmb3JtYSBwcsOhY3RpY2EnLFxuICAgICAgJ2V4cGVyaW1lbnRhbmRvJywgJ3Byb2JhbmRvJywgJ2hhY2llbmRvIGVqZXJjaWNpb3MnLCAnYWN0aXZpZGFkZXMnXG4gICAgXVxuICAgIFxuICAgIGxldCBraW5lc3RoZXRpY1Njb3JlID0gdGhpcy5jYWxjdWxhdGVLZXl3b3JkU2NvcmUobXNnTG93ZXIsIGtpbmVzdGhldGljS2V5d29yZHMsIGtpbmVzdGhldGljUGhyYXNlcylcbiAgICBpZiAoa2luZXN0aGV0aWNTY29yZSA+IDApIHtcbiAgICAgIGluZGljYXRvcnMucHVzaCh7XG4gICAgICAgIHN0eWxlOiBMZWFybmluZ1N0eWxlLktJTkVTVEhFVElDLFxuICAgICAgICB3ZWlnaHQ6IGtpbmVzdGhldGljU2NvcmUsXG4gICAgICAgIGV2aWRlbmNlOiB0aGlzLmV4dHJhY3RFdmlkZW5jZShtc2dMb3dlciwgWy4uLmtpbmVzdGhldGljS2V5d29yZHMsIC4uLmtpbmVzdGhldGljUGhyYXNlc10pLFxuICAgICAgICBjb25maWRlbmNlOiBNYXRoLm1pbihraW5lc3RoZXRpY1Njb3JlICogMS4zLCAxLjApXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIFJlY29yZCBiZWhhdmlvciBwYXR0ZXJuXG4gICAgaWYgKGluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5yZWNvcmRCZWhhdmlvclBhdHRlcm4odXNlcklkLCAnbWVzc2FnZV9hbmFseXNpcycsIG1lc3NhZ2UsIFxuICAgICAgICBpbmRpY2F0b3JzLm1hcChpID0+IGkuc3R5bGUpKVxuICAgIH1cblxuICAgIHJldHVybiBpbmRpY2F0b3JzLnNvcnQoKGEsIGIpID0+IGIud2VpZ2h0IC0gYS53ZWlnaHQpXG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYXRlcyBzY29yZSBiYXNlZCBvbiBrZXl3b3JkIGFuZCBwaHJhc2UgbWF0Y2hlc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY2FsY3VsYXRlS2V5d29yZFNjb3JlKHRleHQ6IHN0cmluZywga2V5d29yZHM6IHN0cmluZ1tdLCBwaHJhc2VzOiBzdHJpbmdbXSk6IG51bWJlciB7XG4gICAgbGV0IHNjb3JlID0gMFxuICAgIFxuICAgIC8vIEtleXdvcmQgbWF0Y2hlcyAobG93ZXIgd2VpZ2h0KVxuICAgIGZvciAoY29uc3Qga2V5d29yZCBvZiBrZXl3b3Jkcykge1xuICAgICAgaWYgKHRleHQuaW5jbHVkZXMoa2V5d29yZCkpIHtcbiAgICAgICAgc2NvcmUgKz0gMC4xXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFBocmFzZSBtYXRjaGVzIChoaWdoZXIgd2VpZ2h0KVxuICAgIGZvciAoY29uc3QgcGhyYXNlIG9mIHBocmFzZXMpIHtcbiAgICAgIGlmICh0ZXh0LmluY2x1ZGVzKHBocmFzZSkpIHtcbiAgICAgICAgc2NvcmUgKz0gMC4zXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBNYXRoLm1pbihzY29yZSwgMS4wKVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3RzIGV2aWRlbmNlIGZyb20gdGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdEV2aWRlbmNlKHRleHQ6IHN0cmluZywgcGF0dGVybnM6IHN0cmluZ1tdKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGV2aWRlbmNlOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHBhdHRlcm5zKSB7XG4gICAgICBpZiAodGV4dC5pbmNsdWRlcyhwYXR0ZXJuKSkge1xuICAgICAgICAvLyBFeHRyYWN0IHNlbnRlbmNlIGNvbnRhaW5pbmcgdGhlIHBhdHRlcm5cbiAgICAgICAgY29uc3Qgc2VudGVuY2VzID0gdGV4dC5zcGxpdCgvWy4hP10rLylcbiAgICAgICAgY29uc3QgbWF0Y2hpbmdTZW50ZW5jZSA9IHNlbnRlbmNlcy5maW5kKHNlbnRlbmNlID0+IFxuICAgICAgICAgIHNlbnRlbmNlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocGF0dGVybikpXG4gICAgICAgIGlmIChtYXRjaGluZ1NlbnRlbmNlKSB7XG4gICAgICAgICAgZXZpZGVuY2UucHVzaChtYXRjaGluZ1NlbnRlbmNlLnRyaW0oKSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZXZpZGVuY2Uuc2xpY2UoMCwgMykgLy8gTGltaXQgdG8gMyBwaWVjZXMgb2YgZXZpZGVuY2VcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWNvcmRzIGEgbGVhcm5pbmcgYmVoYXZpb3IgcGF0dGVyblxuICAgKi9cbiAgc3RhdGljIHJlY29yZEJlaGF2aW9yUGF0dGVybih1c2VySWQ6IHN0cmluZywgYWN0aW9uOiBzdHJpbmcsIGNvbnRleHQ6IHN0cmluZywgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGVJbmRpY2F0b3JzOiBMZWFybmluZ1N0eWxlW10pIHtcbiAgICB0aGlzLmJlaGF2aW9ycy5wdXNoKHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIGFjdGlvbixcbiAgICAgIGNvbnRleHQsXG4gICAgICBzdHlsZUluZGljYXRvcnNcbiAgICB9KVxuXG4gICAgLy8gS2VlcCBvbmx5IHJlY2VudCBiZWhhdmlvcnMgKGxhc3QgMTAwIHBlciB1c2VyKVxuICAgIGNvbnN0IHVzZXJCZWhhdmlvcnMgPSB0aGlzLmJlaGF2aW9ycy5maWx0ZXIoYiA9PiBiLnVzZXJJZCA9PT0gdXNlcklkKVxuICAgIGlmICh1c2VyQmVoYXZpb3JzLmxlbmd0aCA+IDEwMCkge1xuICAgICAgdGhpcy5iZWhhdmlvcnMgPSB0aGlzLmJlaGF2aW9ycy5maWx0ZXIoYiA9PiBiLnVzZXJJZCAhPT0gdXNlcklkKVxuICAgICAgICAuY29uY2F0KHVzZXJCZWhhdmlvcnMuc2xpY2UoLTEwMCkpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZXMgb3IgY3JlYXRlcyBsZWFybmluZyBwcm9maWxlIGZvciB1c2VyXG4gICAqL1xuICBzdGF0aWMgdXBkYXRlTGVhcm5pbmdQcm9maWxlKHVzZXJJZDogc3RyaW5nLCBpbmRpY2F0b3JzOiBMZWFybmluZ1N0eWxlSW5kaWNhdG9yW10sIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ/OiBzdHJpbmcpOiBMZWFybmluZ1Byb2ZpbGUge1xuICAgIGxldCBwcm9maWxlID0gdGhpcy5wcm9maWxlcy5nZXQodXNlcklkKSB8fCB0aGlzLmNyZWF0ZUluaXRpYWxQcm9maWxlKHVzZXJJZClcblxuICAgIC8vIFVwZGF0ZSBzdHlsZSBkaXN0cmlidXRpb24gYmFzZWQgb24gbmV3IGluZGljYXRvcnNcbiAgICBmb3IgKGNvbnN0IGluZGljYXRvciBvZiBpbmRpY2F0b3JzKSB7XG4gICAgICBjb25zdCB3ZWlnaHQgPSBpbmRpY2F0b3Iud2VpZ2h0ICogaW5kaWNhdG9yLmNvbmZpZGVuY2VcbiAgICAgIFxuICAgICAgc3dpdGNoIChpbmRpY2F0b3Iuc3R5bGUpIHtcbiAgICAgICAgY2FzZSBMZWFybmluZ1N0eWxlLlZJU1VBTDpcbiAgICAgICAgICBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLnZpc3VhbCA9IE1hdGgubWluKFxuICAgICAgICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi52aXN1YWwgKyB3ZWlnaHQgKiAwLjEsIDEuMClcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExlYXJuaW5nU3R5bGUuQVVESVRPUlk6XG4gICAgICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5hdWRpdG9yeSA9IE1hdGgubWluKFxuICAgICAgICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5hdWRpdG9yeSArIHdlaWdodCAqIDAuMSwgMS4wKVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTGVhcm5pbmdTdHlsZS5SRUFESU5HX1dSSVRJTkc6XG4gICAgICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5yZWFkaW5nX3dyaXRpbmcgPSBNYXRoLm1pbihcbiAgICAgICAgICAgIHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ucmVhZGluZ193cml0aW5nICsgd2VpZ2h0ICogMC4xLCAxLjApXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSBMZWFybmluZ1N0eWxlLktJTkVTVEhFVElDOlxuICAgICAgICAgIHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ua2luZXN0aGV0aWMgPSBNYXRoLm1pbihcbiAgICAgICAgICAgIHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ua2luZXN0aGV0aWMgKyB3ZWlnaHQgKiAwLjEsIDEuMClcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIE5vcm1hbGl6ZSBkaXN0cmlidXRpb25cbiAgICBjb25zdCB0b3RhbCA9IHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24udmlzdWFsICsgXG4gICAgICAgICAgICAgICAgICBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLmF1ZGl0b3J5ICtcbiAgICAgICAgICAgICAgICAgIHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ucmVhZGluZ193cml0aW5nICsgXG4gICAgICAgICAgICAgICAgICBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLmtpbmVzdGhldGljXG5cbiAgICBpZiAodG90YWwgPiAwKSB7XG4gICAgICBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLnZpc3VhbCAvPSB0b3RhbFxuICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5hdWRpdG9yeSAvPSB0b3RhbFxuICAgICAgcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5yZWFkaW5nX3dyaXRpbmcgLz0gdG90YWxcbiAgICAgIHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ua2luZXN0aGV0aWMgLz0gdG90YWxcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmUgcHJpbWFyeSBhbmQgc2Vjb25kYXJ5IHN0eWxlc1xuICAgIGNvbnN0IHN0eWxlcyA9IFtcbiAgICAgIHsgc3R5bGU6IExlYXJuaW5nU3R5bGUuVklTVUFMLCBzY29yZTogcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi52aXN1YWwgfSxcbiAgICAgIHsgc3R5bGU6IExlYXJuaW5nU3R5bGUuQVVESVRPUlksIHNjb3JlOiBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLmF1ZGl0b3J5IH0sXG4gICAgICB7IHN0eWxlOiBMZWFybmluZ1N0eWxlLlJFQURJTkdfV1JJVElORywgc2NvcmU6IHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24ucmVhZGluZ193cml0aW5nIH0sXG4gICAgICB7IHN0eWxlOiBMZWFybmluZ1N0eWxlLktJTkVTVEhFVElDLCBzY29yZTogcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5raW5lc3RoZXRpYyB9XG4gICAgXS5zb3J0KChhLCBiKSA9PiBiLnNjb3JlIC0gYS5zY29yZSlcblxuICAgIHByb2ZpbGUucHJpbWFyeVN0eWxlID0gc3R5bGVzWzBdLnNjb3JlID4gMC4zNSA/IHN0eWxlc1swXS5zdHlsZSA6IExlYXJuaW5nU3R5bGUuTVVMVElNT0RBTFxuICAgIHByb2ZpbGUuc2Vjb25kYXJ5U3R5bGUgPSBzdHlsZXNbMV0uc2NvcmUgPiAwLjI1ID8gc3R5bGVzWzFdLnN0eWxlIDogdW5kZWZpbmVkXG5cbiAgICAvLyBVcGRhdGUgYWRhcHRhdGlvbiBwcmVmZXJlbmNlc1xuICAgIHByb2ZpbGUuYWRhcHRhdGlvblByZWZlcmVuY2VzID0ge1xuICAgICAgcHJlZmVyc0RpYWdyYW1zOiBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLnZpc3VhbCA+IDAuMyxcbiAgICAgIHByZWZlcnNTdGVwQnlTdGVwOiBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLnJlYWRpbmdfd3JpdGluZyA+IDAuMyxcbiAgICAgIHByZWZlcnNFeGFtcGxlczogcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi52aXN1YWwgPiAwLjI1IHx8IFxuICAgICAgICAgICAgICAgICAgICAgICBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLmtpbmVzdGhldGljID4gMC4yNSxcbiAgICAgIHByZWZlcnNJbnRlcmFjdGlvbjogcHJvZmlsZS5zdHlsZURpc3RyaWJ1dGlvbi5raW5lc3RoZXRpYyA+IDAuMyxcbiAgICAgIHByZWZlcnNWaXN1YWxBaWRzOiBwcm9maWxlLnN0eWxlRGlzdHJpYnV0aW9uLnZpc3VhbCA+IDAuMjUsXG4gICAgICBwcmVmZXJzVmVyYmFsRXhwbGFuYXRpb246IHByb2ZpbGUuc3R5bGVEaXN0cmlidXRpb24uYXVkaXRvcnkgPiAwLjNcbiAgICB9XG5cbiAgICBwcm9maWxlLmxhc3RVcGRhdGVkID0gbmV3IERhdGUoKVxuICAgIHByb2ZpbGUuaW50ZXJhY3Rpb25zKytcbiAgICBcbiAgICB0aGlzLnByb2ZpbGVzLnNldCh1c2VySWQsIHByb2ZpbGUpXG4gICAgXG4gICAgY29uc29sZS5sb2coYPCfk4ogTGVhcm5pbmcgcHJvZmlsZSB1cGRhdGVkIGZvciAke3VzZXJJZH06IFByaW1hcnk9JHtwcm9maWxlLnByaW1hcnlTdHlsZX0sIFNlY29uZGFyeT0ke3Byb2ZpbGUuc2Vjb25kYXJ5U3R5bGUgfHwgJ25vbmUnfWApXG4gICAgXG4gICAgcmV0dXJuIHByb2ZpbGVcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGluaXRpYWwgbGVhcm5pbmcgcHJvZmlsZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlSW5pdGlhbFByb2ZpbGUodXNlcklkOiBzdHJpbmcpOiBMZWFybmluZ1Byb2ZpbGUge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VySWQsXG4gICAgICBwcmltYXJ5U3R5bGU6IExlYXJuaW5nU3R5bGUuTVVMVElNT0RBTCxcbiAgICAgIHNlY29uZGFyeVN0eWxlOiB1bmRlZmluZWQsXG4gICAgICBzdHlsZURpc3RyaWJ1dGlvbjoge1xuICAgICAgICB2aXN1YWw6IDAuMjUsXG4gICAgICAgIGF1ZGl0b3J5OiAwLjI1LFxuICAgICAgICByZWFkaW5nX3dyaXRpbmc6IDAuMjUsXG4gICAgICAgIGtpbmVzdGhldGljOiAwLjI1XG4gICAgICB9LFxuICAgICAgYWRhcHRhdGlvblByZWZlcmVuY2VzOiB7XG4gICAgICAgIHByZWZlcnNEaWFncmFtczogZmFsc2UsXG4gICAgICAgIHByZWZlcnNTdGVwQnlTdGVwOiB0cnVlLFxuICAgICAgICBwcmVmZXJzRXhhbXBsZXM6IHRydWUsXG4gICAgICAgIHByZWZlcnNJbnRlcmFjdGlvbjogZmFsc2UsXG4gICAgICAgIHByZWZlcnNWaXN1YWxBaWRzOiBmYWxzZSxcbiAgICAgICAgcHJlZmVyc1ZlcmJhbEV4cGxhbmF0aW9uOiBmYWxzZVxuICAgICAgfSxcbiAgICAgIGRldGVjdGVkRnJvbToge1xuICAgICAgICBtZXNzYWdlQW5hbHlzaXM6IDAsXG4gICAgICAgIGJlaGF2aW9yUGF0dGVybnM6IDAsXG4gICAgICAgIGV4cGxpY2l0UHJlZmVyZW5jZXM6IDBcbiAgICAgIH0sXG4gICAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKSxcbiAgICAgIGludGVyYWN0aW9uczogMFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGxlYXJuaW5nIHByb2ZpbGUgZm9yIHVzZXJcbiAgICovXG4gIHN0YXRpYyBnZXRMZWFybmluZ1Byb2ZpbGUodXNlcklkOiBzdHJpbmcpOiBMZWFybmluZ1Byb2ZpbGUge1xuICAgIHJldHVybiB0aGlzLnByb2ZpbGVzLmdldCh1c2VySWQpIHx8IHRoaXMuY3JlYXRlSW5pdGlhbFByb2ZpbGUodXNlcklkKVxuICB9XG5cbiAgLyoqXG4gICAqIEFkYXB0cyByZXNwb25zZSBjb250ZW50IGJhc2VkIG9uIGxlYXJuaW5nIHByb2ZpbGVcbiAgICovXG4gIHN0YXRpYyBhZGFwdFJlc3BvbnNlVG9MZWFybmluZ1N0eWxlKGNvbnRlbnQ6IHN0cmluZywgcHJvZmlsZTogTGVhcm5pbmdQcm9maWxlKTogc3RyaW5nIHtcbiAgICBsZXQgYWRhcHRlZENvbnRlbnQgPSBjb250ZW50XG5cbiAgICAvLyBWaXN1YWwgbGVhcm5lciBhZGFwdGF0aW9uc1xuICAgIGlmIChwcm9maWxlLmFkYXB0YXRpb25QcmVmZXJlbmNlcy5wcmVmZXJzVmlzdWFsQWlkcykge1xuICAgICAgYWRhcHRlZENvbnRlbnQgPSB0aGlzLmFkZFZpc3VhbEVsZW1lbnRzKGFkYXB0ZWRDb250ZW50LCBwcm9maWxlKVxuICAgIH1cblxuICAgIC8vIEF1ZGl0b3J5IGxlYXJuZXIgYWRhcHRhdGlvbnNcbiAgICBpZiAocHJvZmlsZS5hZGFwdGF0aW9uUHJlZmVyZW5jZXMucHJlZmVyc1ZlcmJhbEV4cGxhbmF0aW9uKSB7XG4gICAgICBhZGFwdGVkQ29udGVudCA9IHRoaXMuYWRkQXVkaXRvcnlFbGVtZW50cyhhZGFwdGVkQ29udGVudCwgcHJvZmlsZSlcbiAgICB9XG5cbiAgICAvLyBSZWFkaW5nL1dyaXRpbmcgbGVhcm5lciBhZGFwdGF0aW9uc1xuICAgIGlmIChwcm9maWxlLmFkYXB0YXRpb25QcmVmZXJlbmNlcy5wcmVmZXJzU3RlcEJ5U3RlcCkge1xuICAgICAgYWRhcHRlZENvbnRlbnQgPSB0aGlzLmFkZFN0cnVjdHVyZWRFbGVtZW50cyhhZGFwdGVkQ29udGVudCwgcHJvZmlsZSlcbiAgICB9XG5cbiAgICAvLyBLaW5lc3RoZXRpYyBsZWFybmVyIGFkYXB0YXRpb25zXG4gICAgaWYgKHByb2ZpbGUuYWRhcHRhdGlvblByZWZlcmVuY2VzLnByZWZlcnNJbnRlcmFjdGlvbikge1xuICAgICAgYWRhcHRlZENvbnRlbnQgPSB0aGlzLmFkZEludGVyYWN0aXZlRWxlbWVudHMoYWRhcHRlZENvbnRlbnQsIHByb2ZpbGUpXG4gICAgfVxuXG4gICAgcmV0dXJuIGFkYXB0ZWRDb250ZW50XG4gIH1cblxuICAvKipcbiAgICogQWRkcyB2aXN1YWwgZWxlbWVudHMgZm9yIHZpc3VhbCBsZWFybmVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYWRkVmlzdWFsRWxlbWVudHMoY29udGVudDogc3RyaW5nLCBwcm9maWxlOiBMZWFybmluZ1Byb2ZpbGUpOiBzdHJpbmcge1xuICAgIGxldCBlbmhhbmNlZCA9IGNvbnRlbnRcblxuICAgIC8vIEFkZCB2aXN1YWwgY3VlcyBhbmQgZm9ybWF0dGluZ1xuICAgIGVuaGFuY2VkID0gZW5oYW5jZWQucmVwbGFjZSgvaW1wb3J0YW50ZTovZ2ksICfwn5SNICoqSU1QT1JUQU5URToqKicpXG4gICAgZW5oYW5jZWQgPSBlbmhhbmNlZC5yZXBsYWNlKC9ub3RhOi9naSwgJ/Cfk50gKipOT1RBOioqJylcbiAgICBlbmhhbmNlZCA9IGVuaGFuY2VkLnJlcGxhY2UoL2VqZW1wbG86L2dpLCAn8J+SoSAqKkVKRU1QTE86KionKVxuICAgIGVuaGFuY2VkID0gZW5oYW5jZWQucmVwbGFjZSgvcmVzdWx0YWRvOi9naSwgJ+KchSAqKlJFU1VMVEFETzoqKicpXG5cbiAgICAvLyBBZGQgdmlzdWFsIHNlcGFyYXRvcnNcbiAgICBpZiAoZW5oYW5jZWQuaW5jbHVkZXMoJ3Bhc28nKSB8fCBlbmhhbmNlZC5pbmNsdWRlcygnc3RlcCcpKSB7XG4gICAgICBlbmhhbmNlZCA9IGVuaGFuY2VkLnJlcGxhY2UoL3Bhc28gKFxcZCspL2dpLCAnXFxu8J+TjSAqKlBBU08gJDEqKlxcbicpXG4gICAgfVxuXG4gICAgcmV0dXJuIGVuaGFuY2VkXG4gIH1cblxuICAvKipcbiAgICogQWRkcyBhdWRpdG9yeSBlbGVtZW50cyBmb3IgYXVkaXRvcnkgbGVhcm5lcnMgIFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYWRkQXVkaXRvcnlFbGVtZW50cyhjb250ZW50OiBzdHJpbmcsIHByb2ZpbGU6IExlYXJuaW5nUHJvZmlsZSk6IHN0cmluZyB7XG4gICAgbGV0IGVuaGFuY2VkID0gY29udGVudFxuXG4gICAgLy8gQWRkIGNvbnZlcnNhdGlvbmFsIHBocmFzZXNcbiAgICBlbmhhbmNlZCA9IFwi8J+Xo++4jyBUZSB2b3kgYSBleHBsaWNhciBlc3RvIHBhc28gYSBwYXNvOlxcblxcblwiICsgZW5oYW5jZWRcbiAgICBcbiAgICAvLyBBZGQgdmVyYmFsIHRyYW5zaXRpb24gcGhyYXNlc1xuICAgIGVuaGFuY2VkID0gZW5oYW5jZWQucmVwbGFjZSgvXFwuIChbQS1aXSkvZywgJy4gQWhvcmEsICQxJylcbiAgICBlbmhhbmNlZCA9IGVuaGFuY2VkLnJlcGxhY2UoLzpcXG4vZywgJy4gRXNjdWNoYSBiaWVuOlxcbicpXG5cbiAgICByZXR1cm4gZW5oYW5jZWRcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIHN0cnVjdHVyZWQgZWxlbWVudHMgZm9yIHJlYWRpbmcvd3JpdGluZyBsZWFybmVyc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYWRkU3RydWN0dXJlZEVsZW1lbnRzKGNvbnRlbnQ6IHN0cmluZywgcHJvZmlsZTogTGVhcm5pbmdQcm9maWxlKTogc3RyaW5nIHtcbiAgICBsZXQgZW5oYW5jZWQgPSBjb250ZW50XG5cbiAgICAvLyBBZGQgY2xlYXIgc3RydWN0dXJlIGFuZCBidWxsZXQgcG9pbnRzXG4gICAgaWYgKCFlbmhhbmNlZC5pbmNsdWRlcygnKionKSAmJiBlbmhhbmNlZC5sZW5ndGggPiAyMDApIHtcbiAgICAgIGNvbnN0IHNlbnRlbmNlcyA9IGVuaGFuY2VkLnNwbGl0KCcuJylcbiAgICAgIGlmIChzZW50ZW5jZXMubGVuZ3RoID4gMykge1xuICAgICAgICBlbmhhbmNlZCA9IHNlbnRlbmNlc1xuICAgICAgICAgIC5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICAgICAgICAubWFwKChzZW50ZW5jZSwgaW5kZXgpID0+IGAke2luZGV4ICsgMX0uICR7c2VudGVuY2UudHJpbSgpfWApXG4gICAgICAgICAgLmpvaW4oJ1xcbicpXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGVuaGFuY2VkXG4gIH1cblxuICAvKipcbiAgICogQWRkcyBpbnRlcmFjdGl2ZSBlbGVtZW50cyBmb3Iga2luZXN0aGV0aWMgbGVhcm5lcnNcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFkZEludGVyYWN0aXZlRWxlbWVudHMoY29udGVudDogc3RyaW5nLCBwcm9maWxlOiBMZWFybmluZ1Byb2ZpbGUpOiBzdHJpbmcge1xuICAgIGxldCBlbmhhbmNlZCA9IGNvbnRlbnRcblxuICAgIC8vIEFkZCBhY3Rpb24tb3JpZW50ZWQgbGFuZ3VhZ2VcbiAgICBlbmhhbmNlZCArPSBcIlxcblxcbvCfjq8gKipQcnVlYmEgZXN0bzoqKlwiXG4gICAgZW5oYW5jZWQgKz0gXCJcXG7igKIgQXBsaWNhIGVzdGUgY29uY2VwdG8gYSB1biBwcm9ibGVtYSByZWFsXCJcbiAgICBlbmhhbmNlZCArPSBcIlxcbuKAoiBFeHBlcmltZW50YSBjYW1iaWFuZG8gbG9zIHZhbG9yZXNcIlxuICAgIGVuaGFuY2VkICs9IFwiXFxu4oCiIFByYWN0aWNhIGNvbiBlamVyY2ljaW9zIHNpbWlsYXJlc1wiXG5cbiAgICByZXR1cm4gZW5oYW5jZWRcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFseXplcyBiZWhhdmlvciBwYXR0ZXJucyB0byBlbmhhbmNlIHByb2ZpbGVcbiAgICovXG4gIHN0YXRpYyBhbmFseXplQmVoYXZpb3JQYXR0ZXJucyh1c2VySWQ6IHN0cmluZyk6IExlYXJuaW5nUHJvZmlsZSB7XG4gICAgY29uc3QgdXNlckJlaGF2aW9ycyA9IHRoaXMuYmVoYXZpb3JzLmZpbHRlcihiID0+IGIudXNlcklkID09PSB1c2VySWQpXG4gICAgY29uc3QgcHJvZmlsZSA9IHRoaXMuZ2V0TGVhcm5pbmdQcm9maWxlKHVzZXJJZClcblxuICAgIGlmICh1c2VyQmVoYXZpb3JzLmxlbmd0aCA8IDUpIHJldHVybiBwcm9maWxlXG5cbiAgICAvLyBBbmFseXplIHBhdHRlcm5zIGluIHJlY2VudCBiZWhhdmlvcnNcbiAgICBjb25zdCByZWNlbnRCZWhhdmlvcnMgPSB1c2VyQmVoYXZpb3JzLnNsaWNlKC0yMClcbiAgICBjb25zdCBzdHlsZUZyZXF1ZW5jeSA9IG5ldyBNYXA8TGVhcm5pbmdTdHlsZSwgbnVtYmVyPigpXG5cbiAgICBmb3IgKGNvbnN0IGJlaGF2aW9yIG9mIHJlY2VudEJlaGF2aW9ycykge1xuICAgICAgZm9yIChjb25zdCBzdHlsZSBvZiBiZWhhdmlvci5zdHlsZUluZGljYXRvcnMpIHtcbiAgICAgICAgc3R5bGVGcmVxdWVuY3kuc2V0KHN0eWxlLCAoc3R5bGVGcmVxdWVuY3kuZ2V0KHN0eWxlKSB8fCAwKSArIDEpXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHByb2ZpbGUgYmFzZWQgb24gYmVoYXZpb3JhbCBwYXR0ZXJuc1xuICAgIGNvbnN0IGluZGljYXRvcnM6IExlYXJuaW5nU3R5bGVJbmRpY2F0b3JbXSA9IFtdXG4gICAgZm9yIChjb25zdCBbc3R5bGUsIGZyZXF1ZW5jeV0gb2Ygc3R5bGVGcmVxdWVuY3kuZW50cmllcygpKSB7XG4gICAgICBjb25zdCB3ZWlnaHQgPSBmcmVxdWVuY3kgLyByZWNlbnRCZWhhdmlvcnMubGVuZ3RoXG4gICAgICBpZiAod2VpZ2h0ID4gMC4xKSB7XG4gICAgICAgIGluZGljYXRvcnMucHVzaCh7XG4gICAgICAgICAgc3R5bGUsXG4gICAgICAgICAgd2VpZ2h0LFxuICAgICAgICAgIGV2aWRlbmNlOiBbYERldGVjdGFkbyBlbiAke2ZyZXF1ZW5jeX0gZGUgJHtyZWNlbnRCZWhhdmlvcnMubGVuZ3RofSBpbnRlcmFjY2lvbmVzIHJlY2llbnRlc2BdLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWluKHdlaWdodCAqIDIsIDEuMClcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy51cGRhdGVMZWFybmluZ1Byb2ZpbGUodXNlcklkLCBpbmRpY2F0b3JzLCAnYmVoYXZpb3JfYW5hbHlzaXMnKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgcHJvZmlsZSBzdGF0aXN0aWNzXG4gICAqL1xuICBzdGF0aWMgZ2V0UHJvZmlsZVN0YXRpc3RpY3ModXNlcklkPzogc3RyaW5nKTogYW55IHtcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBjb25zdCBwcm9maWxlID0gdGhpcy5wcm9maWxlcy5nZXQodXNlcklkKVxuICAgICAgY29uc3QgYmVoYXZpb3JzID0gdGhpcy5iZWhhdmlvcnMuZmlsdGVyKGIgPT4gYi51c2VySWQgPT09IHVzZXJJZClcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcHJvZmlsZTogcHJvZmlsZSB8fCBudWxsLFxuICAgICAgICBiZWhhdmlvckNvdW50OiBiZWhhdmlvcnMubGVuZ3RoLFxuICAgICAgICByZWNlbnRJbnRlcmFjdGlvbnM6IGJlaGF2aW9ycy5maWx0ZXIoYiA9PiBcbiAgICAgICAgICBiLnRpbWVzdGFtcCA+IG5ldyBEYXRlKERhdGUubm93KCkgLSA3ICogMjQgKiA2MCAqIDYwICogMTAwMClcbiAgICAgICAgKS5sZW5ndGhcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxQcm9maWxlczogdGhpcy5wcm9maWxlcy5zaXplLFxuICAgICAgdG90YWxCZWhhdmlvcnM6IHRoaXMuYmVoYXZpb3JzLmxlbmd0aCxcbiAgICAgIHN0eWxlRGlzdHJpYnV0aW9uOiB0aGlzLmdldEdsb2JhbFN0eWxlRGlzdHJpYnV0aW9uKClcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBnbG9iYWwgc3R5bGUgZGlzdHJpYnV0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBnZXRHbG9iYWxTdHlsZURpc3RyaWJ1dGlvbigpOiBhbnkge1xuICAgIGNvbnN0IGRpc3RyaWJ1dGlvbiA9IHtcbiAgICAgIHZpc3VhbDogMCxcbiAgICAgIGF1ZGl0b3J5OiAwLFxuICAgICAgcmVhZGluZ193cml0aW5nOiAwLFxuICAgICAga2luZXN0aGV0aWM6IDAsXG4gICAgICBtdWx0aW1vZGFsOiAwXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBwcm9maWxlIG9mIHRoaXMucHJvZmlsZXMudmFsdWVzKCkpIHtcbiAgICAgIHN3aXRjaCAocHJvZmlsZS5wcmltYXJ5U3R5bGUpIHtcbiAgICAgICAgY2FzZSBMZWFybmluZ1N0eWxlLlZJU1VBTDpcbiAgICAgICAgICBkaXN0cmlidXRpb24udmlzdWFsKytcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExlYXJuaW5nU3R5bGUuQVVESVRPUlk6XG4gICAgICAgICAgZGlzdHJpYnV0aW9uLmF1ZGl0b3J5KytcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIExlYXJuaW5nU3R5bGUuUkVBRElOR19XUklUSU5HOlxuICAgICAgICAgIGRpc3RyaWJ1dGlvbi5yZWFkaW5nX3dyaXRpbmcrK1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTGVhcm5pbmdTdHlsZS5LSU5FU1RIRVRJQzpcbiAgICAgICAgICBkaXN0cmlidXRpb24ua2luZXN0aGV0aWMrK1xuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTGVhcm5pbmdTdHlsZS5NVUxUSU1PREFMOlxuICAgICAgICAgIGRpc3RyaWJ1dGlvbi5tdWx0aW1vZGFsKytcbiAgICAgICAgICBicmVha1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBkaXN0cmlidXRpb25cbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNzIHVzZXIgbWVzc2FnZSBhbmQgdXBkYXRlIGxlYXJuaW5nIHByb2ZpbGVcbiAgICovXG4gIHN0YXRpYyBwcm9jZXNzVXNlck1lc3NhZ2UodXNlcklkOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZyk6IExlYXJuaW5nUHJvZmlsZSB7XG4gICAgLy8gQW5hbHl6ZSBtZXNzYWdlIGZvciBsZWFybmluZyBzdHlsZSBpbmRpY2F0b3JzXG4gICAgY29uc3QgaW5kaWNhdG9ycyA9IHRoaXMuYW5hbHl6ZU1lc3NhZ2VGb3JMZWFybmluZ1N0eWxlKG1lc3NhZ2UsIHVzZXJJZClcbiAgICBcbiAgICAvLyBVcGRhdGUgbGVhcm5pbmcgcHJvZmlsZSBpZiBpbmRpY2F0b3JzIGZvdW5kXG4gICAgaWYgKGluZGljYXRvcnMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIHRoaXMudXBkYXRlTGVhcm5pbmdQcm9maWxlKHVzZXJJZCwgaW5kaWNhdG9ycywgJ21lc3NhZ2VfcHJvY2Vzc2luZycpXG4gICAgfVxuICAgIFxuICAgIC8vIEFuYWx5emUgYmVoYXZpb3IgcGF0dGVybnMgcGVyaW9kaWNhbGx5XG4gICAgY29uc3QgcHJvZmlsZSA9IHRoaXMuZ2V0TGVhcm5pbmdQcm9maWxlKHVzZXJJZClcbiAgICBpZiAocHJvZmlsZS5pbnRlcmFjdGlvbnMgJSAxMCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRoaXMuYW5hbHl6ZUJlaGF2aW9yUGF0dGVybnModXNlcklkKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcHJvZmlsZVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyBsZWFybmluZyBzdHlsZSByZWNvbW1lbmRhdGlvbnMgZm9yIFNhcmFcbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZVN0eWxlUmVjb21tZW5kYXRpb25zKHByb2ZpbGU6IExlYXJuaW5nUHJvZmlsZSk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBzd2l0Y2ggKHByb2ZpbGUucHJpbWFyeVN0eWxlKSB7XG4gICAgICBjYXNlIExlYXJuaW5nU3R5bGUuVklTVUFMOlxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIlVzYXIgZGlhZ3JhbWFzIHkgZXNxdWVtYXMgY3VhbmRvIGV4cGxpY28gY29uY2VwdG9zXCIpXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiSW5jbHVpciBlamVtcGxvcyB2aXN1YWxlcyB5IGdyw6FmaWNvc1wiKVxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIkVzdHJ1Y3R1cmFyIGluZm9ybWFjacOzbiBjb24gdmnDsWV0YXMgeSBjb2xvcmVzXCIpXG4gICAgICAgIGJyZWFrXG4gICAgICAgIFxuICAgICAgY2FzZSBMZWFybmluZ1N0eWxlLkFVRElUT1JZOlxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIkV4cGxpY2FyIGNvbmNlcHRvcyBjb24gbGVuZ3VhamUgY29udmVyc2FjaW9uYWxcIilcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXCJVc2FyIGFuYWxvZ8OtYXMgeSBtZXTDoWZvcmFzIHZlcmJhbGVzXCIpXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiSW5jbHVpciBkaXNjdXNpb25lcyB5IHByZWd1bnRhcyBhYmllcnRhc1wiKVxuICAgICAgICBicmVha1xuICAgICAgICBcbiAgICAgIGNhc2UgTGVhcm5pbmdTdHlsZS5SRUFESU5HX1dSSVRJTkc6XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiUHJvcG9yY2lvbmFyIGluZm9ybWFjacOzbiBkZXRhbGxhZGEgcG9yIGVzY3JpdG9cIilcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXCJDcmVhciBsaXN0YXMgeSByZXPDum1lbmVzIGVzdHJ1Y3R1cmFkb3NcIilcbiAgICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2goXCJJbmNsdWlyIGRlZmluaWNpb25lcyB5IGRlc2NyaXBjaW9uZXMgcHJlY2lzYXNcIilcbiAgICAgICAgYnJlYWtcbiAgICAgICAgXG4gICAgICBjYXNlIExlYXJuaW5nU3R5bGUuS0lORVNUSEVUSUM6XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiSW5jbHVpciBlamVyY2ljaW9zIHByw6FjdGljb3MgeSBhY3RpdmlkYWRlc1wiKVxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIlN1Z2VyaXIgZXhwZXJpbWVudG9zIHkgYXBsaWNhY2lvbmVzIHJlYWxlc1wiKVxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIlVzYXIgZWplbXBsb3MgY29uY3JldG9zIHkgbWFuaXB1bGFibGVzXCIpXG4gICAgICAgIGJyZWFrXG4gICAgICAgIFxuICAgICAgY2FzZSBMZWFybmluZ1N0eWxlLk1VTFRJTU9EQUw6XG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiQ29tYmluYXIgbcO6bHRpcGxlcyBlbmZvcXVlcyBkZSBlbnNlw7FhbnphXCIpXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKFwiQWRhcHRhciBleHBsaWNhY2lvbmVzIHNlZ8O6biBlbCBjb250ZXh0b1wiKVxuICAgICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChcIk9mcmVjZXIgb3BjaW9uZXMgZGUgYXByZW5kaXphamUgdmFyaWFkYXNcIilcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9uc1xuICB9XG59Il0sIm5hbWVzIjpbIkxlYXJuaW5nU3R5bGUiLCJBZHZhbmNlZExlYXJuaW5nUHJvZmlsZU1hbmFnZXIiLCJwcm9maWxlcyIsIk1hcCIsImJlaGF2aW9ycyIsImFuYWx5emVNZXNzYWdlRm9yTGVhcm5pbmdTdHlsZSIsIm1lc3NhZ2UiLCJ1c2VySWQiLCJtc2dMb3dlciIsInRvTG93ZXJDYXNlIiwiaW5kaWNhdG9ycyIsInZpc3VhbEtleXdvcmRzIiwidmlzdWFsUGhyYXNlcyIsInZpc3VhbFNjb3JlIiwiY2FsY3VsYXRlS2V5d29yZFNjb3JlIiwicHVzaCIsInN0eWxlIiwid2VpZ2h0IiwiZXZpZGVuY2UiLCJleHRyYWN0RXZpZGVuY2UiLCJjb25maWRlbmNlIiwiTWF0aCIsIm1pbiIsImF1ZGl0b3J5S2V5d29yZHMiLCJhdWRpdG9yeVBocmFzZXMiLCJhdWRpdG9yeVNjb3JlIiwicmVhZFdyaXRlS2V5d29yZHMiLCJyZWFkV3JpdGVQaHJhc2VzIiwicmVhZFdyaXRlU2NvcmUiLCJraW5lc3RoZXRpY0tleXdvcmRzIiwia2luZXN0aGV0aWNQaHJhc2VzIiwia2luZXN0aGV0aWNTY29yZSIsImxlbmd0aCIsInJlY29yZEJlaGF2aW9yUGF0dGVybiIsIm1hcCIsImkiLCJzb3J0IiwiYSIsImIiLCJ0ZXh0Iiwia2V5d29yZHMiLCJwaHJhc2VzIiwic2NvcmUiLCJrZXl3b3JkIiwiaW5jbHVkZXMiLCJwaHJhc2UiLCJwYXR0ZXJucyIsInBhdHRlcm4iLCJzZW50ZW5jZXMiLCJzcGxpdCIsIm1hdGNoaW5nU2VudGVuY2UiLCJmaW5kIiwic2VudGVuY2UiLCJ0cmltIiwic2xpY2UiLCJhY3Rpb24iLCJjb250ZXh0Iiwic3R5bGVJbmRpY2F0b3JzIiwidGltZXN0YW1wIiwiRGF0ZSIsInVzZXJCZWhhdmlvcnMiLCJmaWx0ZXIiLCJjb25jYXQiLCJ1cGRhdGVMZWFybmluZ1Byb2ZpbGUiLCJwcm9maWxlIiwiZ2V0IiwiY3JlYXRlSW5pdGlhbFByb2ZpbGUiLCJpbmRpY2F0b3IiLCJzdHlsZURpc3RyaWJ1dGlvbiIsInZpc3VhbCIsImF1ZGl0b3J5IiwicmVhZGluZ193cml0aW5nIiwia2luZXN0aGV0aWMiLCJ0b3RhbCIsInN0eWxlcyIsInByaW1hcnlTdHlsZSIsInNlY29uZGFyeVN0eWxlIiwidW5kZWZpbmVkIiwiYWRhcHRhdGlvblByZWZlcmVuY2VzIiwicHJlZmVyc0RpYWdyYW1zIiwicHJlZmVyc1N0ZXBCeVN0ZXAiLCJwcmVmZXJzRXhhbXBsZXMiLCJwcmVmZXJzSW50ZXJhY3Rpb24iLCJwcmVmZXJzVmlzdWFsQWlkcyIsInByZWZlcnNWZXJiYWxFeHBsYW5hdGlvbiIsImxhc3RVcGRhdGVkIiwiaW50ZXJhY3Rpb25zIiwic2V0IiwiY29uc29sZSIsImxvZyIsImRldGVjdGVkRnJvbSIsIm1lc3NhZ2VBbmFseXNpcyIsImJlaGF2aW9yUGF0dGVybnMiLCJleHBsaWNpdFByZWZlcmVuY2VzIiwiZ2V0TGVhcm5pbmdQcm9maWxlIiwiYWRhcHRSZXNwb25zZVRvTGVhcm5pbmdTdHlsZSIsImNvbnRlbnQiLCJhZGFwdGVkQ29udGVudCIsImFkZFZpc3VhbEVsZW1lbnRzIiwiYWRkQXVkaXRvcnlFbGVtZW50cyIsImFkZFN0cnVjdHVyZWRFbGVtZW50cyIsImFkZEludGVyYWN0aXZlRWxlbWVudHMiLCJlbmhhbmNlZCIsInJlcGxhY2UiLCJzIiwiaW5kZXgiLCJqb2luIiwiYW5hbHl6ZUJlaGF2aW9yUGF0dGVybnMiLCJyZWNlbnRCZWhhdmlvcnMiLCJzdHlsZUZyZXF1ZW5jeSIsImJlaGF2aW9yIiwiZnJlcXVlbmN5IiwiZW50cmllcyIsImdldFByb2ZpbGVTdGF0aXN0aWNzIiwiYmVoYXZpb3JDb3VudCIsInJlY2VudEludGVyYWN0aW9ucyIsIm5vdyIsInRvdGFsUHJvZmlsZXMiLCJzaXplIiwidG90YWxCZWhhdmlvcnMiLCJnZXRHbG9iYWxTdHlsZURpc3RyaWJ1dGlvbiIsImRpc3RyaWJ1dGlvbiIsIm11bHRpbW9kYWwiLCJ2YWx1ZXMiLCJwcm9jZXNzVXNlck1lc3NhZ2UiLCJnZW5lcmF0ZVN0eWxlUmVjb21tZW5kYXRpb25zIiwicmVjb21tZW5kYXRpb25zIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/advanced-learning-profiles.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/ai-providers.ts":
/*!*********************************!*\
  !*** ./src/lib/ai-providers.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AIProvider: () => (/* binding */ AIProvider),\n/* harmony export */   AIProviderFactory: () => (/* binding */ AIProviderFactory),\n/* harmony export */   AIService: () => (/* binding */ AIService),\n/* harmony export */   AI_CONFIG: () => (/* binding */ AI_CONFIG),\n/* harmony export */   BaseAIProvider: () => (/* binding */ BaseAIProvider),\n/* harmony export */   GoogleGeminiProvider: () => (/* binding */ GoogleGeminiProvider),\n/* harmony export */   GroqProvider: () => (/* binding */ GroqProvider),\n/* harmony export */   HuggingFaceProvider: () => (/* binding */ HuggingFaceProvider),\n/* harmony export */   OllamaProvider: () => (/* binding */ OllamaProvider),\n/* harmony export */   TemplateProvider: () => (/* binding */ TemplateProvider),\n/* harmony export */   TransformersJSProvider: () => (/* binding */ TransformersJSProvider),\n/* harmony export */   aiService: () => (/* binding */ aiService)\n/* harmony export */ });\n// AI Providers Configuration\n// Supports multiple AI providers with fallback system\nvar AIProvider = /*#__PURE__*/ function(AIProvider) {\n    AIProvider[\"GOOGLE_GEMINI\"] = \"google_gemini\";\n    AIProvider[\"GROQ\"] = \"groq\";\n    AIProvider[\"HUGGING_FACE\"] = \"huggingface\";\n    AIProvider[\"OLLAMA_LOCAL\"] = \"ollama_local\";\n    AIProvider[\"TRANSFORMERS_JS\"] = \"transformers_js\";\n    AIProvider[\"TEMPLATES_ONLY\"] = \"templates_only\";\n    return AIProvider;\n}({});\n// Default configuration - Groq first for ultra-fast responses\nconst AI_CONFIG = [\n    {\n        provider: \"groq\",\n        apiKey: process.env.GROQ_API_KEY,\n        baseUrl: 'https://api.groq.com/openai/v1',\n        model: 'llama-3.3-70b-versatile',\n        enabled: !!process.env.GROQ_API_KEY\n    },\n    {\n        provider: \"google_gemini\",\n        apiKey: process.env.GOOGLE_AI_API_KEY,\n        model: 'gemini-1.5-flash',\n        enabled: !!process.env.GOOGLE_AI_API_KEY\n    },\n    {\n        provider: \"huggingface\",\n        apiKey: process.env.HUGGING_FACE_API_KEY,\n        baseUrl: 'https://api-inference.huggingface.co/models',\n        model: 'microsoft/DialoGPT-large',\n        enabled: !!process.env.HUGGING_FACE_API_KEY\n    },\n    {\n        provider: \"ollama_local\",\n        baseUrl: process.env.OLLAMA_URL || 'http://localhost:11434',\n        model: process.env.OLLAMA_MODEL || 'llama3.1:8b',\n        enabled: process.env.OLLAMA_ENABLED === 'true'\n    },\n    {\n        provider: \"transformers_js\",\n        enabled: process.env.TRANSFORMERS_JS_ENABLED === 'true'\n    },\n    {\n        provider: \"templates_only\",\n        enabled: true // Always available as final fallback\n    }\n];\n// Abstract AI Provider Interface\nclass BaseAIProvider {\n    constructor(config){\n        this.config = config;\n    }\n}\n// Google Gemini Provider\nclass GoogleGeminiProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        if (!this.config.apiKey) {\n            throw new Error('Google AI API key not configured');\n        }\n        const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${this.config.model}:generateContent?key=${this.config.apiKey}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                contents: [\n                    {\n                        parts: [\n                            {\n                                text: prompt\n                            }\n                        ]\n                    }\n                ],\n                generationConfig: {\n                    temperature: 0.7,\n                    topK: 1,\n                    topP: 1,\n                    maxOutputTokens: 500\n                }\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`Google AI API error: ${response.status}`);\n        }\n        const data = await response.json();\n        return data.candidates[0]?.content?.parts[0]?.text || 'Error generating content';\n    }\n    async isAvailable() {\n        return !!this.config.apiKey;\n    }\n}\n// Hugging Face Provider\nclass HuggingFaceProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        if (!this.config.apiKey) {\n            throw new Error('Hugging Face API key not configured');\n        }\n        const response = await fetch(`${this.config.baseUrl}/${this.config.model}`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${this.config.apiKey}`,\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                inputs: prompt,\n                parameters: {\n                    max_new_tokens: 300,\n                    temperature: 0.7,\n                    return_full_text: false\n                }\n            })\n        });\n        if (!response.ok) {\n            throw new Error(`Hugging Face API error: ${response.status}`);\n        }\n        const data = await response.json();\n        return data[0]?.generated_text || 'Error generating content';\n    }\n    async isAvailable() {\n        return !!this.config.apiKey;\n    }\n}\n// Ollama Local Provider\nclass OllamaProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        try {\n            const response = await fetch(`${this.config.baseUrl}/api/generate`, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                    model: this.config.model,\n                    prompt: prompt,\n                    stream: false,\n                    options: {\n                        temperature: 0.7,\n                        num_predict: 300\n                    }\n                })\n            });\n            if (!response.ok) {\n                throw new Error(`Ollama API error: ${response.status}`);\n            }\n            const data = await response.json();\n            return data.response || 'Error generating content';\n        } catch (error) {\n            throw new Error(`Ollama connection failed: ${error}`);\n        }\n    }\n    async isAvailable() {\n        try {\n            const response = await fetch(`${this.config.baseUrl}/api/version`, {\n                method: 'GET',\n                signal: AbortSignal.timeout(3000) // 3 second timeout\n            });\n            return response.ok;\n        } catch  {\n            return false;\n        }\n    }\n}\n// Transformers.js Provider (Browser-based)\nclass TransformersJSProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        if (!this.pipeline) {\n            const { pipeline } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @xenova/transformers */ \"@xenova/transformers\"));\n            this.pipeline = await pipeline('text-generation', 'Xenova/gpt2');\n        }\n        const result = await this.pipeline(prompt, {\n            max_new_tokens: 150,\n            temperature: 0.7\n        });\n        return result[0]?.generated_text?.replace(prompt, '').trim() || 'Error generating content';\n    }\n    async isAvailable() {\n        try {\n            await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @xenova/transformers */ \"@xenova/transformers\"));\n            return true;\n        } catch  {\n            return false;\n        }\n    }\n    constructor(...args){\n        super(...args), this.pipeline = null;\n    }\n}\n// Groq Provider\nclass GroqProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        if (!this.config.apiKey) {\n            throw new Error('Groq API key not configured');\n        }\n        const response = await fetch(`${this.config.baseUrl}/chat/completions`, {\n            method: 'POST',\n            headers: {\n                'Authorization': `Bearer ${this.config.apiKey}`,\n                'Content-Type': 'application/json'\n            },\n            body: JSON.stringify({\n                model: this.config.model,\n                messages: [\n                    {\n                        role: 'system',\n                        content: 'Eres Sara, un asistente personal académico especializado en ayudar a estudiantes con organización, planificación y aprendizaje. Responde de manera clara, práctica y motivacional.'\n                    },\n                    {\n                        role: 'user',\n                        content: prompt\n                    }\n                ],\n                temperature: 0.7,\n                max_tokens: 500,\n                top_p: 0.9\n            })\n        });\n        if (!response.ok) {\n            const errorData = await response.text();\n            throw new Error(`Groq API error (${response.status}): ${errorData}`);\n        }\n        const data = await response.json();\n        return data.choices[0]?.message?.content || 'Error generating content';\n    }\n    async isAvailable() {\n        if (!this.config.apiKey) return false;\n        try {\n            const response = await fetch(`${this.config.baseUrl}/models`, {\n                method: 'GET',\n                headers: {\n                    'Authorization': `Bearer ${this.config.apiKey}`\n                },\n                signal: AbortSignal.timeout(5000) // 5 second timeout\n            });\n            return response.ok;\n        } catch  {\n            return false;\n        }\n    }\n}\n// Template Provider (Always Available Fallback)\nclass TemplateProvider extends BaseAIProvider {\n    async generateExercise(prompt) {\n        // This will use the existing template system\n        return 'TEMPLATE_FALLBACK';\n    }\n    async isAvailable() {\n        return true;\n    }\n}\n// Provider Factory\nclass AIProviderFactory {\n    static createProvider(config) {\n        switch(config.provider){\n            case \"google_gemini\":\n                return new GoogleGeminiProvider(config);\n            case \"groq\":\n                return new GroqProvider(config);\n            case \"huggingface\":\n                return new HuggingFaceProvider(config);\n            case \"ollama_local\":\n                return new OllamaProvider(config);\n            case \"transformers_js\":\n                return new TransformersJSProvider(config);\n            case \"templates_only\":\n                return new TemplateProvider(config);\n            default:\n                throw new Error(`Unknown AI provider: ${config.provider}`);\n        }\n    }\n}\n// Main AI Service with Fallback System\nclass AIService {\n    constructor(){\n        this.providers = [];\n        this.currentProviderIndex = 0;\n        this.initializeProviders();\n    }\n    initializeProviders() {\n        this.providers = AI_CONFIG.filter((config)=>config.enabled).map((config)=>AIProviderFactory.createProvider(config));\n    }\n    async generateExercise(prompt) {\n        for(let i = this.currentProviderIndex; i < this.providers.length; i++){\n            const provider = this.providers[i];\n            try {\n                const isAvailable = await provider.isAvailable();\n                if (!isAvailable) {\n                    console.log(`Provider ${i} not available, trying next...`);\n                    continue;\n                }\n                const result = await provider.generateExercise(prompt);\n                if (result === 'TEMPLATE_FALLBACK') {\n                    return result // Special marker for template system\n                    ;\n                }\n                if (result && result.length > 10) {\n                    this.currentProviderIndex = i // Remember working provider\n                    ;\n                    return result;\n                }\n            } catch (error) {\n                console.error(`Provider ${i} failed:`, error);\n                continue;\n            }\n        }\n        // If all providers fail, return template fallback marker\n        return 'TEMPLATE_FALLBACK';\n    }\n    async getAvailableProviders() {\n        const available = [];\n        for(let i = 0; i < this.providers.length; i++){\n            try {\n                const isAvailable = await this.providers[i].isAvailable();\n                if (isAvailable) {\n                    available.push(AI_CONFIG[i].provider);\n                }\n            } catch  {\n            // Provider not available\n            }\n        }\n        return available;\n    }\n}\n// Export singleton instance\nconst aiService = new AIService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBRUQsSUFBSztZQUM5QyxJQUFJO2dCQUNGLE1BQU1yQyxjQUFjLE1BQU0sSUFBSSxDQUFDZ0MsU0FBUyxDQUFDSyxFQUFFLENBQUNyQyxXQUFXO2dCQUN2RCxJQUFJQSxhQUFhO29CQUNmMEMsVUFBVUMsSUFBSSxDQUFDdEYsU0FBUyxDQUFDZ0YsRUFBRSxDQUFDL0UsUUFBUTtnQkFDdEM7WUFDRixFQUFFLE9BQU07WUFDTix5QkFBeUI7WUFDM0I7UUFDRjtRQUNBLE9BQU9vRjtJQUNUO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDckIsTUFBTUUsWUFBWSxJQUFJYixZQUFXIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL2FpLXByb3ZpZGVycy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBBSSBQcm92aWRlcnMgQ29uZmlndXJhdGlvblxuLy8gU3VwcG9ydHMgbXVsdGlwbGUgQUkgcHJvdmlkZXJzIHdpdGggZmFsbGJhY2sgc3lzdGVtXG5cbmV4cG9ydCBlbnVtIEFJUHJvdmlkZXIge1xuICBHT09HTEVfR0VNSU5JID0gJ2dvb2dsZV9nZW1pbmknLFxuICBHUk9RID0gJ2dyb3EnLFxuICBIVUdHSU5HX0ZBQ0UgPSAnaHVnZ2luZ2ZhY2UnLFxuICBPTExBTUFfTE9DQUwgPSAnb2xsYW1hX2xvY2FsJyxcbiAgVFJBTlNGT1JNRVJTX0pTID0gJ3RyYW5zZm9ybWVyc19qcycsXG4gIFRFTVBMQVRFU19PTkxZID0gJ3RlbXBsYXRlc19vbmx5J1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFJQ29uZmlnIHtcbiAgcHJvdmlkZXI6IEFJUHJvdmlkZXJcbiAgYXBpS2V5Pzogc3RyaW5nXG4gIGJhc2VVcmw/OiBzdHJpbmdcbiAgbW9kZWw/OiBzdHJpbmdcbiAgZW5hYmxlZDogYm9vbGVhblxufVxuXG4vLyBEZWZhdWx0IGNvbmZpZ3VyYXRpb24gLSBHcm9xIGZpcnN0IGZvciB1bHRyYS1mYXN0IHJlc3BvbnNlc1xuZXhwb3J0IGNvbnN0IEFJX0NPTkZJRzogQUlDb25maWdbXSA9IFtcbiAge1xuICAgIHByb3ZpZGVyOiBBSVByb3ZpZGVyLkdST1EsXG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVksXG4gICAgYmFzZVVybDogJ2h0dHBzOi8vYXBpLmdyb3EuY29tL29wZW5haS92MScsXG4gICAgbW9kZWw6ICdsbGFtYS0zLjMtNzBiLXZlcnNhdGlsZScsIC8vIFVsdHJhLWZhc3Q6IDI0OSB0b2tlbnMvc2VjXG4gICAgZW5hYmxlZDogISFwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVlcbiAgfSxcbiAge1xuICAgIHByb3ZpZGVyOiBBSVByb3ZpZGVyLkdPT0dMRV9HRU1JTkksXG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5HT09HTEVfQUlfQVBJX0tFWSxcbiAgICBtb2RlbDogJ2dlbWluaS0xLjUtZmxhc2gnLCAvLyBGcmVlIHRpZXIgbW9kZWwgLSBiYWNrdXBcbiAgICBlbmFibGVkOiAhIXByb2Nlc3MuZW52LkdPT0dMRV9BSV9BUElfS0VZXG4gIH0sXG4gIHtcbiAgICBwcm92aWRlcjogQUlQcm92aWRlci5IVUdHSU5HX0ZBQ0UsXG4gICAgYXBpS2V5OiBwcm9jZXNzLmVudi5IVUdHSU5HX0ZBQ0VfQVBJX0tFWSxcbiAgICBiYXNlVXJsOiAnaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscycsXG4gICAgbW9kZWw6ICdtaWNyb3NvZnQvRGlhbG9HUFQtbGFyZ2UnLCAvLyBHb29kIGZvciBlZHVjYXRpb25hbCBjb250ZW50XG4gICAgZW5hYmxlZDogISFwcm9jZXNzLmVudi5IVUdHSU5HX0ZBQ0VfQVBJX0tFWVxuICB9LFxuICB7XG4gICAgcHJvdmlkZXI6IEFJUHJvdmlkZXIuT0xMQU1BX0xPQ0FMLFxuICAgIGJhc2VVcmw6IHByb2Nlc3MuZW52Lk9MTEFNQV9VUkwgfHwgJ2h0dHA6Ly9sb2NhbGhvc3Q6MTE0MzQnLFxuICAgIG1vZGVsOiBwcm9jZXNzLmVudi5PTExBTUFfTU9ERUwgfHwgJ2xsYW1hMy4xOjhiJyxcbiAgICBlbmFibGVkOiBwcm9jZXNzLmVudi5PTExBTUFfRU5BQkxFRCA9PT0gJ3RydWUnXG4gIH0sXG4gIHtcbiAgICBwcm92aWRlcjogQUlQcm92aWRlci5UUkFOU0ZPUk1FUlNfSlMsXG4gICAgZW5hYmxlZDogcHJvY2Vzcy5lbnYuVFJBTlNGT1JNRVJTX0pTX0VOQUJMRUQgPT09ICd0cnVlJ1xuICB9LFxuICB7XG4gICAgcHJvdmlkZXI6IEFJUHJvdmlkZXIuVEVNUExBVEVTX09OTFksXG4gICAgZW5hYmxlZDogdHJ1ZSAvLyBBbHdheXMgYXZhaWxhYmxlIGFzIGZpbmFsIGZhbGxiYWNrXG4gIH1cbl1cblxuLy8gQWJzdHJhY3QgQUkgUHJvdmlkZXIgSW50ZXJmYWNlXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgQmFzZUFJUHJvdmlkZXIge1xuICBwcm90ZWN0ZWQgY29uZmlnOiBBSUNvbmZpZ1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZzogQUlDb25maWcpIHtcbiAgICB0aGlzLmNvbmZpZyA9IGNvbmZpZ1xuICB9XG5cbiAgYWJzdHJhY3QgZ2VuZXJhdGVFeGVyY2lzZShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPlxuICBhYnN0cmFjdCBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+XG59XG5cbi8vIEdvb2dsZSBHZW1pbmkgUHJvdmlkZXJcbmV4cG9ydCBjbGFzcyBHb29nbGVHZW1pbmlQcm92aWRlciBleHRlbmRzIEJhc2VBSVByb3ZpZGVyIHtcbiAgYXN5bmMgZ2VuZXJhdGVFeGVyY2lzZShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignR29vZ2xlIEFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZ2VuZXJhdGl2ZWxhbmd1YWdlLmdvb2dsZWFwaXMuY29tL3YxYmV0YS9tb2RlbHMvJHt0aGlzLmNvbmZpZy5tb2RlbH06Z2VuZXJhdGVDb250ZW50P2tleT0ke3RoaXMuY29uZmlnLmFwaUtleX1gLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGNvbnRlbnRzOiBbe1xuICAgICAgICAgIHBhcnRzOiBbe1xuICAgICAgICAgICAgdGV4dDogcHJvbXB0XG4gICAgICAgICAgfV1cbiAgICAgICAgfV0sXG4gICAgICAgIGdlbmVyYXRpb25Db25maWc6IHtcbiAgICAgICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgICAgIHRvcEs6IDEsXG4gICAgICAgICAgdG9wUDogMSxcbiAgICAgICAgICBtYXhPdXRwdXRUb2tlbnM6IDUwMCxcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9KVxuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBHb29nbGUgQUkgQVBJIGVycm9yOiAke3Jlc3BvbnNlLnN0YXR1c31gKVxuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICByZXR1cm4gZGF0YS5jYW5kaWRhdGVzWzBdPy5jb250ZW50Py5wYXJ0c1swXT8udGV4dCB8fCAnRXJyb3IgZ2VuZXJhdGluZyBjb250ZW50J1xuICB9XG5cbiAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5XG4gIH1cbn1cblxuLy8gSHVnZ2luZyBGYWNlIFByb3ZpZGVyXG5leHBvcnQgY2xhc3MgSHVnZ2luZ0ZhY2VQcm92aWRlciBleHRlbmRzIEJhc2VBSVByb3ZpZGVyIHtcbiAgYXN5bmMgZ2VuZXJhdGVFeGVyY2lzZShwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgaWYgKCF0aGlzLmNvbmZpZy5hcGlLZXkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignSHVnZ2luZyBGYWNlIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vJHt0aGlzLmNvbmZpZy5tb2RlbH1gLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5jb25maWcuYXBpS2V5fWAsXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBpbnB1dHM6IHByb21wdCxcbiAgICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICAgIG1heF9uZXdfdG9rZW5zOiAzMDAsXG4gICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICByZXR1cm5fZnVsbF90ZXh0OiBmYWxzZVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEh1Z2dpbmcgRmFjZSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfWApXG4gICAgfVxuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIHJldHVybiBkYXRhWzBdPy5nZW5lcmF0ZWRfdGV4dCB8fCAnRXJyb3IgZ2VuZXJhdGluZyBjb250ZW50J1xuICB9XG5cbiAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuICEhdGhpcy5jb25maWcuYXBpS2V5XG4gIH1cbn1cblxuLy8gT2xsYW1hIExvY2FsIFByb3ZpZGVyXG5leHBvcnQgY2xhc3MgT2xsYW1hUHJvdmlkZXIgZXh0ZW5kcyBCYXNlQUlQcm92aWRlciB7XG4gIGFzeW5jIGdlbmVyYXRlRXhlcmNpc2UocHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3RoaXMuY29uZmlnLmJhc2VVcmx9L2FwaS9nZW5lcmF0ZWAsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgbW9kZWw6IHRoaXMuY29uZmlnLm1vZGVsLFxuICAgICAgICAgIHByb21wdDogcHJvbXB0LFxuICAgICAgICAgIHN0cmVhbTogZmFsc2UsXG4gICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgIG51bV9wcmVkaWN0OiAzMDBcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICB9KVxuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgT2xsYW1hIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9YClcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgcmV0dXJuIGRhdGEucmVzcG9uc2UgfHwgJ0Vycm9yIGdlbmVyYXRpbmcgY29udGVudCdcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBPbGxhbWEgY29ubmVjdGlvbiBmYWlsZWQ6ICR7ZXJyb3J9YClcbiAgICB9XG4gIH1cblxuICBhc3luYyBpc0F2YWlsYWJsZSgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS9hcGkvdmVyc2lvbmAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDMwMDApIC8vIDMgc2Vjb25kIHRpbWVvdXRcbiAgICAgIH0pXG4gICAgICByZXR1cm4gcmVzcG9uc2Uub2tcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxufVxuXG4vLyBUcmFuc2Zvcm1lcnMuanMgUHJvdmlkZXIgKEJyb3dzZXItYmFzZWQpXG5leHBvcnQgY2xhc3MgVHJhbnNmb3JtZXJzSlNQcm92aWRlciBleHRlbmRzIEJhc2VBSVByb3ZpZGVyIHtcbiAgcHJpdmF0ZSBwaXBlbGluZTogYW55ID0gbnVsbFxuXG4gIGFzeW5jIGdlbmVyYXRlRXhlcmNpc2UocHJvbXB0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGlmICghdGhpcy5waXBlbGluZSkge1xuICAgICAgY29uc3QgeyBwaXBlbGluZSB9ID0gYXdhaXQgaW1wb3J0KCdAeGVub3ZhL3RyYW5zZm9ybWVycycpXG4gICAgICB0aGlzLnBpcGVsaW5lID0gYXdhaXQgcGlwZWxpbmUoJ3RleHQtZ2VuZXJhdGlvbicsICdYZW5vdmEvZ3B0MicpXG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5waXBlbGluZShwcm9tcHQsIHtcbiAgICAgIG1heF9uZXdfdG9rZW5zOiAxNTAsXG4gICAgICB0ZW1wZXJhdHVyZTogMC43XG4gICAgfSlcblxuICAgIHJldHVybiByZXN1bHRbMF0/LmdlbmVyYXRlZF90ZXh0Py5yZXBsYWNlKHByb21wdCwgJycpLnRyaW0oKSB8fCAnRXJyb3IgZ2VuZXJhdGluZyBjb250ZW50J1xuICB9XG5cbiAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGltcG9ydCgnQHhlbm92YS90cmFuc2Zvcm1lcnMnKVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxufVxuXG4vLyBHcm9xIFByb3ZpZGVyXG5leHBvcnQgY2xhc3MgR3JvcVByb3ZpZGVyIGV4dGVuZHMgQmFzZUFJUHJvdmlkZXIge1xuICBhc3luYyBnZW5lcmF0ZUV4ZXJjaXNlKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBpZiAoIXRoaXMuY29uZmlnLmFwaUtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdHcm9xIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQnKVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5jb25maWcuYmFzZVVybH0vY2hhdC9jb21wbGV0aW9uc2AsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YCxcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG1vZGVsOiB0aGlzLmNvbmZpZy5tb2RlbCxcbiAgICAgICAgbWVzc2FnZXM6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6ICdFcmVzIFNhcmEsIHVuIGFzaXN0ZW50ZSBwZXJzb25hbCBhY2Fkw6ltaWNvIGVzcGVjaWFsaXphZG8gZW4gYXl1ZGFyIGEgZXN0dWRpYW50ZXMgY29uIG9yZ2FuaXphY2nDs24sIHBsYW5pZmljYWNpw7NuIHkgYXByZW5kaXphamUuIFJlc3BvbmRlIGRlIG1hbmVyYSBjbGFyYSwgcHLDoWN0aWNhIHkgbW90aXZhY2lvbmFsLidcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICd1c2VyJyxcbiAgICAgICAgICAgIGNvbnRlbnQ6IHByb21wdFxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgbWF4X3Rva2VuczogNTAwLFxuICAgICAgICB0b3BfcDogMC45XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBlcnJvckRhdGEgPSBhd2FpdCByZXNwb25zZS50ZXh0KClcbiAgICAgIHRocm93IG5ldyBFcnJvcihgR3JvcSBBUEkgZXJyb3IgKCR7cmVzcG9uc2Uuc3RhdHVzfSk6ICR7ZXJyb3JEYXRhfWApXG4gICAgfVxuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIHJldHVybiBkYXRhLmNob2ljZXNbMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgJ0Vycm9yIGdlbmVyYXRpbmcgY29udGVudCdcbiAgfVxuXG4gIGFzeW5jIGlzQXZhaWxhYmxlKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgIGlmICghdGhpcy5jb25maWcuYXBpS2V5KSByZXR1cm4gZmFsc2VcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmNvbmZpZy5iYXNlVXJsfS9tb2RlbHNgLCB7XG4gICAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0aGlzLmNvbmZpZy5hcGlLZXl9YCxcbiAgICAgICAgfSxcbiAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDUwMDApIC8vIDUgc2Vjb25kIHRpbWVvdXRcbiAgICAgIH0pXG4gICAgICByZXR1cm4gcmVzcG9uc2Uub2tcbiAgICB9IGNhdGNoIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxufVxuXG4vLyBUZW1wbGF0ZSBQcm92aWRlciAoQWx3YXlzIEF2YWlsYWJsZSBGYWxsYmFjaylcbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZVByb3ZpZGVyIGV4dGVuZHMgQmFzZUFJUHJvdmlkZXIge1xuICBhc3luYyBnZW5lcmF0ZUV4ZXJjaXNlKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAvLyBUaGlzIHdpbGwgdXNlIHRoZSBleGlzdGluZyB0ZW1wbGF0ZSBzeXN0ZW1cbiAgICByZXR1cm4gJ1RFTVBMQVRFX0ZBTExCQUNLJ1xuICB9XG5cbiAgYXN5bmMgaXNBdmFpbGFibGUoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxufVxuXG4vLyBQcm92aWRlciBGYWN0b3J5XG5leHBvcnQgY2xhc3MgQUlQcm92aWRlckZhY3Rvcnkge1xuICBzdGF0aWMgY3JlYXRlUHJvdmlkZXIoY29uZmlnOiBBSUNvbmZpZyk6IEJhc2VBSVByb3ZpZGVyIHtcbiAgICBzd2l0Y2ggKGNvbmZpZy5wcm92aWRlcikge1xuICAgICAgY2FzZSBBSVByb3ZpZGVyLkdPT0dMRV9HRU1JTkk6XG4gICAgICAgIHJldHVybiBuZXcgR29vZ2xlR2VtaW5pUHJvdmlkZXIoY29uZmlnKVxuICAgICAgY2FzZSBBSVByb3ZpZGVyLkdST1E6XG4gICAgICAgIHJldHVybiBuZXcgR3JvcVByb3ZpZGVyKGNvbmZpZylcbiAgICAgIGNhc2UgQUlQcm92aWRlci5IVUdHSU5HX0ZBQ0U6XG4gICAgICAgIHJldHVybiBuZXcgSHVnZ2luZ0ZhY2VQcm92aWRlcihjb25maWcpXG4gICAgICBjYXNlIEFJUHJvdmlkZXIuT0xMQU1BX0xPQ0FMOlxuICAgICAgICByZXR1cm4gbmV3IE9sbGFtYVByb3ZpZGVyKGNvbmZpZylcbiAgICAgIGNhc2UgQUlQcm92aWRlci5UUkFOU0ZPUk1FUlNfSlM6XG4gICAgICAgIHJldHVybiBuZXcgVHJhbnNmb3JtZXJzSlNQcm92aWRlcihjb25maWcpXG4gICAgICBjYXNlIEFJUHJvdmlkZXIuVEVNUExBVEVTX09OTFk6XG4gICAgICAgIHJldHVybiBuZXcgVGVtcGxhdGVQcm92aWRlcihjb25maWcpXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gQUkgcHJvdmlkZXI6ICR7Y29uZmlnLnByb3ZpZGVyfWApXG4gICAgfVxuICB9XG59XG5cbi8vIE1haW4gQUkgU2VydmljZSB3aXRoIEZhbGxiYWNrIFN5c3RlbVxuZXhwb3J0IGNsYXNzIEFJU2VydmljZSB7XG4gIHByaXZhdGUgcHJvdmlkZXJzOiBCYXNlQUlQcm92aWRlcltdID0gW11cbiAgcHJpdmF0ZSBjdXJyZW50UHJvdmlkZXJJbmRleCA9IDBcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmluaXRpYWxpemVQcm92aWRlcnMoKVxuICB9XG5cbiAgcHJpdmF0ZSBpbml0aWFsaXplUHJvdmlkZXJzKCkge1xuICAgIHRoaXMucHJvdmlkZXJzID0gQUlfQ09ORklHXG4gICAgICAuZmlsdGVyKGNvbmZpZyA9PiBjb25maWcuZW5hYmxlZClcbiAgICAgIC5tYXAoY29uZmlnID0+IEFJUHJvdmlkZXJGYWN0b3J5LmNyZWF0ZVByb3ZpZGVyKGNvbmZpZykpXG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUV4ZXJjaXNlKHByb21wdDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBmb3IgKGxldCBpID0gdGhpcy5jdXJyZW50UHJvdmlkZXJJbmRleDsgaSA8IHRoaXMucHJvdmlkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBwcm92aWRlciA9IHRoaXMucHJvdmlkZXJzW2ldXG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGlzQXZhaWxhYmxlID0gYXdhaXQgcHJvdmlkZXIuaXNBdmFpbGFibGUoKVxuICAgICAgICBpZiAoIWlzQXZhaWxhYmxlKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYFByb3ZpZGVyICR7aX0gbm90IGF2YWlsYWJsZSwgdHJ5aW5nIG5leHQuLi5gKVxuICAgICAgICAgIGNvbnRpbnVlXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcm92aWRlci5nZW5lcmF0ZUV4ZXJjaXNlKHByb21wdClcbiAgICAgICAgXG4gICAgICAgIGlmIChyZXN1bHQgPT09ICdURU1QTEFURV9GQUxMQkFDSycpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0IC8vIFNwZWNpYWwgbWFya2VyIGZvciB0ZW1wbGF0ZSBzeXN0ZW1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQubGVuZ3RoID4gMTApIHsgLy8gQmFzaWMgcXVhbGl0eSBjaGVja1xuICAgICAgICAgIHRoaXMuY3VycmVudFByb3ZpZGVySW5kZXggPSBpIC8vIFJlbWVtYmVyIHdvcmtpbmcgcHJvdmlkZXJcbiAgICAgICAgICByZXR1cm4gcmVzdWx0XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFByb3ZpZGVyICR7aX0gZmFpbGVkOmAsIGVycm9yKVxuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIGFsbCBwcm92aWRlcnMgZmFpbCwgcmV0dXJuIHRlbXBsYXRlIGZhbGxiYWNrIG1hcmtlclxuICAgIHJldHVybiAnVEVNUExBVEVfRkFMTEJBQ0snXG4gIH1cblxuICBhc3luYyBnZXRBdmFpbGFibGVQcm92aWRlcnMoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgIGNvbnN0IGF2YWlsYWJsZSA9IFtdXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnByb3ZpZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaXNBdmFpbGFibGUgPSBhd2FpdCB0aGlzLnByb3ZpZGVyc1tpXS5pc0F2YWlsYWJsZSgpXG4gICAgICAgIGlmIChpc0F2YWlsYWJsZSkge1xuICAgICAgICAgIGF2YWlsYWJsZS5wdXNoKEFJX0NPTkZJR1tpXS5wcm92aWRlcilcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIC8vIFByb3ZpZGVyIG5vdCBhdmFpbGFibGVcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGF2YWlsYWJsZVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBhaVNlcnZpY2UgPSBuZXcgQUlTZXJ2aWNlKCkiXSwibmFtZXMiOlsiQUlQcm92aWRlciIsIkFJX0NPTkZJRyIsInByb3ZpZGVyIiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkdST1FfQVBJX0tFWSIsImJhc2VVcmwiLCJtb2RlbCIsImVuYWJsZWQiLCJHT09HTEVfQUlfQVBJX0tFWSIsIkhVR0dJTkdfRkFDRV9BUElfS0VZIiwiT0xMQU1BX1VSTCIsIk9MTEFNQV9NT0RFTCIsIk9MTEFNQV9FTkFCTEVEIiwiVFJBTlNGT1JNRVJTX0pTX0VOQUJMRUQiLCJCYXNlQUlQcm92aWRlciIsImNvbnN0cnVjdG9yIiwiY29uZmlnIiwiR29vZ2xlR2VtaW5pUHJvdmlkZXIiLCJnZW5lcmF0ZUV4ZXJjaXNlIiwicHJvbXB0IiwiRXJyb3IiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY29udGVudHMiLCJwYXJ0cyIsInRleHQiLCJnZW5lcmF0aW9uQ29uZmlnIiwidGVtcGVyYXR1cmUiLCJ0b3BLIiwidG9wUCIsIm1heE91dHB1dFRva2VucyIsIm9rIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJjYW5kaWRhdGVzIiwiY29udGVudCIsImlzQXZhaWxhYmxlIiwiSHVnZ2luZ0ZhY2VQcm92aWRlciIsImlucHV0cyIsInBhcmFtZXRlcnMiLCJtYXhfbmV3X3Rva2VucyIsInJldHVybl9mdWxsX3RleHQiLCJnZW5lcmF0ZWRfdGV4dCIsIk9sbGFtYVByb3ZpZGVyIiwic3RyZWFtIiwib3B0aW9ucyIsIm51bV9wcmVkaWN0IiwiZXJyb3IiLCJzaWduYWwiLCJBYm9ydFNpZ25hbCIsInRpbWVvdXQiLCJUcmFuc2Zvcm1lcnNKU1Byb3ZpZGVyIiwicGlwZWxpbmUiLCJyZXN1bHQiLCJyZXBsYWNlIiwidHJpbSIsIkdyb3FQcm92aWRlciIsIm1lc3NhZ2VzIiwicm9sZSIsIm1heF90b2tlbnMiLCJ0b3BfcCIsImVycm9yRGF0YSIsImNob2ljZXMiLCJtZXNzYWdlIiwiVGVtcGxhdGVQcm92aWRlciIsIkFJUHJvdmlkZXJGYWN0b3J5IiwiY3JlYXRlUHJvdmlkZXIiLCJBSVNlcnZpY2UiLCJwcm92aWRlcnMiLCJjdXJyZW50UHJvdmlkZXJJbmRleCIsImluaXRpYWxpemVQcm92aWRlcnMiLCJmaWx0ZXIiLCJtYXAiLCJpIiwibGVuZ3RoIiwiY29uc29sZSIsImxvZyIsImdldEF2YWlsYWJsZVByb3ZpZGVycyIsImF2YWlsYWJsZSIsInB1c2giLCJhaVNlcnZpY2UiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/ai-providers.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/auth.ts":
/*!*************************!*\
  !*** ./src/lib/auth.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var _hybrid_storage__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./hybrid-storage */ \"(rsc)/./src/lib/hybrid-storage.ts\");\n\n\n\nconst authOptions = {\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                // Find user in database\n                const user = await (0,_hybrid_storage__WEBPACK_IMPORTED_MODULE_2__.findUserByEmail)(credentials.email);\n                if (!user || !user.password) {\n                    return null;\n                }\n                const isPasswordValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_1__[\"default\"].compare(credentials.password, user.password);\n                if (!isPasswordValid) {\n                    return null;\n                }\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.name,\n                    role: user.role,\n                    studentId: user.studentId || undefined\n                };\n            }\n        })\n    ],\n    session: {\n        strategy: \"jwt\"\n    },\n    callbacks: {\n        async jwt ({ token, user }) {\n            if (user) {\n                token.role = user.role;\n                token.studentId = user.studentId;\n            }\n            return token;\n        },\n        async session ({ session, token }) {\n            if (token) {\n                session.user.id = token.sub;\n                session.user.role = token.role;\n                session.user.studentId = token.studentId;\n            }\n            return session;\n        },\n        async redirect ({ url, baseUrl }) {\n            // Handle internal redirects\n            if (url.startsWith(\"/\")) return `${baseUrl}${url}`;\n            else if (new URL(url).origin === baseUrl) return url;\n            // Default to home page for external redirects\n            return baseUrl;\n        },\n        async signIn ({ user, account, profile }) {\n            return true;\n        }\n    },\n    pages: {\n        signIn: \"/auth/signin\"\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2F1dGgudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNpRTtBQUNwQztBQUNxQjtBQUUzQyxNQUFNRyxjQUErQjtJQUMxQ0MsV0FBVztRQUNUSiwyRUFBbUJBLENBQUM7WUFDbEJLLE1BQU07WUFDTkMsYUFBYTtnQkFDWEMsT0FBTztvQkFBRUMsT0FBTztvQkFBU0MsTUFBTTtnQkFBUTtnQkFDdkNDLFVBQVU7b0JBQUVGLE9BQU87b0JBQVlDLE1BQU07Z0JBQVc7WUFDbEQ7WUFDQSxNQUFNRSxXQUFVTCxXQUFXO2dCQUN6QixJQUFJLENBQUNBLGFBQWFDLFNBQVMsQ0FBQ0QsYUFBYUksVUFBVTtvQkFDakQsT0FBTztnQkFDVDtnQkFFQSx3QkFBd0I7Z0JBQ3hCLE1BQU1FLE9BQU8sTUFBTVYsZ0VBQWVBLENBQUNJLFlBQVlDLEtBQUs7Z0JBRXBELElBQUksQ0FBQ0ssUUFBUSxDQUFDQSxLQUFLRixRQUFRLEVBQUU7b0JBQzNCLE9BQU87Z0JBQ1Q7Z0JBRUEsTUFBTUcsa0JBQWtCLE1BQU1aLHdEQUFjLENBQzFDSyxZQUFZSSxRQUFRLEVBQ3BCRSxLQUFLRixRQUFRO2dCQUdmLElBQUksQ0FBQ0csaUJBQWlCO29CQUNwQixPQUFPO2dCQUNUO2dCQUVBLE9BQU87b0JBQ0xFLElBQUlILEtBQUtHLEVBQUU7b0JBQ1hSLE9BQU9LLEtBQUtMLEtBQUs7b0JBQ2pCRixNQUFNTyxLQUFLUCxJQUFJO29CQUNmVyxNQUFNSixLQUFLSSxJQUFJO29CQUNmQyxXQUFXTCxLQUFLSyxTQUFTLElBQUlDO2dCQUMvQjtZQUNGO1FBQ0Y7S0FDRDtJQUNEQyxTQUFTO1FBQ1BDLFVBQVU7SUFDWjtJQUNBQyxXQUFXO1FBQ1QsTUFBTUMsS0FBSSxFQUFFQyxLQUFLLEVBQUVYLElBQUksRUFBRTtZQUN2QixJQUFJQSxNQUFNO2dCQUNSVyxNQUFNUCxJQUFJLEdBQUdKLEtBQUtJLElBQUk7Z0JBQ3RCTyxNQUFNTixTQUFTLEdBQUdMLEtBQUtLLFNBQVM7WUFDbEM7WUFDQSxPQUFPTTtRQUNUO1FBQ0EsTUFBTUosU0FBUSxFQUFFQSxPQUFPLEVBQUVJLEtBQUssRUFBRTtZQUM5QixJQUFJQSxPQUFPO2dCQUNUSixRQUFRUCxJQUFJLENBQUNHLEVBQUUsR0FBR1EsTUFBTUMsR0FBRztnQkFDM0JMLFFBQVFQLElBQUksQ0FBQ0ksSUFBSSxHQUFHTyxNQUFNUCxJQUFJO2dCQUM5QkcsUUFBUVAsSUFBSSxDQUFDSyxTQUFTLEdBQUdNLE1BQU1OLFNBQVM7WUFDMUM7WUFDQSxPQUFPRTtRQUNUO1FBQ0EsTUFBTU0sVUFBUyxFQUFFQyxHQUFHLEVBQUVDLE9BQU8sRUFBRTtZQUM3Qiw0QkFBNEI7WUFDNUIsSUFBSUQsSUFBSUUsVUFBVSxDQUFDLE1BQU0sT0FBTyxHQUFHRCxVQUFVRCxLQUFLO2lCQUM3QyxJQUFJLElBQUlHLElBQUlILEtBQUtJLE1BQU0sS0FBS0gsU0FBUyxPQUFPRDtZQUVqRCw4Q0FBOEM7WUFDOUMsT0FBT0M7UUFDVDtRQUNBLE1BQU1JLFFBQU8sRUFBRW5CLElBQUksRUFBRW9CLE9BQU8sRUFBRUMsT0FBTyxFQUFFO1lBQ3JDLE9BQU87UUFDVDtJQUNGO0lBQ0FDLE9BQU87UUFDTEgsUUFBUTtJQUNWO0FBQ0YsRUFBQyIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9hdXRoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBdXRoT3B0aW9ucyB9IGZyb20gXCJuZXh0LWF1dGhcIlxuaW1wb3J0IENyZWRlbnRpYWxzUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHNcIlxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIlxuaW1wb3J0IHsgZmluZFVzZXJCeUVtYWlsIH0gZnJvbSBcIi4vaHlicmlkLXN0b3JhZ2VcIlxuXG5leHBvcnQgY29uc3QgYXV0aE9wdGlvbnM6IE5leHRBdXRoT3B0aW9ucyA9IHtcbiAgcHJvdmlkZXJzOiBbXG4gICAgQ3JlZGVudGlhbHNQcm92aWRlcih7XG4gICAgICBuYW1lOiBcImNyZWRlbnRpYWxzXCIsXG4gICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICBlbWFpbDogeyBsYWJlbDogXCJFbWFpbFwiLCB0eXBlOiBcImVtYWlsXCIgfSxcbiAgICAgICAgcGFzc3dvcmQ6IHsgbGFiZWw6IFwiUGFzc3dvcmRcIiwgdHlwZTogXCJwYXNzd29yZFwiIH1cbiAgICAgIH0sXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgaWYgKCFjcmVkZW50aWFscz8uZW1haWwgfHwgIWNyZWRlbnRpYWxzPy5wYXNzd29yZCkge1xuICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cblxuICAgICAgICAvLyBGaW5kIHVzZXIgaW4gZGF0YWJhc2VcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGZpbmRVc2VyQnlFbWFpbChjcmVkZW50aWFscy5lbWFpbClcblxuICAgICAgICBpZiAoIXVzZXIgfHwgIXVzZXIucGFzc3dvcmQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgICAgICAgY3JlZGVudGlhbHMucGFzc3dvcmQsXG4gICAgICAgICAgdXNlci5wYXNzd29yZFxuICAgICAgICApXG5cbiAgICAgICAgaWYgKCFpc1Bhc3N3b3JkVmFsaWQpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICBlbWFpbDogdXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgcm9sZTogdXNlci5yb2xlLFxuICAgICAgICAgIHN0dWRlbnRJZDogdXNlci5zdHVkZW50SWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgXSxcbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiBcImp3dFwiLFxuICB9LFxuICBjYWxsYmFja3M6IHtcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XG4gICAgICBpZiAodXNlcikge1xuICAgICAgICB0b2tlbi5yb2xlID0gdXNlci5yb2xlXG4gICAgICAgIHRva2VuLnN0dWRlbnRJZCA9IHVzZXIuc3R1ZGVudElkXG4gICAgICB9XG4gICAgICByZXR1cm4gdG9rZW5cbiAgICB9LFxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBpZiAodG9rZW4pIHtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkID0gdG9rZW4uc3ViIVxuICAgICAgICBzZXNzaW9uLnVzZXIucm9sZSA9IHRva2VuLnJvbGUgYXMgc3RyaW5nXG4gICAgICAgIHNlc3Npb24udXNlci5zdHVkZW50SWQgPSB0b2tlbi5zdHVkZW50SWQgYXMgc3RyaW5nXG4gICAgICB9XG4gICAgICByZXR1cm4gc2Vzc2lvblxuICAgIH0sXG4gICAgYXN5bmMgcmVkaXJlY3QoeyB1cmwsIGJhc2VVcmwgfSkge1xuICAgICAgLy8gSGFuZGxlIGludGVybmFsIHJlZGlyZWN0c1xuICAgICAgaWYgKHVybC5zdGFydHNXaXRoKFwiL1wiKSkgcmV0dXJuIGAke2Jhc2VVcmx9JHt1cmx9YFxuICAgICAgZWxzZSBpZiAobmV3IFVSTCh1cmwpLm9yaWdpbiA9PT0gYmFzZVVybCkgcmV0dXJuIHVybFxuICAgICAgXG4gICAgICAvLyBEZWZhdWx0IHRvIGhvbWUgcGFnZSBmb3IgZXh0ZXJuYWwgcmVkaXJlY3RzXG4gICAgICByZXR1cm4gYmFzZVVybFxuICAgIH0sXG4gICAgYXN5bmMgc2lnbkluKHsgdXNlciwgYWNjb3VudCwgcHJvZmlsZSB9KSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46IFwiL2F1dGgvc2lnbmluXCIsXG4gIH0sXG59Il0sIm5hbWVzIjpbIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJiY3J5cHQiLCJmaW5kVXNlckJ5RW1haWwiLCJhdXRoT3B0aW9ucyIsInByb3ZpZGVycyIsIm5hbWUiLCJjcmVkZW50aWFscyIsImVtYWlsIiwibGFiZWwiLCJ0eXBlIiwicGFzc3dvcmQiLCJhdXRob3JpemUiLCJ1c2VyIiwiaXNQYXNzd29yZFZhbGlkIiwiY29tcGFyZSIsImlkIiwicm9sZSIsInN0dWRlbnRJZCIsInVuZGVmaW5lZCIsInNlc3Npb24iLCJzdHJhdGVneSIsImNhbGxiYWNrcyIsImp3dCIsInRva2VuIiwic3ViIiwicmVkaXJlY3QiLCJ1cmwiLCJiYXNlVXJsIiwic3RhcnRzV2l0aCIsIlVSTCIsIm9yaWdpbiIsInNpZ25JbiIsImFjY291bnQiLCJwcm9maWxlIiwicGFnZXMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/calendar-ai-integration.ts":
/*!********************************************!*\
  !*** ./src/lib/calendar-ai-integration.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AICalendarIntegration: () => (/* binding */ AICalendarIntegration),\n/* harmony export */   analyzeConversationForEvents: () => (/* binding */ analyzeConversationForEvents),\n/* harmony export */   convertSuggestionToCalendarEvent: () => (/* binding */ convertSuggestionToCalendarEvent),\n/* harmony export */   createEventFromAI: () => (/* binding */ createEventFromAI),\n/* harmony export */   deleteEventFromAI: () => (/* binding */ deleteEventFromAI),\n/* harmony export */   editEventFromAI: () => (/* binding */ editEventFromAI),\n/* harmony export */   findUserEvents: () => (/* binding */ findUserEvents),\n/* harmony export */   generateEventQuestions: () => (/* binding */ generateEventQuestions),\n/* harmony export */   generateEventSuggestionResponse: () => (/* binding */ generateEventSuggestionResponse)\n/* harmony export */ });\n/* harmony import */ var _calendar_data__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n// Calendar AI Integration Service\n// Integra el sistema de IA tutora con el calendario para crear eventos automáticamente\n\n/**\n * Analiza una conversación con la IA para detectar menciones de eventos\n */ function analyzeConversationForEvents(conversationHistory) {\n    const userMessages = conversationHistory.filter((msg)=>msg.role === 'user').map((msg)=>msg.content).join(' ');\n    const analysis = {\n        hasEventMention: false,\n        eventSuggestions: [],\n        questions: [],\n        missingInfo: []\n    };\n    // Análisis más inteligente del último mensaje del usuario\n    const lastUserMessage = conversationHistory.length > 0 ? conversationHistory[conversationHistory.length - 1]?.content || userMessages : userMessages;\n    const msgLower = lastUserMessage.toLowerCase();\n    // Detectar intención de agendar/crear evento\n    const agendarPatterns = /agendes?|agend[aá]|cre[ae]|programa|anot[ae]|agrega/i;\n    const isRequestingToSchedule = agendarPatterns.test(lastUserMessage);\n    // Detectar intención de editar evento\n    const editarPatterns = /edit[ae]|modific[ae]|cambi[ae]|actualiz[ae]|reprograma/i;\n    const isRequestingToEdit = editarPatterns.test(lastUserMessage);\n    // Detectar intención de eliminar evento\n    const eliminarPatterns = /elimin[ae]|borr[ae]|quit[ae]|cancel[ae]|suprimi/i;\n    const isRequestingToDelete = eliminarPatterns.test(lastUserMessage);\n    // Detectar menciones de exámenes con mejor parsing\n    if (/(examen|evaluaci[oó]n|parcial|final|prueba|test)/i.test(lastUserMessage)) {\n        const eventData = extractEventDataFromMessage(lastUserMessage, 'exam');\n        if (eventData.hasEvent) {\n            // Normalizar subject con acentos correctos\n            const normalizedSubject = normalizeSubjectName(eventData.subject);\n            analysis.eventSuggestions.push({\n                type: 'exam',\n                title: normalizedSubject ? `Examen de ${normalizedSubject}` : 'Examen',\n                subject: normalizedSubject,\n                date: eventData.date,\n                startTime: eventData.startTime,\n                duration: eventData.duration || 120,\n                location: eventData.location,\n                description: eventData.description,\n                priority: 'high',\n                confidence: 0.9\n            });\n            analysis.hasEventMention = true;\n        }\n    } else if (/(estudiar|repasar|preparar|practicar|sesi[oó]n.*estudio)/i.test(lastUserMessage)) {\n        const eventData = extractEventDataFromMessage(lastUserMessage, 'study_session');\n        if (eventData.hasEvent) {\n            // Normalizar subject con acentos correctos\n            const normalizedSubject = normalizeSubjectName(eventData.subject) || 'Revisión General';\n            analysis.eventSuggestions.push({\n                type: 'study_session',\n                title: `Sesión de Estudio - ${normalizedSubject}`,\n                subject: normalizedSubject,\n                date: eventData.date,\n                startTime: eventData.startTime,\n                duration: eventData.duration || 90,\n                location: eventData.location,\n                description: eventData.description,\n                priority: 'medium',\n                confidence: 0.8\n            });\n            analysis.hasEventMention = true;\n        }\n    }\n    // Solo generar preguntas para información realmente faltante\n    if (analysis.eventSuggestions.length > 0) {\n        const suggestion = analysis.eventSuggestions[0];\n        const questions = [];\n        const missingInfo = [];\n        if (!suggestion.date) {\n            questions.push(\"📅 ¿Para qué fecha es?\");\n            missingInfo.push(\"fecha\");\n        }\n        if (!suggestion.startTime) {\n            questions.push(\"🕐 ¿A qué hora?\");\n            missingInfo.push(\"hora\");\n        }\n        if (suggestion.type === 'exam' && !suggestion.subject) {\n            questions.push(\"📚 ¿De qué materia es el examen?\");\n            missingInfo.push(\"materia\");\n        }\n        if (suggestion.type === 'exam' && !suggestion.location) {\n            questions.push(\"📍 ¿En qué aula será?\");\n            missingInfo.push(\"ubicación\");\n        }\n        // Solo agregar preguntas si realmente falta información\n        analysis.questions = questions;\n        analysis.missingInfo = missingInfo;\n    }\n    return analysis;\n}\n/**\n * Extrae datos específicos del evento desde el mensaje\n */ function extractEventDataFromMessage(message, eventType) {\n    const msgLower = message.toLowerCase();\n    // Extraer materia de manera más inteligente\n    let subject = null;\n    const subjectPatterns = [\n        /(?:examen|evaluaci[oó]n|parcial|final|prueba|test).*?(?:de|en)\\s+([a-záéíóúñ]+)/i,\n        /([a-záéíóúñ]+).*?(?:examen|evaluaci[oó]n|parcial|final|prueba|test)/i,\n        /(?:estudiar|repasar|preparar|practicar)\\s+([a-záéíóúñ]+)/i,\n        /(?:sesi[oó]n.*?(?:de|en)\\s+([a-záéíóúñ]+))/i\n    ];\n    for (const pattern of subjectPatterns){\n        const match = message.match(pattern);\n        if (match && match[1]) {\n            // Capitalizar primera letra\n            subject = match[1].charAt(0).toUpperCase() + match[1].slice(1).toLowerCase();\n            break;\n        }\n    }\n    // Extraer fecha de manera más inteligente\n    let date = null;\n    let startTime = null;\n    // Detectar fechas específicas (dd de mes, dd/mm, etc.)\n    const specificDatePatterns = [\n        /(\\d{1,2})\\s+de\\s+(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,\n        /(\\d{1,2})\\/(\\d{1,2})(?:\\/(\\d{2,4}))?/,\n        /(\\d{1,2})-(\\d{1,2})(?:-(\\d{2,4}))?/,\n        /el\\s+(\\d{1,2})/i\n    ];\n    for (const pattern of specificDatePatterns){\n        const match = message.match(pattern);\n        if (match) {\n            if (pattern.source.includes('de')) {\n                // \"10 de julio\"\n                const day = parseInt(match[1]);\n                const monthName = match[2].toLowerCase();\n                const monthMap = {\n                    'enero': 0,\n                    'febrero': 1,\n                    'marzo': 2,\n                    'abril': 3,\n                    'mayo': 4,\n                    'junio': 5,\n                    'julio': 6,\n                    'agosto': 7,\n                    'septiembre': 8,\n                    'octubre': 9,\n                    'noviembre': 10,\n                    'diciembre': 11\n                };\n                if (monthMap[monthName] !== undefined) {\n                    const now = new Date();\n                    const eventDate = new Date(now.getFullYear(), monthMap[monthName], day);\n                    date = eventDate.toISOString().split('T')[0];\n                }\n            } else if (match[1] && !isNaN(parseInt(match[1]))) {\n                // Formato dd/mm o dd-mm o \"el 10\"\n                const day = parseInt(match[1]);\n                const month = match[2] ? parseInt(match[2]) - 1 : new Date().getMonth();\n                const year = match[3] ? parseInt(match[3]) : new Date().getFullYear();\n                const eventDate = new Date(year, month, day);\n                date = eventDate.toISOString().split('T')[0];\n            }\n            break;\n        }\n    }\n    // Si no se encontró fecha específica, buscar días relativos\n    if (!date) {\n        const relativeDatePatterns = [\n            {\n                pattern: /ma[ñn]ana/i,\n                days: 1\n            },\n            {\n                pattern: /hoy/i,\n                days: 0\n            },\n            {\n                pattern: /pasado.*ma[ñn]ana/i,\n                days: 2\n            },\n            {\n                pattern: /lunes/i,\n                targetDay: 1\n            },\n            {\n                pattern: /martes/i,\n                targetDay: 2\n            },\n            {\n                pattern: /mi[eé]rcoles/i,\n                targetDay: 3\n            },\n            {\n                pattern: /jueves/i,\n                targetDay: 4\n            },\n            {\n                pattern: /viernes/i,\n                targetDay: 5\n            },\n            {\n                pattern: /s[aá]bado/i,\n                targetDay: 6\n            },\n            {\n                pattern: /domingo/i,\n                targetDay: 0\n            }\n        ];\n        for (const { pattern, days, targetDay } of relativeDatePatterns){\n            if (pattern.test(message)) {\n                const now = new Date();\n                let eventDate;\n                if (days !== undefined) {\n                    eventDate = new Date(now.getTime() + days * 24 * 60 * 60 * 1000);\n                } else if (targetDay !== undefined) {\n                    const currentDay = now.getDay();\n                    let daysToAdd = targetDay - currentDay;\n                    if (daysToAdd <= 0) daysToAdd += 7 // Próxima semana\n                    ;\n                    eventDate = new Date(now.getTime() + daysToAdd * 24 * 60 * 60 * 1000);\n                } else {\n                    continue;\n                }\n                date = eventDate.toISOString().split('T')[0];\n                break;\n            }\n        }\n    }\n    // Extraer hora de manera más inteligente\n    const timePatterns = [\n        /(?:a\\s+las?\\s+)?(\\d{1,2})(?::(\\d{2}))?\\s*(am|pm|a\\.?m\\.?|p\\.?m\\.?)/i,\n        /(?:a\\s+las?\\s+)?(\\d{1,2})(?::(\\d{2}))?\\s*h(?:oras?)?/i,\n        /(\\d{1,2})(?::(\\d{2}))?\\s*(?:de\\s+la\\s+)?(ma[ñn]ana|tarde|noche)/i\n    ];\n    for (const pattern of timePatterns){\n        const match = message.match(pattern);\n        if (match) {\n            let hour = parseInt(match[1]);\n            const minute = match[2] ? parseInt(match[2]) : 0;\n            const period = match[3]?.toLowerCase();\n            // Convertir a formato 24h\n            if (period) {\n                if ((period.includes('pm') || period.includes('p.m') || period === 'tarde' || period === 'noche') && hour < 12) {\n                    hour += 12;\n                } else if ((period.includes('am') || period.includes('a.m') || period === 'ma[ñn]ana') && hour === 12) {\n                    hour = 0;\n                } else if (period === 'noche' && hour < 6) {\n                    hour += 12 // Para casos como \"3 de la noche\" = 15:00\n                    ;\n                }\n            }\n            startTime = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;\n            break;\n        }\n    }\n    // Extraer ubicación\n    let location = null;\n    const locationPatterns = [\n        /(?:en\\s+el?\\s+)?(aula|laboratorio|sala|auditorio)\\s+([a-zA-Z0-9]+)/i,\n        /(?:en\\s+)([a-zA-Z\\s]+(?:aula|laboratorio|sala|auditorio)[a-zA-Z0-9\\s]*)/i\n    ];\n    for (const pattern of locationPatterns){\n        const match = message.match(pattern);\n        if (match) {\n            location = match[0].replace(/^en\\s+/i, '').trim();\n            break;\n        }\n    }\n    // Extraer duración\n    let duration = null;\n    const durationMatch = message.match(/(?:durante\\s+)?(\\d+)\\s*(horas?|minutos?|min)/i);\n    if (durationMatch) {\n        const value = parseInt(durationMatch[1]);\n        const unit = durationMatch[2].toLowerCase();\n        duration = unit.includes('hora') ? value * 60 : value;\n    }\n    // Extraer descripción/tema específico si se menciona\n    let description = null;\n    const topicPatterns = [\n        /(?:sobre|tema|temas?)\\s+([a-záéíóúñ\\s]+?)(?:\\s+para|\\s+el|\\s+a|$)/i,\n        /(?:sobre)\\s+el\\s+tema\\s+([a-záéíóúñ\\s]+?)(?:\\s+para|\\s+el|\\s+a|$)/i\n    ];\n    for (const pattern of topicPatterns){\n        const match = message.match(pattern);\n        if (match && match[1] && match[1].trim().length > 3) {\n            description = match[1].trim();\n            break;\n        }\n    }\n    return {\n        hasEvent: true,\n        subject,\n        date,\n        startTime,\n        location,\n        duration,\n        description\n    };\n}\n/**\n * Genera preguntas para completar la información de un evento\n */ function generateEventQuestions(suggestion) {\n    const questions = [];\n    if (!suggestion.date) {\n        questions.push(\"📅 ¿Para qué fecha es?\");\n    }\n    if (!suggestion.startTime) {\n        questions.push(\"🕐 ¿A qué hora?\");\n    }\n    if (suggestion.type === 'exam') {\n        if (!suggestion.subject) {\n            questions.push(\"📚 ¿De qué materia es el examen?\");\n        }\n        if (!suggestion.location) {\n            questions.push(\"📍 ¿En qué aula o laboratorio será?\");\n        }\n        if (!suggestion.duration) {\n            questions.push(\"⏱️ ¿Cuánto tiempo durará?\");\n        }\n    }\n    if (suggestion.type === 'study_session') {\n        if (!suggestion.subject) {\n            questions.push(\"📖 ¿Qué tema vas a estudiar?\");\n        }\n        if (!suggestion.duration) {\n            questions.push(\"⏰ ¿Cuántas horas planeas estudiar?\");\n        }\n    }\n    if (suggestion.type === 'personal' || suggestion.type === 'extracurricular') {\n        if (!suggestion.location) {\n            questions.push(\"📍 ¿Dónde será?\");\n        }\n    }\n    return questions;\n}\n/**\n * Convierte una sugerencia de evento en un evento de calendario\n */ function convertSuggestionToCalendarEvent(suggestion, userId, additionalInfo) {\n    const merged = {\n        ...suggestion,\n        ...additionalInfo\n    };\n    // Procesar fecha\n    let eventDate = new Date();\n    if (merged.date) {\n        eventDate = parseDateFromText(merged.date);\n    }\n    // Procesar hora\n    let startTime = merged.startTime || '15:00';\n    let endTime = merged.startTime || '16:00';\n    if (merged.duration && merged.startTime) {\n        const start = new Date(`2000-01-01T${merged.startTime}:00`);\n        const end = new Date(start.getTime() + merged.duration * 60000);\n        endTime = end.toTimeString().substring(0, 5);\n    }\n    const event = {\n        id: `ai-event-${Date.now()}`,\n        title: merged.title,\n        date: eventDate,\n        startTime: startTime,\n        endTime: endTime,\n        type: merged.type,\n        color: (0,_calendar_data__WEBPACK_IMPORTED_MODULE_0__.getEventTypeColor)(merged.type),\n        subject: merged.subject,\n        location: merged.location,\n        description: merged.description || 'Creado automáticamente por IA Tutora',\n        priority: merged.priority || 'medium',\n        duration: merged.duration || 60\n    };\n    return event;\n}\n/**\n * Crea un evento automáticamente desde la IA usando el API endpoint dedicado\n */ async function createEventFromAI(suggestion, userId, additionalInfo) {\n    try {\n        const merged = {\n            ...suggestion,\n            ...additionalInfo\n        };\n        // Procesar fecha\n        let eventDate = new Date();\n        if (merged.date) {\n            eventDate = parseDateFromText(merged.date);\n        }\n        // Calcular endTime basado en duration y startTime\n        let endTime = merged.startTime || '16:00';\n        if (merged.duration && merged.startTime) {\n            const start = new Date(`2000-01-01T${merged.startTime}:00`);\n            const end = new Date(start.getTime() + merged.duration * 60000);\n            endTime = end.toTimeString().substring(0, 5);\n        }\n        const eventData = {\n            title: merged.title,\n            type: merged.type,\n            subject: merged.subject,\n            date: eventDate.toISOString(),\n            startTime: merged.startTime || '15:00',\n            endTime: endTime,\n            duration: merged.duration || 60,\n            location: merged.location,\n            description: merged.description || `Creado automáticamente por IA Tutora`,\n            priority: merged.priority || 'medium'\n        };\n        // For server-side execution, call the function directly instead of HTTP fetch\n        try {\n            const { createCalendarEvent } = __webpack_require__(/*! ../app/api/ai-calendar/create-event/route */ \"(rsc)/./src/app/api/ai-calendar/create-event/route.ts\");\n            const mockRequest = {\n                json: async ()=>eventData\n            };\n            const response1 = await createCalendarEvent(mockRequest);\n            const result = await response1.json();\n            return {\n                success: result.success,\n                event: result.event,\n                message: result.message\n            };\n        } catch (directCallError) {\n            console.log('Direct API call failed, trying alternative approach:', directCallError);\n            // Alternative: Use calendar-data functions directly\n            const { addCalendarEvent, getUserCalendarData, createUserCalendarData } = __webpack_require__(/*! ./calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n            // Ensure user has calendar data\n            let userData = getUserCalendarData(userId);\n            if (!userData) {\n                console.log(`🆕 Creating calendar data for user ${userId}`);\n                userData = createUserCalendarData(userId);\n            }\n            const calendarEvent = {\n                id: `ai-event-${Date.now()}`,\n                title: eventData.title,\n                date: new Date(eventData.date),\n                startTime: eventData.startTime,\n                endTime: eventData.endTime,\n                type: eventData.type,\n                color: '#3B82F6',\n                subject: eventData.subject,\n                location: eventData.location,\n                description: eventData.description,\n                priority: eventData.priority,\n                duration: eventData.duration\n            };\n            console.log(`📅 Creating event: ${calendarEvent.title} for ${eventData.date} at ${eventData.startTime}`);\n            const success = addCalendarEvent(userId, calendarEvent);\n            return {\n                success,\n                event: success ? calendarEvent : undefined,\n                message: success ? 'Evento creado exitosamente' : 'Error al crear evento'\n            };\n        }\n        const result = await response.json();\n        if (result.success) {\n            console.log(`🤖 IA confirmó creación: ${result.event.title}`);\n            // Disparar evento del lado del cliente para notificar componentes\n            if (false) {}\n            return {\n                success: true,\n                event: result.event,\n                message: result.message\n            };\n        } else {\n            console.error('❌ IA falló al crear evento:', result.error);\n            return {\n                success: false,\n                message: result.error || 'Error desconocido'\n            };\n        }\n    } catch (error) {\n        console.error('❌ Error in AI event creation:', error);\n        return {\n            success: false,\n            message: 'Error de conexión al crear evento'\n        };\n    }\n}\n/**\n * Parsea fechas desde texto natural\n */ function parseDateFromText(dateText) {\n    const text = dateText.toLowerCase();\n    const today = new Date();\n    if (text.includes('hoy')) {\n        return today;\n    }\n    if (text.includes('mañana') || text.includes('ma[ñn]ana')) {\n        const tomorrow = new Date(today);\n        tomorrow.setDate(today.getDate() + 1);\n        return tomorrow;\n    }\n    if (text.includes('pasado')) {\n        const dayAfterTomorrow = new Date(today);\n        dayAfterTomorrow.setDate(today.getDate() + 2);\n        return dayAfterTomorrow;\n    }\n    // Días de la semana\n    const dayMap = {\n        'lunes': 1,\n        'martes': 2,\n        'miércoles': 3,\n        'miercoles': 3,\n        'jueves': 4,\n        'viernes': 5,\n        'sábado': 6,\n        'sabado': 6,\n        'domingo': 0\n    };\n    for (const [dayName, dayNumber] of Object.entries(dayMap)){\n        if (text.includes(dayName)) {\n            const targetDate = new Date(today);\n            const currentDay = today.getDay();\n            let daysToAdd = dayNumber - currentDay;\n            if (daysToAdd <= 0) {\n                daysToAdd += 7 // Próxima semana\n                ;\n            }\n            targetDate.setDate(today.getDate() + daysToAdd);\n            return targetDate;\n        }\n    }\n    // Si incluye números (ej: \"en 3 días\")\n    const daysMatch = text.match(/en\\s+(\\d+)\\s+d[ií]as?/);\n    if (daysMatch) {\n        const days = parseInt(daysMatch[1]);\n        const futureDate = new Date(today);\n        futureDate.setDate(today.getDate() + days);\n        return futureDate;\n    }\n    // Por defecto, devolver mañana\n    const defaultDate = new Date(today);\n    defaultDate.setDate(today.getDate() + 1);\n    return defaultDate;\n}\n/**\n * Genera respuesta de la IA para sugerir crear eventos\n */ function generateEventSuggestionResponse(analysis) {\n    if (!analysis.hasEventMention || analysis.eventSuggestions.length === 0) {\n        return \"\";\n    }\n    const suggestion = analysis.eventSuggestions[0] // Tomar la primera sugerencia\n    ;\n    let response1 = `📅 Perfecto! Veo que quieres agendar: **${suggestion.title}**\\n\\n`;\n    // Mostrar información detectada\n    const detectedInfo = [];\n    if (suggestion.subject) detectedInfo.push(`📚 Materia: ${suggestion.subject}`);\n    if (suggestion.date) {\n        const dateObj = new Date(suggestion.date);\n        const formattedDate = dateObj.toLocaleDateString('es-ES', {\n            weekday: 'long',\n            day: 'numeric',\n            month: 'long'\n        });\n        detectedInfo.push(`📅 Fecha: ${formattedDate}`);\n    }\n    if (suggestion.startTime) detectedInfo.push(`🕐 Hora: ${suggestion.startTime}`);\n    if (suggestion.location) detectedInfo.push(`📍 Ubicación: ${suggestion.location}`);\n    if (detectedInfo.length > 0) {\n        response1 += `**Información detectada:**\\n${detectedInfo.join('\\n')}\\n\\n`;\n    }\n    if (analysis.questions.length > 0) {\n        response1 += `Para completar el evento necesito:\\n`;\n        analysis.questions.forEach((question, index)=>{\n            response1 += `${index + 1}. ${question}\\n`;\n        });\n        response1 += `\\n¿Podrías darme estos detalles?`;\n    } else {\n        response1 += `¡Tengo toda la información necesaria! ¿Confirmas que lo agregue a tu calendario?`;\n    }\n    return response1;\n}\n/**\n * Interfaz para el workflow completo de creación de eventos por IA\n */ class AICalendarIntegration {\n    constructor(userId){\n        this.pendingSuggestion = null;\n        this.collectedInfo = {};\n        this.userId = userId;\n    }\n    /**\n   * Procesa un mensaje del usuario y detecta si necesita crear eventos\n   */ async processMessage(message, conversationHistory) {\n        const analysis = analyzeConversationForEvents([\n            ...conversationHistory,\n            {\n                role: 'user',\n                content: message\n            }\n        ]);\n        if (analysis.hasEventMention && analysis.eventSuggestions.length > 0) {\n            this.pendingSuggestion = analysis.eventSuggestions[0];\n            if (analysis.questions.length > 0) {\n                return {\n                    needsEventCreation: true,\n                    response: generateEventSuggestionResponse(analysis),\n                    questions: analysis.questions\n                };\n            } else {\n                // Información completa, crear evento directamente\n                const result = await this.createPendingEvent();\n                return {\n                    needsEventCreation: true,\n                    response: result.success ? this.generateSuccessMessage(result.event) : `❌ ${result.message || 'Hubo un error al crear el evento. Por favor intenta nuevamente.'}`,\n                    event: result.event\n                };\n            }\n        }\n        return {\n            needsEventCreation: false\n        };\n    }\n    /**\n   * Recopila información adicional del usuario\n   */ collectAdditionalInfo(infoType, value) {\n        if (!this.pendingSuggestion) return false;\n        switch(infoType.toLowerCase()){\n            case 'fecha':\n                this.collectedInfo.date = value;\n                break;\n            case 'hora':\n                this.collectedInfo.startTime = value;\n                break;\n            case 'materia':\n            case 'tema':\n                this.collectedInfo.subject = value;\n                break;\n            case 'ubicación':\n            case 'ubicacion':\n                this.collectedInfo.location = value;\n                break;\n            case 'duración':\n            case 'duracion':\n                this.collectedInfo.duration = parseInt(value);\n                break;\n        }\n        return true;\n    }\n    /**\n   * Crea el evento pendiente con la información recopilada\n   */ async createPendingEvent() {\n        if (!this.pendingSuggestion) {\n            return {\n                success: false,\n                message: 'No hay evento pendiente'\n            };\n        }\n        const result = await createEventFromAI(this.pendingSuggestion, this.userId, this.collectedInfo);\n        if (result.success) {\n            this.pendingSuggestion = null;\n            this.collectedInfo = {};\n        }\n        return result;\n    }\n    /**\n   * Cancela la creación del evento pendiente\n   */ cancelPendingEvent() {\n        this.pendingSuggestion = null;\n        this.collectedInfo = {};\n    }\n    /**\n   * Obtiene la sugerencia pendiente\n   */ getPendingSuggestion() {\n        return this.pendingSuggestion;\n    }\n    /**\n   * Genera mensaje de éxito con detalles del evento creado\n   */ generateSuccessMessage(event) {\n        let message = `✅ ¡Perfecto! He creado \"${event.title}\" en tu calendario.`;\n        // Agregar detalles específicos\n        const details = [];\n        if (event.date) {\n            const dateStr = event.date.toLocaleDateString('es-ES', {\n                weekday: 'long',\n                day: 'numeric',\n                month: 'long'\n            });\n            details.push(`📅 **Fecha**: ${dateStr}`);\n        }\n        if (event.startTime) {\n            details.push(`🕐 **Hora**: ${event.startTime}`);\n        }\n        if (event.location) {\n            details.push(`📍 **Ubicación**: ${event.location}`);\n        }\n        if (event.subject && event.type === 'exam') {\n            details.push(`📚 **Materia**: ${event.subject}`);\n        }\n        if (event.description && !event.description.includes('Creado automáticamente')) {\n            details.push(`📝 **Tema**: ${event.description}`);\n        }\n        if (details.length > 0) {\n            message += `\\n\\n**Detalles del evento:**\\n${details.join('\\n')}`;\n        }\n        message += `\\n\\n🎯 Puedes ver todos tus eventos en la sección \"Organizador Inteligente\" de tu calendario.`;\n        return message;\n    }\n}\n/**\n * Busca eventos del usuario por texto de búsqueda\n */ function findUserEvents(userId, searchText) {\n    const userData = (0,_calendar_data__WEBPACK_IMPORTED_MODULE_0__.getUserCalendarData)(userId);\n    if (!userData) return [];\n    const search = searchText.toLowerCase();\n    return userData.events.filter((event)=>{\n        return event.title.toLowerCase().includes(search) || event.subject?.toLowerCase().includes(search) || event.description?.toLowerCase().includes(search) || event.location?.toLowerCase().includes(search);\n    });\n}\n/**\n * Edita un evento usando el API endpoint\n */ async function editEventFromAI(eventId, updates) {\n    try {\n        // For server-side execution, call the function directly\n        try {\n            const { updateCalendarEvent } = __webpack_require__(/*! ./calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n            const success = updateCalendarEvent(eventId, updates);\n            return {\n                success,\n                event: success ? {\n                    id: eventId,\n                    ...updates\n                } : undefined,\n                message: success ? 'Evento actualizado exitosamente' : 'Error al actualizar evento'\n            };\n        } catch (error) {\n            console.error('Error updating event:', error);\n            return {\n                success: false,\n                message: 'Error al actualizar evento'\n            };\n        }\n        const result = await response.json();\n        if (result.success) {\n            console.log(`🤖 IA editó evento: ${result.event.title}`);\n            // Disparar evento del lado del cliente\n            if (false) {}\n            return {\n                success: true,\n                event: result.event,\n                message: result.message\n            };\n        } else {\n            return {\n                success: false,\n                message: result.error || 'Error desconocido al editar'\n            };\n        }\n    } catch (error) {\n        console.error('❌ Error editing event from AI:', error);\n        return {\n            success: false,\n            message: 'Error de conexión al editar evento'\n        };\n    }\n}\n/**\n * Elimina un evento usando el API endpoint\n */ async function deleteEventFromAI(eventId) {\n    try {\n        // For server-side execution, call the function directly\n        try {\n            const { deleteCalendarEvent } = __webpack_require__(/*! ./calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n            const deletedEvent = deleteCalendarEvent(eventId);\n            return {\n                success: !!deletedEvent,\n                message: deletedEvent ? `Evento \"${deletedEvent.title}\" eliminado exitosamente` : 'Evento no encontrado'\n            };\n        } catch (error) {\n            console.error('Error deleting event:', error);\n            return {\n                success: false,\n                message: 'Error al eliminar evento'\n            };\n        }\n        const result = await response.json();\n        if (result.success) {\n            console.log(`🤖 IA eliminó evento: ${result.deletedEvent.title}`);\n            // Disparar evento del lado del cliente\n            if (false) {}\n            return {\n                success: true,\n                message: result.message\n            };\n        } else {\n            return {\n                success: false,\n                message: result.error || 'Error desconocido al eliminar'\n            };\n        }\n    } catch (error) {\n        console.error('❌ Error deleting event from AI:', error);\n        return {\n            success: false,\n            message: 'Error de conexión al eliminar evento'\n        };\n    }\n}\n/**\n * Normaliza nombres de materias con acentos y mayúsculas correctas\n */ function normalizeSubjectName(subject) {\n    if (!subject) return null;\n    const normalized = subject.toLowerCase().trim();\n    const subjectMap = {\n        'quimica': 'Química',\n        'química': 'Química',\n        'fisica': 'Física',\n        'física': 'Física',\n        'matematica': 'Matemática',\n        'matemáticas': 'Matemáticas',\n        'matematicas': 'Matemáticas',\n        'biologia': 'Biología',\n        'biología': 'Biología',\n        'historia': 'Historia',\n        'geografia': 'Geografía',\n        'geografía': 'Geografía',\n        'ingles': 'Inglés',\n        'inglés': 'Inglés',\n        'lengua': 'Lengua y Literatura',\n        'literatura': 'Lengua y Literatura',\n        'filosofia': 'Filosofía',\n        'filosofía': 'Filosofía',\n        'economia': 'Economía',\n        'economía': 'Economía',\n        'educacion fisica': 'Educación Física',\n        'educación física': 'Educación Física',\n        'ed fisica': 'Educación Física',\n        'arte': 'Arte',\n        'musica': 'Música',\n        'música': 'Música'\n    };\n    // Buscar coincidencia exacta primero\n    if (subjectMap[normalized]) {\n        return subjectMap[normalized];\n    }\n    // Buscar coincidencia parcial\n    for (const [key, value] of Object.entries(subjectMap)){\n        if (key.includes(normalized) || normalized.includes(key)) {\n            return value;\n        }\n    }\n    // Si no se encuentra, capitalizar primera letra\n    return subject.charAt(0).toUpperCase() + subject.slice(1).toLowerCase();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQ2RYLFFBQVFXLEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE9BQU87WUFDTGIsU0FBUztZQUNUbkUsU0FBUztRQUNYO0lBQ0Y7QUFDRjtBQUVBOztDQUVDLEdBQ0QsU0FBU2IscUJBQXFCQyxPQUF1QjtJQUNuRCxJQUFJLENBQUNBLFNBQVMsT0FBTztJQUVyQixNQUFNK0ksYUFBYS9JLFFBQVFiLFdBQVcsR0FBR2tFLElBQUk7SUFFN0MsTUFBTTJGLGFBQXFDO1FBQ3pDLFdBQVc7UUFDWCxXQUFXO1FBQ1gsVUFBVTtRQUNWLFVBQVU7UUFDVixjQUFjO1FBQ2QsZUFBZTtRQUNmLGVBQWU7UUFDZixZQUFZO1FBQ1osWUFBWTtRQUNaLFlBQVk7UUFDWixhQUFhO1FBQ2IsYUFBYTtRQUNiLFVBQVU7UUFDVixVQUFVO1FBQ1YsVUFBVTtRQUNWLGNBQWM7UUFDZCxhQUFhO1FBQ2IsYUFBYTtRQUNiLFlBQVk7UUFDWixZQUFZO1FBQ1osb0JBQW9CO1FBQ3BCLG9CQUFvQjtRQUNwQixhQUFhO1FBQ2IsUUFBUTtRQUNSLFVBQVU7UUFDVixVQUFVO0lBQ1o7SUFFQSxxQ0FBcUM7SUFDckMsSUFBSUEsVUFBVSxDQUFDRCxXQUFXLEVBQUU7UUFDMUIsT0FBT0MsVUFBVSxDQUFDRCxXQUFXO0lBQy9CO0lBRUEsOEJBQThCO0lBQzlCLEtBQUssTUFBTSxDQUFDRSxLQUFLMUYsTUFBTSxJQUFJZ0QsT0FBT0MsT0FBTyxDQUFDd0MsWUFBYTtRQUNyRCxJQUFJQyxJQUFJM0gsUUFBUSxDQUFDeUgsZUFBZUEsV0FBV3pILFFBQVEsQ0FBQzJILE1BQU07WUFDeEQsT0FBTzFGO1FBQ1Q7SUFDRjtJQUVBLGdEQUFnRDtJQUNoRCxPQUFPdkQsUUFBUWlCLE1BQU0sQ0FBQyxHQUFHQyxXQUFXLEtBQUtsQixRQUFRbUIsS0FBSyxDQUFDLEdBQUdoQyxXQUFXO0FBQ3ZFIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL2NhbGVuZGFyLWFpLWludGVncmF0aW9uLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIENhbGVuZGFyIEFJIEludGVncmF0aW9uIFNlcnZpY2Vcbi8vIEludGVncmEgZWwgc2lzdGVtYSBkZSBJQSB0dXRvcmEgY29uIGVsIGNhbGVuZGFyaW8gcGFyYSBjcmVhciBldmVudG9zIGF1dG9tw6F0aWNhbWVudGVcblxuaW1wb3J0IHsgQ2FsZW5kYXJFdmVudCwgYWRkQ2FsZW5kYXJFdmVudCwgZ2V0RXZlbnRUeXBlQ29sb3IsIGdldFVzZXJDYWxlbmRhckRhdGEgfSBmcm9tICcuL2NhbGVuZGFyLWRhdGEnXG5pbXBvcnQgeyBjb252ZXJzYXRpb25FbmdpbmUgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1lbmdpbmUnXG5cbmV4cG9ydCBpbnRlcmZhY2UgRXZlbnRTdWdnZXN0aW9uIHtcbiAgdHlwZTogJ2V4YW0nIHwgJ3N0dWR5X3Nlc3Npb24nIHwgJ3BlcnNvbmFsJyB8ICdleHRyYWN1cnJpY3VsYXInXG4gIHRpdGxlOiBzdHJpbmdcbiAgc3ViamVjdD86IHN0cmluZ1xuICBkYXRlPzogc3RyaW5nXG4gIHN0YXJ0VGltZT86IHN0cmluZ1xuICBkdXJhdGlvbj86IG51bWJlclxuICBsb2NhdGlvbj86IHN0cmluZ1xuICBkZXNjcmlwdGlvbj86IHN0cmluZ1xuICBwcmlvcml0eT86ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdydcbiAgY29uZmlkZW5jZTogbnVtYmVyIC8vIDAtMSBuaXZlbCBkZSBjb25maWFuemEgZW4gbGEgc3VnZXJlbmNpYVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnZlcnNhdGlvbkFuYWx5c2lzIHtcbiAgaGFzRXZlbnRNZW50aW9uOiBib29sZWFuXG4gIGV2ZW50U3VnZ2VzdGlvbnM6IEV2ZW50U3VnZ2VzdGlvbltdXG4gIHF1ZXN0aW9uczogc3RyaW5nW11cbiAgbWlzc2luZ0luZm86IHN0cmluZ1tdXG59XG5cbi8qKlxuICogQW5hbGl6YSB1bmEgY29udmVyc2FjacOzbiBjb24gbGEgSUEgcGFyYSBkZXRlY3RhciBtZW5jaW9uZXMgZGUgZXZlbnRvc1xuICovXG5leHBvcnQgZnVuY3Rpb24gYW5hbHl6ZUNvbnZlcnNhdGlvbkZvckV2ZW50cyhcbiAgY29udmVyc2F0aW9uSGlzdG9yeTogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nIH0+XG4pOiBDb252ZXJzYXRpb25BbmFseXNpcyB7XG4gIGNvbnN0IHVzZXJNZXNzYWdlcyA9IGNvbnZlcnNhdGlvbkhpc3RvcnlcbiAgICAuZmlsdGVyKG1zZyA9PiBtc2cucm9sZSA9PT0gJ3VzZXInKVxuICAgIC5tYXAobXNnID0+IG1zZy5jb250ZW50KVxuICAgIC5qb2luKCcgJylcblxuICBjb25zdCBhbmFseXNpczogQ29udmVyc2F0aW9uQW5hbHlzaXMgPSB7XG4gICAgaGFzRXZlbnRNZW50aW9uOiBmYWxzZSxcbiAgICBldmVudFN1Z2dlc3Rpb25zOiBbXSxcbiAgICBxdWVzdGlvbnM6IFtdLFxuICAgIG1pc3NpbmdJbmZvOiBbXVxuICB9XG5cbiAgLy8gQW7DoWxpc2lzIG3DoXMgaW50ZWxpZ2VudGUgZGVsIMO6bHRpbW8gbWVuc2FqZSBkZWwgdXN1YXJpb1xuICBjb25zdCBsYXN0VXNlck1lc3NhZ2UgPSBjb252ZXJzYXRpb25IaXN0b3J5Lmxlbmd0aCA+IDAgXG4gICAgPyBjb252ZXJzYXRpb25IaXN0b3J5W2NvbnZlcnNhdGlvbkhpc3RvcnkubGVuZ3RoIC0gMV0/LmNvbnRlbnQgfHwgdXNlck1lc3NhZ2VzXG4gICAgOiB1c2VyTWVzc2FnZXNcblxuICBjb25zdCBtc2dMb3dlciA9IGxhc3RVc2VyTWVzc2FnZS50b0xvd2VyQ2FzZSgpXG5cbiAgLy8gRGV0ZWN0YXIgaW50ZW5jacOzbiBkZSBhZ2VuZGFyL2NyZWFyIGV2ZW50b1xuICBjb25zdCBhZ2VuZGFyUGF0dGVybnMgPSAvYWdlbmRlcz98YWdlbmRbYcOhXXxjcmVbYWVdfHByb2dyYW1hfGFub3RbYWVdfGFncmVnYS9pXG4gIGNvbnN0IGlzUmVxdWVzdGluZ1RvU2NoZWR1bGUgPSBhZ2VuZGFyUGF0dGVybnMudGVzdChsYXN0VXNlck1lc3NhZ2UpXG4gIFxuICAvLyBEZXRlY3RhciBpbnRlbmNpw7NuIGRlIGVkaXRhciBldmVudG9cbiAgY29uc3QgZWRpdGFyUGF0dGVybnMgPSAvZWRpdFthZV18bW9kaWZpY1thZV18Y2FtYmlbYWVdfGFjdHVhbGl6W2FlXXxyZXByb2dyYW1hL2lcbiAgY29uc3QgaXNSZXF1ZXN0aW5nVG9FZGl0ID0gZWRpdGFyUGF0dGVybnMudGVzdChsYXN0VXNlck1lc3NhZ2UpXG4gIFxuICAvLyBEZXRlY3RhciBpbnRlbmNpw7NuIGRlIGVsaW1pbmFyIGV2ZW50b1xuICBjb25zdCBlbGltaW5hclBhdHRlcm5zID0gL2VsaW1pblthZV18Ym9yclthZV18cXVpdFthZV18Y2FuY2VsW2FlXXxzdXByaW1pL2lcbiAgY29uc3QgaXNSZXF1ZXN0aW5nVG9EZWxldGUgPSBlbGltaW5hclBhdHRlcm5zLnRlc3QobGFzdFVzZXJNZXNzYWdlKVxuXG4gIC8vIERldGVjdGFyIG1lbmNpb25lcyBkZSBleMOhbWVuZXMgY29uIG1lam9yIHBhcnNpbmdcbiAgaWYgKC8oZXhhbWVufGV2YWx1YWNpW2/Ds11ufHBhcmNpYWx8ZmluYWx8cHJ1ZWJhfHRlc3QpL2kudGVzdChsYXN0VXNlck1lc3NhZ2UpKSB7XG4gICAgY29uc3QgZXZlbnREYXRhID0gZXh0cmFjdEV2ZW50RGF0YUZyb21NZXNzYWdlKGxhc3RVc2VyTWVzc2FnZSwgJ2V4YW0nKVxuICAgIFxuICAgIGlmIChldmVudERhdGEuaGFzRXZlbnQpIHtcbiAgICAgIC8vIE5vcm1hbGl6YXIgc3ViamVjdCBjb24gYWNlbnRvcyBjb3JyZWN0b3NcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWRTdWJqZWN0ID0gbm9ybWFsaXplU3ViamVjdE5hbWUoZXZlbnREYXRhLnN1YmplY3QpXG4gICAgICBcbiAgICAgIGFuYWx5c2lzLmV2ZW50U3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdleGFtJyxcbiAgICAgICAgdGl0bGU6IG5vcm1hbGl6ZWRTdWJqZWN0ID8gYEV4YW1lbiBkZSAke25vcm1hbGl6ZWRTdWJqZWN0fWAgOiAnRXhhbWVuJyxcbiAgICAgICAgc3ViamVjdDogbm9ybWFsaXplZFN1YmplY3QsXG4gICAgICAgIGRhdGU6IGV2ZW50RGF0YS5kYXRlLFxuICAgICAgICBzdGFydFRpbWU6IGV2ZW50RGF0YS5zdGFydFRpbWUsXG4gICAgICAgIGR1cmF0aW9uOiBldmVudERhdGEuZHVyYXRpb24gfHwgMTIwLFxuICAgICAgICBsb2NhdGlvbjogZXZlbnREYXRhLmxvY2F0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXZlbnREYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBwcmlvcml0eTogJ2hpZ2gnLFxuICAgICAgICBjb25maWRlbmNlOiAwLjlcbiAgICAgIH0pXG4gICAgICBhbmFseXNpcy5oYXNFdmVudE1lbnRpb24gPSB0cnVlXG4gICAgfVxuICB9XG5cbiAgLy8gRGV0ZWN0YXIgbWVuY2lvbmVzIGRlIGVzdHVkaW9cbiAgZWxzZSBpZiAoLyhlc3R1ZGlhcnxyZXBhc2FyfHByZXBhcmFyfHByYWN0aWNhcnxzZXNpW2/Ds11uLiplc3R1ZGlvKS9pLnRlc3QobGFzdFVzZXJNZXNzYWdlKSkge1xuICAgIGNvbnN0IGV2ZW50RGF0YSA9IGV4dHJhY3RFdmVudERhdGFGcm9tTWVzc2FnZShsYXN0VXNlck1lc3NhZ2UsICdzdHVkeV9zZXNzaW9uJylcbiAgICBcbiAgICBpZiAoZXZlbnREYXRhLmhhc0V2ZW50KSB7XG4gICAgICAvLyBOb3JtYWxpemFyIHN1YmplY3QgY29uIGFjZW50b3MgY29ycmVjdG9zXG4gICAgICBjb25zdCBub3JtYWxpemVkU3ViamVjdCA9IG5vcm1hbGl6ZVN1YmplY3ROYW1lKGV2ZW50RGF0YS5zdWJqZWN0KSB8fCAnUmV2aXNpw7NuIEdlbmVyYWwnXG4gICAgICBcbiAgICAgIGFuYWx5c2lzLmV2ZW50U3VnZ2VzdGlvbnMucHVzaCh7XG4gICAgICAgIHR5cGU6ICdzdHVkeV9zZXNzaW9uJyxcbiAgICAgICAgdGl0bGU6IGBTZXNpw7NuIGRlIEVzdHVkaW8gLSAke25vcm1hbGl6ZWRTdWJqZWN0fWAsXG4gICAgICAgIHN1YmplY3Q6IG5vcm1hbGl6ZWRTdWJqZWN0LFxuICAgICAgICBkYXRlOiBldmVudERhdGEuZGF0ZSxcbiAgICAgICAgc3RhcnRUaW1lOiBldmVudERhdGEuc3RhcnRUaW1lLFxuICAgICAgICBkdXJhdGlvbjogZXZlbnREYXRhLmR1cmF0aW9uIHx8IDkwLFxuICAgICAgICBsb2NhdGlvbjogZXZlbnREYXRhLmxvY2F0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXZlbnREYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICAgIGNvbmZpZGVuY2U6IDAuOFxuICAgICAgfSlcbiAgICAgIGFuYWx5c2lzLmhhc0V2ZW50TWVudGlvbiA9IHRydWVcbiAgICB9XG4gIH1cblxuICAvLyBTb2xvIGdlbmVyYXIgcHJlZ3VudGFzIHBhcmEgaW5mb3JtYWNpw7NuIHJlYWxtZW50ZSBmYWx0YW50ZVxuICBpZiAoYW5hbHlzaXMuZXZlbnRTdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3Qgc3VnZ2VzdGlvbiA9IGFuYWx5c2lzLmV2ZW50U3VnZ2VzdGlvbnNbMF1cbiAgICBjb25zdCBxdWVzdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBtaXNzaW5nSW5mbzogc3RyaW5nW10gPSBbXVxuXG4gICAgaWYgKCFzdWdnZXN0aW9uLmRhdGUpIHtcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKFwi8J+ThSDCv1BhcmEgcXXDqSBmZWNoYSBlcz9cIilcbiAgICAgIG1pc3NpbmdJbmZvLnB1c2goXCJmZWNoYVwiKVxuICAgIH1cblxuICAgIGlmICghc3VnZ2VzdGlvbi5zdGFydFRpbWUpIHtcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKFwi8J+VkCDCv0EgcXXDqSBob3JhP1wiKVxuICAgICAgbWlzc2luZ0luZm8ucHVzaChcImhvcmFcIilcbiAgICB9XG5cbiAgICBpZiAoc3VnZ2VzdGlvbi50eXBlID09PSAnZXhhbScgJiYgIXN1Z2dlc3Rpb24uc3ViamVjdCkge1xuICAgICAgcXVlc3Rpb25zLnB1c2goXCLwn5OaIMK/RGUgcXXDqSBtYXRlcmlhIGVzIGVsIGV4YW1lbj9cIilcbiAgICAgIG1pc3NpbmdJbmZvLnB1c2goXCJtYXRlcmlhXCIpXG4gICAgfVxuXG4gICAgaWYgKHN1Z2dlc3Rpb24udHlwZSA9PT0gJ2V4YW0nICYmICFzdWdnZXN0aW9uLmxvY2F0aW9uKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaChcIvCfk40gwr9FbiBxdcOpIGF1bGEgc2Vyw6E/XCIpXG4gICAgICBtaXNzaW5nSW5mby5wdXNoKFwidWJpY2FjacOzblwiKVxuICAgIH1cblxuICAgIC8vIFNvbG8gYWdyZWdhciBwcmVndW50YXMgc2kgcmVhbG1lbnRlIGZhbHRhIGluZm9ybWFjacOzblxuICAgIGFuYWx5c2lzLnF1ZXN0aW9ucyA9IHF1ZXN0aW9uc1xuICAgIGFuYWx5c2lzLm1pc3NpbmdJbmZvID0gbWlzc2luZ0luZm9cbiAgfVxuXG4gIHJldHVybiBhbmFseXNpc1xufVxuXG4vKipcbiAqIEV4dHJhZSBkYXRvcyBlc3BlY8OtZmljb3MgZGVsIGV2ZW50byBkZXNkZSBlbCBtZW5zYWplXG4gKi9cbmZ1bmN0aW9uIGV4dHJhY3RFdmVudERhdGFGcm9tTWVzc2FnZShtZXNzYWdlOiBzdHJpbmcsIGV2ZW50VHlwZTogJ2V4YW0nIHwgJ3N0dWR5X3Nlc3Npb24nIHwgJ3BlcnNvbmFsJyB8ICdleHRyYWN1cnJpY3VsYXInKSB7XG4gIGNvbnN0IG1zZ0xvd2VyID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpXG4gIFxuICAvLyBFeHRyYWVyIG1hdGVyaWEgZGUgbWFuZXJhIG3DoXMgaW50ZWxpZ2VudGVcbiAgbGV0IHN1YmplY3QgPSBudWxsXG4gIGNvbnN0IHN1YmplY3RQYXR0ZXJucyA9IFtcbiAgICAvKD86ZXhhbWVufGV2YWx1YWNpW2/Ds11ufHBhcmNpYWx8ZmluYWx8cHJ1ZWJhfHRlc3QpLio/KD86ZGV8ZW4pXFxzKyhbYS16w6HDqcOtw7PDusOxXSspL2ksXG4gICAgLyhbYS16w6HDqcOtw7PDusOxXSspLio/KD86ZXhhbWVufGV2YWx1YWNpW2/Ds11ufHBhcmNpYWx8ZmluYWx8cHJ1ZWJhfHRlc3QpL2ksXG4gICAgLyg/OmVzdHVkaWFyfHJlcGFzYXJ8cHJlcGFyYXJ8cHJhY3RpY2FyKVxccysoW2EtesOhw6nDrcOzw7rDsV0rKS9pLFxuICAgIC8oPzpzZXNpW2/Ds11uLio/KD86ZGV8ZW4pXFxzKyhbYS16w6HDqcOtw7PDusOxXSspKS9pXG4gIF1cbiAgXG4gIGZvciAoY29uc3QgcGF0dGVybiBvZiBzdWJqZWN0UGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IG1lc3NhZ2UubWF0Y2gocGF0dGVybilcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgIC8vIENhcGl0YWxpemFyIHByaW1lcmEgbGV0cmFcbiAgICAgIHN1YmplY3QgPSBtYXRjaFsxXS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIG1hdGNoWzFdLnNsaWNlKDEpLnRvTG93ZXJDYXNlKClcbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgLy8gRXh0cmFlciBmZWNoYSBkZSBtYW5lcmEgbcOhcyBpbnRlbGlnZW50ZVxuICBsZXQgZGF0ZSA9IG51bGxcbiAgbGV0IHN0YXJ0VGltZSA9IG51bGxcbiAgXG4gIC8vIERldGVjdGFyIGZlY2hhcyBlc3BlY8OtZmljYXMgKGRkIGRlIG1lcywgZGQvbW0sIGV0Yy4pXG4gIGNvbnN0IHNwZWNpZmljRGF0ZVBhdHRlcm5zID0gW1xuICAgIC8oXFxkezEsMn0pXFxzK2RlXFxzKyhlbmVyb3xmZWJyZXJvfG1hcnpvfGFicmlsfG1heW98anVuaW98anVsaW98YWdvc3RvfHNlcHRpZW1icmV8b2N0dWJyZXxub3ZpZW1icmV8ZGljaWVtYnJlKS9pLFxuICAgIC8oXFxkezEsMn0pXFwvKFxcZHsxLDJ9KSg/OlxcLyhcXGR7Miw0fSkpPy8sXG4gICAgLyhcXGR7MSwyfSktKFxcZHsxLDJ9KSg/Oi0oXFxkezIsNH0pKT8vLFxuICAgIC9lbFxccysoXFxkezEsMn0pL2lcbiAgXVxuICBcbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHNwZWNpZmljRGF0ZVBhdHRlcm5zKSB7XG4gICAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlLm1hdGNoKHBhdHRlcm4pXG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICBpZiAocGF0dGVybi5zb3VyY2UuaW5jbHVkZXMoJ2RlJykpIHtcbiAgICAgICAgLy8gXCIxMCBkZSBqdWxpb1wiXG4gICAgICAgIGNvbnN0IGRheSA9IHBhcnNlSW50KG1hdGNoWzFdKVxuICAgICAgICBjb25zdCBtb250aE5hbWUgPSBtYXRjaFsyXS50b0xvd2VyQ2FzZSgpXG4gICAgICAgIGNvbnN0IG1vbnRoTWFwOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge1xuICAgICAgICAgICdlbmVybyc6IDAsICdmZWJyZXJvJzogMSwgJ21hcnpvJzogMiwgJ2FicmlsJzogMyxcbiAgICAgICAgICAnbWF5byc6IDQsICdqdW5pbyc6IDUsICdqdWxpbyc6IDYsICdhZ29zdG8nOiA3LFxuICAgICAgICAgICdzZXB0aWVtYnJlJzogOCwgJ29jdHVicmUnOiA5LCAnbm92aWVtYnJlJzogMTAsICdkaWNpZW1icmUnOiAxMVxuICAgICAgICB9XG4gICAgICAgIGlmIChtb250aE1hcFttb250aE5hbWVdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gICAgICAgICAgY29uc3QgZXZlbnREYXRlID0gbmV3IERhdGUobm93LmdldEZ1bGxZZWFyKCksIG1vbnRoTWFwW21vbnRoTmFtZV0sIGRheSlcbiAgICAgICAgICBkYXRlID0gZXZlbnREYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG1hdGNoWzFdICYmICFpc05hTihwYXJzZUludChtYXRjaFsxXSkpKSB7XG4gICAgICAgIC8vIEZvcm1hdG8gZGQvbW0gbyBkZC1tbSBvIFwiZWwgMTBcIlxuICAgICAgICBjb25zdCBkYXkgPSBwYXJzZUludChtYXRjaFsxXSlcbiAgICAgICAgY29uc3QgbW9udGggPSBtYXRjaFsyXSA/IHBhcnNlSW50KG1hdGNoWzJdKSAtIDEgOiBuZXcgRGF0ZSgpLmdldE1vbnRoKClcbiAgICAgICAgY29uc3QgeWVhciA9IG1hdGNoWzNdID8gcGFyc2VJbnQobWF0Y2hbM10pIDogbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpXG4gICAgICAgIGNvbnN0IGV2ZW50RGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoLCBkYXkpXG4gICAgICAgIGRhdGUgPSBldmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gICAgICB9XG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIC8vIFNpIG5vIHNlIGVuY29udHLDsyBmZWNoYSBlc3BlY8OtZmljYSwgYnVzY2FyIGTDrWFzIHJlbGF0aXZvc1xuICBpZiAoIWRhdGUpIHtcbiAgICBjb25zdCByZWxhdGl2ZURhdGVQYXR0ZXJucyA9IFtcbiAgICAgIHsgcGF0dGVybjogL21hW8Oxbl1hbmEvaSwgZGF5czogMSB9LFxuICAgICAgeyBwYXR0ZXJuOiAvaG95L2ksIGRheXM6IDAgfSxcbiAgICAgIHsgcGF0dGVybjogL3Bhc2Fkby4qbWFbw7FuXWFuYS9pLCBkYXlzOiAyIH0sXG4gICAgICB7IHBhdHRlcm46IC9sdW5lcy9pLCB0YXJnZXREYXk6IDEgfSxcbiAgICAgIHsgcGF0dGVybjogL21hcnRlcy9pLCB0YXJnZXREYXk6IDIgfSxcbiAgICAgIHsgcGF0dGVybjogL21pW2XDqV1yY29sZXMvaSwgdGFyZ2V0RGF5OiAzIH0sXG4gICAgICB7IHBhdHRlcm46IC9qdWV2ZXMvaSwgdGFyZ2V0RGF5OiA0IH0sXG4gICAgICB7IHBhdHRlcm46IC92aWVybmVzL2ksIHRhcmdldERheTogNSB9LFxuICAgICAgeyBwYXR0ZXJuOiAvc1thw6FdYmFkby9pLCB0YXJnZXREYXk6IDYgfSxcbiAgICAgIHsgcGF0dGVybjogL2RvbWluZ28vaSwgdGFyZ2V0RGF5OiAwIH1cbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHsgcGF0dGVybiwgZGF5cywgdGFyZ2V0RGF5IH0gb2YgcmVsYXRpdmVEYXRlUGF0dGVybnMpIHtcbiAgICAgIGlmIChwYXR0ZXJuLnRlc3QobWVzc2FnZSkpIHtcbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKVxuICAgICAgICBsZXQgZXZlbnREYXRlOiBEYXRlXG5cbiAgICAgICAgaWYgKGRheXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGV2ZW50RGF0ZSA9IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyBkYXlzICogMjQgKiA2MCAqIDYwICogMTAwMClcbiAgICAgICAgfSBlbHNlIGlmICh0YXJnZXREYXkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNvbnN0IGN1cnJlbnREYXkgPSBub3cuZ2V0RGF5KClcbiAgICAgICAgICBsZXQgZGF5c1RvQWRkID0gdGFyZ2V0RGF5IC0gY3VycmVudERheVxuICAgICAgICAgIGlmIChkYXlzVG9BZGQgPD0gMCkgZGF5c1RvQWRkICs9IDcgLy8gUHLDs3hpbWEgc2VtYW5hXG4gICAgICAgICAgZXZlbnREYXRlID0gbmV3IERhdGUobm93LmdldFRpbWUoKSArIGRheXNUb0FkZCAqIDI0ICogNjAgKiA2MCAqIDEwMDApXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udGludWVcbiAgICAgICAgfVxuXG4gICAgICAgIGRhdGUgPSBldmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gRXh0cmFlciBob3JhIGRlIG1hbmVyYSBtw6FzIGludGVsaWdlbnRlXG4gIGNvbnN0IHRpbWVQYXR0ZXJucyA9IFtcbiAgICAvKD86YVxccytsYXM/XFxzKyk/KFxcZHsxLDJ9KSg/OjooXFxkezJ9KSk/XFxzKihhbXxwbXxhXFwuP21cXC4/fHBcXC4/bVxcLj8pL2ksXG4gICAgLyg/OmFcXHMrbGFzP1xccyspPyhcXGR7MSwyfSkoPzo6KFxcZHsyfSkpP1xccypoKD86b3Jhcz8pPy9pLFxuICAgIC8oXFxkezEsMn0pKD86OihcXGR7Mn0pKT9cXHMqKD86ZGVcXHMrbGFcXHMrKT8obWFbw7FuXWFuYXx0YXJkZXxub2NoZSkvaVxuICBdXG5cbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRpbWVQYXR0ZXJucykge1xuICAgIGNvbnN0IG1hdGNoID0gbWVzc2FnZS5tYXRjaChwYXR0ZXJuKVxuICAgIGlmIChtYXRjaCkge1xuICAgICAgbGV0IGhvdXIgPSBwYXJzZUludChtYXRjaFsxXSlcbiAgICAgIGNvbnN0IG1pbnV0ZSA9IG1hdGNoWzJdID8gcGFyc2VJbnQobWF0Y2hbMl0pIDogMFxuICAgICAgY29uc3QgcGVyaW9kID0gbWF0Y2hbM10/LnRvTG93ZXJDYXNlKClcblxuICAgICAgLy8gQ29udmVydGlyIGEgZm9ybWF0byAyNGhcbiAgICAgIGlmIChwZXJpb2QpIHtcbiAgICAgICAgaWYgKChwZXJpb2QuaW5jbHVkZXMoJ3BtJykgfHwgcGVyaW9kLmluY2x1ZGVzKCdwLm0nKSB8fCBwZXJpb2QgPT09ICd0YXJkZScgfHwgcGVyaW9kID09PSAnbm9jaGUnKSAmJiBob3VyIDwgMTIpIHtcbiAgICAgICAgICBob3VyICs9IDEyXG4gICAgICAgIH0gZWxzZSBpZiAoKHBlcmlvZC5pbmNsdWRlcygnYW0nKSB8fCBwZXJpb2QuaW5jbHVkZXMoJ2EubScpIHx8IHBlcmlvZCA9PT0gJ21hW8Oxbl1hbmEnKSAmJiBob3VyID09PSAxMikge1xuICAgICAgICAgIGhvdXIgPSAwXG4gICAgICAgIH0gZWxzZSBpZiAocGVyaW9kID09PSAnbm9jaGUnICYmIGhvdXIgPCA2KSB7XG4gICAgICAgICAgaG91ciArPSAxMiAvLyBQYXJhIGNhc29zIGNvbW8gXCIzIGRlIGxhIG5vY2hlXCIgPSAxNTowMFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHN0YXJ0VGltZSA9IGAke2hvdXIudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfToke21pbnV0ZS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YFxuICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICAvLyBFeHRyYWVyIHViaWNhY2nDs25cbiAgbGV0IGxvY2F0aW9uID0gbnVsbFxuICBjb25zdCBsb2NhdGlvblBhdHRlcm5zID0gW1xuICAgIC8oPzplblxccytlbD9cXHMrKT8oYXVsYXxsYWJvcmF0b3Jpb3xzYWxhfGF1ZGl0b3JpbylcXHMrKFthLXpBLVowLTldKykvaSxcbiAgICAvKD86ZW5cXHMrKShbYS16QS1aXFxzXSsoPzphdWxhfGxhYm9yYXRvcmlvfHNhbGF8YXVkaXRvcmlvKVthLXpBLVowLTlcXHNdKikvaVxuICBdXG5cbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGxvY2F0aW9uUGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IG1lc3NhZ2UubWF0Y2gocGF0dGVybilcbiAgICBpZiAobWF0Y2gpIHtcbiAgICAgIGxvY2F0aW9uID0gbWF0Y2hbMF0ucmVwbGFjZSgvXmVuXFxzKy9pLCAnJykudHJpbSgpXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIC8vIEV4dHJhZXIgZHVyYWNpw7NuXG4gIGxldCBkdXJhdGlvbiA9IG51bGxcbiAgY29uc3QgZHVyYXRpb25NYXRjaCA9IG1lc3NhZ2UubWF0Y2goLyg/OmR1cmFudGVcXHMrKT8oXFxkKylcXHMqKGhvcmFzP3xtaW51dG9zP3xtaW4pL2kpXG4gIGlmIChkdXJhdGlvbk1hdGNoKSB7XG4gICAgY29uc3QgdmFsdWUgPSBwYXJzZUludChkdXJhdGlvbk1hdGNoWzFdKVxuICAgIGNvbnN0IHVuaXQgPSBkdXJhdGlvbk1hdGNoWzJdLnRvTG93ZXJDYXNlKClcbiAgICBkdXJhdGlvbiA9IHVuaXQuaW5jbHVkZXMoJ2hvcmEnKSA/IHZhbHVlICogNjAgOiB2YWx1ZVxuICB9XG5cbiAgLy8gRXh0cmFlciBkZXNjcmlwY2nDs24vdGVtYSBlc3BlY8OtZmljbyBzaSBzZSBtZW5jaW9uYVxuICBsZXQgZGVzY3JpcHRpb24gPSBudWxsXG4gIGNvbnN0IHRvcGljUGF0dGVybnMgPSBbXG4gICAgLyg/OnNvYnJlfHRlbWF8dGVtYXM/KVxccysoW2EtesOhw6nDrcOzw7rDsVxcc10rPykoPzpcXHMrcGFyYXxcXHMrZWx8XFxzK2F8JCkvaSxcbiAgICAvKD86c29icmUpXFxzK2VsXFxzK3RlbWFcXHMrKFthLXrDocOpw63Ds8O6w7FcXHNdKz8pKD86XFxzK3BhcmF8XFxzK2VsfFxccythfCQpL2lcbiAgXVxuICBcbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIHRvcGljUGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IG1lc3NhZ2UubWF0Y2gocGF0dGVybilcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0gJiYgbWF0Y2hbMV0udHJpbSgpLmxlbmd0aCA+IDMpIHtcbiAgICAgIGRlc2NyaXB0aW9uID0gbWF0Y2hbMV0udHJpbSgpXG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaGFzRXZlbnQ6IHRydWUsXG4gICAgc3ViamVjdCxcbiAgICBkYXRlLFxuICAgIHN0YXJ0VGltZSxcbiAgICBsb2NhdGlvbixcbiAgICBkdXJhdGlvbixcbiAgICBkZXNjcmlwdGlvblxuICB9XG59XG5cbi8qKlxuICogR2VuZXJhIHByZWd1bnRhcyBwYXJhIGNvbXBsZXRhciBsYSBpbmZvcm1hY2nDs24gZGUgdW4gZXZlbnRvXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUV2ZW50UXVlc3Rpb25zKHN1Z2dlc3Rpb246IEV2ZW50U3VnZ2VzdGlvbik6IHN0cmluZ1tdIHtcbiAgY29uc3QgcXVlc3Rpb25zOiBzdHJpbmdbXSA9IFtdXG5cbiAgaWYgKCFzdWdnZXN0aW9uLmRhdGUpIHtcbiAgICBxdWVzdGlvbnMucHVzaChcIvCfk4Ugwr9QYXJhIHF1w6kgZmVjaGEgZXM/XCIpXG4gIH1cblxuICBpZiAoIXN1Z2dlc3Rpb24uc3RhcnRUaW1lKSB7XG4gICAgcXVlc3Rpb25zLnB1c2goXCLwn5WQIMK/QSBxdcOpIGhvcmE/XCIpXG4gIH1cblxuICBpZiAoc3VnZ2VzdGlvbi50eXBlID09PSAnZXhhbScpIHtcbiAgICBpZiAoIXN1Z2dlc3Rpb24uc3ViamVjdCkge1xuICAgICAgcXVlc3Rpb25zLnB1c2goXCLwn5OaIMK/RGUgcXXDqSBtYXRlcmlhIGVzIGVsIGV4YW1lbj9cIilcbiAgICB9XG4gICAgaWYgKCFzdWdnZXN0aW9uLmxvY2F0aW9uKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaChcIvCfk40gwr9FbiBxdcOpIGF1bGEgbyBsYWJvcmF0b3JpbyBzZXLDoT9cIilcbiAgICB9XG4gICAgaWYgKCFzdWdnZXN0aW9uLmR1cmF0aW9uKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaChcIuKPse+4jyDCv0N1w6FudG8gdGllbXBvIGR1cmFyw6E/XCIpXG4gICAgfVxuICB9XG5cbiAgaWYgKHN1Z2dlc3Rpb24udHlwZSA9PT0gJ3N0dWR5X3Nlc3Npb24nKSB7XG4gICAgaWYgKCFzdWdnZXN0aW9uLnN1YmplY3QpIHtcbiAgICAgIHF1ZXN0aW9ucy5wdXNoKFwi8J+TliDCv1F1w6kgdGVtYSB2YXMgYSBlc3R1ZGlhcj9cIilcbiAgICB9XG4gICAgaWYgKCFzdWdnZXN0aW9uLmR1cmF0aW9uKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaChcIuKPsCDCv0N1w6FudGFzIGhvcmFzIHBsYW5lYXMgZXN0dWRpYXI/XCIpXG4gICAgfVxuICB9XG5cbiAgaWYgKHN1Z2dlc3Rpb24udHlwZSA9PT0gJ3BlcnNvbmFsJyB8fCBzdWdnZXN0aW9uLnR5cGUgPT09ICdleHRyYWN1cnJpY3VsYXInKSB7XG4gICAgaWYgKCFzdWdnZXN0aW9uLmxvY2F0aW9uKSB7XG4gICAgICBxdWVzdGlvbnMucHVzaChcIvCfk40gwr9Ew7NuZGUgc2Vyw6E/XCIpXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHF1ZXN0aW9uc1xufVxuXG4vKipcbiAqIENvbnZpZXJ0ZSB1bmEgc3VnZXJlbmNpYSBkZSBldmVudG8gZW4gdW4gZXZlbnRvIGRlIGNhbGVuZGFyaW9cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGNvbnZlcnRTdWdnZXN0aW9uVG9DYWxlbmRhckV2ZW50KFxuICBzdWdnZXN0aW9uOiBFdmVudFN1Z2dlc3Rpb24sXG4gIHVzZXJJZDogc3RyaW5nLFxuICBhZGRpdGlvbmFsSW5mbz86IFBhcnRpYWw8RXZlbnRTdWdnZXN0aW9uPlxuKTogQ2FsZW5kYXJFdmVudCB7XG4gIGNvbnN0IG1lcmdlZCA9IHsgLi4uc3VnZ2VzdGlvbiwgLi4uYWRkaXRpb25hbEluZm8gfVxuICBcbiAgLy8gUHJvY2VzYXIgZmVjaGFcbiAgbGV0IGV2ZW50RGF0ZSA9IG5ldyBEYXRlKClcbiAgaWYgKG1lcmdlZC5kYXRlKSB7XG4gICAgZXZlbnREYXRlID0gcGFyc2VEYXRlRnJvbVRleHQobWVyZ2VkLmRhdGUpXG4gIH1cblxuICAvLyBQcm9jZXNhciBob3JhXG4gIGxldCBzdGFydFRpbWUgPSBtZXJnZWQuc3RhcnRUaW1lIHx8ICcxNTowMCdcbiAgbGV0IGVuZFRpbWUgPSBtZXJnZWQuc3RhcnRUaW1lIHx8ICcxNjowMCdcbiAgXG4gIGlmIChtZXJnZWQuZHVyYXRpb24gJiYgbWVyZ2VkLnN0YXJ0VGltZSkge1xuICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHttZXJnZWQuc3RhcnRUaW1lfTowMGApXG4gICAgY29uc3QgZW5kID0gbmV3IERhdGUoc3RhcnQuZ2V0VGltZSgpICsgbWVyZ2VkLmR1cmF0aW9uICogNjAwMDApXG4gICAgZW5kVGltZSA9IGVuZC50b1RpbWVTdHJpbmcoKS5zdWJzdHJpbmcoMCwgNSlcbiAgfVxuXG4gIGNvbnN0IGV2ZW50OiBDYWxlbmRhckV2ZW50ID0ge1xuICAgIGlkOiBgYWktZXZlbnQtJHtEYXRlLm5vdygpfWAsXG4gICAgdGl0bGU6IG1lcmdlZC50aXRsZSxcbiAgICBkYXRlOiBldmVudERhdGUsXG4gICAgc3RhcnRUaW1lOiBzdGFydFRpbWUsXG4gICAgZW5kVGltZTogZW5kVGltZSxcbiAgICB0eXBlOiBtZXJnZWQudHlwZSxcbiAgICBjb2xvcjogZ2V0RXZlbnRUeXBlQ29sb3IobWVyZ2VkLnR5cGUpLFxuICAgIHN1YmplY3Q6IG1lcmdlZC5zdWJqZWN0LFxuICAgIGxvY2F0aW9uOiBtZXJnZWQubG9jYXRpb24sXG4gICAgZGVzY3JpcHRpb246IG1lcmdlZC5kZXNjcmlwdGlvbiB8fCAnQ3JlYWRvIGF1dG9tw6F0aWNhbWVudGUgcG9yIElBIFR1dG9yYScsXG4gICAgcHJpb3JpdHk6IG1lcmdlZC5wcmlvcml0eSB8fCAnbWVkaXVtJyxcbiAgICBkdXJhdGlvbjogbWVyZ2VkLmR1cmF0aW9uIHx8IDYwXG4gIH1cblxuICByZXR1cm4gZXZlbnRcbn1cblxuLyoqXG4gKiBDcmVhIHVuIGV2ZW50byBhdXRvbcOhdGljYW1lbnRlIGRlc2RlIGxhIElBIHVzYW5kbyBlbCBBUEkgZW5kcG9pbnQgZGVkaWNhZG9cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUV2ZW50RnJvbUFJKFxuICBzdWdnZXN0aW9uOiBFdmVudFN1Z2dlc3Rpb24sXG4gIHVzZXJJZDogc3RyaW5nLFxuICBhZGRpdGlvbmFsSW5mbz86IFBhcnRpYWw8RXZlbnRTdWdnZXN0aW9uPlxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGV2ZW50PzogQ2FsZW5kYXJFdmVudDsgbWVzc2FnZT86IHN0cmluZyB9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgbWVyZ2VkID0geyAuLi5zdWdnZXN0aW9uLCAuLi5hZGRpdGlvbmFsSW5mbyB9XG4gICAgXG4gICAgLy8gUHJvY2VzYXIgZmVjaGFcbiAgICBsZXQgZXZlbnREYXRlID0gbmV3IERhdGUoKVxuICAgIGlmIChtZXJnZWQuZGF0ZSkge1xuICAgICAgZXZlbnREYXRlID0gcGFyc2VEYXRlRnJvbVRleHQobWVyZ2VkLmRhdGUpXG4gICAgfVxuICAgIFxuICAgIC8vIENhbGN1bGFyIGVuZFRpbWUgYmFzYWRvIGVuIGR1cmF0aW9uIHkgc3RhcnRUaW1lXG4gICAgbGV0IGVuZFRpbWUgPSBtZXJnZWQuc3RhcnRUaW1lIHx8ICcxNjowMCdcbiAgICBpZiAobWVyZ2VkLmR1cmF0aW9uICYmIG1lcmdlZC5zdGFydFRpbWUpIHtcbiAgICAgIGNvbnN0IHN0YXJ0ID0gbmV3IERhdGUoYDIwMDAtMDEtMDFUJHttZXJnZWQuc3RhcnRUaW1lfTowMGApXG4gICAgICBjb25zdCBlbmQgPSBuZXcgRGF0ZShzdGFydC5nZXRUaW1lKCkgKyBtZXJnZWQuZHVyYXRpb24gKiA2MDAwMClcbiAgICAgIGVuZFRpbWUgPSBlbmQudG9UaW1lU3RyaW5nKCkuc3Vic3RyaW5nKDAsIDUpXG4gICAgfVxuXG4gICAgY29uc3QgZXZlbnREYXRhID0ge1xuICAgICAgdGl0bGU6IG1lcmdlZC50aXRsZSxcbiAgICAgIHR5cGU6IG1lcmdlZC50eXBlLFxuICAgICAgc3ViamVjdDogbWVyZ2VkLnN1YmplY3QsXG4gICAgICBkYXRlOiBldmVudERhdGUudG9JU09TdHJpbmcoKSxcbiAgICAgIHN0YXJ0VGltZTogbWVyZ2VkLnN0YXJ0VGltZSB8fCAnMTU6MDAnLFxuICAgICAgZW5kVGltZTogZW5kVGltZSxcbiAgICAgIGR1cmF0aW9uOiBtZXJnZWQuZHVyYXRpb24gfHwgNjAsXG4gICAgICBsb2NhdGlvbjogbWVyZ2VkLmxvY2F0aW9uLFxuICAgICAgZGVzY3JpcHRpb246IG1lcmdlZC5kZXNjcmlwdGlvbiB8fCBgQ3JlYWRvIGF1dG9tw6F0aWNhbWVudGUgcG9yIElBIFR1dG9yYWAsXG4gICAgICBwcmlvcml0eTogbWVyZ2VkLnByaW9yaXR5IHx8ICdtZWRpdW0nXG4gICAgfVxuXG4gICAgLy8gRm9yIHNlcnZlci1zaWRlIGV4ZWN1dGlvbiwgY2FsbCB0aGUgZnVuY3Rpb24gZGlyZWN0bHkgaW5zdGVhZCBvZiBIVFRQIGZldGNoXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgY3JlYXRlQ2FsZW5kYXJFdmVudCB9ID0gcmVxdWlyZSgnLi4vYXBwL2FwaS9haS1jYWxlbmRhci9jcmVhdGUtZXZlbnQvcm91dGUnKVxuICAgICAgY29uc3QgbW9ja1JlcXVlc3QgPSB7XG4gICAgICAgIGpzb246IGFzeW5jICgpID0+IGV2ZW50RGF0YVxuICAgICAgfVxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBjcmVhdGVDYWxlbmRhckV2ZW50KG1vY2tSZXF1ZXN0IGFzIGFueSlcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiByZXN1bHQuc3VjY2VzcyxcbiAgICAgICAgZXZlbnQ6IHJlc3VsdC5ldmVudCxcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9IGNhdGNoIChkaXJlY3RDYWxsRXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdEaXJlY3QgQVBJIGNhbGwgZmFpbGVkLCB0cnlpbmcgYWx0ZXJuYXRpdmUgYXBwcm9hY2g6JywgZGlyZWN0Q2FsbEVycm9yKVxuICAgICAgXG4gICAgICAvLyBBbHRlcm5hdGl2ZTogVXNlIGNhbGVuZGFyLWRhdGEgZnVuY3Rpb25zIGRpcmVjdGx5XG4gICAgICBjb25zdCB7IGFkZENhbGVuZGFyRXZlbnQsIGdldFVzZXJDYWxlbmRhckRhdGEsIGNyZWF0ZVVzZXJDYWxlbmRhckRhdGEgfSA9IHJlcXVpcmUoJy4vY2FsZW5kYXItZGF0YScpXG4gICAgICBcbiAgICAgIC8vIEVuc3VyZSB1c2VyIGhhcyBjYWxlbmRhciBkYXRhXG4gICAgICBsZXQgdXNlckRhdGEgPSBnZXRVc2VyQ2FsZW5kYXJEYXRhKHVzZXJJZClcbiAgICAgIGlmICghdXNlckRhdGEpIHtcbiAgICAgICAgY29uc29sZS5sb2coYPCfhpUgQ3JlYXRpbmcgY2FsZW5kYXIgZGF0YSBmb3IgdXNlciAke3VzZXJJZH1gKVxuICAgICAgICB1c2VyRGF0YSA9IGNyZWF0ZVVzZXJDYWxlbmRhckRhdGEodXNlcklkKVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBjYWxlbmRhckV2ZW50ID0ge1xuICAgICAgICBpZDogYGFpLWV2ZW50LSR7RGF0ZS5ub3coKX1gLFxuICAgICAgICB0aXRsZTogZXZlbnREYXRhLnRpdGxlLFxuICAgICAgICBkYXRlOiBuZXcgRGF0ZShldmVudERhdGEuZGF0ZSksXG4gICAgICAgIHN0YXJ0VGltZTogZXZlbnREYXRhLnN0YXJ0VGltZSxcbiAgICAgICAgZW5kVGltZTogZXZlbnREYXRhLmVuZFRpbWUsXG4gICAgICAgIHR5cGU6IGV2ZW50RGF0YS50eXBlLFxuICAgICAgICBjb2xvcjogJyMzQjgyRjYnLCAvLyBEZWZhdWx0IGNvbG9yXG4gICAgICAgIHN1YmplY3Q6IGV2ZW50RGF0YS5zdWJqZWN0LFxuICAgICAgICBsb2NhdGlvbjogZXZlbnREYXRhLmxvY2F0aW9uLFxuICAgICAgICBkZXNjcmlwdGlvbjogZXZlbnREYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgICBwcmlvcml0eTogZXZlbnREYXRhLnByaW9yaXR5LFxuICAgICAgICBkdXJhdGlvbjogZXZlbnREYXRhLmR1cmF0aW9uXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OFIENyZWF0aW5nIGV2ZW50OiAke2NhbGVuZGFyRXZlbnQudGl0bGV9IGZvciAke2V2ZW50RGF0YS5kYXRlfSBhdCAke2V2ZW50RGF0YS5zdGFydFRpbWV9YClcbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBhZGRDYWxlbmRhckV2ZW50KHVzZXJJZCwgY2FsZW5kYXJFdmVudClcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgZXZlbnQ6IHN1Y2Nlc3MgPyBjYWxlbmRhckV2ZW50IDogdW5kZWZpbmVkLFxuICAgICAgICBtZXNzYWdlOiBzdWNjZXNzID8gJ0V2ZW50byBjcmVhZG8gZXhpdG9zYW1lbnRlJyA6ICdFcnJvciBhbCBjcmVhciBldmVudG8nXG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpXG4gICAgXG4gICAgaWYgKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+kliBJQSBjb25maXJtw7MgY3JlYWNpw7NuOiAke3Jlc3VsdC5ldmVudC50aXRsZX1gKVxuICAgICAgXG4gICAgICAvLyBEaXNwYXJhciBldmVudG8gZGVsIGxhZG8gZGVsIGNsaWVudGUgcGFyYSBub3RpZmljYXIgY29tcG9uZW50ZXNcbiAgICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoJ2NhbGVuZGFyRXZlbnRDcmVhdGVkJywge1xuICAgICAgICAgICAgZGV0YWlsOiB7IGV2ZW50OiByZXN1bHQuZXZlbnQsIHVzZXJJZCB9XG4gICAgICAgICAgfSkpXG4gICAgICAgIH0sIDIwMClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZXZlbnQ6IHJlc3VsdC5ldmVudCxcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIElBIGZhbGzDsyBhbCBjcmVhciBldmVudG86JywgcmVzdWx0LmVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5lcnJvciB8fCAnRXJyb3IgZGVzY29ub2NpZG8nXG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBpbiBBSSBldmVudCBjcmVhdGlvbjonLCBlcnJvcilcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnRXJyb3IgZGUgY29uZXhpw7NuIGFsIGNyZWFyIGV2ZW50bydcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBQYXJzZWEgZmVjaGFzIGRlc2RlIHRleHRvIG5hdHVyYWxcbiAqL1xuZnVuY3Rpb24gcGFyc2VEYXRlRnJvbVRleHQoZGF0ZVRleHQ6IHN0cmluZyk6IERhdGUge1xuICBjb25zdCB0ZXh0ID0gZGF0ZVRleHQudG9Mb3dlckNhc2UoKVxuICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKClcbiAgXG4gIGlmICh0ZXh0LmluY2x1ZGVzKCdob3knKSkge1xuICAgIHJldHVybiB0b2RheVxuICB9XG4gIFxuICBpZiAodGV4dC5pbmNsdWRlcygnbWHDsWFuYScpIHx8IHRleHQuaW5jbHVkZXMoJ21hW8Oxbl1hbmEnKSkge1xuICAgIGNvbnN0IHRvbW9ycm93ID0gbmV3IERhdGUodG9kYXkpXG4gICAgdG9tb3Jyb3cuc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgKyAxKVxuICAgIHJldHVybiB0b21vcnJvd1xuICB9XG4gIFxuICBpZiAodGV4dC5pbmNsdWRlcygncGFzYWRvJykpIHtcbiAgICBjb25zdCBkYXlBZnRlclRvbW9ycm93ID0gbmV3IERhdGUodG9kYXkpXG4gICAgZGF5QWZ0ZXJUb21vcnJvdy5zZXREYXRlKHRvZGF5LmdldERhdGUoKSArIDIpXG4gICAgcmV0dXJuIGRheUFmdGVyVG9tb3Jyb3dcbiAgfVxuXG4gIC8vIETDrWFzIGRlIGxhIHNlbWFuYVxuICBjb25zdCBkYXlNYXA6IFJlY29yZDxzdHJpbmcsIG51bWJlcj4gPSB7XG4gICAgJ2x1bmVzJzogMSwgJ21hcnRlcyc6IDIsICdtacOpcmNvbGVzJzogMywgJ21pZXJjb2xlcyc6IDMsXG4gICAgJ2p1ZXZlcyc6IDQsICd2aWVybmVzJzogNSwgJ3PDoWJhZG8nOiA2LCAnc2FiYWRvJzogNiwgJ2RvbWluZ28nOiAwXG4gIH1cblxuICBmb3IgKGNvbnN0IFtkYXlOYW1lLCBkYXlOdW1iZXJdIG9mIE9iamVjdC5lbnRyaWVzKGRheU1hcCkpIHtcbiAgICBpZiAodGV4dC5pbmNsdWRlcyhkYXlOYW1lKSkge1xuICAgICAgY29uc3QgdGFyZ2V0RGF0ZSA9IG5ldyBEYXRlKHRvZGF5KVxuICAgICAgY29uc3QgY3VycmVudERheSA9IHRvZGF5LmdldERheSgpXG4gICAgICBsZXQgZGF5c1RvQWRkID0gZGF5TnVtYmVyIC0gY3VycmVudERheVxuICAgICAgXG4gICAgICBpZiAoZGF5c1RvQWRkIDw9IDApIHtcbiAgICAgICAgZGF5c1RvQWRkICs9IDcgLy8gUHLDs3hpbWEgc2VtYW5hXG4gICAgICB9XG4gICAgICBcbiAgICAgIHRhcmdldERhdGUuc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgKyBkYXlzVG9BZGQpXG4gICAgICByZXR1cm4gdGFyZ2V0RGF0ZVxuICAgIH1cbiAgfVxuXG4gIC8vIFNpIGluY2x1eWUgbsO6bWVyb3MgKGVqOiBcImVuIDMgZMOtYXNcIilcbiAgY29uc3QgZGF5c01hdGNoID0gdGV4dC5tYXRjaCgvZW5cXHMrKFxcZCspXFxzK2RbacOtXWFzPy8pXG4gIGlmIChkYXlzTWF0Y2gpIHtcbiAgICBjb25zdCBkYXlzID0gcGFyc2VJbnQoZGF5c01hdGNoWzFdKVxuICAgIGNvbnN0IGZ1dHVyZURhdGUgPSBuZXcgRGF0ZSh0b2RheSlcbiAgICBmdXR1cmVEYXRlLnNldERhdGUodG9kYXkuZ2V0RGF0ZSgpICsgZGF5cylcbiAgICByZXR1cm4gZnV0dXJlRGF0ZVxuICB9XG5cbiAgLy8gUG9yIGRlZmVjdG8sIGRldm9sdmVyIG1hw7FhbmFcbiAgY29uc3QgZGVmYXVsdERhdGUgPSBuZXcgRGF0ZSh0b2RheSlcbiAgZGVmYXVsdERhdGUuc2V0RGF0ZSh0b2RheS5nZXREYXRlKCkgKyAxKVxuICByZXR1cm4gZGVmYXVsdERhdGVcbn1cblxuLyoqXG4gKiBHZW5lcmEgcmVzcHVlc3RhIGRlIGxhIElBIHBhcmEgc3VnZXJpciBjcmVhciBldmVudG9zXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZUV2ZW50U3VnZ2VzdGlvblJlc3BvbnNlKGFuYWx5c2lzOiBDb252ZXJzYXRpb25BbmFseXNpcyk6IHN0cmluZyB7XG4gIGlmICghYW5hbHlzaXMuaGFzRXZlbnRNZW50aW9uIHx8IGFuYWx5c2lzLmV2ZW50U3VnZ2VzdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIFwiXCJcbiAgfVxuXG4gIGNvbnN0IHN1Z2dlc3Rpb24gPSBhbmFseXNpcy5ldmVudFN1Z2dlc3Rpb25zWzBdIC8vIFRvbWFyIGxhIHByaW1lcmEgc3VnZXJlbmNpYVxuICBcbiAgbGV0IHJlc3BvbnNlID0gYPCfk4UgUGVyZmVjdG8hIFZlbyBxdWUgcXVpZXJlcyBhZ2VuZGFyOiAqKiR7c3VnZ2VzdGlvbi50aXRsZX0qKlxcblxcbmBcbiAgXG4gIC8vIE1vc3RyYXIgaW5mb3JtYWNpw7NuIGRldGVjdGFkYVxuICBjb25zdCBkZXRlY3RlZEluZm86IHN0cmluZ1tdID0gW11cbiAgaWYgKHN1Z2dlc3Rpb24uc3ViamVjdCkgZGV0ZWN0ZWRJbmZvLnB1c2goYPCfk5ogTWF0ZXJpYTogJHtzdWdnZXN0aW9uLnN1YmplY3R9YClcbiAgaWYgKHN1Z2dlc3Rpb24uZGF0ZSkge1xuICAgIGNvbnN0IGRhdGVPYmogPSBuZXcgRGF0ZShzdWdnZXN0aW9uLmRhdGUpXG4gICAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGRhdGVPYmoudG9Mb2NhbGVEYXRlU3RyaW5nKCdlcy1FUycsIHtcbiAgICAgIHdlZWtkYXk6ICdsb25nJyxcbiAgICAgIGRheTogJ251bWVyaWMnLCBcbiAgICAgIG1vbnRoOiAnbG9uZydcbiAgICB9KVxuICAgIGRldGVjdGVkSW5mby5wdXNoKGDwn5OFIEZlY2hhOiAke2Zvcm1hdHRlZERhdGV9YClcbiAgfVxuICBpZiAoc3VnZ2VzdGlvbi5zdGFydFRpbWUpIGRldGVjdGVkSW5mby5wdXNoKGDwn5WQIEhvcmE6ICR7c3VnZ2VzdGlvbi5zdGFydFRpbWV9YClcbiAgaWYgKHN1Z2dlc3Rpb24ubG9jYXRpb24pIGRldGVjdGVkSW5mby5wdXNoKGDwn5ONIFViaWNhY2nDs246ICR7c3VnZ2VzdGlvbi5sb2NhdGlvbn1gKVxuICBcbiAgaWYgKGRldGVjdGVkSW5mby5sZW5ndGggPiAwKSB7XG4gICAgcmVzcG9uc2UgKz0gYCoqSW5mb3JtYWNpw7NuIGRldGVjdGFkYToqKlxcbiR7ZGV0ZWN0ZWRJbmZvLmpvaW4oJ1xcbicpfVxcblxcbmBcbiAgfVxuICBcbiAgaWYgKGFuYWx5c2lzLnF1ZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgcmVzcG9uc2UgKz0gYFBhcmEgY29tcGxldGFyIGVsIGV2ZW50byBuZWNlc2l0bzpcXG5gXG4gICAgYW5hbHlzaXMucXVlc3Rpb25zLmZvckVhY2goKHF1ZXN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgcmVzcG9uc2UgKz0gYCR7aW5kZXggKyAxfS4gJHtxdWVzdGlvbn1cXG5gXG4gICAgfSlcbiAgICByZXNwb25zZSArPSBgXFxuwr9Qb2Ryw61hcyBkYXJtZSBlc3RvcyBkZXRhbGxlcz9gXG4gIH0gZWxzZSB7XG4gICAgcmVzcG9uc2UgKz0gYMKhVGVuZ28gdG9kYSBsYSBpbmZvcm1hY2nDs24gbmVjZXNhcmlhISDCv0NvbmZpcm1hcyBxdWUgbG8gYWdyZWd1ZSBhIHR1IGNhbGVuZGFyaW8/YFxuICB9XG5cbiAgcmV0dXJuIHJlc3BvbnNlXG59XG5cbi8qKlxuICogSW50ZXJmYXogcGFyYSBlbCB3b3JrZmxvdyBjb21wbGV0byBkZSBjcmVhY2nDs24gZGUgZXZlbnRvcyBwb3IgSUFcbiAqL1xuZXhwb3J0IGNsYXNzIEFJQ2FsZW5kYXJJbnRlZ3JhdGlvbiB7XG4gIHByaXZhdGUgdXNlcklkOiBzdHJpbmdcbiAgcHJpdmF0ZSBwZW5kaW5nU3VnZ2VzdGlvbjogRXZlbnRTdWdnZXN0aW9uIHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSBjb2xsZWN0ZWRJbmZvOiBQYXJ0aWFsPEV2ZW50U3VnZ2VzdGlvbj4gPSB7fVxuXG4gIGNvbnN0cnVjdG9yKHVzZXJJZDogc3RyaW5nKSB7XG4gICAgdGhpcy51c2VySWQgPSB1c2VySWRcbiAgfVxuXG4gIC8qKlxuICAgKiBQcm9jZXNhIHVuIG1lbnNhamUgZGVsIHVzdWFyaW8geSBkZXRlY3RhIHNpIG5lY2VzaXRhIGNyZWFyIGV2ZW50b3NcbiAgICovXG4gIGFzeW5jIHByb2Nlc3NNZXNzYWdlKG1lc3NhZ2U6IHN0cmluZywgY29udmVyc2F0aW9uSGlzdG9yeTogQXJyYXk8eyByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgY29udGVudDogc3RyaW5nIH0+KTogUHJvbWlzZTx7XG4gICAgbmVlZHNFdmVudENyZWF0aW9uOiBib29sZWFuXG4gICAgcmVzcG9uc2U/OiBzdHJpbmdcbiAgICBxdWVzdGlvbnM/OiBzdHJpbmdbXVxuICAgIGV2ZW50PzogQ2FsZW5kYXJFdmVudFxuICB9PiB7XG4gICAgY29uc3QgYW5hbHlzaXMgPSBhbmFseXplQ29udmVyc2F0aW9uRm9yRXZlbnRzKFsuLi5jb252ZXJzYXRpb25IaXN0b3J5LCB7IHJvbGU6ICd1c2VyJywgY29udGVudDogbWVzc2FnZSB9XSlcblxuICAgIGlmIChhbmFseXNpcy5oYXNFdmVudE1lbnRpb24gJiYgYW5hbHlzaXMuZXZlbnRTdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLnBlbmRpbmdTdWdnZXN0aW9uID0gYW5hbHlzaXMuZXZlbnRTdWdnZXN0aW9uc1swXVxuICAgICAgXG4gICAgICBpZiAoYW5hbHlzaXMucXVlc3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBuZWVkc0V2ZW50Q3JlYXRpb246IHRydWUsXG4gICAgICAgICAgcmVzcG9uc2U6IGdlbmVyYXRlRXZlbnRTdWdnZXN0aW9uUmVzcG9uc2UoYW5hbHlzaXMpLFxuICAgICAgICAgIHF1ZXN0aW9uczogYW5hbHlzaXMucXVlc3Rpb25zXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEluZm9ybWFjacOzbiBjb21wbGV0YSwgY3JlYXIgZXZlbnRvIGRpcmVjdGFtZW50ZVxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLmNyZWF0ZVBlbmRpbmdFdmVudCgpXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgbmVlZHNFdmVudENyZWF0aW9uOiB0cnVlLFxuICAgICAgICAgIHJlc3BvbnNlOiByZXN1bHQuc3VjY2VzcyBcbiAgICAgICAgICAgID8gdGhpcy5nZW5lcmF0ZVN1Y2Nlc3NNZXNzYWdlKHJlc3VsdC5ldmVudCEpXG4gICAgICAgICAgICA6IGDinYwgJHtyZXN1bHQubWVzc2FnZSB8fCAnSHVibyB1biBlcnJvciBhbCBjcmVhciBlbCBldmVudG8uIFBvciBmYXZvciBpbnRlbnRhIG51ZXZhbWVudGUuJ31gLFxuICAgICAgICAgIGV2ZW50OiByZXN1bHQuZXZlbnRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7IG5lZWRzRXZlbnRDcmVhdGlvbjogZmFsc2UgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlY29waWxhIGluZm9ybWFjacOzbiBhZGljaW9uYWwgZGVsIHVzdWFyaW9cbiAgICovXG4gIGNvbGxlY3RBZGRpdGlvbmFsSW5mbyhpbmZvVHlwZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgaWYgKCF0aGlzLnBlbmRpbmdTdWdnZXN0aW9uKSByZXR1cm4gZmFsc2VcblxuICAgIHN3aXRjaCAoaW5mb1R5cGUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgY2FzZSAnZmVjaGEnOlxuICAgICAgICB0aGlzLmNvbGxlY3RlZEluZm8uZGF0ZSA9IHZhbHVlXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdob3JhJzpcbiAgICAgICAgdGhpcy5jb2xsZWN0ZWRJbmZvLnN0YXJ0VGltZSA9IHZhbHVlXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdtYXRlcmlhJzpcbiAgICAgIGNhc2UgJ3RlbWEnOlxuICAgICAgICB0aGlzLmNvbGxlY3RlZEluZm8uc3ViamVjdCA9IHZhbHVlXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICd1YmljYWNpw7NuJzpcbiAgICAgIGNhc2UgJ3ViaWNhY2lvbic6XG4gICAgICAgIHRoaXMuY29sbGVjdGVkSW5mby5sb2NhdGlvbiA9IHZhbHVlXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdkdXJhY2nDs24nOlxuICAgICAgY2FzZSAnZHVyYWNpb24nOlxuICAgICAgICB0aGlzLmNvbGxlY3RlZEluZm8uZHVyYXRpb24gPSBwYXJzZUludCh2YWx1ZSlcbiAgICAgICAgYnJlYWtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWEgZWwgZXZlbnRvIHBlbmRpZW50ZSBjb24gbGEgaW5mb3JtYWNpw7NuIHJlY29waWxhZGFcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVBlbmRpbmdFdmVudCgpOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgbWVzc2FnZT86IHN0cmluZzsgZXZlbnQ/OiBDYWxlbmRhckV2ZW50IH0+IHtcbiAgICBpZiAoIXRoaXMucGVuZGluZ1N1Z2dlc3Rpb24pIHtcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBtZXNzYWdlOiAnTm8gaGF5IGV2ZW50byBwZW5kaWVudGUnIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjcmVhdGVFdmVudEZyb21BSSh0aGlzLnBlbmRpbmdTdWdnZXN0aW9uLCB0aGlzLnVzZXJJZCwgdGhpcy5jb2xsZWN0ZWRJbmZvKVxuICAgIFxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgdGhpcy5wZW5kaW5nU3VnZ2VzdGlvbiA9IG51bGxcbiAgICAgIHRoaXMuY29sbGVjdGVkSW5mbyA9IHt9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdFxuICB9XG5cbiAgLyoqXG4gICAqIENhbmNlbGEgbGEgY3JlYWNpw7NuIGRlbCBldmVudG8gcGVuZGllbnRlXG4gICAqL1xuICBjYW5jZWxQZW5kaW5nRXZlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5wZW5kaW5nU3VnZ2VzdGlvbiA9IG51bGxcbiAgICB0aGlzLmNvbGxlY3RlZEluZm8gPSB7fVxuICB9XG5cbiAgLyoqXG4gICAqIE9idGllbmUgbGEgc3VnZXJlbmNpYSBwZW5kaWVudGVcbiAgICovXG4gIGdldFBlbmRpbmdTdWdnZXN0aW9uKCk6IEV2ZW50U3VnZ2VzdGlvbiB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLnBlbmRpbmdTdWdnZXN0aW9uXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZW5lcmEgbWVuc2FqZSBkZSDDqXhpdG8gY29uIGRldGFsbGVzIGRlbCBldmVudG8gY3JlYWRvXG4gICAqL1xuICBwcml2YXRlIGdlbmVyYXRlU3VjY2Vzc01lc3NhZ2UoZXZlbnQ6IENhbGVuZGFyRXZlbnQpOiBzdHJpbmcge1xuICAgIGxldCBtZXNzYWdlID0gYOKchSDCoVBlcmZlY3RvISBIZSBjcmVhZG8gXCIke2V2ZW50LnRpdGxlfVwiIGVuIHR1IGNhbGVuZGFyaW8uYFxuICAgIFxuICAgIC8vIEFncmVnYXIgZGV0YWxsZXMgZXNwZWPDrWZpY29zXG4gICAgY29uc3QgZGV0YWlsczogc3RyaW5nW10gPSBbXVxuICAgIFxuICAgIGlmIChldmVudC5kYXRlKSB7XG4gICAgICBjb25zdCBkYXRlU3RyID0gZXZlbnQuZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VzLUVTJywge1xuICAgICAgICB3ZWVrZGF5OiAnbG9uZycsXG4gICAgICAgIGRheTogJ251bWVyaWMnLFxuICAgICAgICBtb250aDogJ2xvbmcnXG4gICAgICB9KVxuICAgICAgZGV0YWlscy5wdXNoKGDwn5OFICoqRmVjaGEqKjogJHtkYXRlU3RyfWApXG4gICAgfVxuICAgIFxuICAgIGlmIChldmVudC5zdGFydFRpbWUpIHtcbiAgICAgIGRldGFpbHMucHVzaChg8J+VkCAqKkhvcmEqKjogJHtldmVudC5zdGFydFRpbWV9YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGV2ZW50LmxvY2F0aW9uKSB7XG4gICAgICBkZXRhaWxzLnB1c2goYPCfk40gKipVYmljYWNpw7NuKio6ICR7ZXZlbnQubG9jYXRpb259YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGV2ZW50LnN1YmplY3QgJiYgZXZlbnQudHlwZSA9PT0gJ2V4YW0nKSB7XG4gICAgICBkZXRhaWxzLnB1c2goYPCfk5ogKipNYXRlcmlhKio6ICR7ZXZlbnQuc3ViamVjdH1gKVxuICAgIH1cbiAgICBcbiAgICBpZiAoZXZlbnQuZGVzY3JpcHRpb24gJiYgIWV2ZW50LmRlc2NyaXB0aW9uLmluY2x1ZGVzKCdDcmVhZG8gYXV0b23DoXRpY2FtZW50ZScpKSB7XG4gICAgICBkZXRhaWxzLnB1c2goYPCfk50gKipUZW1hKio6ICR7ZXZlbnQuZGVzY3JpcHRpb259YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGRldGFpbHMubGVuZ3RoID4gMCkge1xuICAgICAgbWVzc2FnZSArPSBgXFxuXFxuKipEZXRhbGxlcyBkZWwgZXZlbnRvOioqXFxuJHtkZXRhaWxzLmpvaW4oJ1xcbicpfWBcbiAgICB9XG4gICAgXG4gICAgbWVzc2FnZSArPSBgXFxuXFxu8J+OryBQdWVkZXMgdmVyIHRvZG9zIHR1cyBldmVudG9zIGVuIGxhIHNlY2Npw7NuIFwiT3JnYW5pemFkb3IgSW50ZWxpZ2VudGVcIiBkZSB0dSBjYWxlbmRhcmlvLmBcbiAgICBcbiAgICByZXR1cm4gbWVzc2FnZVxuICB9XG59XG5cbi8qKlxuICogQnVzY2EgZXZlbnRvcyBkZWwgdXN1YXJpbyBwb3IgdGV4dG8gZGUgYsO6c3F1ZWRhXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaW5kVXNlckV2ZW50cyh1c2VySWQ6IHN0cmluZywgc2VhcmNoVGV4dDogc3RyaW5nKTogQ2FsZW5kYXJFdmVudFtdIHtcbiAgY29uc3QgdXNlckRhdGEgPSBnZXRVc2VyQ2FsZW5kYXJEYXRhKHVzZXJJZClcbiAgaWYgKCF1c2VyRGF0YSkgcmV0dXJuIFtdXG4gIFxuICBjb25zdCBzZWFyY2ggPSBzZWFyY2hUZXh0LnRvTG93ZXJDYXNlKClcbiAgcmV0dXJuIHVzZXJEYXRhLmV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xuICAgIHJldHVybiBldmVudC50aXRsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaCkgfHxcbiAgICAgICAgICAgZXZlbnQuc3ViamVjdD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzZWFyY2gpIHx8XG4gICAgICAgICAgIGV2ZW50LmRlc2NyaXB0aW9uPy50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHNlYXJjaCkgfHxcbiAgICAgICAgICAgZXZlbnQubG9jYXRpb24/LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoc2VhcmNoKVxuICB9KVxufVxuXG4vKipcbiAqIEVkaXRhIHVuIGV2ZW50byB1c2FuZG8gZWwgQVBJIGVuZHBvaW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBlZGl0RXZlbnRGcm9tQUkoXG4gIGV2ZW50SWQ6IHN0cmluZyxcbiAgdXBkYXRlczogUGFydGlhbDxDYWxlbmRhckV2ZW50PlxuKTogUHJvbWlzZTx7IHN1Y2Nlc3M6IGJvb2xlYW47IGV2ZW50PzogQ2FsZW5kYXJFdmVudDsgbWVzc2FnZT86IHN0cmluZyB9PiB7XG4gIHRyeSB7XG4gICAgLy8gRm9yIHNlcnZlci1zaWRlIGV4ZWN1dGlvbiwgY2FsbCB0aGUgZnVuY3Rpb24gZGlyZWN0bHlcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyB1cGRhdGVDYWxlbmRhckV2ZW50IH0gPSByZXF1aXJlKCcuL2NhbGVuZGFyLWRhdGEnKVxuICAgICAgY29uc3Qgc3VjY2VzcyA9IHVwZGF0ZUNhbGVuZGFyRXZlbnQoZXZlbnRJZCwgdXBkYXRlcylcbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzcyxcbiAgICAgICAgZXZlbnQ6IHN1Y2Nlc3MgPyB7IGlkOiBldmVudElkLCAuLi51cGRhdGVzIH0gOiB1bmRlZmluZWQsXG4gICAgICAgIG1lc3NhZ2U6IHN1Y2Nlc3MgPyAnRXZlbnRvIGFjdHVhbGl6YWRvIGV4aXRvc2FtZW50ZScgOiAnRXJyb3IgYWwgYWN0dWFsaXphciBldmVudG8nXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVwZGF0aW5nIGV2ZW50OicsIGVycm9yKVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdFcnJvciBhbCBhY3R1YWxpemFyIGV2ZW50bydcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKClcbiAgICBcbiAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgIGNvbnNvbGUubG9nKGDwn6SWIElBIGVkaXTDsyBldmVudG86ICR7cmVzdWx0LmV2ZW50LnRpdGxlfWApXG4gICAgICBcbiAgICAgIC8vIERpc3BhcmFyIGV2ZW50byBkZWwgbGFkbyBkZWwgY2xpZW50ZVxuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBDdXN0b21FdmVudCgnY2FsZW5kYXJFdmVudFVwZGF0ZWQnLCB7XG4gICAgICAgICAgICBkZXRhaWw6IHsgZXZlbnQ6IHJlc3VsdC5ldmVudCwgZXZlbnRJZCB9XG4gICAgICAgICAgfSkpXG4gICAgICAgIH0sIDIwMClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZXZlbnQ6IHJlc3VsdC5ldmVudCxcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5lcnJvciB8fCAnRXJyb3IgZGVzY29ub2NpZG8gYWwgZWRpdGFyJ1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgZWRpdGluZyBldmVudCBmcm9tIEFJOicsIGVycm9yKVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdFcnJvciBkZSBjb25leGnDs24gYWwgZWRpdGFyIGV2ZW50bydcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBFbGltaW5hIHVuIGV2ZW50byB1c2FuZG8gZWwgQVBJIGVuZHBvaW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVFdmVudEZyb21BSShcbiAgZXZlbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPHsgc3VjY2VzczogYm9vbGVhbjsgbWVzc2FnZT86IHN0cmluZyB9PiB7XG4gIHRyeSB7XG4gICAgLy8gRm9yIHNlcnZlci1zaWRlIGV4ZWN1dGlvbiwgY2FsbCB0aGUgZnVuY3Rpb24gZGlyZWN0bHlcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBkZWxldGVDYWxlbmRhckV2ZW50IH0gPSByZXF1aXJlKCcuL2NhbGVuZGFyLWRhdGEnKVxuICAgICAgY29uc3QgZGVsZXRlZEV2ZW50ID0gZGVsZXRlQ2FsZW5kYXJFdmVudChldmVudElkKVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiAhIWRlbGV0ZWRFdmVudCxcbiAgICAgICAgbWVzc2FnZTogZGVsZXRlZEV2ZW50ID8gXG4gICAgICAgICAgYEV2ZW50byBcIiR7ZGVsZXRlZEV2ZW50LnRpdGxlfVwiIGVsaW1pbmFkbyBleGl0b3NhbWVudGVgIDogXG4gICAgICAgICAgJ0V2ZW50byBubyBlbmNvbnRyYWRvJ1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkZWxldGluZyBldmVudDonLCBlcnJvcilcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBtZXNzYWdlOiAnRXJyb3IgYWwgZWxpbWluYXIgZXZlbnRvJ1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKVxuICAgIFxuICAgIGlmIChyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgY29uc29sZS5sb2coYPCfpJYgSUEgZWxpbWluw7MgZXZlbnRvOiAke3Jlc3VsdC5kZWxldGVkRXZlbnQudGl0bGV9YClcbiAgICAgIFxuICAgICAgLy8gRGlzcGFyYXIgZXZlbnRvIGRlbCBsYWRvIGRlbCBjbGllbnRlXG4gICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KCdjYWxlbmRhckV2ZW50RGVsZXRlZCcsIHtcbiAgICAgICAgICAgIGRldGFpbDogeyBldmVudElkLCB0aXRsZTogcmVzdWx0LmRlbGV0ZWRFdmVudC50aXRsZSB9XG4gICAgICAgICAgfSkpXG4gICAgICAgIH0sIDIwMClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2VcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIG1lc3NhZ2U6IHJlc3VsdC5lcnJvciB8fCAnRXJyb3IgZGVzY29ub2NpZG8gYWwgZWxpbWluYXInXG4gICAgICB9XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBkZWxldGluZyBldmVudCBmcm9tIEFJOicsIGVycm9yKVxuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdFcnJvciBkZSBjb25leGnDs24gYWwgZWxpbWluYXIgZXZlbnRvJ1xuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIE5vcm1hbGl6YSBub21icmVzIGRlIG1hdGVyaWFzIGNvbiBhY2VudG9zIHkgbWF5w7pzY3VsYXMgY29ycmVjdGFzXG4gKi9cbmZ1bmN0aW9uIG5vcm1hbGl6ZVN1YmplY3ROYW1lKHN1YmplY3Q/OiBzdHJpbmcgfCBudWxsKTogc3RyaW5nIHwgbnVsbCB7XG4gIGlmICghc3ViamVjdCkgcmV0dXJuIG51bGxcbiAgXG4gIGNvbnN0IG5vcm1hbGl6ZWQgPSBzdWJqZWN0LnRvTG93ZXJDYXNlKCkudHJpbSgpXG4gIFxuICBjb25zdCBzdWJqZWN0TWFwOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgICdxdWltaWNhJzogJ1F1w61taWNhJyxcbiAgICAncXXDrW1pY2EnOiAnUXXDrW1pY2EnLFxuICAgICdmaXNpY2EnOiAnRsOtc2ljYScsXG4gICAgJ2bDrXNpY2EnOiAnRsOtc2ljYScsXG4gICAgJ21hdGVtYXRpY2EnOiAnTWF0ZW3DoXRpY2EnLFxuICAgICdtYXRlbcOhdGljYXMnOiAnTWF0ZW3DoXRpY2FzJyxcbiAgICAnbWF0ZW1hdGljYXMnOiAnTWF0ZW3DoXRpY2FzJyxcbiAgICAnYmlvbG9naWEnOiAnQmlvbG9nw61hJyxcbiAgICAnYmlvbG9nw61hJzogJ0Jpb2xvZ8OtYScsXG4gICAgJ2hpc3RvcmlhJzogJ0hpc3RvcmlhJyxcbiAgICAnZ2VvZ3JhZmlhJzogJ0dlb2dyYWbDrWEnLFxuICAgICdnZW9ncmFmw61hJzogJ0dlb2dyYWbDrWEnLFxuICAgICdpbmdsZXMnOiAnSW5nbMOpcycsXG4gICAgJ2luZ2zDqXMnOiAnSW5nbMOpcycsXG4gICAgJ2xlbmd1YSc6ICdMZW5ndWEgeSBMaXRlcmF0dXJhJyxcbiAgICAnbGl0ZXJhdHVyYSc6ICdMZW5ndWEgeSBMaXRlcmF0dXJhJyxcbiAgICAnZmlsb3NvZmlhJzogJ0ZpbG9zb2bDrWEnLFxuICAgICdmaWxvc29mw61hJzogJ0ZpbG9zb2bDrWEnLFxuICAgICdlY29ub21pYSc6ICdFY29ub23DrWEnLFxuICAgICdlY29ub23DrWEnOiAnRWNvbm9tw61hJyxcbiAgICAnZWR1Y2FjaW9uIGZpc2ljYSc6ICdFZHVjYWNpw7NuIEbDrXNpY2EnLFxuICAgICdlZHVjYWNpw7NuIGbDrXNpY2EnOiAnRWR1Y2FjacOzbiBGw61zaWNhJyxcbiAgICAnZWQgZmlzaWNhJzogJ0VkdWNhY2nDs24gRsOtc2ljYScsXG4gICAgJ2FydGUnOiAnQXJ0ZScsXG4gICAgJ211c2ljYSc6ICdNw7pzaWNhJyxcbiAgICAnbcO6c2ljYSc6ICdNw7pzaWNhJ1xuICB9XG4gIFxuICAvLyBCdXNjYXIgY29pbmNpZGVuY2lhIGV4YWN0YSBwcmltZXJvXG4gIGlmIChzdWJqZWN0TWFwW25vcm1hbGl6ZWRdKSB7XG4gICAgcmV0dXJuIHN1YmplY3RNYXBbbm9ybWFsaXplZF1cbiAgfVxuICBcbiAgLy8gQnVzY2FyIGNvaW5jaWRlbmNpYSBwYXJjaWFsXG4gIGZvciAoY29uc3QgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHN1YmplY3RNYXApKSB7XG4gICAgaWYgKGtleS5pbmNsdWRlcyhub3JtYWxpemVkKSB8fCBub3JtYWxpemVkLmluY2x1ZGVzKGtleSkpIHtcbiAgICAgIHJldHVybiB2YWx1ZVxuICAgIH1cbiAgfVxuICBcbiAgLy8gU2kgbm8gc2UgZW5jdWVudHJhLCBjYXBpdGFsaXphciBwcmltZXJhIGxldHJhXG4gIHJldHVybiBzdWJqZWN0LmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3ViamVjdC5zbGljZSgxKS50b0xvd2VyQ2FzZSgpXG59Il0sIm5hbWVzIjpbImdldEV2ZW50VHlwZUNvbG9yIiwiZ2V0VXNlckNhbGVuZGFyRGF0YSIsImFuYWx5emVDb252ZXJzYXRpb25Gb3JFdmVudHMiLCJjb252ZXJzYXRpb25IaXN0b3J5IiwidXNlck1lc3NhZ2VzIiwiZmlsdGVyIiwibXNnIiwicm9sZSIsIm1hcCIsImNvbnRlbnQiLCJqb2luIiwiYW5hbHlzaXMiLCJoYXNFdmVudE1lbnRpb24iLCJldmVudFN1Z2dlc3Rpb25zIiwicXVlc3Rpb25zIiwibWlzc2luZ0luZm8iLCJsYXN0VXNlck1lc3NhZ2UiLCJsZW5ndGgiLCJtc2dMb3dlciIsInRvTG93ZXJDYXNlIiwiYWdlbmRhclBhdHRlcm5zIiwiaXNSZXF1ZXN0aW5nVG9TY2hlZHVsZSIsInRlc3QiLCJlZGl0YXJQYXR0ZXJucyIsImlzUmVxdWVzdGluZ1RvRWRpdCIsImVsaW1pbmFyUGF0dGVybnMiLCJpc1JlcXVlc3RpbmdUb0RlbGV0ZSIsImV2ZW50RGF0YSIsImV4dHJhY3RFdmVudERhdGFGcm9tTWVzc2FnZSIsImhhc0V2ZW50Iiwibm9ybWFsaXplZFN1YmplY3QiLCJub3JtYWxpemVTdWJqZWN0TmFtZSIsInN1YmplY3QiLCJwdXNoIiwidHlwZSIsInRpdGxlIiwiZGF0ZSIsInN0YXJ0VGltZSIsImR1cmF0aW9uIiwibG9jYXRpb24iLCJkZXNjcmlwdGlvbiIsInByaW9yaXR5IiwiY29uZmlkZW5jZSIsInN1Z2dlc3Rpb24iLCJtZXNzYWdlIiwiZXZlbnRUeXBlIiwic3ViamVjdFBhdHRlcm5zIiwicGF0dGVybiIsIm1hdGNoIiwiY2hhckF0IiwidG9VcHBlckNhc2UiLCJzbGljZSIsInNwZWNpZmljRGF0ZVBhdHRlcm5zIiwic291cmNlIiwiaW5jbHVkZXMiLCJkYXkiLCJwYXJzZUludCIsIm1vbnRoTmFtZSIsIm1vbnRoTWFwIiwidW5kZWZpbmVkIiwibm93IiwiRGF0ZSIsImV2ZW50RGF0ZSIsImdldEZ1bGxZZWFyIiwidG9JU09TdHJpbmciLCJzcGxpdCIsImlzTmFOIiwibW9udGgiLCJnZXRNb250aCIsInllYXIiLCJyZWxhdGl2ZURhdGVQYXR0ZXJucyIsImRheXMiLCJ0YXJnZXREYXkiLCJnZXRUaW1lIiwiY3VycmVudERheSIsImdldERheSIsImRheXNUb0FkZCIsInRpbWVQYXR0ZXJucyIsImhvdXIiLCJtaW51dGUiLCJwZXJpb2QiLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwibG9jYXRpb25QYXR0ZXJucyIsInJlcGxhY2UiLCJ0cmltIiwiZHVyYXRpb25NYXRjaCIsInZhbHVlIiwidW5pdCIsInRvcGljUGF0dGVybnMiLCJnZW5lcmF0ZUV2ZW50UXVlc3Rpb25zIiwiY29udmVydFN1Z2dlc3Rpb25Ub0NhbGVuZGFyRXZlbnQiLCJ1c2VySWQiLCJhZGRpdGlvbmFsSW5mbyIsIm1lcmdlZCIsInBhcnNlRGF0ZUZyb21UZXh0IiwiZW5kVGltZSIsInN0YXJ0IiwiZW5kIiwidG9UaW1lU3RyaW5nIiwic3Vic3RyaW5nIiwiZXZlbnQiLCJpZCIsImNvbG9yIiwiY3JlYXRlRXZlbnRGcm9tQUkiLCJjcmVhdGVDYWxlbmRhckV2ZW50IiwicmVxdWlyZSIsIm1vY2tSZXF1ZXN0IiwianNvbiIsInJlc3BvbnNlIiwicmVzdWx0Iiwic3VjY2VzcyIsImRpcmVjdENhbGxFcnJvciIsImNvbnNvbGUiLCJsb2ciLCJhZGRDYWxlbmRhckV2ZW50IiwiY3JlYXRlVXNlckNhbGVuZGFyRGF0YSIsInVzZXJEYXRhIiwiY2FsZW5kYXJFdmVudCIsInNldFRpbWVvdXQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiQ3VzdG9tRXZlbnQiLCJkZXRhaWwiLCJlcnJvciIsImRhdGVUZXh0IiwidGV4dCIsInRvZGF5IiwidG9tb3Jyb3ciLCJzZXREYXRlIiwiZ2V0RGF0ZSIsImRheUFmdGVyVG9tb3Jyb3ciLCJkYXlNYXAiLCJkYXlOYW1lIiwiZGF5TnVtYmVyIiwiT2JqZWN0IiwiZW50cmllcyIsInRhcmdldERhdGUiLCJkYXlzTWF0Y2giLCJmdXR1cmVEYXRlIiwiZGVmYXVsdERhdGUiLCJnZW5lcmF0ZUV2ZW50U3VnZ2VzdGlvblJlc3BvbnNlIiwiZGV0ZWN0ZWRJbmZvIiwiZGF0ZU9iaiIsImZvcm1hdHRlZERhdGUiLCJ0b0xvY2FsZURhdGVTdHJpbmciLCJ3ZWVrZGF5IiwiZm9yRWFjaCIsInF1ZXN0aW9uIiwiaW5kZXgiLCJBSUNhbGVuZGFySW50ZWdyYXRpb24iLCJjb25zdHJ1Y3RvciIsInBlbmRpbmdTdWdnZXN0aW9uIiwiY29sbGVjdGVkSW5mbyIsInByb2Nlc3NNZXNzYWdlIiwibmVlZHNFdmVudENyZWF0aW9uIiwiY3JlYXRlUGVuZGluZ0V2ZW50IiwiZ2VuZXJhdGVTdWNjZXNzTWVzc2FnZSIsImNvbGxlY3RBZGRpdGlvbmFsSW5mbyIsImluZm9UeXBlIiwiY2FuY2VsUGVuZGluZ0V2ZW50IiwiZ2V0UGVuZGluZ1N1Z2dlc3Rpb24iLCJkZXRhaWxzIiwiZGF0ZVN0ciIsImZpbmRVc2VyRXZlbnRzIiwic2VhcmNoVGV4dCIsInNlYXJjaCIsImV2ZW50cyIsImVkaXRFdmVudEZyb21BSSIsImV2ZW50SWQiLCJ1cGRhdGVzIiwidXBkYXRlQ2FsZW5kYXJFdmVudCIsImRlbGV0ZUV2ZW50RnJvbUFJIiwiZGVsZXRlQ2FsZW5kYXJFdmVudCIsImRlbGV0ZWRFdmVudCIsIm5vcm1hbGl6ZWQiLCJzdWJqZWN0TWFwIiwia2V5Il0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/calendar-ai-integration.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/calendar-data.ts":
/*!**********************************!*\
  !*** ./src/lib/calendar-data.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addCalendarEvent: () => (/* binding */ addCalendarEvent),\n/* harmony export */   createUserCalendarData: () => (/* binding */ createUserCalendarData),\n/* harmony export */   deleteCalendarEvent: () => (/* binding */ deleteCalendarEvent),\n/* harmony export */   findAvailableTimeSlots: () => (/* binding */ findAvailableTimeSlots),\n/* harmony export */   getEventTypeColor: () => (/* binding */ getEventTypeColor),\n/* harmony export */   getEventTypeIcon: () => (/* binding */ getEventTypeIcon),\n/* harmony export */   getEventsForDate: () => (/* binding */ getEventsForDate),\n/* harmony export */   getEventsForDateRange: () => (/* binding */ getEventsForDateRange),\n/* harmony export */   getUserCalendarData: () => (/* binding */ getUserCalendarData),\n/* harmony export */   isTimeSlotAvailable: () => (/* binding */ isTimeSlotAvailable),\n/* harmony export */   tempCalendarData: () => (/* binding */ tempCalendarData),\n/* harmony export */   updateCalendarEvent: () => (/* binding */ updateCalendarEvent),\n/* harmony export */   updateUserCalendarData: () => (/* binding */ updateUserCalendarData)\n/* harmony export */ });\n// Calendar Data Models for Smart Calendar\n// Temporary storage for calendar data\nconst globalForCalendarData = globalThis;\nconst tempCalendarData = globalForCalendarData.tempCalendarData ?? [];\nglobalForCalendarData.tempCalendarData = tempCalendarData;\n// Calendar Data Management Functions\nfunction getUserCalendarData(userId) {\n    return tempCalendarData.find((data)=>data.userId === userId);\n}\nfunction createUserCalendarData(userId) {\n    const newData = {\n        userId,\n        schoolSchedule: {\n            monday: [],\n            tuesday: [],\n            wednesday: [],\n            thursday: [],\n            friday: []\n        },\n        studyPreferences: {\n            preferredStudyTime: 'afternoon',\n            dailyStudyHours: 3,\n            maxSessionDuration: 90,\n            breakBetweenSessions: 15,\n            weekendStudyHours: 4,\n            noStudyDays: [\n                0\n            ] // Sunday\n        },\n        events: [],\n        isSetupComplete: false,\n        lastUpdated: new Date()\n    };\n    tempCalendarData.push(newData);\n    return newData;\n}\nfunction updateUserCalendarData(userId, updates) {\n    const index = tempCalendarData.findIndex((data)=>data.userId === userId);\n    if (index !== -1) {\n        tempCalendarData[index] = {\n            ...tempCalendarData[index],\n            ...updates,\n            lastUpdated: new Date()\n        };\n        return true;\n    }\n    return false;\n}\nfunction addCalendarEvent(userId, event) {\n    const userData = getUserCalendarData(userId);\n    if (userData) {\n        userData.events.push(event);\n        userData.lastUpdated = new Date();\n        // Force update in global storage\n        const index = tempCalendarData.findIndex((data)=>data.userId === userId);\n        if (index !== -1) {\n            tempCalendarData[index] = userData;\n        }\n        console.log(`📅 Evento agregado: ${event.title} - Total eventos: ${userData.events.length}`);\n        return true;\n    }\n    return false;\n}\nfunction updateCalendarEvent(userId, eventId, updates) {\n    const userData = getUserCalendarData(userId);\n    if (userData) {\n        const eventIndex = userData.events.findIndex((e)=>e.id === eventId);\n        if (eventIndex !== -1) {\n            userData.events[eventIndex] = {\n                ...userData.events[eventIndex],\n                ...updates\n            };\n            userData.lastUpdated = new Date();\n            // Force update in global storage\n            const index = tempCalendarData.findIndex((data)=>data.userId === userId);\n            if (index !== -1) {\n                tempCalendarData[index] = userData;\n            }\n            console.log(`📅 Evento actualizado: ${userData.events[eventIndex].title}`);\n            return true;\n        }\n    }\n    return false;\n}\nfunction deleteCalendarEvent(userId, eventId) {\n    const userData = getUserCalendarData(userId);\n    if (userData) {\n        const eventIndex = userData.events.findIndex((e)=>e.id === eventId);\n        if (eventIndex !== -1) {\n            const deletedEvent = userData.events[eventIndex];\n            userData.events.splice(eventIndex, 1);\n            userData.lastUpdated = new Date();\n            // Force update in global storage\n            const index = tempCalendarData.findIndex((data)=>data.userId === userId);\n            if (index !== -1) {\n                tempCalendarData[index] = userData;\n            }\n            console.log(`📅 Evento eliminado: ${deletedEvent.title} - Total eventos: ${userData.events.length}`);\n            return true;\n        }\n    }\n    return false;\n}\nfunction getEventsForDate(userId, date) {\n    const userData = getUserCalendarData(userId);\n    if (!userData) return [];\n    const targetDate = new Date(date);\n    targetDate.setHours(0, 0, 0, 0);\n    return userData.events.filter((event)=>{\n        const eventDate = new Date(event.date);\n        eventDate.setHours(0, 0, 0, 0);\n        return eventDate.getTime() === targetDate.getTime();\n    });\n}\nfunction getEventsForDateRange(userId, startDate, endDate) {\n    const userData = getUserCalendarData(userId);\n    if (!userData) return [];\n    return userData.events.filter((event)=>{\n        const eventDate = new Date(event.date);\n        return eventDate >= startDate && eventDate <= endDate;\n    });\n}\n// Utility functions for calendar operations\nfunction isTimeSlotAvailable(userId, date, startTime, endTime) {\n    const userData = getUserCalendarData(userId);\n    if (!userData) return true;\n    const dayName = getDayName(date.getDay());\n    const schoolSlots = userData.schoolSchedule[dayName] || [];\n    // Check school schedule conflicts\n    for (const slot of schoolSlots){\n        if (timeOverlaps(startTime, endTime, slot.start, slot.end)) {\n            return false;\n        }\n    }\n    // Check existing events\n    const dayEvents = getEventsForDate(userId, date);\n    for (const event of dayEvents){\n        if (event.startTime && event.endTime) {\n            if (timeOverlaps(startTime, endTime, event.startTime, event.endTime)) {\n                return false;\n            }\n        }\n    }\n    return true;\n}\nfunction findAvailableTimeSlots(userId, date, duration, preferredTime) {\n    const userData = getUserCalendarData(userId);\n    if (!userData) return [];\n    const slots = [];\n    // Define time ranges based on preference\n    const timeRanges = {\n        morning: [\n            '08:00',\n            '12:00'\n        ],\n        afternoon: [\n            '14:00',\n            '18:00'\n        ],\n        evening: [\n            '19:00',\n            '22:00'\n        ]\n    };\n    const searchRange = preferredTime ? timeRanges[preferredTime] : [\n        '08:00',\n        '22:00'\n    ];\n    const [searchStart, searchEnd] = searchRange;\n    // Generate potential slots every 30 minutes\n    const startMinutes = timeToMinutes(searchStart);\n    const endMinutes = timeToMinutes(searchEnd);\n    for(let minutes = startMinutes; minutes <= endMinutes - duration; minutes += 30){\n        const slotStart = minutesToTime(minutes);\n        const slotEnd = minutesToTime(minutes + duration);\n        if (isTimeSlotAvailable(userId, date, slotStart, slotEnd)) {\n            slots.push({\n                start: slotStart,\n                end: slotEnd\n            });\n        }\n    }\n    return slots;\n}\nfunction getEventTypeColor(type) {\n    const colors = {\n        exam: '#EF4444',\n        study_session: '#3B82F6',\n        class: '#10B981',\n        personal: '#8B5CF6',\n        extracurricular: '#F59E0B' // Orange\n    };\n    return colors[type] || '#64748B';\n}\nfunction getEventTypeIcon(type) {\n    const icons = {\n        exam: '📝',\n        study_session: '📚',\n        class: '🎓',\n        personal: '👤',\n        extracurricular: '🏃‍♀️'\n    };\n    return icons[type] || '📅';\n}\n// Helper functions\nfunction getDayName(dayIndex) {\n    const days = [\n        'sunday',\n        'monday',\n        'tuesday',\n        'wednesday',\n        'thursday',\n        'friday',\n        'saturday'\n    ];\n    return days[dayIndex];\n}\nfunction timeToMinutes(time) {\n    const [hours, minutes] = time.split(':').map(Number);\n    return hours * 60 + minutes;\n}\nfunction minutesToTime(minutes) {\n    const hours = Math.floor(minutes / 60);\n    const mins = minutes % 60;\n    return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;\n}\nfunction timeOverlaps(start1, end1, start2, end2) {\n    const start1Minutes = timeToMinutes(start1);\n    const end1Minutes = timeToMinutes(end1);\n    const start2Minutes = timeToMinutes(start2);\n    const end2Minutes = timeToMinutes(end2);\n    return start1Minutes < end2Minutes && end1Minutes > start2Minutes;\n}\n// Initialize demo data\nfunction initDemoCalendarData() {\n    const demoUserId = \"demo-student-fixed\";\n    if (!getUserCalendarData(demoUserId)) {\n        console.log(\"📅 Inicializando datos de calendario demo...\");\n        const demoData = createUserCalendarData(demoUserId);\n        // Demo school schedule\n        demoData.schoolSchedule = {\n            monday: [\n                {\n                    start: '08:00',\n                    end: '09:30',\n                    subject: 'Matemáticas',\n                    location: 'Aula 201',\n                    color: '#3B82F6'\n                },\n                {\n                    start: '09:45',\n                    end: '11:15',\n                    subject: 'Química',\n                    location: 'Laboratorio A',\n                    color: '#EF4444'\n                },\n                {\n                    start: '11:30',\n                    end: '13:00',\n                    subject: 'Historia',\n                    location: 'Aula 105',\n                    color: '#8B5CF6'\n                }\n            ],\n            tuesday: [\n                {\n                    start: '08:00',\n                    end: '09:30',\n                    subject: 'Física',\n                    location: 'Laboratorio B',\n                    color: '#10B981'\n                },\n                {\n                    start: '09:45',\n                    end: '11:15',\n                    subject: 'Literatura',\n                    location: 'Aula 203',\n                    color: '#F59E0B'\n                },\n                {\n                    start: '11:30',\n                    end: '13:00',\n                    subject: 'Biología',\n                    location: 'Laboratorio C',\n                    color: '#EC4899'\n                }\n            ],\n            wednesday: [\n                {\n                    start: '08:00',\n                    end: '09:30',\n                    subject: 'Matemáticas',\n                    location: 'Aula 201',\n                    color: '#3B82F6'\n                },\n                {\n                    start: '09:45',\n                    end: '11:15',\n                    subject: 'Educación Física',\n                    location: 'Gimnasio',\n                    color: '#06B6D4'\n                },\n                {\n                    start: '11:30',\n                    end: '13:00',\n                    subject: 'Arte',\n                    location: 'Taller',\n                    color: '#F97316'\n                }\n            ],\n            thursday: [\n                {\n                    start: '08:00',\n                    end: '09:30',\n                    subject: 'Química',\n                    location: 'Laboratorio A',\n                    color: '#EF4444'\n                },\n                {\n                    start: '09:45',\n                    end: '11:15',\n                    subject: 'Física',\n                    location: 'Laboratorio B',\n                    color: '#10B981'\n                },\n                {\n                    start: '11:30',\n                    end: '13:00',\n                    subject: 'Historia',\n                    location: 'Aula 105',\n                    color: '#8B5CF6'\n                }\n            ],\n            friday: [\n                {\n                    start: '08:00',\n                    end: '09:30',\n                    subject: 'Biología',\n                    location: 'Laboratorio C',\n                    color: '#EC4899'\n                },\n                {\n                    start: '09:45',\n                    end: '11:15',\n                    subject: 'Literatura',\n                    location: 'Aula 203',\n                    color: '#F59E0B'\n                },\n                {\n                    start: '11:30',\n                    end: '13:00',\n                    subject: 'Matemáticas',\n                    location: 'Aula 201',\n                    color: '#3B82F6'\n                }\n            ]\n        };\n        // Demo events\n        const now = new Date();\n        const demoEvents = [\n            {\n                id: 'exam-1',\n                title: 'Examen Química Orgánica',\n                date: new Date(now.getTime() + 7 * 24 * 60 * 60 * 1000),\n                startTime: '10:00',\n                endTime: '12:00',\n                type: 'exam',\n                color: getEventTypeColor('exam'),\n                description: 'Examen parcial de química orgánica',\n                subject: 'Química',\n                location: 'Laboratorio A'\n            },\n            {\n                id: 'study-1',\n                title: 'Sesión de Estudio - Matemáticas',\n                date: new Date(now.getTime() + 1 * 24 * 60 * 60 * 1000),\n                startTime: '15:00',\n                endTime: '16:30',\n                type: 'study_session',\n                color: getEventTypeColor('study_session'),\n                description: 'Repaso de cálculo integral',\n                subject: 'Matemáticas'\n            },\n            {\n                id: 'personal-1',\n                title: 'Entrenamiento Fútbol',\n                date: new Date(now.getTime() + 2 * 24 * 60 * 60 * 1000),\n                startTime: '17:00',\n                endTime: '18:30',\n                type: 'extracurricular',\n                color: getEventTypeColor('extracurricular'),\n                description: 'Entrenamiento de fútbol',\n                location: 'Campo deportivo'\n            }\n        ];\n        demoEvents.forEach((event)=>{\n            demoData.events.push(event);\n        });\n        demoData.isSetupComplete = true;\n        demoData.lastUpdated = new Date();\n        console.log(\"✅ Datos de calendario demo inicializados\");\n    } else {\n        console.log(\"✅ Datos de calendario demo ya existen\");\n    }\n}\n// Initialize demo data on module load\ninitDemoCalendarData();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEtBQUs7Z0JBQ2xESyxXQUFXO2dCQUNYQyxTQUFTO2dCQUNUNkIsTUFBTTtnQkFDTmtDLE9BQU9uQyxrQkFBa0I7Z0JBQ3pCc0MsYUFBYTtnQkFDYkosVUFBVTtZQUNaO1NBQ0Q7UUFFREcsV0FBV0UsT0FBTyxDQUFDN0YsQ0FBQUE7WUFDakJzRixTQUFTaEcsTUFBTSxDQUFDSSxJQUFJLENBQUNNO1FBQ3ZCO1FBRUFzRixTQUFTL0YsZUFBZSxHQUFHO1FBQzNCK0YsU0FBUzlGLFdBQVcsR0FBRyxJQUFJQztRQUUzQlMsUUFBUUMsR0FBRyxDQUFDO0lBQ2QsT0FBTztRQUNMRCxRQUFRQyxHQUFHLENBQUM7SUFDZDtBQUNGO0FBRUEsc0NBQXNDO0FBQ3RDaUYiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvY2FsZW5kYXItZGF0YS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDYWxlbmRhciBEYXRhIE1vZGVscyBmb3IgU21hcnQgQ2FsZW5kYXJcblxuZXhwb3J0IGludGVyZmFjZSBUaW1lU2xvdCB7XG4gIHN0YXJ0OiBzdHJpbmcgLy8gXCIwODowMFwiXG4gIGVuZDogc3RyaW5nICAgLy8gXCIwOTozMFwiXG4gIHN1YmplY3Q6IHN0cmluZ1xuICBsb2NhdGlvbj86IHN0cmluZ1xuICBjb2xvcj86IHN0cmluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNjaG9vbFNjaGVkdWxlIHtcbiAgbW9uZGF5OiBUaW1lU2xvdFtdXG4gIHR1ZXNkYXk6IFRpbWVTbG90W11cbiAgd2VkbmVzZGF5OiBUaW1lU2xvdFtdXG4gIHRodXJzZGF5OiBUaW1lU2xvdFtdXG4gIGZyaWRheTogVGltZVNsb3RbXVxuICBzYXR1cmRheT86IFRpbWVTbG90W11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBDYWxlbmRhckV2ZW50IHtcbiAgaWQ6IHN0cmluZ1xuICB0aXRsZTogc3RyaW5nXG4gIGRhdGU6IERhdGVcbiAgc3RhcnRUaW1lPzogc3RyaW5nXG4gIGVuZFRpbWU/OiBzdHJpbmdcbiAgdHlwZTogJ2V4YW0nIHwgJ3N0dWR5X3Nlc3Npb24nIHwgJ2NsYXNzJyB8ICdwZXJzb25hbCcgfCAnZXh0cmFjdXJyaWN1bGFyJ1xuICBjb2xvcjogc3RyaW5nXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gIHN1YmplY3Q/OiBzdHJpbmdcbiAgbG9jYXRpb24/OiBzdHJpbmdcbiAgcHJpb3JpdHk/OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnXG4gIGR1cmF0aW9uPzogbnVtYmVyIC8vIGluIG1pbnV0ZXNcbiAgaXNSZWN1cnJpbmc/OiBib29sZWFuXG4gIHJlY3VycmluZ1BhdHRlcm4/OiB7XG4gICAgZnJlcXVlbmN5OiAnZGFpbHknIHwgJ3dlZWtseScgfCAnbW9udGhseSdcbiAgICBkYXlzPzogbnVtYmVyW10gLy8gMD1TdW5kYXksIDE9TW9uZGF5LCBldGMuXG4gICAgZW5kRGF0ZT86IERhdGVcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0dWR5UHJlZmVyZW5jZXMge1xuICBwcmVmZXJyZWRTdHVkeVRpbWU6ICdtb3JuaW5nJyB8ICdhZnRlcm5vb24nIHwgJ2V2ZW5pbmcnIHwgJ2ZsZXhpYmxlJ1xuICBkYWlseVN0dWR5SG91cnM6IG51bWJlclxuICBtYXhTZXNzaW9uRHVyYXRpb246IG51bWJlclxuICBicmVha0JldHdlZW5TZXNzaW9uczogbnVtYmVyXG4gIHdlZWtlbmRTdHVkeUhvdXJzOiBudW1iZXJcbiAgbm9TdHVkeURheXM6IG51bWJlcltdIC8vIERheXMgb2Ygd2VlayB0byBhdm9pZCBzdHVkeWluZ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVzZXJDYWxlbmRhckRhdGEge1xuICB1c2VySWQ6IHN0cmluZ1xuICBzY2hvb2xTY2hlZHVsZTogU2Nob29sU2NoZWR1bGVcbiAgc3R1ZHlQcmVmZXJlbmNlczogU3R1ZHlQcmVmZXJlbmNlc1xuICBldmVudHM6IENhbGVuZGFyRXZlbnRbXVxuICBpc1NldHVwQ29tcGxldGU6IGJvb2xlYW5cbiAgbGFzdFVwZGF0ZWQ6IERhdGVcbn1cblxuLy8gVGVtcG9yYXJ5IHN0b3JhZ2UgZm9yIGNhbGVuZGFyIGRhdGFcbmNvbnN0IGdsb2JhbEZvckNhbGVuZGFyRGF0YSA9IGdsb2JhbFRoaXMgYXMgdW5rbm93biBhcyB7XG4gIHRlbXBDYWxlbmRhckRhdGE6IFVzZXJDYWxlbmRhckRhdGFbXSB8IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3QgdGVtcENhbGVuZGFyRGF0YTogVXNlckNhbGVuZGFyRGF0YVtdID0gZ2xvYmFsRm9yQ2FsZW5kYXJEYXRhLnRlbXBDYWxlbmRhckRhdGEgPz8gW11cbmdsb2JhbEZvckNhbGVuZGFyRGF0YS50ZW1wQ2FsZW5kYXJEYXRhID0gdGVtcENhbGVuZGFyRGF0YVxuXG4vLyBDYWxlbmRhciBEYXRhIE1hbmFnZW1lbnQgRnVuY3Rpb25zXG5leHBvcnQgZnVuY3Rpb24gZ2V0VXNlckNhbGVuZGFyRGF0YSh1c2VySWQ6IHN0cmluZyk6IFVzZXJDYWxlbmRhckRhdGEgfCB1bmRlZmluZWQge1xuICByZXR1cm4gdGVtcENhbGVuZGFyRGF0YS5maW5kKGRhdGEgPT4gZGF0YS51c2VySWQgPT09IHVzZXJJZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVVzZXJDYWxlbmRhckRhdGEodXNlcklkOiBzdHJpbmcpOiBVc2VyQ2FsZW5kYXJEYXRhIHtcbiAgY29uc3QgbmV3RGF0YTogVXNlckNhbGVuZGFyRGF0YSA9IHtcbiAgICB1c2VySWQsXG4gICAgc2Nob29sU2NoZWR1bGU6IHtcbiAgICAgIG1vbmRheTogW10sXG4gICAgICB0dWVzZGF5OiBbXSxcbiAgICAgIHdlZG5lc2RheTogW10sXG4gICAgICB0aHVyc2RheTogW10sXG4gICAgICBmcmlkYXk6IFtdXG4gICAgfSxcbiAgICBzdHVkeVByZWZlcmVuY2VzOiB7XG4gICAgICBwcmVmZXJyZWRTdHVkeVRpbWU6ICdhZnRlcm5vb24nLFxuICAgICAgZGFpbHlTdHVkeUhvdXJzOiAzLFxuICAgICAgbWF4U2Vzc2lvbkR1cmF0aW9uOiA5MCxcbiAgICAgIGJyZWFrQmV0d2VlblNlc3Npb25zOiAxNSxcbiAgICAgIHdlZWtlbmRTdHVkeUhvdXJzOiA0LFxuICAgICAgbm9TdHVkeURheXM6IFswXSAvLyBTdW5kYXlcbiAgICB9LFxuICAgIGV2ZW50czogW10sXG4gICAgaXNTZXR1cENvbXBsZXRlOiBmYWxzZSxcbiAgICBsYXN0VXBkYXRlZDogbmV3IERhdGUoKVxuICB9XG4gIFxuICB0ZW1wQ2FsZW5kYXJEYXRhLnB1c2gobmV3RGF0YSlcbiAgcmV0dXJuIG5ld0RhdGFcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVVzZXJDYWxlbmRhckRhdGEodXNlcklkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8VXNlckNhbGVuZGFyRGF0YT4pOiBib29sZWFuIHtcbiAgY29uc3QgaW5kZXggPSB0ZW1wQ2FsZW5kYXJEYXRhLmZpbmRJbmRleChkYXRhID0+IGRhdGEudXNlcklkID09PSB1c2VySWQpXG4gIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICB0ZW1wQ2FsZW5kYXJEYXRhW2luZGV4XSA9IHtcbiAgICAgIC4uLnRlbXBDYWxlbmRhckRhdGFbaW5kZXhdLFxuICAgICAgLi4udXBkYXRlcyxcbiAgICAgIGxhc3RVcGRhdGVkOiBuZXcgRGF0ZSgpXG4gICAgfVxuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRDYWxlbmRhckV2ZW50KHVzZXJJZDogc3RyaW5nLCBldmVudDogQ2FsZW5kYXJFdmVudCk6IGJvb2xlYW4ge1xuICBjb25zdCB1c2VyRGF0YSA9IGdldFVzZXJDYWxlbmRhckRhdGEodXNlcklkKVxuICBpZiAodXNlckRhdGEpIHtcbiAgICB1c2VyRGF0YS5ldmVudHMucHVzaChldmVudClcbiAgICB1c2VyRGF0YS5sYXN0VXBkYXRlZCA9IG5ldyBEYXRlKClcbiAgICBcbiAgICAvLyBGb3JjZSB1cGRhdGUgaW4gZ2xvYmFsIHN0b3JhZ2VcbiAgICBjb25zdCBpbmRleCA9IHRlbXBDYWxlbmRhckRhdGEuZmluZEluZGV4KGRhdGEgPT4gZGF0YS51c2VySWQgPT09IHVzZXJJZClcbiAgICBpZiAoaW5kZXggIT09IC0xKSB7XG4gICAgICB0ZW1wQ2FsZW5kYXJEYXRhW2luZGV4XSA9IHVzZXJEYXRhXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDwn5OFIEV2ZW50byBhZ3JlZ2FkbzogJHtldmVudC50aXRsZX0gLSBUb3RhbCBldmVudG9zOiAke3VzZXJEYXRhLmV2ZW50cy5sZW5ndGh9YClcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXBkYXRlQ2FsZW5kYXJFdmVudCh1c2VySWQ6IHN0cmluZywgZXZlbnRJZDogc3RyaW5nLCB1cGRhdGVzOiBQYXJ0aWFsPENhbGVuZGFyRXZlbnQ+KTogYm9vbGVhbiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gZ2V0VXNlckNhbGVuZGFyRGF0YSh1c2VySWQpXG4gIGlmICh1c2VyRGF0YSkge1xuICAgIGNvbnN0IGV2ZW50SW5kZXggPSB1c2VyRGF0YS5ldmVudHMuZmluZEluZGV4KGUgPT4gZS5pZCA9PT0gZXZlbnRJZClcbiAgICBpZiAoZXZlbnRJbmRleCAhPT0gLTEpIHtcbiAgICAgIHVzZXJEYXRhLmV2ZW50c1tldmVudEluZGV4XSA9IHtcbiAgICAgICAgLi4udXNlckRhdGEuZXZlbnRzW2V2ZW50SW5kZXhdLFxuICAgICAgICAuLi51cGRhdGVzXG4gICAgICB9XG4gICAgICB1c2VyRGF0YS5sYXN0VXBkYXRlZCA9IG5ldyBEYXRlKClcbiAgICAgIFxuICAgICAgLy8gRm9yY2UgdXBkYXRlIGluIGdsb2JhbCBzdG9yYWdlXG4gICAgICBjb25zdCBpbmRleCA9IHRlbXBDYWxlbmRhckRhdGEuZmluZEluZGV4KGRhdGEgPT4gZGF0YS51c2VySWQgPT09IHVzZXJJZClcbiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHtcbiAgICAgICAgdGVtcENhbGVuZGFyRGF0YVtpbmRleF0gPSB1c2VyRGF0YVxuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmxvZyhg8J+ThSBFdmVudG8gYWN0dWFsaXphZG86ICR7dXNlckRhdGEuZXZlbnRzW2V2ZW50SW5kZXhdLnRpdGxlfWApXG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cbiAgfVxuICByZXR1cm4gZmFsc2Vcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRlbGV0ZUNhbGVuZGFyRXZlbnQodXNlcklkOiBzdHJpbmcsIGV2ZW50SWQ6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCB1c2VyRGF0YSA9IGdldFVzZXJDYWxlbmRhckRhdGEodXNlcklkKVxuICBpZiAodXNlckRhdGEpIHtcbiAgICBjb25zdCBldmVudEluZGV4ID0gdXNlckRhdGEuZXZlbnRzLmZpbmRJbmRleChlID0+IGUuaWQgPT09IGV2ZW50SWQpXG4gICAgaWYgKGV2ZW50SW5kZXggIT09IC0xKSB7XG4gICAgICBjb25zdCBkZWxldGVkRXZlbnQgPSB1c2VyRGF0YS5ldmVudHNbZXZlbnRJbmRleF1cbiAgICAgIHVzZXJEYXRhLmV2ZW50cy5zcGxpY2UoZXZlbnRJbmRleCwgMSlcbiAgICAgIHVzZXJEYXRhLmxhc3RVcGRhdGVkID0gbmV3IERhdGUoKVxuICAgICAgXG4gICAgICAvLyBGb3JjZSB1cGRhdGUgaW4gZ2xvYmFsIHN0b3JhZ2VcbiAgICAgIGNvbnN0IGluZGV4ID0gdGVtcENhbGVuZGFyRGF0YS5maW5kSW5kZXgoZGF0YSA9PiBkYXRhLnVzZXJJZCA9PT0gdXNlcklkKVxuICAgICAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgICAgICB0ZW1wQ2FsZW5kYXJEYXRhW2luZGV4XSA9IHVzZXJEYXRhXG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKGDwn5OFIEV2ZW50byBlbGltaW5hZG86ICR7ZGVsZXRlZEV2ZW50LnRpdGxlfSAtIFRvdGFsIGV2ZW50b3M6ICR7dXNlckRhdGEuZXZlbnRzLmxlbmd0aH1gKVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFdmVudHNGb3JEYXRlKHVzZXJJZDogc3RyaW5nLCBkYXRlOiBEYXRlKTogQ2FsZW5kYXJFdmVudFtdIHtcbiAgY29uc3QgdXNlckRhdGEgPSBnZXRVc2VyQ2FsZW5kYXJEYXRhKHVzZXJJZClcbiAgaWYgKCF1c2VyRGF0YSkgcmV0dXJuIFtdXG4gIFxuICBjb25zdCB0YXJnZXREYXRlID0gbmV3IERhdGUoZGF0ZSlcbiAgdGFyZ2V0RGF0ZS5zZXRIb3VycygwLCAwLCAwLCAwKVxuICBcbiAgcmV0dXJuIHVzZXJEYXRhLmV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xuICAgIGNvbnN0IGV2ZW50RGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRhdGUpXG4gICAgZXZlbnREYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApXG4gICAgcmV0dXJuIGV2ZW50RGF0ZS5nZXRUaW1lKCkgPT09IHRhcmdldERhdGUuZ2V0VGltZSgpXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFdmVudHNGb3JEYXRlUmFuZ2UodXNlcklkOiBzdHJpbmcsIHN0YXJ0RGF0ZTogRGF0ZSwgZW5kRGF0ZTogRGF0ZSk6IENhbGVuZGFyRXZlbnRbXSB7XG4gIGNvbnN0IHVzZXJEYXRhID0gZ2V0VXNlckNhbGVuZGFyRGF0YSh1c2VySWQpXG4gIGlmICghdXNlckRhdGEpIHJldHVybiBbXVxuICBcbiAgcmV0dXJuIHVzZXJEYXRhLmV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xuICAgIGNvbnN0IGV2ZW50RGF0ZSA9IG5ldyBEYXRlKGV2ZW50LmRhdGUpXG4gICAgcmV0dXJuIGV2ZW50RGF0ZSA+PSBzdGFydERhdGUgJiYgZXZlbnREYXRlIDw9IGVuZERhdGVcbiAgfSlcbn1cblxuLy8gVXRpbGl0eSBmdW5jdGlvbnMgZm9yIGNhbGVuZGFyIG9wZXJhdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBpc1RpbWVTbG90QXZhaWxhYmxlKFxuICB1c2VySWQ6IHN0cmluZywgXG4gIGRhdGU6IERhdGUsIFxuICBzdGFydFRpbWU6IHN0cmluZywgXG4gIGVuZFRpbWU6IHN0cmluZ1xuKTogYm9vbGVhbiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gZ2V0VXNlckNhbGVuZGFyRGF0YSh1c2VySWQpXG4gIGlmICghdXNlckRhdGEpIHJldHVybiB0cnVlXG4gIFxuICBjb25zdCBkYXlOYW1lID0gZ2V0RGF5TmFtZShkYXRlLmdldERheSgpKVxuICBjb25zdCBzY2hvb2xTbG90cyA9IHVzZXJEYXRhLnNjaG9vbFNjaGVkdWxlW2RheU5hbWVdIHx8IFtdXG4gIFxuICAvLyBDaGVjayBzY2hvb2wgc2NoZWR1bGUgY29uZmxpY3RzXG4gIGZvciAoY29uc3Qgc2xvdCBvZiBzY2hvb2xTbG90cykge1xuICAgIGlmICh0aW1lT3ZlcmxhcHMoc3RhcnRUaW1lLCBlbmRUaW1lLCBzbG90LnN0YXJ0LCBzbG90LmVuZCkpIHtcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cbiAgfVxuICBcbiAgLy8gQ2hlY2sgZXhpc3RpbmcgZXZlbnRzXG4gIGNvbnN0IGRheUV2ZW50cyA9IGdldEV2ZW50c0ZvckRhdGUodXNlcklkLCBkYXRlKVxuICBmb3IgKGNvbnN0IGV2ZW50IG9mIGRheUV2ZW50cykge1xuICAgIGlmIChldmVudC5zdGFydFRpbWUgJiYgZXZlbnQuZW5kVGltZSkge1xuICAgICAgaWYgKHRpbWVPdmVybGFwcyhzdGFydFRpbWUsIGVuZFRpbWUsIGV2ZW50LnN0YXJ0VGltZSwgZXZlbnQuZW5kVGltZSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gdHJ1ZVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZEF2YWlsYWJsZVRpbWVTbG90cyhcbiAgdXNlcklkOiBzdHJpbmcsXG4gIGRhdGU6IERhdGUsXG4gIGR1cmF0aW9uOiBudW1iZXIsIC8vIGluIG1pbnV0ZXNcbiAgcHJlZmVycmVkVGltZT86ICdtb3JuaW5nJyB8ICdhZnRlcm5vb24nIHwgJ2V2ZW5pbmcnXG4pOiB7IHN0YXJ0OiBzdHJpbmc7IGVuZDogc3RyaW5nIH1bXSB7XG4gIGNvbnN0IHVzZXJEYXRhID0gZ2V0VXNlckNhbGVuZGFyRGF0YSh1c2VySWQpXG4gIGlmICghdXNlckRhdGEpIHJldHVybiBbXVxuICBcbiAgY29uc3Qgc2xvdHM6IHsgc3RhcnQ6IHN0cmluZzsgZW5kOiBzdHJpbmcgfVtdID0gW11cbiAgXG4gIC8vIERlZmluZSB0aW1lIHJhbmdlcyBiYXNlZCBvbiBwcmVmZXJlbmNlXG4gIGNvbnN0IHRpbWVSYW5nZXMgPSB7XG4gICAgbW9ybmluZzogWycwODowMCcsICcxMjowMCddLFxuICAgIGFmdGVybm9vbjogWycxNDowMCcsICcxODowMCddLFxuICAgIGV2ZW5pbmc6IFsnMTk6MDAnLCAnMjI6MDAnXVxuICB9XG4gIFxuICBjb25zdCBzZWFyY2hSYW5nZSA9IHByZWZlcnJlZFRpbWUgPyB0aW1lUmFuZ2VzW3ByZWZlcnJlZFRpbWVdIDogWycwODowMCcsICcyMjowMCddXG4gIGNvbnN0IFtzZWFyY2hTdGFydCwgc2VhcmNoRW5kXSA9IHNlYXJjaFJhbmdlXG4gIFxuICAvLyBHZW5lcmF0ZSBwb3RlbnRpYWwgc2xvdHMgZXZlcnkgMzAgbWludXRlc1xuICBjb25zdCBzdGFydE1pbnV0ZXMgPSB0aW1lVG9NaW51dGVzKHNlYXJjaFN0YXJ0KVxuICBjb25zdCBlbmRNaW51dGVzID0gdGltZVRvTWludXRlcyhzZWFyY2hFbmQpXG4gIFxuICBmb3IgKGxldCBtaW51dGVzID0gc3RhcnRNaW51dGVzOyBtaW51dGVzIDw9IGVuZE1pbnV0ZXMgLSBkdXJhdGlvbjsgbWludXRlcyArPSAzMCkge1xuICAgIGNvbnN0IHNsb3RTdGFydCA9IG1pbnV0ZXNUb1RpbWUobWludXRlcylcbiAgICBjb25zdCBzbG90RW5kID0gbWludXRlc1RvVGltZShtaW51dGVzICsgZHVyYXRpb24pXG4gICAgXG4gICAgaWYgKGlzVGltZVNsb3RBdmFpbGFibGUodXNlcklkLCBkYXRlLCBzbG90U3RhcnQsIHNsb3RFbmQpKSB7XG4gICAgICBzbG90cy5wdXNoKHsgc3RhcnQ6IHNsb3RTdGFydCwgZW5kOiBzbG90RW5kIH0pXG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gc2xvdHNcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEV2ZW50VHlwZUNvbG9yKHR5cGU6IENhbGVuZGFyRXZlbnRbJ3R5cGUnXSk6IHN0cmluZyB7XG4gIGNvbnN0IGNvbG9ycyA9IHtcbiAgICBleGFtOiAnI0VGNDQ0NCcsICAgICAgICAgIC8vIFJlZFxuICAgIHN0dWR5X3Nlc3Npb246ICcjM0I4MkY2JywgLy8gQmx1ZVxuICAgIGNsYXNzOiAnIzEwQjk4MScsICAgICAgICAgLy8gR3JlZW5cbiAgICBwZXJzb25hbDogJyM4QjVDRjYnLCAgICAgIC8vIFB1cnBsZVxuICAgIGV4dHJhY3VycmljdWxhcjogJyNGNTlFMEInIC8vIE9yYW5nZVxuICB9XG4gIHJldHVybiBjb2xvcnNbdHlwZV0gfHwgJyM2NDc0OEInXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRFdmVudFR5cGVJY29uKHR5cGU6IENhbGVuZGFyRXZlbnRbJ3R5cGUnXSk6IHN0cmluZyB7XG4gIGNvbnN0IGljb25zID0ge1xuICAgIGV4YW06ICfwn5OdJyxcbiAgICBzdHVkeV9zZXNzaW9uOiAn8J+TmicsXG4gICAgY2xhc3M6ICfwn46TJyxcbiAgICBwZXJzb25hbDogJ/CfkaQnLFxuICAgIGV4dHJhY3VycmljdWxhcjogJ/Cfj4PigI3imYDvuI8nXG4gIH1cbiAgcmV0dXJuIGljb25zW3R5cGVdIHx8ICfwn5OFJ1xufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb25zXG5mdW5jdGlvbiBnZXREYXlOYW1lKGRheUluZGV4OiBudW1iZXIpOiBrZXlvZiBTY2hvb2xTY2hlZHVsZSB7XG4gIGNvbnN0IGRheXMgPSBbJ3N1bmRheScsICdtb25kYXknLCAndHVlc2RheScsICd3ZWRuZXNkYXknLCAndGh1cnNkYXknLCAnZnJpZGF5JywgJ3NhdHVyZGF5J11cbiAgcmV0dXJuIGRheXNbZGF5SW5kZXhdIGFzIGtleW9mIFNjaG9vbFNjaGVkdWxlXG59XG5cbmZ1bmN0aW9uIHRpbWVUb01pbnV0ZXModGltZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgY29uc3QgW2hvdXJzLCBtaW51dGVzXSA9IHRpbWUuc3BsaXQoJzonKS5tYXAoTnVtYmVyKVxuICByZXR1cm4gaG91cnMgKiA2MCArIG1pbnV0ZXNcbn1cblxuZnVuY3Rpb24gbWludXRlc1RvVGltZShtaW51dGVzOiBudW1iZXIpOiBzdHJpbmcge1xuICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IobWludXRlcyAvIDYwKVxuICBjb25zdCBtaW5zID0gbWludXRlcyAlIDYwXG4gIHJldHVybiBgJHtob3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bWlucy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YFxufVxuXG5mdW5jdGlvbiB0aW1lT3ZlcmxhcHMoc3RhcnQxOiBzdHJpbmcsIGVuZDE6IHN0cmluZywgc3RhcnQyOiBzdHJpbmcsIGVuZDI6IHN0cmluZyk6IGJvb2xlYW4ge1xuICBjb25zdCBzdGFydDFNaW51dGVzID0gdGltZVRvTWludXRlcyhzdGFydDEpXG4gIGNvbnN0IGVuZDFNaW51dGVzID0gdGltZVRvTWludXRlcyhlbmQxKVxuICBjb25zdCBzdGFydDJNaW51dGVzID0gdGltZVRvTWludXRlcyhzdGFydDIpXG4gIGNvbnN0IGVuZDJNaW51dGVzID0gdGltZVRvTWludXRlcyhlbmQyKVxuICBcbiAgcmV0dXJuIHN0YXJ0MU1pbnV0ZXMgPCBlbmQyTWludXRlcyAmJiBlbmQxTWludXRlcyA+IHN0YXJ0Mk1pbnV0ZXNcbn1cblxuLy8gSW5pdGlhbGl6ZSBkZW1vIGRhdGFcbmZ1bmN0aW9uIGluaXREZW1vQ2FsZW5kYXJEYXRhKCkge1xuICBjb25zdCBkZW1vVXNlcklkID0gXCJkZW1vLXN0dWRlbnQtZml4ZWRcIlxuICBcbiAgaWYgKCFnZXRVc2VyQ2FsZW5kYXJEYXRhKGRlbW9Vc2VySWQpKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5OFIEluaWNpYWxpemFuZG8gZGF0b3MgZGUgY2FsZW5kYXJpbyBkZW1vLi4uXCIpXG4gICAgXG4gICAgY29uc3QgZGVtb0RhdGEgPSBjcmVhdGVVc2VyQ2FsZW5kYXJEYXRhKGRlbW9Vc2VySWQpXG4gICAgXG4gICAgLy8gRGVtbyBzY2hvb2wgc2NoZWR1bGVcbiAgICBkZW1vRGF0YS5zY2hvb2xTY2hlZHVsZSA9IHtcbiAgICAgIG1vbmRheTogW1xuICAgICAgICB7IHN0YXJ0OiAnMDg6MDAnLCBlbmQ6ICcwOTozMCcsIHN1YmplY3Q6ICdNYXRlbcOhdGljYXMnLCBsb2NhdGlvbjogJ0F1bGEgMjAxJywgY29sb3I6ICcjM0I4MkY2JyB9LFxuICAgICAgICB7IHN0YXJ0OiAnMDk6NDUnLCBlbmQ6ICcxMToxNScsIHN1YmplY3Q6ICdRdcOtbWljYScsIGxvY2F0aW9uOiAnTGFib3JhdG9yaW8gQScsIGNvbG9yOiAnI0VGNDQ0NCcgfSxcbiAgICAgICAgeyBzdGFydDogJzExOjMwJywgZW5kOiAnMTM6MDAnLCBzdWJqZWN0OiAnSGlzdG9yaWEnLCBsb2NhdGlvbjogJ0F1bGEgMTA1JywgY29sb3I6ICcjOEI1Q0Y2JyB9XG4gICAgICBdLFxuICAgICAgdHVlc2RheTogW1xuICAgICAgICB7IHN0YXJ0OiAnMDg6MDAnLCBlbmQ6ICcwOTozMCcsIHN1YmplY3Q6ICdGw61zaWNhJywgbG9jYXRpb246ICdMYWJvcmF0b3JpbyBCJywgY29sb3I6ICcjMTBCOTgxJyB9LFxuICAgICAgICB7IHN0YXJ0OiAnMDk6NDUnLCBlbmQ6ICcxMToxNScsIHN1YmplY3Q6ICdMaXRlcmF0dXJhJywgbG9jYXRpb246ICdBdWxhIDIwMycsIGNvbG9yOiAnI0Y1OUUwQicgfSxcbiAgICAgICAgeyBzdGFydDogJzExOjMwJywgZW5kOiAnMTM6MDAnLCBzdWJqZWN0OiAnQmlvbG9nw61hJywgbG9jYXRpb246ICdMYWJvcmF0b3JpbyBDJywgY29sb3I6ICcjRUM0ODk5JyB9XG4gICAgICBdLFxuICAgICAgd2VkbmVzZGF5OiBbXG4gICAgICAgIHsgc3RhcnQ6ICcwODowMCcsIGVuZDogJzA5OjMwJywgc3ViamVjdDogJ01hdGVtw6F0aWNhcycsIGxvY2F0aW9uOiAnQXVsYSAyMDEnLCBjb2xvcjogJyMzQjgyRjYnIH0sXG4gICAgICAgIHsgc3RhcnQ6ICcwOTo0NScsIGVuZDogJzExOjE1Jywgc3ViamVjdDogJ0VkdWNhY2nDs24gRsOtc2ljYScsIGxvY2F0aW9uOiAnR2ltbmFzaW8nLCBjb2xvcjogJyMwNkI2RDQnIH0sXG4gICAgICAgIHsgc3RhcnQ6ICcxMTozMCcsIGVuZDogJzEzOjAwJywgc3ViamVjdDogJ0FydGUnLCBsb2NhdGlvbjogJ1RhbGxlcicsIGNvbG9yOiAnI0Y5NzMxNicgfVxuICAgICAgXSxcbiAgICAgIHRodXJzZGF5OiBbXG4gICAgICAgIHsgc3RhcnQ6ICcwODowMCcsIGVuZDogJzA5OjMwJywgc3ViamVjdDogJ1F1w61taWNhJywgbG9jYXRpb246ICdMYWJvcmF0b3JpbyBBJywgY29sb3I6ICcjRUY0NDQ0JyB9LFxuICAgICAgICB7IHN0YXJ0OiAnMDk6NDUnLCBlbmQ6ICcxMToxNScsIHN1YmplY3Q6ICdGw61zaWNhJywgbG9jYXRpb246ICdMYWJvcmF0b3JpbyBCJywgY29sb3I6ICcjMTBCOTgxJyB9LFxuICAgICAgICB7IHN0YXJ0OiAnMTE6MzAnLCBlbmQ6ICcxMzowMCcsIHN1YmplY3Q6ICdIaXN0b3JpYScsIGxvY2F0aW9uOiAnQXVsYSAxMDUnLCBjb2xvcjogJyM4QjVDRjYnIH1cbiAgICAgIF0sXG4gICAgICBmcmlkYXk6IFtcbiAgICAgICAgeyBzdGFydDogJzA4OjAwJywgZW5kOiAnMDk6MzAnLCBzdWJqZWN0OiAnQmlvbG9nw61hJywgbG9jYXRpb246ICdMYWJvcmF0b3JpbyBDJywgY29sb3I6ICcjRUM0ODk5JyB9LFxuICAgICAgICB7IHN0YXJ0OiAnMDk6NDUnLCBlbmQ6ICcxMToxNScsIHN1YmplY3Q6ICdMaXRlcmF0dXJhJywgbG9jYXRpb246ICdBdWxhIDIwMycsIGNvbG9yOiAnI0Y1OUUwQicgfSxcbiAgICAgICAgeyBzdGFydDogJzExOjMwJywgZW5kOiAnMTM6MDAnLCBzdWJqZWN0OiAnTWF0ZW3DoXRpY2FzJywgbG9jYXRpb246ICdBdWxhIDIwMScsIGNvbG9yOiAnIzNCODJGNicgfVxuICAgICAgXVxuICAgIH1cbiAgICBcbiAgICAvLyBEZW1vIGV2ZW50c1xuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBkZW1vRXZlbnRzOiBDYWxlbmRhckV2ZW50W10gPSBbXG4gICAgICB7XG4gICAgICAgIGlkOiAnZXhhbS0xJyxcbiAgICAgICAgdGl0bGU6ICdFeGFtZW4gUXXDrW1pY2EgT3Jnw6FuaWNhJyxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUobm93LmdldFRpbWUoKSArIDcgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcbiAgICAgICAgc3RhcnRUaW1lOiAnMTA6MDAnLFxuICAgICAgICBlbmRUaW1lOiAnMTI6MDAnLFxuICAgICAgICB0eXBlOiAnZXhhbScsXG4gICAgICAgIGNvbG9yOiBnZXRFdmVudFR5cGVDb2xvcignZXhhbScpLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ0V4YW1lbiBwYXJjaWFsIGRlIHF1w61taWNhIG9yZ8OhbmljYScsXG4gICAgICAgIHN1YmplY3Q6ICdRdcOtbWljYScsXG4gICAgICAgIGxvY2F0aW9uOiAnTGFib3JhdG9yaW8gQSdcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGlkOiAnc3R1ZHktMScsXG4gICAgICAgIHRpdGxlOiAnU2VzacOzbiBkZSBFc3R1ZGlvIC0gTWF0ZW3DoXRpY2FzJyxcbiAgICAgICAgZGF0ZTogbmV3IERhdGUobm93LmdldFRpbWUoKSArIDEgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcbiAgICAgICAgc3RhcnRUaW1lOiAnMTU6MDAnLFxuICAgICAgICBlbmRUaW1lOiAnMTY6MzAnLFxuICAgICAgICB0eXBlOiAnc3R1ZHlfc2Vzc2lvbicsXG4gICAgICAgIGNvbG9yOiBnZXRFdmVudFR5cGVDb2xvcignc3R1ZHlfc2Vzc2lvbicpLFxuICAgICAgICBkZXNjcmlwdGlvbjogJ1JlcGFzbyBkZSBjw6FsY3VsbyBpbnRlZ3JhbCcsXG4gICAgICAgIHN1YmplY3Q6ICdNYXRlbcOhdGljYXMnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBpZDogJ3BlcnNvbmFsLTEnLFxuICAgICAgICB0aXRsZTogJ0VudHJlbmFtaWVudG8gRsO6dGJvbCcsXG4gICAgICAgIGRhdGU6IG5ldyBEYXRlKG5vdy5nZXRUaW1lKCkgKyAyICogMjQgKiA2MCAqIDYwICogMTAwMCksXG4gICAgICAgIHN0YXJ0VGltZTogJzE3OjAwJyxcbiAgICAgICAgZW5kVGltZTogJzE4OjMwJyxcbiAgICAgICAgdHlwZTogJ2V4dHJhY3VycmljdWxhcicsXG4gICAgICAgIGNvbG9yOiBnZXRFdmVudFR5cGVDb2xvcignZXh0cmFjdXJyaWN1bGFyJyksXG4gICAgICAgIGRlc2NyaXB0aW9uOiAnRW50cmVuYW1pZW50byBkZSBmw7p0Ym9sJyxcbiAgICAgICAgbG9jYXRpb246ICdDYW1wbyBkZXBvcnRpdm8nXG4gICAgICB9XG4gICAgXVxuICAgIFxuICAgIGRlbW9FdmVudHMuZm9yRWFjaChldmVudCA9PiB7XG4gICAgICBkZW1vRGF0YS5ldmVudHMucHVzaChldmVudClcbiAgICB9KVxuICAgIFxuICAgIGRlbW9EYXRhLmlzU2V0dXBDb21wbGV0ZSA9IHRydWVcbiAgICBkZW1vRGF0YS5sYXN0VXBkYXRlZCA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBjb25zb2xlLmxvZyhcIuKchSBEYXRvcyBkZSBjYWxlbmRhcmlvIGRlbW8gaW5pY2lhbGl6YWRvc1wiKVxuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKFwi4pyFIERhdG9zIGRlIGNhbGVuZGFyaW8gZGVtbyB5YSBleGlzdGVuXCIpXG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZSBkZW1vIGRhdGEgb24gbW9kdWxlIGxvYWRcbmluaXREZW1vQ2FsZW5kYXJEYXRhKCkiXSwibmFtZXMiOlsiZ2xvYmFsRm9yQ2FsZW5kYXJEYXRhIiwiZ2xvYmFsVGhpcyIsInRlbXBDYWxlbmRhckRhdGEiLCJnZXRVc2VyQ2FsZW5kYXJEYXRhIiwidXNlcklkIiwiZmluZCIsImRhdGEiLCJjcmVhdGVVc2VyQ2FsZW5kYXJEYXRhIiwibmV3RGF0YSIsInNjaG9vbFNjaGVkdWxlIiwibW9uZGF5IiwidHVlc2RheSIsIndlZG5lc2RheSIsInRodXJzZGF5IiwiZnJpZGF5Iiwic3R1ZHlQcmVmZXJlbmNlcyIsInByZWZlcnJlZFN0dWR5VGltZSIsImRhaWx5U3R1ZHlIb3VycyIsIm1heFNlc3Npb25EdXJhdGlvbiIsImJyZWFrQmV0d2VlblNlc3Npb25zIiwid2Vla2VuZFN0dWR5SG91cnMiLCJub1N0dWR5RGF5cyIsImV2ZW50cyIsImlzU2V0dXBDb21wbGV0ZSIsImxhc3RVcGRhdGVkIiwiRGF0ZSIsInB1c2giLCJ1cGRhdGVVc2VyQ2FsZW5kYXJEYXRhIiwidXBkYXRlcyIsImluZGV4IiwiZmluZEluZGV4IiwiYWRkQ2FsZW5kYXJFdmVudCIsImV2ZW50IiwidXNlckRhdGEiLCJjb25zb2xlIiwibG9nIiwidGl0bGUiLCJsZW5ndGgiLCJ1cGRhdGVDYWxlbmRhckV2ZW50IiwiZXZlbnRJZCIsImV2ZW50SW5kZXgiLCJlIiwiaWQiLCJkZWxldGVDYWxlbmRhckV2ZW50IiwiZGVsZXRlZEV2ZW50Iiwic3BsaWNlIiwiZ2V0RXZlbnRzRm9yRGF0ZSIsImRhdGUiLCJ0YXJnZXREYXRlIiwic2V0SG91cnMiLCJmaWx0ZXIiLCJldmVudERhdGUiLCJnZXRUaW1lIiwiZ2V0RXZlbnRzRm9yRGF0ZVJhbmdlIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsImlzVGltZVNsb3RBdmFpbGFibGUiLCJzdGFydFRpbWUiLCJlbmRUaW1lIiwiZGF5TmFtZSIsImdldERheU5hbWUiLCJnZXREYXkiLCJzY2hvb2xTbG90cyIsInNsb3QiLCJ0aW1lT3ZlcmxhcHMiLCJzdGFydCIsImVuZCIsImRheUV2ZW50cyIsImZpbmRBdmFpbGFibGVUaW1lU2xvdHMiLCJkdXJhdGlvbiIsInByZWZlcnJlZFRpbWUiLCJzbG90cyIsInRpbWVSYW5nZXMiLCJtb3JuaW5nIiwiYWZ0ZXJub29uIiwiZXZlbmluZyIsInNlYXJjaFJhbmdlIiwic2VhcmNoU3RhcnQiLCJzZWFyY2hFbmQiLCJzdGFydE1pbnV0ZXMiLCJ0aW1lVG9NaW51dGVzIiwiZW5kTWludXRlcyIsIm1pbnV0ZXMiLCJzbG90U3RhcnQiLCJtaW51dGVzVG9UaW1lIiwic2xvdEVuZCIsImdldEV2ZW50VHlwZUNvbG9yIiwidHlwZSIsImNvbG9ycyIsImV4YW0iLCJzdHVkeV9zZXNzaW9uIiwiY2xhc3MiLCJwZXJzb25hbCIsImV4dHJhY3VycmljdWxhciIsImdldEV2ZW50VHlwZUljb24iLCJpY29ucyIsImRheUluZGV4IiwiZGF5cyIsInRpbWUiLCJob3VycyIsInNwbGl0IiwibWFwIiwiTnVtYmVyIiwiTWF0aCIsImZsb29yIiwibWlucyIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJzdGFydDEiLCJlbmQxIiwic3RhcnQyIiwiZW5kMiIsInN0YXJ0MU1pbnV0ZXMiLCJlbmQxTWludXRlcyIsInN0YXJ0Mk1pbnV0ZXMiLCJlbmQyTWludXRlcyIsImluaXREZW1vQ2FsZW5kYXJEYXRhIiwiZGVtb1VzZXJJZCIsImRlbW9EYXRhIiwic3ViamVjdCIsImxvY2F0aW9uIiwiY29sb3IiLCJub3ciLCJkZW1vRXZlbnRzIiwiZGVzY3JpcHRpb24iLCJmb3JFYWNoIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/calendar-data.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/contextual-conversation-manager.ts":
/*!****************************************************!*\
  !*** ./src/lib/contextual-conversation-manager.ts ***!
  \****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ContextualConversationManager: () => (/* binding */ ContextualConversationManager)\n/* harmony export */ });\n/* harmony import */ var _advanced_learning_profiles__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./advanced-learning-profiles */ \"(rsc)/./src/lib/advanced-learning-profiles.ts\");\n/* harmony import */ var _visual_learning_engine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./visual-learning-engine */ \"(rsc)/./src/lib/visual-learning-engine.ts\");\n/* harmony import */ var _calendar_ai_integration__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./calendar-ai-integration */ \"(rsc)/./src/lib/calendar-ai-integration.ts\");\n// Contextual Conversation Manager for Sara AI\n// Provides intelligent context management and conversation coherence\n\n\n\nclass ContextualConversationManager {\n    static{\n        // Configuration for persistent conversation management\n        this.MAX_TURNS_RETAINED = 20;\n    }\n    static{\n        this.MAX_REFERENCES = 10;\n    }\n    static{\n        this.CONTEXT_DECAY_HOURS = 24;\n    }\n    /**\n   * Processes user message with full contextual awareness\n   */ static async processContextualMessage(userId, message, sessionId, userName) {\n        const actualSessionId = sessionId || `session_${userId}_${Date.now()}`;\n        // Import persistent storage functions\n        const { getConversationSession, createConversationSession, addConversationTurn, addPendingTask, getPendingTasks } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n        // Get or create persistent conversation session\n        let session = getConversationSession(userId, actualSessionId);\n        if (!session) {\n            session = createConversationSession(userId, actualSessionId);\n        }\n        console.log(`💬 Processing message for session ${actualSessionId}: \"${message.substring(0, 50)}...\"`);\n        console.log(`📊 Session has ${session.turns.length} previous turns, ${session.pendingTasks.filter((t)=>!t.completed).length} pending tasks`);\n        // Analyze message metadata\n        const messageMetadata = this.analyzeMessageMetadata(message);\n        // Add user turn to persistent storage\n        session = addConversationTurn(userId, actualSessionId, 'user', message, messageMetadata);\n        // Check for pending tasks that might relate to this message\n        const pendingTasks = getPendingTasks(userId, actualSessionId);\n        // Build context from persistent data\n        const context = {\n            userId,\n            sessionId: actualSessionId,\n            currentTopic: session.currentTopic,\n            currentSubject: session.currentSubject,\n            conversationFlow: session.turns.map((turn)=>({\n                    id: turn.id,\n                    timestamp: turn.timestamp,\n                    role: turn.role,\n                    content: turn.content,\n                    metadata: turn.metadata\n                })),\n            contextSummary: this.buildContextSummary(session),\n            activeIntentions: this.extractActiveIntentions(session.turns.slice(-5)),\n            pendingQuestions: [],\n            referenceMemory: this.buildReferenceMemory(session.turns),\n            lastUpdate: new Date()\n        };\n        // Generate contextually aware response\n        const response = await this.generateContextualResponse(context, userName, pendingTasks);\n        // Add assistant turn to persistent storage\n        const assistantMetadata = {\n            confidence: response.continuityScore,\n            visualsGenerated: !!response.visualRecommendation,\n            searchPerformed: response.personalizations.includes('academic_search'),\n            taskCompleted: response.personalizations.includes('task_completed')\n        };\n        addConversationTurn(userId, actualSessionId, 'assistant', response.content, assistantMetadata);\n        return response;\n    }\n    /**\n   * Build context summary from persistent conversation data\n   */ static buildContextSummary(session) {\n        const recentTurns = session.turns.slice(-6);\n        const keyTopics = [\n            ...new Set(recentTurns.map((turn)=>turn.metadata.topic).filter(Boolean))\n        ];\n        const keySubjects = [\n            ...new Set(recentTurns.map((turn)=>turn.metadata.subject).filter(Boolean))\n        ];\n        const summaryParts = [];\n        if (keySubjects.length > 0) {\n            summaryParts.push(`Materias: ${keySubjects.join(', ')}`);\n        }\n        if (keyTopics.length > 0) {\n            summaryParts.push(`Temas: ${keyTopics.join(', ')}`);\n        }\n        return summaryParts.join(' | ') || 'Conversación general';\n    }\n    /**\n   * Extract active intentions from recent conversation turns\n   */ static extractActiveIntentions(recentTurns) {\n        const intentions = recentTurns.map((turn)=>turn.metadata.intention).filter(Boolean).slice(-3);\n        return [\n            ...new Set(intentions)\n        ];\n    }\n    /**\n   * Build reference memory from conversation turns\n   */ static buildReferenceMemory(turns) {\n        const references = [];\n        const recentTurns = turns.slice(-10);\n        recentTurns.forEach((turn, index)=>{\n            if (turn.metadata.confidence && turn.metadata.confidence > 0.7) {\n                references.push({\n                    id: `ref_${turn.id}`,\n                    type: this.determineReferenceTypeFromMetadata(turn.metadata),\n                    content: turn.content.substring(0, 100) + '...',\n                    relevanceScore: turn.metadata.confidence,\n                    turnIndex: index,\n                    timestamp: turn.timestamp\n                });\n            }\n        });\n        return references.slice(-5) // Keep only last 5 references\n        ;\n    }\n    /**\n   * Helper to determine reference type from metadata\n   */ static determineReferenceTypeFromMetadata(metadata) {\n        if (metadata.intention === 'continuation') return 'topic_continuation';\n        if (metadata.intention === 'problem_solving') return 'problem_solving';\n        if (metadata.intention === 'explanation') return 'explanation_followup';\n        return 'subject_reference';\n    }\n    /**\n   * Handles calendar task execution with real event creation\n   */ static async handleCalendarTasks(userId, message, conversationHistory, pendingTasks) {\n        console.log(`🔍 Checking for calendar tasks in message: \"${message.substring(0, 50)}...\"`);\n        // Initialize calendar integration\n        const calendarIntegration = new _calendar_ai_integration__WEBPACK_IMPORTED_MODULE_2__.AICalendarIntegration(userId);\n        // Analyze message for calendar events\n        const calendarResult = await calendarIntegration.processMessage(message, conversationHistory);\n        if (calendarResult.needsEventCreation) {\n            console.log(`🎯 Calendar task detected and executed!`);\n            // Mark any related pending task as completed\n            if (pendingTasks.length > 0) {\n                const calendarTask = pendingTasks.find((t)=>t.type === 'calendar_event');\n                if (calendarTask) {\n                    const { markTaskCompleted } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n                    markTaskCompleted(userId, 'current-session', calendarTask.id, calendarResult);\n                }\n            }\n            return {\n                type: 'calendar_event_creation',\n                content: calendarResult.response || 'Evento creado exitosamente',\n                metadata: {\n                    suggestedActions: calendarResult.event ? [\n                        'Ver en calendario',\n                        'Editar evento',\n                        'Eliminar evento'\n                    ] : [\n                        'Reintentar',\n                        'Proporcionar más detalles'\n                    ],\n                    eventCreated: !!calendarResult.event\n                }\n            };\n        }\n        return null;\n    }\n    /**\n   * Builds educational prompt based on conversation context\n   */ static buildEducationalPrompt(context, message, userName) {\n        const recentTurns = context.conversationFlow.slice(-3);\n        const conversationContext = recentTurns.map((turn)=>`${turn.role === 'user' ? 'Estudiante' : 'Tutor'}: ${turn.content}`).join('\\n');\n        let prompt = `Eres Sara, una tutora de IA especializada en educación secundaria. `;\n        if (userName) {\n            prompt += `El estudiante se llama ${userName}. `;\n        }\n        if (context.currentSubject) {\n            prompt += `Actualmente estás ayudando con ${context.currentSubject}. `;\n        }\n        if (context.contextSummary && context.contextSummary !== 'Conversación general') {\n            prompt += `Contexto de la conversación: ${context.contextSummary}. `;\n        }\n        prompt += `\\n\\nConversación reciente:\\n${conversationContext}`;\n        prompt += `\\n\\nNuevo mensaje del estudiante: \"${message}\"`;\n        prompt += `\\n\\nInstrucciones:\\n`;\n        prompt += `- Responde como Sara, la tutora de IA amigable y experta\\n`;\n        prompt += `- Mantén coherencia con la conversación anterior\\n`;\n        prompt += `- Si detectas que el estudiante quiere agendar algo (examen, sesión de estudio), menciona que puedes ayudar con eso\\n`;\n        prompt += `- Usa ejemplos concretos y un lenguaje claro para estudiantes de secundaria\\n`;\n        prompt += `- Si es una pregunta académica, proporciona explicaciones paso a paso\\n`;\n        prompt += `- Mantén un tono motivador y positivo\\n\\n`;\n        prompt += `Respuesta de Sara:`;\n        return prompt;\n    }\n    /**\n   * Generates contextual fallback response when AI services fail\n   */ static generateContextualFallback(context, message, userName) {\n        const msgLower = message.toLowerCase();\n        // Calendar-related fallback\n        if (/agendes?|agend[aá]|cre[ae]|programa|anot[ae]|agrega.*(?:examen|evento|sesión)/i.test(message)) {\n            return `¡Hola${userName ? ' ' + userName : ''}! Veo que quieres agendar algo en tu calendario.\\n\\n` + `Por favor proporciona estos detalles:\\n` + `📅 **Fecha**: ¿Para cuándo es?\\n` + `🕐 **Hora**: ¿A qué hora?\\n` + `📚 **Tema**: ¿De qué se trata?\\n\\n` + `Una vez que me des estos datos, podré agregarlo a tu calendario automáticamente.`;\n        }\n        // Academic question fallback\n        if (/¿|qué.*es|cómo|explica|no.*entiendo/i.test(message)) {\n            let response = `Entiendo tu pregunta${userName ? ', ' + userName : ''}.\\n\\n`;\n            if (context.currentSubject) {\n                response += `Para ayudarte mejor con ${context.currentSubject}, `;\n            }\n            response += `¿podrías ser más específico sobre qué parte necesitas que te explique?\\n\\n`;\n            response += `Mientras tanto, puedo:\\n`;\n            response += `• Explicarte conceptos paso a paso\\n`;\n            response += `• Ayudarte a resolver ejercicios\\n`;\n            response += `• Crear recordatorios de estudio\\n`;\n            response += `• Agendar sesiones de repaso`;\n            return response;\n        }\n        // General fallback with context\n        let response = `¡Hola${userName ? ' ' + userName : ''}! 👋\\n\\n`;\n        if (context.currentSubject) {\n            response += `Veo que hemos estado trabajando con ${context.currentSubject}. `;\n        }\n        response += `¿En qué más puedo ayudarte hoy?\\n\\n`;\n        response += `Puedo ayudarte con:\\n`;\n        response += `📚 **Explicar conceptos** de tus materias\\n`;\n        response += `📝 **Resolver ejercicios** paso a paso\\n`;\n        response += `📅 **Agendar eventos** en tu calendario\\n`;\n        response += `🎯 **Hacer evaluaciones** adaptativas\\n`;\n        response += `🔍 **Buscar información** académica`;\n        return response;\n    }\n    /**\n   * Analyzes message metadata for context\n   */ static analyzeMessageMetadata(message) {\n        const msgLower = message.toLowerCase();\n        // Subject detection\n        let subject;\n        if (/matemáticas?|álgebra|geometría|cálculo/.test(msgLower)) {\n            subject = 'matemáticas';\n        } else if (/física|mecánica|cinemática|energía/.test(msgLower)) {\n            subject = 'física';\n        } else if (/química|reacción|átomo|molécula/.test(msgLower)) {\n            subject = 'química';\n        }\n        // Topic detection\n        let topic;\n        const topicMatches = msgLower.match(/(ecuación|función|derivada|integral|fórmula|problema)/gi);\n        if (topicMatches) {\n            topic = topicMatches[0];\n        }\n        // Intention detection\n        let intention;\n        if (/explica|qué es|cómo funciona/.test(msgLower)) {\n            intention = 'explanation';\n        } else if (/resuelve|calcula|encuentra/.test(msgLower)) {\n            intention = 'problem_solving';\n        } else if (/ayuda|no entiendo|estoy confundido/.test(msgLower)) {\n            intention = 'help_request';\n        } else if (/continúa|sigue|y después/.test(msgLower)) {\n            intention = 'continuation';\n        }\n        // Confidence based on clarity and specificity\n        let confidence = 0.5;\n        if (subject) confidence += 0.2;\n        if (topic) confidence += 0.2;\n        if (intention) confidence += 0.1;\n        return {\n            subject,\n            topic,\n            intention,\n            confidence: Math.min(confidence, 1.0)\n        };\n    }\n    /**\n   * Updates contextual information based on new message\n   */ static async updateContextualInformation(context, message) {\n        const recentTurns = context.conversationFlow.slice(-5);\n        const metadata = recentTurns[recentTurns.length - 1]?.metadata;\n        // Update current topic/subject if detected\n        if (metadata?.subject) {\n            context.currentSubject = metadata.subject;\n        }\n        if (metadata?.topic) {\n            context.currentTopic = metadata.topic;\n        }\n        // Detect conversation continuity patterns\n        if (metadata?.intention === 'continuation') {\n            const lastAssistantTurn = recentTurns.slice().reverse().find((turn)=>turn.role === 'assistant');\n            if (lastAssistantTurn?.metadata?.subject) {\n                context.currentSubject = lastAssistantTurn.metadata.subject;\n            }\n        }\n        // Update active intentions\n        if (metadata?.intention && !context.activeIntentions.includes(metadata.intention)) {\n            context.activeIntentions.push(metadata.intention);\n            // Keep only recent intentions\n            if (context.activeIntentions.length > 3) {\n                context.activeIntentions.shift();\n            }\n        }\n        // Create context references for important information\n        if (metadata?.confidence && metadata.confidence > 0.7) {\n            const reference = {\n                id: `ref_${Date.now()}`,\n                type: this.determineReferenceType(metadata),\n                content: message,\n                relevanceScore: metadata.confidence,\n                turnIndex: context.conversationFlow.length - 1,\n                timestamp: new Date()\n            };\n            context.referenceMemory.push(reference);\n            // Keep only most relevant references\n            if (context.referenceMemory.length > this.MAX_REFERENCES) {\n                context.referenceMemory.sort((a, b)=>b.relevanceScore - a.relevanceScore);\n                context.referenceMemory = context.referenceMemory.slice(0, this.MAX_REFERENCES);\n            }\n        }\n        // Update context summary\n        await this.updateContextSummary(context);\n    }\n    /**\n   * Determines reference type based on metadata\n   */ static determineReferenceType(metadata) {\n        if (metadata.intention === 'continuation') return 'topic_continuation';\n        if (metadata.intention === 'problem_solving') return 'problem_solving';\n        if (metadata.intention === 'explanation') return 'explanation_followup';\n        return 'subject_reference';\n    }\n    /**\n   * Updates context summary with key conversation points\n   */ static async updateContextSummary(context) {\n        const recentTurns = context.conversationFlow.slice(-6);\n        const keyTopics = [\n            ...new Set(recentTurns.map((turn)=>turn.metadata.topic).filter(Boolean))\n        ];\n        const keySubjects = [\n            ...new Set(recentTurns.map((turn)=>turn.metadata.subject).filter(Boolean))\n        ];\n        const summaryParts = [];\n        if (keySubjects.length > 0) {\n            summaryParts.push(`Materias: ${keySubjects.join(', ')}`);\n        }\n        if (keyTopics.length > 0) {\n            summaryParts.push(`Temas: ${keyTopics.join(', ')}`);\n        }\n        if (context.activeIntentions.length > 0) {\n            summaryParts.push(`Intenciones: ${context.activeIntentions.join(', ')}`);\n        }\n        context.contextSummary = summaryParts.join(' | ') || 'Conversación general';\n    }\n    /**\n   * Generates contextually aware response using persistent storage\n   */ static async generateContextualResponse(context, userName, pendingTasks = []) {\n        // Get learning profile for personalization\n        const learningProfile = _advanced_learning_profiles__WEBPACK_IMPORTED_MODULE_0__.AdvancedLearningProfileManager.getLearningProfile(context.userId);\n        // Update learning profile based on current message\n        const latestMessage = context.conversationFlow[context.conversationFlow.length - 1]?.content || '';\n        _advanced_learning_profiles__WEBPACK_IMPORTED_MODULE_0__.AdvancedLearningProfileManager.processUserMessage(context.userId, latestMessage);\n        // Analyze conversation for continuity\n        const continuityAnalysis = this.analyzeContinuity(context);\n        // 🎯 FIRST PRIORITY: Check for calendar task execution\n        const calendarResult = await this.handleCalendarTasks(context.userId, latestMessage, this.formatConversationHistory(context), pendingTasks);\n        if (calendarResult) {\n            console.log(`📅 Calendar task executed: ${calendarResult.type}`);\n            return {\n                content: calendarResult.content,\n                context,\n                continuityScore: 0.9,\n                personalizations: [\n                    'calendar_task_executed'\n                ],\n                suggestedFollowups: calendarResult.metadata?.suggestedActions || []\n            };\n        }\n        // Generate base response using AI providers directly\n        const { aiService } = __webpack_require__(/*! ./ai-providers */ \"(rsc)/./src/lib/ai-providers.ts\");\n        let baseContent = '';\n        try {\n            // Create educational prompt based on context\n            const educationalPrompt = this.buildEducationalPrompt(context, latestMessage, userName);\n            baseContent = await aiService.generateExercise(educationalPrompt);\n            // If AI service returns fallback template, use contextual fallback\n            if (baseContent === 'TEMPLATE_FALLBACK') {\n                baseContent = this.generateContextualFallback(context, latestMessage, userName);\n            }\n        } catch (error) {\n            console.error('AI service error, using contextual fallback:', error);\n            baseContent = this.generateContextualFallback(context, latestMessage, userName);\n        }\n        // Enhance response with contextual information\n        let enhancedContent = baseContent;\n        // Add continuity references if relevant\n        if (continuityAnalysis.shouldReference) {\n            enhancedContent = this.addContinuityReferences(enhancedContent, context);\n        }\n        // Apply learning style adaptations\n        enhancedContent = _advanced_learning_profiles__WEBPACK_IMPORTED_MODULE_0__.AdvancedLearningProfileManager.adaptResponseToLearningStyle(enhancedContent, learningProfile);\n        // Determine personalizations applied\n        const personalizations = [];\n        if (continuityAnalysis.shouldReference) personalizations.push('context_reference');\n        if (learningProfile.primaryStyle !== 'multimodal') personalizations.push('learning_style_adaptation');\n        if (pendingTasks.length > 0) personalizations.push('task_aware');\n        // Generate visual recommendations\n        let visualRecommendation;\n        if (learningProfile.adaptationPreferences.prefersVisualAids && (context.currentSubject || context.currentTopic)) {\n            visualRecommendation = {\n                type: _visual_learning_engine__WEBPACK_IMPORTED_MODULE_1__.VisualLearningEngine.detectOptimalVisualType(enhancedContent, context.currentSubject),\n                reason: `Recomendado para tu perfil de aprendizaje ${learningProfile.primaryStyle}`\n            };\n        }\n        // Generate follow-up suggestions\n        const followups = this.generateContextualFollowups(context, learningProfile);\n        return {\n            content: enhancedContent,\n            context,\n            continuityScore: continuityAnalysis.score,\n            personalizations,\n            suggestedFollowups: followups,\n            visualRecommendation\n        };\n    }\n    /**\n   * Analyzes conversation continuity\n   */ static analyzeContinuity(context) {\n        const recentTurns = context.conversationFlow.slice(-4);\n        let score = 0.5 // Base score\n        ;\n        let shouldReference = false;\n        let referenceType;\n        // Check for topic continuity\n        const topics = recentTurns.map((turn)=>turn.metadata.topic).filter(Boolean);\n        if (topics.length > 1 && topics[topics.length - 1] === topics[topics.length - 2]) {\n            score += 0.2;\n            shouldReference = true;\n            referenceType = 'topic_continuity';\n        }\n        // Check for subject continuity\n        const subjects = recentTurns.map((turn)=>turn.metadata.subject).filter(Boolean);\n        if (subjects.length > 1 && subjects[subjects.length - 1] === subjects[subjects.length - 2]) {\n            score += 0.15;\n            shouldReference = true;\n            referenceType = 'subject_continuity';\n        }\n        // Check for continuation indicators\n        const latestMessage = recentTurns[recentTurns.length - 1]?.content?.toLowerCase() || '';\n        if (/continúa|sigue|y después|también|además/.test(latestMessage)) {\n            score += 0.25;\n            shouldReference = true;\n            referenceType = 'explicit_continuation';\n        }\n        // Check for question follow-up patterns\n        const hasQuestionFollowup = recentTurns.some((turn, index)=>index > 0 && turn.role === 'user' && /por qué|cómo|cuándo|dónde|explica/.test(turn.content.toLowerCase()) && recentTurns[index - 1]?.role === 'assistant');\n        if (hasQuestionFollowup) {\n            score += 0.1;\n            shouldReference = true;\n            referenceType = 'followup_question';\n        }\n        return {\n            score: Math.min(score, 1.0),\n            shouldReference,\n            referenceType\n        };\n    }\n    /**\n   * Adds continuity references to response\n   */ static addContinuityReferences(content, context) {\n        const recentAssistantTurns = context.conversationFlow.filter((turn)=>turn.role === 'assistant').slice(-2);\n        if (recentAssistantTurns.length === 0) return content;\n        const lastTopic = context.currentTopic;\n        const lastSubject = context.currentSubject;\n        let referencePrefix = '';\n        if (lastTopic && lastSubject) {\n            referencePrefix = `Continuando con ${lastTopic} en ${lastSubject}: `;\n        } else if (lastTopic) {\n            referencePrefix = `Siguiendo con el tema de ${lastTopic}: `;\n        } else if (lastSubject) {\n            referencePrefix = `Continuando con ${lastSubject}: `;\n        } else {\n            referencePrefix = `Como mencioné anteriormente: `;\n        }\n        return referencePrefix + content;\n    }\n    /**\n   * Generates contextual follow-up suggestions\n   */ static generateContextualFollowups(context, learningProfile) {\n        const followups = [];\n        // Based on current topic/subject\n        if (context.currentTopic) {\n            followups.push(`¿Tienes más preguntas sobre ${context.currentTopic}?`);\n        }\n        if (context.currentSubject) {\n            followups.push(`¿Te gustaría ver ejercicios de ${context.currentSubject}?`);\n        }\n        // Based on learning style\n        if (learningProfile.adaptationPreferences.prefersVisualAids) {\n            followups.push('¿Te ayudaría ver un diagrama de esto?');\n        }\n        if (learningProfile.adaptationPreferences.prefersInteraction) {\n            followups.push('¿Quieres practicar con un ejercicio?');\n        }\n        // Based on active intentions\n        if (context.activeIntentions.includes('explanation')) {\n            followups.push('¿Necesitas que profundice en algún aspecto específico?');\n        }\n        if (context.activeIntentions.includes('problem_solving')) {\n            followups.push('¿Quieres que resolvamos otro problema similar?');\n        }\n        // Generic contextual followups\n        if (context.conversationFlow.length > 3) {\n            followups.push('¿Hay algo que no quedó claro?');\n        }\n        return followups.slice(0, 3) // Limit to 3 suggestions\n        ;\n    }\n    /**\n   * Formats conversation history for external engines\n   */ static formatConversationHistory(context) {\n        return context.conversationFlow.slice(-10) // Last 10 turns\n        .map((turn)=>({\n                role: turn.role,\n                content: turn.content\n            }));\n    }\n    /**\n   * Maintains context memory by cleaning old data\n   */ static maintainContextMemory(context) {\n        // Keep only recent turns\n        if (context.conversationFlow.length > this.MAX_TURNS_RETAINED) {\n            context.conversationFlow = context.conversationFlow.slice(-this.MAX_TURNS_RETAINED);\n        }\n        // Clean old references\n        const cutoffTime = new Date(Date.now() - 12 * 60 * 60 * 1000) // 12 hours\n        ;\n        context.referenceMemory = context.referenceMemory.filter((ref)=>ref.timestamp > cutoffTime);\n        // Clean old intentions\n        if (context.activeIntentions.length > 3) {\n            context.activeIntentions = context.activeIntentions.slice(-3);\n        }\n    }\n    /**\n   * Gets conversation statistics using persistent storage\n   */ static getConversationStats(userId) {\n        const { getUserActiveSessions } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n        if (userId) {\n            const userSessions = getUserActiveSessions(userId);\n            return {\n                activeContexts: userSessions.length,\n                totalTurns: userSessions.reduce((sum, session)=>sum + session.turns.length, 0),\n                currentTopics: [\n                    ...new Set(userSessions.map((session)=>session.currentTopic).filter(Boolean))\n                ],\n                currentSubjects: [\n                    ...new Set(userSessions.map((session)=>session.currentSubject).filter(Boolean))\n                ]\n            };\n        }\n        // For global stats, we need to import the conversations array\n        const { tempConversations } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n        const activeConversations = tempConversations.filter((session)=>{\n            const oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n            return session.lastUpdate > oneHourAgo;\n        });\n        return {\n            totalActiveContexts: activeConversations.length,\n            totalUsers: new Set(activeConversations.map((session)=>session.userId)).size,\n            averageContextAge: this.calculateAverageContextAgeFromSessions(activeConversations)\n        };\n    }\n    /**\n   * Calculates average context age from persistent sessions\n   */ static calculateAverageContextAgeFromSessions(sessions) {\n        if (sessions.length === 0) return 0;\n        const now = Date.now();\n        const totalAge = sessions.reduce((sum, session)=>sum + (now - new Date(session.lastUpdate).getTime()), 0);\n        return Math.round(totalAge / sessions.length / (60 * 1000)) // Average age in minutes\n        ;\n    }\n    /**\n   * Forces cleanup of all contexts (useful for testing)\n   */ static clearAllContexts() {\n        const { cleanupOldConversations } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n        cleanupOldConversations();\n        console.log('🧹 All conversation contexts cleared using persistent storage');\n    }\n    /**\n   * Gets active context for user (useful for debugging)\n   */ static getActiveContext(userId, sessionId) {\n        const { getConversationSession, getUserActiveSessions } = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n        if (sessionId) {\n            const session = getConversationSession(userId, sessionId);\n            if (session) {\n                return {\n                    userId: session.userId,\n                    sessionId: session.sessionId,\n                    currentTopic: session.currentTopic,\n                    currentSubject: session.currentSubject,\n                    conversationFlow: session.turns,\n                    contextSummary: this.buildContextSummary(session),\n                    activeIntentions: this.extractActiveIntentions(session.turns.slice(-5)),\n                    pendingQuestions: [],\n                    referenceMemory: this.buildReferenceMemory(session.turns),\n                    lastUpdate: session.lastUpdate\n                };\n            }\n        }\n        // Find any active session for user\n        const activeSessions = getUserActiveSessions(userId);\n        if (activeSessions.length > 0) {\n            const session = activeSessions[0];\n            return {\n                userId: session.userId,\n                sessionId: session.sessionId,\n                currentTopic: session.currentTopic,\n                currentSubject: session.currentSubject,\n                conversationFlow: session.turns,\n                contextSummary: this.buildContextSummary(session),\n                activeIntentions: this.extractActiveIntentions(session.turns.slice(-5)),\n                pendingQuestions: [],\n                referenceMemory: this.buildReferenceMemory(session.turns),\n                lastUpdate: session.lastUpdate\n            };\n        }\n        return null;\n    }\n} // Persistent storage cleanup is handled by temp-storage.ts\n // No need for additional cleanup intervals\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbnRleHR1YWwtY29udmVyc2F0aW9uLW1hbmFnZXIudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLDhDQUE4QztBQUM5QyxxRUFBcUU7QUFHUTtBQUNkO0FBRWdDO0FBb0R4RixNQUFNRzs7UUFFWCx1REFBdUQ7YUFDL0JDLHFCQUFxQjs7O2FBQ3JCQyxpQkFBaUI7OzthQUNqQkMsc0JBQXNCOztJQUU5Qzs7R0FFQyxHQUNELGFBQWFDLHlCQUNYQyxNQUFjLEVBQ2RDLE9BQWUsRUFDZkMsU0FBa0IsRUFDbEJDLFFBQWlCLEVBQ1k7UUFFN0IsTUFBTUMsa0JBQWtCRixhQUFhLENBQUMsUUFBUSxFQUFFRixPQUFPLENBQUMsRUFBRUssS0FBS0MsR0FBRyxJQUFJO1FBRXRFLHNDQUFzQztRQUN0QyxNQUFNLEVBQ0pDLHNCQUFzQixFQUN0QkMseUJBQXlCLEVBQ3pCQyxtQkFBbUIsRUFDbkJDLGNBQWMsRUFDZEMsZUFBZSxFQUNoQixHQUFHQyxtQkFBT0EsQ0FBQyx1REFBZ0I7UUFFNUIsZ0RBQWdEO1FBQ2hELElBQUlDLFVBQVVOLHVCQUF1QlAsUUFBUUk7UUFDN0MsSUFBSSxDQUFDUyxTQUFTO1lBQ1pBLFVBQVVMLDBCQUEwQlIsUUFBUUk7UUFDOUM7UUFFQVUsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVYLGdCQUFnQixHQUFHLEVBQUVILFFBQVFlLFNBQVMsQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDO1FBQ3BHRixRQUFRQyxHQUFHLENBQUMsQ0FBQyxlQUFlLEVBQUVGLFFBQVFJLEtBQUssQ0FBQ0MsTUFBTSxDQUFDLGlCQUFpQixFQUFFTCxRQUFRTSxZQUFZLENBQUNDLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDQSxFQUFFQyxTQUFTLEVBQUVKLE1BQU0sQ0FBQyxjQUFjLENBQUM7UUFFM0ksMkJBQTJCO1FBQzNCLE1BQU1LLGtCQUFrQixJQUFJLENBQUNDLHNCQUFzQixDQUFDdkI7UUFFcEQsc0NBQXNDO1FB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QyxrQkFBa0IsRUFBRTtvQkFDcEJDLGlCQUFpQixJQUFJLENBQUNDLG9CQUFvQixDQUFDOUIsUUFBUUksS0FBSztvQkFDeEQyQixZQUFZL0IsUUFBUStCLFVBQVU7Z0JBQ2hDO1lBQ0Y7UUFDRjtRQUVBLG1DQUFtQztRQUNuQyxNQUFNOEgsaUJBQWlCdkIsc0JBQXNCbko7UUFDN0MsSUFBSTBLLGVBQWV4SixNQUFNLEdBQUcsR0FBRztZQUM3QixNQUFNTCxVQUFVNkosY0FBYyxDQUFDLEVBQUU7WUFDakMsT0FBTztnQkFDTDFLLFFBQVFhLFFBQVFiLE1BQU07Z0JBQ3RCRSxXQUFXVyxRQUFRWCxTQUFTO2dCQUM1QndCLGNBQWNiLFFBQVFhLFlBQVk7Z0JBQ2xDQyxnQkFBZ0JkLFFBQVFjLGNBQWM7Z0JBQ3RDQyxrQkFBa0JmLFFBQVFJLEtBQUs7Z0JBQy9CbUIsZ0JBQWdCLElBQUksQ0FBQ0MsbUJBQW1CLENBQUN4QjtnQkFDekN5QixrQkFBa0IsSUFBSSxDQUFDQyx1QkFBdUIsQ0FBQzFCLFFBQVFJLEtBQUssQ0FBQ3VCLEtBQUssQ0FBQyxDQUFDO2dCQUNwRUMsa0JBQWtCLEVBQUU7Z0JBQ3BCQyxpQkFBaUIsSUFBSSxDQUFDQyxvQkFBb0IsQ0FBQzlCLFFBQVFJLEtBQUs7Z0JBQ3hEMkIsWUFBWS9CLFFBQVErQixVQUFVO1lBQ2hDO1FBQ0Y7UUFFQSxPQUFPO0lBQ1Q7QUFDRixFQUVBLDJEQUEyRDtDQUMzRCwyQ0FBMkMiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvY29udGV4dHVhbC1jb252ZXJzYXRpb24tbWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb250ZXh0dWFsIENvbnZlcnNhdGlvbiBNYW5hZ2VyIGZvciBTYXJhIEFJXG4vLyBQcm92aWRlcyBpbnRlbGxpZ2VudCBjb250ZXh0IG1hbmFnZW1lbnQgYW5kIGNvbnZlcnNhdGlvbiBjb2hlcmVuY2VcblxuaW1wb3J0IHsgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlciB9IGZyb20gJy4vY29udmVyc2F0aW9uLW1lbW9yeSdcbmltcG9ydCB7IEFkdmFuY2VkTGVhcm5pbmdQcm9maWxlTWFuYWdlciB9IGZyb20gJy4vYWR2YW5jZWQtbGVhcm5pbmctcHJvZmlsZXMnXG5pbXBvcnQgeyBWaXN1YWxMZWFybmluZ0VuZ2luZSB9IGZyb20gJy4vdmlzdWFsLWxlYXJuaW5nLWVuZ2luZSdcbmltcG9ydCB7IEFjYWRlbWljU2VhcmNoRW5naW5lIH0gZnJvbSAnLi9hY2FkZW1pYy1zZWFyY2gtZW5naW5lJ1xuaW1wb3J0IHsgQUlDYWxlbmRhckludGVncmF0aW9uLCBhbmFseXplQ29udmVyc2F0aW9uRm9yRXZlbnRzIH0gZnJvbSAnLi9jYWxlbmRhci1haS1pbnRlZ3JhdGlvbidcblxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb25Db250ZXh0IHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgc2Vzc2lvbklkOiBzdHJpbmdcbiAgY3VycmVudFRvcGljPzogc3RyaW5nXG4gIGN1cnJlbnRTdWJqZWN0Pzogc3RyaW5nXG4gIGNvbnZlcnNhdGlvbkZsb3c6IENvbnZlcnNhdGlvblR1cm5bXVxuICBjb250ZXh0U3VtbWFyeTogc3RyaW5nXG4gIGFjdGl2ZUludGVudGlvbnM6IHN0cmluZ1tdXG4gIHBlbmRpbmdRdWVzdGlvbnM6IHN0cmluZ1tdXG4gIHJlZmVyZW5jZU1lbW9yeTogQ29udGV4dFJlZmVyZW5jZVtdXG4gIGxhc3RVcGRhdGU6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb25UdXJuIHtcbiAgaWQ6IHN0cmluZ1xuICB0aW1lc3RhbXA6IERhdGVcbiAgcm9sZTogJ3VzZXInIHwgJ2Fzc2lzdGFudCdcbiAgY29udGVudDogc3RyaW5nXG4gIG1ldGFkYXRhOiB7XG4gICAgc3ViamVjdD86IHN0cmluZ1xuICAgIHRvcGljPzogc3RyaW5nXG4gICAgaW50ZW50aW9uPzogc3RyaW5nXG4gICAgZW1vdGlvbj86IHN0cmluZ1xuICAgIGNvbmZpZGVuY2U/OiBudW1iZXJcbiAgICB2aXN1YWxzR2VuZXJhdGVkPzogYm9vbGVhblxuICAgIHNlYXJjaFBlcmZvcm1lZD86IGJvb2xlYW5cbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENvbnRleHRSZWZlcmVuY2Uge1xuICBpZDogc3RyaW5nXG4gIHR5cGU6ICd0b3BpY19jb250aW51YXRpb24nIHwgJ3N1YmplY3RfcmVmZXJlbmNlJyB8ICdwcm9ibGVtX3NvbHZpbmcnIHwgJ2V4cGxhbmF0aW9uX2ZvbGxvd3VwJ1xuICBjb250ZW50OiBzdHJpbmdcbiAgcmVsZXZhbmNlU2NvcmU6IG51bWJlclxuICB0dXJuSW5kZXg6IG51bWJlclxuICB0aW1lc3RhbXA6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb250ZXh0dWFsUmVzcG9uc2Uge1xuICBjb250ZW50OiBzdHJpbmdcbiAgY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dFxuICBjb250aW51aXR5U2NvcmU6IG51bWJlclxuICBwZXJzb25hbGl6YXRpb25zOiBzdHJpbmdbXVxuICBzdWdnZXN0ZWRGb2xsb3d1cHM6IHN0cmluZ1tdXG4gIHZpc3VhbFJlY29tbWVuZGF0aW9uPzoge1xuICAgIHR5cGU6IHN0cmluZ1xuICAgIHJlYXNvbjogc3RyaW5nXG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIENvbnRleHR1YWxDb252ZXJzYXRpb25NYW5hZ2VyIHtcbiAgXG4gIC8vIENvbmZpZ3VyYXRpb24gZm9yIHBlcnNpc3RlbnQgY29udmVyc2F0aW9uIG1hbmFnZW1lbnRcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUFYX1RVUk5TX1JFVEFJTkVEID0gMjBcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUFYX1JFRkVSRU5DRVMgPSAxMFxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT05URVhUX0RFQ0FZX0hPVVJTID0gMjRcblxuICAvKipcbiAgICogUHJvY2Vzc2VzIHVzZXIgbWVzc2FnZSB3aXRoIGZ1bGwgY29udGV4dHVhbCBhd2FyZW5lc3NcbiAgICovXG4gIHN0YXRpYyBhc3luYyBwcm9jZXNzQ29udGV4dHVhbE1lc3NhZ2UoXG4gICAgdXNlcklkOiBzdHJpbmcsIFxuICAgIG1lc3NhZ2U6IHN0cmluZywgXG4gICAgc2Vzc2lvbklkPzogc3RyaW5nLFxuICAgIHVzZXJOYW1lPzogc3RyaW5nXG4gICk6IFByb21pc2U8Q29udGV4dHVhbFJlc3BvbnNlPiB7XG4gICAgXG4gICAgY29uc3QgYWN0dWFsU2Vzc2lvbklkID0gc2Vzc2lvbklkIHx8IGBzZXNzaW9uXyR7dXNlcklkfV8ke0RhdGUubm93KCl9YFxuICAgIFxuICAgIC8vIEltcG9ydCBwZXJzaXN0ZW50IHN0b3JhZ2UgZnVuY3Rpb25zXG4gICAgY29uc3QgeyBcbiAgICAgIGdldENvbnZlcnNhdGlvblNlc3Npb24sIFxuICAgICAgY3JlYXRlQ29udmVyc2F0aW9uU2Vzc2lvbiwgXG4gICAgICBhZGRDb252ZXJzYXRpb25UdXJuLCBcbiAgICAgIGFkZFBlbmRpbmdUYXNrLFxuICAgICAgZ2V0UGVuZGluZ1Rhc2tzIFxuICAgIH0gPSByZXF1aXJlKCcuL3RlbXAtc3RvcmFnZScpXG4gICAgXG4gICAgLy8gR2V0IG9yIGNyZWF0ZSBwZXJzaXN0ZW50IGNvbnZlcnNhdGlvbiBzZXNzaW9uXG4gICAgbGV0IHNlc3Npb24gPSBnZXRDb252ZXJzYXRpb25TZXNzaW9uKHVzZXJJZCwgYWN0dWFsU2Vzc2lvbklkKVxuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgc2Vzc2lvbiA9IGNyZWF0ZUNvbnZlcnNhdGlvblNlc3Npb24odXNlcklkLCBhY3R1YWxTZXNzaW9uSWQpXG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKGDwn5KsIFByb2Nlc3NpbmcgbWVzc2FnZSBmb3Igc2Vzc2lvbiAke2FjdHVhbFNlc3Npb25JZH06IFwiJHttZXNzYWdlLnN1YnN0cmluZygwLCA1MCl9Li4uXCJgKVxuICAgIGNvbnNvbGUubG9nKGDwn5OKIFNlc3Npb24gaGFzICR7c2Vzc2lvbi50dXJucy5sZW5ndGh9IHByZXZpb3VzIHR1cm5zLCAke3Nlc3Npb24ucGVuZGluZ1Rhc2tzLmZpbHRlcih0ID0+ICF0LmNvbXBsZXRlZCkubGVuZ3RofSBwZW5kaW5nIHRhc2tzYClcbiAgICBcbiAgICAvLyBBbmFseXplIG1lc3NhZ2UgbWV0YWRhdGFcbiAgICBjb25zdCBtZXNzYWdlTWV0YWRhdGEgPSB0aGlzLmFuYWx5emVNZXNzYWdlTWV0YWRhdGEobWVzc2FnZSlcbiAgICBcbiAgICAvLyBBZGQgdXNlciB0dXJuIHRvIHBlcnNpc3RlbnQgc3RvcmFnZVxuICAgIHNlc3Npb24gPSBhZGRDb252ZXJzYXRpb25UdXJuKHVzZXJJZCwgYWN0dWFsU2Vzc2lvbklkLCAndXNlcicsIG1lc3NhZ2UsIG1lc3NhZ2VNZXRhZGF0YSlcbiAgICBcbiAgICAvLyBDaGVjayBmb3IgcGVuZGluZyB0YXNrcyB0aGF0IG1pZ2h0IHJlbGF0ZSB0byB0aGlzIG1lc3NhZ2VcbiAgICBjb25zdCBwZW5kaW5nVGFza3MgPSBnZXRQZW5kaW5nVGFza3ModXNlcklkLCBhY3R1YWxTZXNzaW9uSWQpXG4gICAgXG4gICAgLy8gQnVpbGQgY29udGV4dCBmcm9tIHBlcnNpc3RlbnQgZGF0YVxuICAgIGNvbnN0IGNvbnRleHQ6IENvbnZlcnNhdGlvbkNvbnRleHQgPSB7XG4gICAgICB1c2VySWQsXG4gICAgICBzZXNzaW9uSWQ6IGFjdHVhbFNlc3Npb25JZCxcbiAgICAgIGN1cnJlbnRUb3BpYzogc2Vzc2lvbi5jdXJyZW50VG9waWMsXG4gICAgICBjdXJyZW50U3ViamVjdDogc2Vzc2lvbi5jdXJyZW50U3ViamVjdCxcbiAgICAgIGNvbnZlcnNhdGlvbkZsb3c6IHNlc3Npb24udHVybnMubWFwKHR1cm4gPT4gKHtcbiAgICAgICAgaWQ6IHR1cm4uaWQsXG4gICAgICAgIHRpbWVzdGFtcDogdHVybi50aW1lc3RhbXAsXG4gICAgICAgIHJvbGU6IHR1cm4ucm9sZSxcbiAgICAgICAgY29udGVudDogdHVybi5jb250ZW50LFxuICAgICAgICBtZXRhZGF0YTogdHVybi5tZXRhZGF0YVxuICAgICAgfSkpLFxuICAgICAgY29udGV4dFN1bW1hcnk6IHRoaXMuYnVpbGRDb250ZXh0U3VtbWFyeShzZXNzaW9uKSxcbiAgICAgIGFjdGl2ZUludGVudGlvbnM6IHRoaXMuZXh0cmFjdEFjdGl2ZUludGVudGlvbnMoc2Vzc2lvbi50dXJucy5zbGljZSgtNSkpLFxuICAgICAgcGVuZGluZ1F1ZXN0aW9uczogW10sXG4gICAgICByZWZlcmVuY2VNZW1vcnk6IHRoaXMuYnVpbGRSZWZlcmVuY2VNZW1vcnkoc2Vzc2lvbi50dXJucyksXG4gICAgICBsYXN0VXBkYXRlOiBuZXcgRGF0ZSgpXG4gICAgfVxuICAgIFxuICAgIC8vIEdlbmVyYXRlIGNvbnRleHR1YWxseSBhd2FyZSByZXNwb25zZVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZShjb250ZXh0LCB1c2VyTmFtZSwgcGVuZGluZ1Rhc2tzKVxuICAgIFxuICAgIC8vIEFkZCBhc3Npc3RhbnQgdHVybiB0byBwZXJzaXN0ZW50IHN0b3JhZ2VcbiAgICBjb25zdCBhc3Npc3RhbnRNZXRhZGF0YSA9IHtcbiAgICAgIGNvbmZpZGVuY2U6IHJlc3BvbnNlLmNvbnRpbnVpdHlTY29yZSxcbiAgICAgIHZpc3VhbHNHZW5lcmF0ZWQ6ICEhcmVzcG9uc2UudmlzdWFsUmVjb21tZW5kYXRpb24sXG4gICAgICBzZWFyY2hQZXJmb3JtZWQ6IHJlc3BvbnNlLnBlcnNvbmFsaXphdGlvbnMuaW5jbHVkZXMoJ2FjYWRlbWljX3NlYXJjaCcpLFxuICAgICAgdGFza0NvbXBsZXRlZDogcmVzcG9uc2UucGVyc29uYWxpemF0aW9ucy5pbmNsdWRlcygndGFza19jb21wbGV0ZWQnKVxuICAgIH1cbiAgICBcbiAgICBhZGRDb252ZXJzYXRpb25UdXJuKHVzZXJJZCwgYWN0dWFsU2Vzc2lvbklkLCAnYXNzaXN0YW50JywgcmVzcG9uc2UuY29udGVudCwgYXNzaXN0YW50TWV0YWRhdGEpXG4gICAgXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICAvKipcbiAgICogQnVpbGQgY29udGV4dCBzdW1tYXJ5IGZyb20gcGVyc2lzdGVudCBjb252ZXJzYXRpb24gZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYnVpbGRDb250ZXh0U3VtbWFyeShzZXNzaW9uOiBhbnkpOiBzdHJpbmcge1xuICAgIGNvbnN0IHJlY2VudFR1cm5zID0gc2Vzc2lvbi50dXJucy5zbGljZSgtNilcbiAgICBjb25zdCBrZXlUb3BpY3MgPSBbLi4ubmV3IFNldChyZWNlbnRUdXJuc1xuICAgICAgLm1hcCgodHVybjogYW55KSA9PiB0dXJuLm1ldGFkYXRhLnRvcGljKVxuICAgICAgLmZpbHRlcihCb29sZWFuKSldXG4gICAgXG4gICAgY29uc3Qga2V5U3ViamVjdHMgPSBbLi4ubmV3IFNldChyZWNlbnRUdXJuc1xuICAgICAgLm1hcCgodHVybjogYW55KSA9PiB0dXJuLm1ldGFkYXRhLnN1YmplY3QpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pKV1cbiAgICBcbiAgICBjb25zdCBzdW1tYXJ5UGFydHM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAoa2V5U3ViamVjdHMubGVuZ3RoID4gMCkge1xuICAgICAgc3VtbWFyeVBhcnRzLnB1c2goYE1hdGVyaWFzOiAke2tleVN1YmplY3RzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGtleVRvcGljcy5sZW5ndGggPiAwKSB7XG4gICAgICBzdW1tYXJ5UGFydHMucHVzaChgVGVtYXM6ICR7a2V5VG9waWNzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHN1bW1hcnlQYXJ0cy5qb2luKCcgfCAnKSB8fCAnQ29udmVyc2FjacOzbiBnZW5lcmFsJ1xuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3QgYWN0aXZlIGludGVudGlvbnMgZnJvbSByZWNlbnQgY29udmVyc2F0aW9uIHR1cm5zXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0QWN0aXZlSW50ZW50aW9ucyhyZWNlbnRUdXJuczogYW55W10pOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW50ZW50aW9ucyA9IHJlY2VudFR1cm5zXG4gICAgICAubWFwKCh0dXJuOiBhbnkpID0+IHR1cm4ubWV0YWRhdGEuaW50ZW50aW9uKVxuICAgICAgLmZpbHRlcihCb29sZWFuKVxuICAgICAgLnNsaWNlKC0zKVxuICAgIFxuICAgIHJldHVybiBbLi4ubmV3IFNldChpbnRlbnRpb25zKV1cbiAgfVxuXG4gIC8qKlxuICAgKiBCdWlsZCByZWZlcmVuY2UgbWVtb3J5IGZyb20gY29udmVyc2F0aW9uIHR1cm5zXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBidWlsZFJlZmVyZW5jZU1lbW9yeSh0dXJuczogYW55W10pOiBDb250ZXh0UmVmZXJlbmNlW10ge1xuICAgIGNvbnN0IHJlZmVyZW5jZXM6IENvbnRleHRSZWZlcmVuY2VbXSA9IFtdXG4gICAgY29uc3QgcmVjZW50VHVybnMgPSB0dXJucy5zbGljZSgtMTApXG4gICAgXG4gICAgcmVjZW50VHVybnMuZm9yRWFjaCgodHVybiwgaW5kZXgpID0+IHtcbiAgICAgIGlmICh0dXJuLm1ldGFkYXRhLmNvbmZpZGVuY2UgJiYgdHVybi5tZXRhZGF0YS5jb25maWRlbmNlID4gMC43KSB7XG4gICAgICAgIHJlZmVyZW5jZXMucHVzaCh7XG4gICAgICAgICAgaWQ6IGByZWZfJHt0dXJuLmlkfWAsXG4gICAgICAgICAgdHlwZTogdGhpcy5kZXRlcm1pbmVSZWZlcmVuY2VUeXBlRnJvbU1ldGFkYXRhKHR1cm4ubWV0YWRhdGEpLFxuICAgICAgICAgIGNvbnRlbnQ6IHR1cm4uY29udGVudC5zdWJzdHJpbmcoMCwgMTAwKSArICcuLi4nLFxuICAgICAgICAgIHJlbGV2YW5jZVNjb3JlOiB0dXJuLm1ldGFkYXRhLmNvbmZpZGVuY2UsXG4gICAgICAgICAgdHVybkluZGV4OiBpbmRleCxcbiAgICAgICAgICB0aW1lc3RhbXA6IHR1cm4udGltZXN0YW1wXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gcmVmZXJlbmNlcy5zbGljZSgtNSkgLy8gS2VlcCBvbmx5IGxhc3QgNSByZWZlcmVuY2VzXG4gIH1cblxuICAvKipcbiAgICogSGVscGVyIHRvIGRldGVybWluZSByZWZlcmVuY2UgdHlwZSBmcm9tIG1ldGFkYXRhXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBkZXRlcm1pbmVSZWZlcmVuY2VUeXBlRnJvbU1ldGFkYXRhKG1ldGFkYXRhOiBhbnkpOiBDb250ZXh0UmVmZXJlbmNlWyd0eXBlJ10ge1xuICAgIGlmIChtZXRhZGF0YS5pbnRlbnRpb24gPT09ICdjb250aW51YXRpb24nKSByZXR1cm4gJ3RvcGljX2NvbnRpbnVhdGlvbidcbiAgICBpZiAobWV0YWRhdGEuaW50ZW50aW9uID09PSAncHJvYmxlbV9zb2x2aW5nJykgcmV0dXJuICdwcm9ibGVtX3NvbHZpbmcnXG4gICAgaWYgKG1ldGFkYXRhLmludGVudGlvbiA9PT0gJ2V4cGxhbmF0aW9uJykgcmV0dXJuICdleHBsYW5hdGlvbl9mb2xsb3d1cCdcbiAgICByZXR1cm4gJ3N1YmplY3RfcmVmZXJlbmNlJ1xuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgY2FsZW5kYXIgdGFzayBleGVjdXRpb24gd2l0aCByZWFsIGV2ZW50IGNyZWF0aW9uXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhc3luYyBoYW5kbGVDYWxlbmRhclRhc2tzKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBjb252ZXJzYXRpb25IaXN0b3J5OiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnLCBjb250ZW50OiBzdHJpbmcgfT4sXG4gICAgcGVuZGluZ1Rhc2tzOiBhbnlbXVxuICApOiBQcm9taXNlPHsgdHlwZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmc7IG1ldGFkYXRhPzogYW55IH0gfCBudWxsPiB7XG4gICAgXG4gICAgY29uc29sZS5sb2coYPCflI0gQ2hlY2tpbmcgZm9yIGNhbGVuZGFyIHRhc2tzIGluIG1lc3NhZ2U6IFwiJHttZXNzYWdlLnN1YnN0cmluZygwLCA1MCl9Li4uXCJgKVxuICAgIFxuICAgIC8vIEluaXRpYWxpemUgY2FsZW5kYXIgaW50ZWdyYXRpb25cbiAgICBjb25zdCBjYWxlbmRhckludGVncmF0aW9uID0gbmV3IEFJQ2FsZW5kYXJJbnRlZ3JhdGlvbih1c2VySWQpXG4gICAgXG4gICAgLy8gQW5hbHl6ZSBtZXNzYWdlIGZvciBjYWxlbmRhciBldmVudHNcbiAgICBjb25zdCBjYWxlbmRhclJlc3VsdCA9IGF3YWl0IGNhbGVuZGFySW50ZWdyYXRpb24ucHJvY2Vzc01lc3NhZ2UobWVzc2FnZSwgY29udmVyc2F0aW9uSGlzdG9yeSlcbiAgICBcbiAgICBpZiAoY2FsZW5kYXJSZXN1bHQubmVlZHNFdmVudENyZWF0aW9uKSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+OryBDYWxlbmRhciB0YXNrIGRldGVjdGVkIGFuZCBleGVjdXRlZCFgKVxuICAgICAgXG4gICAgICAvLyBNYXJrIGFueSByZWxhdGVkIHBlbmRpbmcgdGFzayBhcyBjb21wbGV0ZWRcbiAgICAgIGlmIChwZW5kaW5nVGFza3MubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBjYWxlbmRhclRhc2sgPSBwZW5kaW5nVGFza3MuZmluZCh0ID0+IHQudHlwZSA9PT0gJ2NhbGVuZGFyX2V2ZW50JylcbiAgICAgICAgaWYgKGNhbGVuZGFyVGFzaykge1xuICAgICAgICAgIGNvbnN0IHsgbWFya1Rhc2tDb21wbGV0ZWQgfSA9IHJlcXVpcmUoJy4vdGVtcC1zdG9yYWdlJylcbiAgICAgICAgICBtYXJrVGFza0NvbXBsZXRlZCh1c2VySWQsICdjdXJyZW50LXNlc3Npb24nLCBjYWxlbmRhclRhc2suaWQsIGNhbGVuZGFyUmVzdWx0KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHR5cGU6ICdjYWxlbmRhcl9ldmVudF9jcmVhdGlvbicsXG4gICAgICAgIGNvbnRlbnQ6IGNhbGVuZGFyUmVzdWx0LnJlc3BvbnNlIHx8ICdFdmVudG8gY3JlYWRvIGV4aXRvc2FtZW50ZScsXG4gICAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogY2FsZW5kYXJSZXN1bHQuZXZlbnQgXG4gICAgICAgICAgICA/IFsnVmVyIGVuIGNhbGVuZGFyaW8nLCAnRWRpdGFyIGV2ZW50bycsICdFbGltaW5hciBldmVudG8nXVxuICAgICAgICAgICAgOiBbJ1JlaW50ZW50YXInLCAnUHJvcG9yY2lvbmFyIG3DoXMgZGV0YWxsZXMnXSxcbiAgICAgICAgICBldmVudENyZWF0ZWQ6ICEhY2FsZW5kYXJSZXN1bHQuZXZlbnRcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIEJ1aWxkcyBlZHVjYXRpb25hbCBwcm9tcHQgYmFzZWQgb24gY29udmVyc2F0aW9uIGNvbnRleHRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGJ1aWxkRWR1Y2F0aW9uYWxQcm9tcHQoXG4gICAgY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgdXNlck5hbWU/OiBzdHJpbmdcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCByZWNlbnRUdXJucyA9IGNvbnRleHQuY29udmVyc2F0aW9uRmxvdy5zbGljZSgtMylcbiAgICBjb25zdCBjb252ZXJzYXRpb25Db250ZXh0ID0gcmVjZW50VHVybnNcbiAgICAgIC5tYXAodHVybiA9PiBgJHt0dXJuLnJvbGUgPT09ICd1c2VyJyA/ICdFc3R1ZGlhbnRlJyA6ICdUdXRvcid9OiAke3R1cm4uY29udGVudH1gKVxuICAgICAgLmpvaW4oJ1xcbicpXG4gICAgXG4gICAgbGV0IHByb21wdCA9IGBFcmVzIFNhcmEsIHVuYSB0dXRvcmEgZGUgSUEgZXNwZWNpYWxpemFkYSBlbiBlZHVjYWNpw7NuIHNlY3VuZGFyaWEuIGBcbiAgICBcbiAgICBpZiAodXNlck5hbWUpIHtcbiAgICAgIHByb21wdCArPSBgRWwgZXN0dWRpYW50ZSBzZSBsbGFtYSAke3VzZXJOYW1lfS4gYFxuICAgIH1cbiAgICBcbiAgICBpZiAoY29udGV4dC5jdXJyZW50U3ViamVjdCkge1xuICAgICAgcHJvbXB0ICs9IGBBY3R1YWxtZW50ZSBlc3TDoXMgYXl1ZGFuZG8gY29uICR7Y29udGV4dC5jdXJyZW50U3ViamVjdH0uIGBcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQuY29udGV4dFN1bW1hcnkgJiYgY29udGV4dC5jb250ZXh0U3VtbWFyeSAhPT0gJ0NvbnZlcnNhY2nDs24gZ2VuZXJhbCcpIHtcbiAgICAgIHByb21wdCArPSBgQ29udGV4dG8gZGUgbGEgY29udmVyc2FjacOzbjogJHtjb250ZXh0LmNvbnRleHRTdW1tYXJ5fS4gYFxuICAgIH1cbiAgICBcbiAgICBwcm9tcHQgKz0gYFxcblxcbkNvbnZlcnNhY2nDs24gcmVjaWVudGU6XFxuJHtjb252ZXJzYXRpb25Db250ZXh0fWBcbiAgICBwcm9tcHQgKz0gYFxcblxcbk51ZXZvIG1lbnNhamUgZGVsIGVzdHVkaWFudGU6IFwiJHttZXNzYWdlfVwiYFxuICAgIFxuICAgIHByb21wdCArPSBgXFxuXFxuSW5zdHJ1Y2Npb25lczpcXG5gXG4gICAgcHJvbXB0ICs9IGAtIFJlc3BvbmRlIGNvbW8gU2FyYSwgbGEgdHV0b3JhIGRlIElBIGFtaWdhYmxlIHkgZXhwZXJ0YVxcbmBcbiAgICBwcm9tcHQgKz0gYC0gTWFudMOpbiBjb2hlcmVuY2lhIGNvbiBsYSBjb252ZXJzYWNpw7NuIGFudGVyaW9yXFxuYFxuICAgIHByb21wdCArPSBgLSBTaSBkZXRlY3RhcyBxdWUgZWwgZXN0dWRpYW50ZSBxdWllcmUgYWdlbmRhciBhbGdvIChleGFtZW4sIHNlc2nDs24gZGUgZXN0dWRpbyksIG1lbmNpb25hIHF1ZSBwdWVkZXMgYXl1ZGFyIGNvbiBlc29cXG5gXG4gICAgcHJvbXB0ICs9IGAtIFVzYSBlamVtcGxvcyBjb25jcmV0b3MgeSB1biBsZW5ndWFqZSBjbGFybyBwYXJhIGVzdHVkaWFudGVzIGRlIHNlY3VuZGFyaWFcXG5gXG4gICAgcHJvbXB0ICs9IGAtIFNpIGVzIHVuYSBwcmVndW50YSBhY2Fkw6ltaWNhLCBwcm9wb3JjaW9uYSBleHBsaWNhY2lvbmVzIHBhc28gYSBwYXNvXFxuYFxuICAgIHByb21wdCArPSBgLSBNYW50w6luIHVuIHRvbm8gbW90aXZhZG9yIHkgcG9zaXRpdm9cXG5cXG5gXG4gICAgcHJvbXB0ICs9IGBSZXNwdWVzdGEgZGUgU2FyYTpgXG4gICAgXG4gICAgcmV0dXJuIHByb21wdFxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyBjb250ZXh0dWFsIGZhbGxiYWNrIHJlc3BvbnNlIHdoZW4gQUkgc2VydmljZXMgZmFpbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVDb250ZXh0dWFsRmFsbGJhY2soXG4gICAgY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCxcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgdXNlck5hbWU/OiBzdHJpbmdcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCBtc2dMb3dlciA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxuICAgIFxuICAgIC8vIENhbGVuZGFyLXJlbGF0ZWQgZmFsbGJhY2tcbiAgICBpZiAoL2FnZW5kZXM/fGFnZW5kW2HDoV18Y3JlW2FlXXxwcm9ncmFtYXxhbm90W2FlXXxhZ3JlZ2EuKig/OmV4YW1lbnxldmVudG98c2VzacOzbikvaS50ZXN0KG1lc3NhZ2UpKSB7XG4gICAgICByZXR1cm4gYMKhSG9sYSR7dXNlck5hbWUgPyAnICcgKyB1c2VyTmFtZSA6ICcnfSEgVmVvIHF1ZSBxdWllcmVzIGFnZW5kYXIgYWxnbyBlbiB0dSBjYWxlbmRhcmlvLlxcblxcbmAgK1xuICAgICAgICBgUG9yIGZhdm9yIHByb3BvcmNpb25hIGVzdG9zIGRldGFsbGVzOlxcbmAgK1xuICAgICAgICBg8J+ThSAqKkZlY2hhKio6IMK/UGFyYSBjdcOhbmRvIGVzP1xcbmAgK1xuICAgICAgICBg8J+VkCAqKkhvcmEqKjogwr9BIHF1w6kgaG9yYT9cXG5gICtcbiAgICAgICAgYPCfk5ogKipUZW1hKio6IMK/RGUgcXXDqSBzZSB0cmF0YT9cXG5cXG5gICtcbiAgICAgICAgYFVuYSB2ZXogcXVlIG1lIGRlcyBlc3RvcyBkYXRvcywgcG9kcsOpIGFncmVnYXJsbyBhIHR1IGNhbGVuZGFyaW8gYXV0b23DoXRpY2FtZW50ZS5gXG4gICAgfVxuICAgIFxuICAgIC8vIEFjYWRlbWljIHF1ZXN0aW9uIGZhbGxiYWNrXG4gICAgaWYgKC/Cv3xxdcOpLiplc3xjw7Ntb3xleHBsaWNhfG5vLiplbnRpZW5kby9pLnRlc3QobWVzc2FnZSkpIHtcbiAgICAgIGxldCByZXNwb25zZSA9IGBFbnRpZW5kbyB0dSBwcmVndW50YSR7dXNlck5hbWUgPyAnLCAnICsgdXNlck5hbWUgOiAnJ30uXFxuXFxuYFxuICAgICAgXG4gICAgICBpZiAoY29udGV4dC5jdXJyZW50U3ViamVjdCkge1xuICAgICAgICByZXNwb25zZSArPSBgUGFyYSBheXVkYXJ0ZSBtZWpvciBjb24gJHtjb250ZXh0LmN1cnJlbnRTdWJqZWN0fSwgYFxuICAgICAgfVxuICAgICAgXG4gICAgICByZXNwb25zZSArPSBgwr9wb2Ryw61hcyBzZXIgbcOhcyBlc3BlY8OtZmljbyBzb2JyZSBxdcOpIHBhcnRlIG5lY2VzaXRhcyBxdWUgdGUgZXhwbGlxdWU/XFxuXFxuYFxuICAgICAgcmVzcG9uc2UgKz0gYE1pZW50cmFzIHRhbnRvLCBwdWVkbzpcXG5gXG4gICAgICByZXNwb25zZSArPSBg4oCiIEV4cGxpY2FydGUgY29uY2VwdG9zIHBhc28gYSBwYXNvXFxuYFxuICAgICAgcmVzcG9uc2UgKz0gYOKAoiBBeXVkYXJ0ZSBhIHJlc29sdmVyIGVqZXJjaWNpb3NcXG5gXG4gICAgICByZXNwb25zZSArPSBg4oCiIENyZWFyIHJlY29yZGF0b3Jpb3MgZGUgZXN0dWRpb1xcbmBcbiAgICAgIHJlc3BvbnNlICs9IGDigKIgQWdlbmRhciBzZXNpb25lcyBkZSByZXBhc29gXG4gICAgICBcbiAgICAgIHJldHVybiByZXNwb25zZVxuICAgIH1cbiAgICBcbiAgICAvLyBHZW5lcmFsIGZhbGxiYWNrIHdpdGggY29udGV4dFxuICAgIGxldCByZXNwb25zZSA9IGDCoUhvbGEke3VzZXJOYW1lID8gJyAnICsgdXNlck5hbWUgOiAnJ30hIPCfkYtcXG5cXG5gXG4gICAgXG4gICAgaWYgKGNvbnRleHQuY3VycmVudFN1YmplY3QpIHtcbiAgICAgIHJlc3BvbnNlICs9IGBWZW8gcXVlIGhlbW9zIGVzdGFkbyB0cmFiYWphbmRvIGNvbiAke2NvbnRleHQuY3VycmVudFN1YmplY3R9LiBgXG4gICAgfVxuICAgIFxuICAgIHJlc3BvbnNlICs9IGDCv0VuIHF1w6kgbcOhcyBwdWVkbyBheXVkYXJ0ZSBob3k/XFxuXFxuYFxuICAgIHJlc3BvbnNlICs9IGBQdWVkbyBheXVkYXJ0ZSBjb246XFxuYFxuICAgIHJlc3BvbnNlICs9IGDwn5OaICoqRXhwbGljYXIgY29uY2VwdG9zKiogZGUgdHVzIG1hdGVyaWFzXFxuYFxuICAgIHJlc3BvbnNlICs9IGDwn5OdICoqUmVzb2x2ZXIgZWplcmNpY2lvcyoqIHBhc28gYSBwYXNvXFxuYFxuICAgIHJlc3BvbnNlICs9IGDwn5OFICoqQWdlbmRhciBldmVudG9zKiogZW4gdHUgY2FsZW5kYXJpb1xcbmBcbiAgICByZXNwb25zZSArPSBg8J+OryAqKkhhY2VyIGV2YWx1YWNpb25lcyoqIGFkYXB0YXRpdmFzXFxuYFxuICAgIHJlc3BvbnNlICs9IGDwn5SNICoqQnVzY2FyIGluZm9ybWFjacOzbioqIGFjYWTDqW1pY2FgXG4gICAgXG4gICAgcmV0dXJuIHJlc3BvbnNlXG4gIH1cblxuICAvKipcbiAgICogQW5hbHl6ZXMgbWVzc2FnZSBtZXRhZGF0YSBmb3IgY29udGV4dFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZU1lc3NhZ2VNZXRhZGF0YShtZXNzYWdlOiBzdHJpbmcpOiBDb252ZXJzYXRpb25UdXJuWydtZXRhZGF0YSddIHtcbiAgICBjb25zdCBtc2dMb3dlciA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxuICAgIFxuICAgIC8vIFN1YmplY3QgZGV0ZWN0aW9uXG4gICAgbGV0IHN1YmplY3Q6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgIGlmICgvbWF0ZW3DoXRpY2FzP3zDoWxnZWJyYXxnZW9tZXRyw61hfGPDoWxjdWxvLy50ZXN0KG1zZ0xvd2VyKSkge1xuICAgICAgc3ViamVjdCA9ICdtYXRlbcOhdGljYXMnXG4gICAgfSBlbHNlIGlmICgvZsOtc2ljYXxtZWPDoW5pY2F8Y2luZW3DoXRpY2F8ZW5lcmfDrWEvLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICBzdWJqZWN0ID0gJ2bDrXNpY2EnXG4gICAgfSBlbHNlIGlmICgvcXXDrW1pY2F8cmVhY2Npw7NufMOhdG9tb3xtb2zDqWN1bGEvLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICBzdWJqZWN0ID0gJ3F1w61taWNhJ1xuICAgIH1cbiAgICBcbiAgICAvLyBUb3BpYyBkZXRlY3Rpb25cbiAgICBsZXQgdG9waWM6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgIGNvbnN0IHRvcGljTWF0Y2hlcyA9IG1zZ0xvd2VyLm1hdGNoKC8oZWN1YWNpw7NufGZ1bmNpw7NufGRlcml2YWRhfGludGVncmFsfGbDs3JtdWxhfHByb2JsZW1hKS9naSlcbiAgICBpZiAodG9waWNNYXRjaGVzKSB7XG4gICAgICB0b3BpYyA9IHRvcGljTWF0Y2hlc1swXVxuICAgIH1cbiAgICBcbiAgICAvLyBJbnRlbnRpb24gZGV0ZWN0aW9uXG4gICAgbGV0IGludGVudGlvbjogc3RyaW5nIHwgdW5kZWZpbmVkXG4gICAgaWYgKC9leHBsaWNhfHF1w6kgZXN8Y8OzbW8gZnVuY2lvbmEvLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICBpbnRlbnRpb24gPSAnZXhwbGFuYXRpb24nXG4gICAgfSBlbHNlIGlmICgvcmVzdWVsdmV8Y2FsY3VsYXxlbmN1ZW50cmEvLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICBpbnRlbnRpb24gPSAncHJvYmxlbV9zb2x2aW5nJ1xuICAgIH0gZWxzZSBpZiAoL2F5dWRhfG5vIGVudGllbmRvfGVzdG95IGNvbmZ1bmRpZG8vLnRlc3QobXNnTG93ZXIpKSB7XG4gICAgICBpbnRlbnRpb24gPSAnaGVscF9yZXF1ZXN0J1xuICAgIH0gZWxzZSBpZiAoL2NvbnRpbsO6YXxzaWd1ZXx5IGRlc3B1w6lzLy50ZXN0KG1zZ0xvd2VyKSkge1xuICAgICAgaW50ZW50aW9uID0gJ2NvbnRpbnVhdGlvbidcbiAgICB9XG4gICAgXG4gICAgLy8gQ29uZmlkZW5jZSBiYXNlZCBvbiBjbGFyaXR5IGFuZCBzcGVjaWZpY2l0eVxuICAgIGxldCBjb25maWRlbmNlID0gMC41XG4gICAgaWYgKHN1YmplY3QpIGNvbmZpZGVuY2UgKz0gMC4yXG4gICAgaWYgKHRvcGljKSBjb25maWRlbmNlICs9IDAuMlxuICAgIGlmIChpbnRlbnRpb24pIGNvbmZpZGVuY2UgKz0gMC4xXG4gICAgXG4gICAgcmV0dXJuIHsgc3ViamVjdCwgdG9waWMsIGludGVudGlvbiwgY29uZmlkZW5jZTogTWF0aC5taW4oY29uZmlkZW5jZSwgMS4wKSB9XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBjb250ZXh0dWFsIGluZm9ybWF0aW9uIGJhc2VkIG9uIG5ldyBtZXNzYWdlXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhc3luYyB1cGRhdGVDb250ZXh0dWFsSW5mb3JtYXRpb24oY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCwgbWVzc2FnZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgY29uc3QgcmVjZW50VHVybnMgPSBjb250ZXh0LmNvbnZlcnNhdGlvbkZsb3cuc2xpY2UoLTUpXG4gICAgY29uc3QgbWV0YWRhdGEgPSByZWNlbnRUdXJuc1tyZWNlbnRUdXJucy5sZW5ndGggLSAxXT8ubWV0YWRhdGFcbiAgICBcbiAgICAvLyBVcGRhdGUgY3VycmVudCB0b3BpYy9zdWJqZWN0IGlmIGRldGVjdGVkXG4gICAgaWYgKG1ldGFkYXRhPy5zdWJqZWN0KSB7XG4gICAgICBjb250ZXh0LmN1cnJlbnRTdWJqZWN0ID0gbWV0YWRhdGEuc3ViamVjdFxuICAgIH1cbiAgICBpZiAobWV0YWRhdGE/LnRvcGljKSB7XG4gICAgICBjb250ZXh0LmN1cnJlbnRUb3BpYyA9IG1ldGFkYXRhLnRvcGljXG4gICAgfVxuICAgIFxuICAgIC8vIERldGVjdCBjb252ZXJzYXRpb24gY29udGludWl0eSBwYXR0ZXJuc1xuICAgIGlmIChtZXRhZGF0YT8uaW50ZW50aW9uID09PSAnY29udGludWF0aW9uJykge1xuICAgICAgY29uc3QgbGFzdEFzc2lzdGFudFR1cm4gPSByZWNlbnRUdXJuc1xuICAgICAgICAuc2xpY2UoKVxuICAgICAgICAucmV2ZXJzZSgpXG4gICAgICAgIC5maW5kKHR1cm4gPT4gdHVybi5yb2xlID09PSAnYXNzaXN0YW50JylcbiAgICAgIFxuICAgICAgaWYgKGxhc3RBc3Npc3RhbnRUdXJuPy5tZXRhZGF0YT8uc3ViamVjdCkge1xuICAgICAgICBjb250ZXh0LmN1cnJlbnRTdWJqZWN0ID0gbGFzdEFzc2lzdGFudFR1cm4ubWV0YWRhdGEuc3ViamVjdFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBVcGRhdGUgYWN0aXZlIGludGVudGlvbnNcbiAgICBpZiAobWV0YWRhdGE/LmludGVudGlvbiAmJiAhY29udGV4dC5hY3RpdmVJbnRlbnRpb25zLmluY2x1ZGVzKG1ldGFkYXRhLmludGVudGlvbikpIHtcbiAgICAgIGNvbnRleHQuYWN0aXZlSW50ZW50aW9ucy5wdXNoKG1ldGFkYXRhLmludGVudGlvbilcbiAgICAgIFxuICAgICAgLy8gS2VlcCBvbmx5IHJlY2VudCBpbnRlbnRpb25zXG4gICAgICBpZiAoY29udGV4dC5hY3RpdmVJbnRlbnRpb25zLmxlbmd0aCA+IDMpIHtcbiAgICAgICAgY29udGV4dC5hY3RpdmVJbnRlbnRpb25zLnNoaWZ0KClcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIGNvbnRleHQgcmVmZXJlbmNlcyBmb3IgaW1wb3J0YW50IGluZm9ybWF0aW9uXG4gICAgaWYgKG1ldGFkYXRhPy5jb25maWRlbmNlICYmIG1ldGFkYXRhLmNvbmZpZGVuY2UgPiAwLjcpIHtcbiAgICAgIGNvbnN0IHJlZmVyZW5jZTogQ29udGV4dFJlZmVyZW5jZSA9IHtcbiAgICAgICAgaWQ6IGByZWZfJHtEYXRlLm5vdygpfWAsXG4gICAgICAgIHR5cGU6IHRoaXMuZGV0ZXJtaW5lUmVmZXJlbmNlVHlwZShtZXRhZGF0YSksXG4gICAgICAgIGNvbnRlbnQ6IG1lc3NhZ2UsXG4gICAgICAgIHJlbGV2YW5jZVNjb3JlOiBtZXRhZGF0YS5jb25maWRlbmNlLFxuICAgICAgICB0dXJuSW5kZXg6IGNvbnRleHQuY29udmVyc2F0aW9uRmxvdy5sZW5ndGggLSAxLFxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29udGV4dC5yZWZlcmVuY2VNZW1vcnkucHVzaChyZWZlcmVuY2UpXG4gICAgICBcbiAgICAgIC8vIEtlZXAgb25seSBtb3N0IHJlbGV2YW50IHJlZmVyZW5jZXNcbiAgICAgIGlmIChjb250ZXh0LnJlZmVyZW5jZU1lbW9yeS5sZW5ndGggPiB0aGlzLk1BWF9SRUZFUkVOQ0VTKSB7XG4gICAgICAgIGNvbnRleHQucmVmZXJlbmNlTWVtb3J5LnNvcnQoKGEsIGIpID0+IGIucmVsZXZhbmNlU2NvcmUgLSBhLnJlbGV2YW5jZVNjb3JlKVxuICAgICAgICBjb250ZXh0LnJlZmVyZW5jZU1lbW9yeSA9IGNvbnRleHQucmVmZXJlbmNlTWVtb3J5LnNsaWNlKDAsIHRoaXMuTUFYX1JFRkVSRU5DRVMpXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIFVwZGF0ZSBjb250ZXh0IHN1bW1hcnlcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZUNvbnRleHRTdW1tYXJ5KGNvbnRleHQpXG4gIH1cblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyByZWZlcmVuY2UgdHlwZSBiYXNlZCBvbiBtZXRhZGF0YVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZGV0ZXJtaW5lUmVmZXJlbmNlVHlwZShtZXRhZGF0YTogQ29udmVyc2F0aW9uVHVyblsnbWV0YWRhdGEnXSk6IENvbnRleHRSZWZlcmVuY2VbJ3R5cGUnXSB7XG4gICAgaWYgKG1ldGFkYXRhLmludGVudGlvbiA9PT0gJ2NvbnRpbnVhdGlvbicpIHJldHVybiAndG9waWNfY29udGludWF0aW9uJ1xuICAgIGlmIChtZXRhZGF0YS5pbnRlbnRpb24gPT09ICdwcm9ibGVtX3NvbHZpbmcnKSByZXR1cm4gJ3Byb2JsZW1fc29sdmluZydcbiAgICBpZiAobWV0YWRhdGEuaW50ZW50aW9uID09PSAnZXhwbGFuYXRpb24nKSByZXR1cm4gJ2V4cGxhbmF0aW9uX2ZvbGxvd3VwJ1xuICAgIHJldHVybiAnc3ViamVjdF9yZWZlcmVuY2UnXG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlcyBjb250ZXh0IHN1bW1hcnkgd2l0aCBrZXkgY29udmVyc2F0aW9uIHBvaW50c1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgdXBkYXRlQ29udGV4dFN1bW1hcnkoY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlY2VudFR1cm5zID0gY29udGV4dC5jb252ZXJzYXRpb25GbG93LnNsaWNlKC02KVxuICAgIGNvbnN0IGtleVRvcGljcyA9IFsuLi5uZXcgU2V0KHJlY2VudFR1cm5zXG4gICAgICAubWFwKHR1cm4gPT4gdHVybi5tZXRhZGF0YS50b3BpYylcbiAgICAgIC5maWx0ZXIoQm9vbGVhbikpXVxuICAgIFxuICAgIGNvbnN0IGtleVN1YmplY3RzID0gWy4uLm5ldyBTZXQocmVjZW50VHVybnNcbiAgICAgIC5tYXAodHVybiA9PiB0dXJuLm1ldGFkYXRhLnN1YmplY3QpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pKV1cbiAgICBcbiAgICBjb25zdCBzdW1tYXJ5UGFydHM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBpZiAoa2V5U3ViamVjdHMubGVuZ3RoID4gMCkge1xuICAgICAgc3VtbWFyeVBhcnRzLnB1c2goYE1hdGVyaWFzOiAke2tleVN1YmplY3RzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGtleVRvcGljcy5sZW5ndGggPiAwKSB7XG4gICAgICBzdW1tYXJ5UGFydHMucHVzaChgVGVtYXM6ICR7a2V5VG9waWNzLmpvaW4oJywgJyl9YClcbiAgICB9XG4gICAgXG4gICAgaWYgKGNvbnRleHQuYWN0aXZlSW50ZW50aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBzdW1tYXJ5UGFydHMucHVzaChgSW50ZW5jaW9uZXM6ICR7Y29udGV4dC5hY3RpdmVJbnRlbnRpb25zLmpvaW4oJywgJyl9YClcbiAgICB9XG4gICAgXG4gICAgY29udGV4dC5jb250ZXh0U3VtbWFyeSA9IHN1bW1hcnlQYXJ0cy5qb2luKCcgfCAnKSB8fCAnQ29udmVyc2FjacOzbiBnZW5lcmFsJ1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyBjb250ZXh0dWFsbHkgYXdhcmUgcmVzcG9uc2UgdXNpbmcgcGVyc2lzdGVudCBzdG9yYWdlXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZShcbiAgICBjb250ZXh0OiBDb252ZXJzYXRpb25Db250ZXh0LCBcbiAgICB1c2VyTmFtZT86IHN0cmluZyxcbiAgICBwZW5kaW5nVGFza3M6IGFueVtdID0gW11cbiAgKTogUHJvbWlzZTxDb250ZXh0dWFsUmVzcG9uc2U+IHtcbiAgICBcbiAgICAvLyBHZXQgbGVhcm5pbmcgcHJvZmlsZSBmb3IgcGVyc29uYWxpemF0aW9uXG4gICAgY29uc3QgbGVhcm5pbmdQcm9maWxlID0gQWR2YW5jZWRMZWFybmluZ1Byb2ZpbGVNYW5hZ2VyLmdldExlYXJuaW5nUHJvZmlsZShjb250ZXh0LnVzZXJJZClcbiAgICBcbiAgICAvLyBVcGRhdGUgbGVhcm5pbmcgcHJvZmlsZSBiYXNlZCBvbiBjdXJyZW50IG1lc3NhZ2VcbiAgICBjb25zdCBsYXRlc3RNZXNzYWdlID0gY29udGV4dC5jb252ZXJzYXRpb25GbG93W2NvbnRleHQuY29udmVyc2F0aW9uRmxvdy5sZW5ndGggLSAxXT8uY29udGVudCB8fCAnJ1xuICAgIEFkdmFuY2VkTGVhcm5pbmdQcm9maWxlTWFuYWdlci5wcm9jZXNzVXNlck1lc3NhZ2UoY29udGV4dC51c2VySWQsIGxhdGVzdE1lc3NhZ2UpXG4gICAgXG4gICAgLy8gQW5hbHl6ZSBjb252ZXJzYXRpb24gZm9yIGNvbnRpbnVpdHlcbiAgICBjb25zdCBjb250aW51aXR5QW5hbHlzaXMgPSB0aGlzLmFuYWx5emVDb250aW51aXR5KGNvbnRleHQpXG4gICAgXG4gICAgLy8g8J+OryBGSVJTVCBQUklPUklUWTogQ2hlY2sgZm9yIGNhbGVuZGFyIHRhc2sgZXhlY3V0aW9uXG4gICAgY29uc3QgY2FsZW5kYXJSZXN1bHQgPSBhd2FpdCB0aGlzLmhhbmRsZUNhbGVuZGFyVGFza3MoXG4gICAgICBjb250ZXh0LnVzZXJJZCxcbiAgICAgIGxhdGVzdE1lc3NhZ2UsXG4gICAgICB0aGlzLmZvcm1hdENvbnZlcnNhdGlvbkhpc3RvcnkoY29udGV4dCksXG4gICAgICBwZW5kaW5nVGFza3NcbiAgICApXG4gICAgXG4gICAgaWYgKGNhbGVuZGFyUmVzdWx0KSB7XG4gICAgICBjb25zb2xlLmxvZyhg8J+ThSBDYWxlbmRhciB0YXNrIGV4ZWN1dGVkOiAke2NhbGVuZGFyUmVzdWx0LnR5cGV9YClcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGNvbnRlbnQ6IGNhbGVuZGFyUmVzdWx0LmNvbnRlbnQsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGNvbnRpbnVpdHlTY29yZTogMC45LFxuICAgICAgICBwZXJzb25hbGl6YXRpb25zOiBbJ2NhbGVuZGFyX3Rhc2tfZXhlY3V0ZWQnXSxcbiAgICAgICAgc3VnZ2VzdGVkRm9sbG93dXBzOiBjYWxlbmRhclJlc3VsdC5tZXRhZGF0YT8uc3VnZ2VzdGVkQWN0aW9ucyB8fCBbXVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIGJhc2UgcmVzcG9uc2UgdXNpbmcgQUkgcHJvdmlkZXJzIGRpcmVjdGx5XG4gICAgY29uc3QgeyBhaVNlcnZpY2UgfSA9IHJlcXVpcmUoJy4vYWktcHJvdmlkZXJzJylcbiAgICBsZXQgYmFzZUNvbnRlbnQgPSAnJ1xuICAgIFxuICAgIHRyeSB7XG4gICAgICAvLyBDcmVhdGUgZWR1Y2F0aW9uYWwgcHJvbXB0IGJhc2VkIG9uIGNvbnRleHRcbiAgICAgIGNvbnN0IGVkdWNhdGlvbmFsUHJvbXB0ID0gdGhpcy5idWlsZEVkdWNhdGlvbmFsUHJvbXB0KGNvbnRleHQsIGxhdGVzdE1lc3NhZ2UsIHVzZXJOYW1lKVxuICAgICAgYmFzZUNvbnRlbnQgPSBhd2FpdCBhaVNlcnZpY2UuZ2VuZXJhdGVFeGVyY2lzZShlZHVjYXRpb25hbFByb21wdClcbiAgICAgIFxuICAgICAgLy8gSWYgQUkgc2VydmljZSByZXR1cm5zIGZhbGxiYWNrIHRlbXBsYXRlLCB1c2UgY29udGV4dHVhbCBmYWxsYmFja1xuICAgICAgaWYgKGJhc2VDb250ZW50ID09PSAnVEVNUExBVEVfRkFMTEJBQ0snKSB7XG4gICAgICAgIGJhc2VDb250ZW50ID0gdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxGYWxsYmFjayhjb250ZXh0LCBsYXRlc3RNZXNzYWdlLCB1c2VyTmFtZSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignQUkgc2VydmljZSBlcnJvciwgdXNpbmcgY29udGV4dHVhbCBmYWxsYmFjazonLCBlcnJvcilcbiAgICAgIGJhc2VDb250ZW50ID0gdGhpcy5nZW5lcmF0ZUNvbnRleHR1YWxGYWxsYmFjayhjb250ZXh0LCBsYXRlc3RNZXNzYWdlLCB1c2VyTmFtZSlcbiAgICB9XG4gICAgXG4gICAgLy8gRW5oYW5jZSByZXNwb25zZSB3aXRoIGNvbnRleHR1YWwgaW5mb3JtYXRpb25cbiAgICBsZXQgZW5oYW5jZWRDb250ZW50ID0gYmFzZUNvbnRlbnRcbiAgICBcbiAgICAvLyBBZGQgY29udGludWl0eSByZWZlcmVuY2VzIGlmIHJlbGV2YW50XG4gICAgaWYgKGNvbnRpbnVpdHlBbmFseXNpcy5zaG91bGRSZWZlcmVuY2UpIHtcbiAgICAgIGVuaGFuY2VkQ29udGVudCA9IHRoaXMuYWRkQ29udGludWl0eVJlZmVyZW5jZXMoZW5oYW5jZWRDb250ZW50LCBjb250ZXh0KVxuICAgIH1cbiAgICBcbiAgICAvLyBBcHBseSBsZWFybmluZyBzdHlsZSBhZGFwdGF0aW9uc1xuICAgIGVuaGFuY2VkQ29udGVudCA9IEFkdmFuY2VkTGVhcm5pbmdQcm9maWxlTWFuYWdlci5hZGFwdFJlc3BvbnNlVG9MZWFybmluZ1N0eWxlKFxuICAgICAgZW5oYW5jZWRDb250ZW50LCBcbiAgICAgIGxlYXJuaW5nUHJvZmlsZVxuICAgIClcbiAgICBcbiAgICAvLyBEZXRlcm1pbmUgcGVyc29uYWxpemF0aW9ucyBhcHBsaWVkXG4gICAgY29uc3QgcGVyc29uYWxpemF0aW9uczogc3RyaW5nW10gPSBbXVxuICAgIGlmIChjb250aW51aXR5QW5hbHlzaXMuc2hvdWxkUmVmZXJlbmNlKSBwZXJzb25hbGl6YXRpb25zLnB1c2goJ2NvbnRleHRfcmVmZXJlbmNlJylcbiAgICBpZiAobGVhcm5pbmdQcm9maWxlLnByaW1hcnlTdHlsZSAhPT0gJ211bHRpbW9kYWwnKSBwZXJzb25hbGl6YXRpb25zLnB1c2goJ2xlYXJuaW5nX3N0eWxlX2FkYXB0YXRpb24nKVxuICAgIGlmIChwZW5kaW5nVGFza3MubGVuZ3RoID4gMCkgcGVyc29uYWxpemF0aW9ucy5wdXNoKCd0YXNrX2F3YXJlJylcbiAgICBcbiAgICAvLyBHZW5lcmF0ZSB2aXN1YWwgcmVjb21tZW5kYXRpb25zXG4gICAgbGV0IHZpc3VhbFJlY29tbWVuZGF0aW9uOiBDb250ZXh0dWFsUmVzcG9uc2VbJ3Zpc3VhbFJlY29tbWVuZGF0aW9uJ11cbiAgICBpZiAobGVhcm5pbmdQcm9maWxlLmFkYXB0YXRpb25QcmVmZXJlbmNlcy5wcmVmZXJzVmlzdWFsQWlkcyAmJiBcbiAgICAgICAgKGNvbnRleHQuY3VycmVudFN1YmplY3QgfHwgY29udGV4dC5jdXJyZW50VG9waWMpKSB7XG4gICAgICBcbiAgICAgIHZpc3VhbFJlY29tbWVuZGF0aW9uID0ge1xuICAgICAgICB0eXBlOiBWaXN1YWxMZWFybmluZ0VuZ2luZS5kZXRlY3RPcHRpbWFsVmlzdWFsVHlwZShlbmhhbmNlZENvbnRlbnQsIGNvbnRleHQuY3VycmVudFN1YmplY3QpLFxuICAgICAgICByZWFzb246IGBSZWNvbWVuZGFkbyBwYXJhIHR1IHBlcmZpbCBkZSBhcHJlbmRpemFqZSAke2xlYXJuaW5nUHJvZmlsZS5wcmltYXJ5U3R5bGV9YFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBHZW5lcmF0ZSBmb2xsb3ctdXAgc3VnZ2VzdGlvbnNcbiAgICBjb25zdCBmb2xsb3d1cHMgPSB0aGlzLmdlbmVyYXRlQ29udGV4dHVhbEZvbGxvd3Vwcyhjb250ZXh0LCBsZWFybmluZ1Byb2ZpbGUpXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbnRlbnQ6IGVuaGFuY2VkQ29udGVudCxcbiAgICAgIGNvbnRleHQsXG4gICAgICBjb250aW51aXR5U2NvcmU6IGNvbnRpbnVpdHlBbmFseXNpcy5zY29yZSxcbiAgICAgIHBlcnNvbmFsaXphdGlvbnMsXG4gICAgICBzdWdnZXN0ZWRGb2xsb3d1cHM6IGZvbGxvd3VwcyxcbiAgICAgIHZpc3VhbFJlY29tbWVuZGF0aW9uXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWx5emVzIGNvbnZlcnNhdGlvbiBjb250aW51aXR5XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBhbmFseXplQ29udGludWl0eShjb250ZXh0OiBDb252ZXJzYXRpb25Db250ZXh0KTogeyBcbiAgICBzY29yZTogbnVtYmVyLCBcbiAgICBzaG91bGRSZWZlcmVuY2U6IGJvb2xlYW4sIFxuICAgIHJlZmVyZW5jZVR5cGU/OiBzdHJpbmcgXG4gIH0ge1xuICAgIGNvbnN0IHJlY2VudFR1cm5zID0gY29udGV4dC5jb252ZXJzYXRpb25GbG93LnNsaWNlKC00KVxuICAgIGxldCBzY29yZSA9IDAuNSAvLyBCYXNlIHNjb3JlXG4gICAgbGV0IHNob3VsZFJlZmVyZW5jZSA9IGZhbHNlXG4gICAgbGV0IHJlZmVyZW5jZVR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgIFxuICAgIC8vIENoZWNrIGZvciB0b3BpYyBjb250aW51aXR5XG4gICAgY29uc3QgdG9waWNzID0gcmVjZW50VHVybnMubWFwKHR1cm4gPT4gdHVybi5tZXRhZGF0YS50b3BpYykuZmlsdGVyKEJvb2xlYW4pXG4gICAgaWYgKHRvcGljcy5sZW5ndGggPiAxICYmIHRvcGljc1t0b3BpY3MubGVuZ3RoIC0gMV0gPT09IHRvcGljc1t0b3BpY3MubGVuZ3RoIC0gMl0pIHtcbiAgICAgIHNjb3JlICs9IDAuMlxuICAgICAgc2hvdWxkUmVmZXJlbmNlID0gdHJ1ZVxuICAgICAgcmVmZXJlbmNlVHlwZSA9ICd0b3BpY19jb250aW51aXR5J1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBmb3Igc3ViamVjdCBjb250aW51aXR5XG4gICAgY29uc3Qgc3ViamVjdHMgPSByZWNlbnRUdXJucy5tYXAodHVybiA9PiB0dXJuLm1ldGFkYXRhLnN1YmplY3QpLmZpbHRlcihCb29sZWFuKVxuICAgIGlmIChzdWJqZWN0cy5sZW5ndGggPiAxICYmIHN1YmplY3RzW3N1YmplY3RzLmxlbmd0aCAtIDFdID09PSBzdWJqZWN0c1tzdWJqZWN0cy5sZW5ndGggLSAyXSkge1xuICAgICAgc2NvcmUgKz0gMC4xNVxuICAgICAgc2hvdWxkUmVmZXJlbmNlID0gdHJ1ZVxuICAgICAgcmVmZXJlbmNlVHlwZSA9ICdzdWJqZWN0X2NvbnRpbnVpdHknXG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGZvciBjb250aW51YXRpb24gaW5kaWNhdG9yc1xuICAgIGNvbnN0IGxhdGVzdE1lc3NhZ2UgPSByZWNlbnRUdXJuc1tyZWNlbnRUdXJucy5sZW5ndGggLSAxXT8uY29udGVudD8udG9Mb3dlckNhc2UoKSB8fCAnJ1xuICAgIGlmICgvY29udGluw7phfHNpZ3VlfHkgZGVzcHXDqXN8dGFtYmnDqW58YWRlbcOhcy8udGVzdChsYXRlc3RNZXNzYWdlKSkge1xuICAgICAgc2NvcmUgKz0gMC4yNVxuICAgICAgc2hvdWxkUmVmZXJlbmNlID0gdHJ1ZVxuICAgICAgcmVmZXJlbmNlVHlwZSA9ICdleHBsaWNpdF9jb250aW51YXRpb24nXG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGZvciBxdWVzdGlvbiBmb2xsb3ctdXAgcGF0dGVybnNcbiAgICBjb25zdCBoYXNRdWVzdGlvbkZvbGxvd3VwID0gcmVjZW50VHVybnMuc29tZSgodHVybiwgaW5kZXgpID0+IFxuICAgICAgaW5kZXggPiAwICYmIFxuICAgICAgdHVybi5yb2xlID09PSAndXNlcicgJiYgXG4gICAgICAvcG9yIHF1w6l8Y8OzbW98Y3XDoW5kb3xkw7NuZGV8ZXhwbGljYS8udGVzdCh0dXJuLmNvbnRlbnQudG9Mb3dlckNhc2UoKSkgJiZcbiAgICAgIHJlY2VudFR1cm5zW2luZGV4IC0gMV0/LnJvbGUgPT09ICdhc3Npc3RhbnQnXG4gICAgKVxuICAgIFxuICAgIGlmIChoYXNRdWVzdGlvbkZvbGxvd3VwKSB7XG4gICAgICBzY29yZSArPSAwLjFcbiAgICAgIHNob3VsZFJlZmVyZW5jZSA9IHRydWVcbiAgICAgIHJlZmVyZW5jZVR5cGUgPSAnZm9sbG93dXBfcXVlc3Rpb24nXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7IFxuICAgICAgc2NvcmU6IE1hdGgubWluKHNjb3JlLCAxLjApLCBcbiAgICAgIHNob3VsZFJlZmVyZW5jZSwgXG4gICAgICByZWZlcmVuY2VUeXBlIFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBZGRzIGNvbnRpbnVpdHkgcmVmZXJlbmNlcyB0byByZXNwb25zZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYWRkQ29udGludWl0eVJlZmVyZW5jZXMoY29udGVudDogc3RyaW5nLCBjb250ZXh0OiBDb252ZXJzYXRpb25Db250ZXh0KTogc3RyaW5nIHtcbiAgICBjb25zdCByZWNlbnRBc3Npc3RhbnRUdXJucyA9IGNvbnRleHQuY29udmVyc2F0aW9uRmxvd1xuICAgICAgLmZpbHRlcih0dXJuID0+IHR1cm4ucm9sZSA9PT0gJ2Fzc2lzdGFudCcpXG4gICAgICAuc2xpY2UoLTIpXG4gICAgXG4gICAgaWYgKHJlY2VudEFzc2lzdGFudFR1cm5zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGNvbnRlbnRcbiAgICBcbiAgICBjb25zdCBsYXN0VG9waWMgPSBjb250ZXh0LmN1cnJlbnRUb3BpY1xuICAgIGNvbnN0IGxhc3RTdWJqZWN0ID0gY29udGV4dC5jdXJyZW50U3ViamVjdFxuICAgIFxuICAgIGxldCByZWZlcmVuY2VQcmVmaXggPSAnJ1xuICAgIFxuICAgIGlmIChsYXN0VG9waWMgJiYgbGFzdFN1YmplY3QpIHtcbiAgICAgIHJlZmVyZW5jZVByZWZpeCA9IGBDb250aW51YW5kbyBjb24gJHtsYXN0VG9waWN9IGVuICR7bGFzdFN1YmplY3R9OiBgXG4gICAgfSBlbHNlIGlmIChsYXN0VG9waWMpIHtcbiAgICAgIHJlZmVyZW5jZVByZWZpeCA9IGBTaWd1aWVuZG8gY29uIGVsIHRlbWEgZGUgJHtsYXN0VG9waWN9OiBgXG4gICAgfSBlbHNlIGlmIChsYXN0U3ViamVjdCkge1xuICAgICAgcmVmZXJlbmNlUHJlZml4ID0gYENvbnRpbnVhbmRvIGNvbiAke2xhc3RTdWJqZWN0fTogYFxuICAgIH0gZWxzZSB7XG4gICAgICByZWZlcmVuY2VQcmVmaXggPSBgQ29tbyBtZW5jaW9uw6kgYW50ZXJpb3JtZW50ZTogYFxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVmZXJlbmNlUHJlZml4ICsgY29udGVudFxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyBjb250ZXh0dWFsIGZvbGxvdy11cCBzdWdnZXN0aW9uc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVDb250ZXh0dWFsRm9sbG93dXBzKFxuICAgIGNvbnRleHQ6IENvbnZlcnNhdGlvbkNvbnRleHQsIFxuICAgIGxlYXJuaW5nUHJvZmlsZTogYW55XG4gICk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBmb2xsb3d1cHM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBCYXNlZCBvbiBjdXJyZW50IHRvcGljL3N1YmplY3RcbiAgICBpZiAoY29udGV4dC5jdXJyZW50VG9waWMpIHtcbiAgICAgIGZvbGxvd3Vwcy5wdXNoKGDCv1RpZW5lcyBtw6FzIHByZWd1bnRhcyBzb2JyZSAke2NvbnRleHQuY3VycmVudFRvcGljfT9gKVxuICAgIH1cbiAgICBcbiAgICBpZiAoY29udGV4dC5jdXJyZW50U3ViamVjdCkge1xuICAgICAgZm9sbG93dXBzLnB1c2goYMK/VGUgZ3VzdGFyw61hIHZlciBlamVyY2ljaW9zIGRlICR7Y29udGV4dC5jdXJyZW50U3ViamVjdH0/YClcbiAgICB9XG4gICAgXG4gICAgLy8gQmFzZWQgb24gbGVhcm5pbmcgc3R5bGVcbiAgICBpZiAobGVhcm5pbmdQcm9maWxlLmFkYXB0YXRpb25QcmVmZXJlbmNlcy5wcmVmZXJzVmlzdWFsQWlkcykge1xuICAgICAgZm9sbG93dXBzLnB1c2goJ8K/VGUgYXl1ZGFyw61hIHZlciB1biBkaWFncmFtYSBkZSBlc3RvPycpXG4gICAgfVxuICAgIFxuICAgIGlmIChsZWFybmluZ1Byb2ZpbGUuYWRhcHRhdGlvblByZWZlcmVuY2VzLnByZWZlcnNJbnRlcmFjdGlvbikge1xuICAgICAgZm9sbG93dXBzLnB1c2goJ8K/UXVpZXJlcyBwcmFjdGljYXIgY29uIHVuIGVqZXJjaWNpbz8nKVxuICAgIH1cbiAgICBcbiAgICAvLyBCYXNlZCBvbiBhY3RpdmUgaW50ZW50aW9uc1xuICAgIGlmIChjb250ZXh0LmFjdGl2ZUludGVudGlvbnMuaW5jbHVkZXMoJ2V4cGxhbmF0aW9uJykpIHtcbiAgICAgIGZvbGxvd3Vwcy5wdXNoKCfCv05lY2VzaXRhcyBxdWUgcHJvZnVuZGljZSBlbiBhbGfDum4gYXNwZWN0byBlc3BlY8OtZmljbz8nKVxuICAgIH1cbiAgICBcbiAgICBpZiAoY29udGV4dC5hY3RpdmVJbnRlbnRpb25zLmluY2x1ZGVzKCdwcm9ibGVtX3NvbHZpbmcnKSkge1xuICAgICAgZm9sbG93dXBzLnB1c2goJ8K/UXVpZXJlcyBxdWUgcmVzb2x2YW1vcyBvdHJvIHByb2JsZW1hIHNpbWlsYXI/JylcbiAgICB9XG4gICAgXG4gICAgLy8gR2VuZXJpYyBjb250ZXh0dWFsIGZvbGxvd3Vwc1xuICAgIGlmIChjb250ZXh0LmNvbnZlcnNhdGlvbkZsb3cubGVuZ3RoID4gMykge1xuICAgICAgZm9sbG93dXBzLnB1c2goJ8K/SGF5IGFsZ28gcXVlIG5vIHF1ZWTDsyBjbGFybz8nKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZm9sbG93dXBzLnNsaWNlKDAsIDMpIC8vIExpbWl0IHRvIDMgc3VnZ2VzdGlvbnNcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXRzIGNvbnZlcnNhdGlvbiBoaXN0b3J5IGZvciBleHRlcm5hbCBlbmdpbmVzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBmb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5KGNvbnRleHQ6IENvbnZlcnNhdGlvbkNvbnRleHQpOiBBcnJheTx7IHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnLCBjb250ZW50OiBzdHJpbmcgfT4ge1xuICAgIHJldHVybiBjb250ZXh0LmNvbnZlcnNhdGlvbkZsb3dcbiAgICAgIC5zbGljZSgtMTApIC8vIExhc3QgMTAgdHVybnNcbiAgICAgIC5tYXAodHVybiA9PiAoe1xuICAgICAgICByb2xlOiB0dXJuLnJvbGUsXG4gICAgICAgIGNvbnRlbnQ6IHR1cm4uY29udGVudFxuICAgICAgfSkpXG4gIH1cblxuICAvKipcbiAgICogTWFpbnRhaW5zIGNvbnRleHQgbWVtb3J5IGJ5IGNsZWFuaW5nIG9sZCBkYXRhXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBtYWludGFpbkNvbnRleHRNZW1vcnkoY29udGV4dDogQ29udmVyc2F0aW9uQ29udGV4dCk6IHZvaWQge1xuICAgIC8vIEtlZXAgb25seSByZWNlbnQgdHVybnNcbiAgICBpZiAoY29udGV4dC5jb252ZXJzYXRpb25GbG93Lmxlbmd0aCA+IHRoaXMuTUFYX1RVUk5TX1JFVEFJTkVEKSB7XG4gICAgICBjb250ZXh0LmNvbnZlcnNhdGlvbkZsb3cgPSBjb250ZXh0LmNvbnZlcnNhdGlvbkZsb3cuc2xpY2UoLXRoaXMuTUFYX1RVUk5TX1JFVEFJTkVEKVxuICAgIH1cbiAgICBcbiAgICAvLyBDbGVhbiBvbGQgcmVmZXJlbmNlc1xuICAgIGNvbnN0IGN1dG9mZlRpbWUgPSBuZXcgRGF0ZShEYXRlLm5vdygpIC0gKDEyICogNjAgKiA2MCAqIDEwMDApKSAvLyAxMiBob3Vyc1xuICAgIGNvbnRleHQucmVmZXJlbmNlTWVtb3J5ID0gY29udGV4dC5yZWZlcmVuY2VNZW1vcnkuZmlsdGVyKFxuICAgICAgcmVmID0+IHJlZi50aW1lc3RhbXAgPiBjdXRvZmZUaW1lXG4gICAgKVxuICAgIFxuICAgIC8vIENsZWFuIG9sZCBpbnRlbnRpb25zXG4gICAgaWYgKGNvbnRleHQuYWN0aXZlSW50ZW50aW9ucy5sZW5ndGggPiAzKSB7XG4gICAgICBjb250ZXh0LmFjdGl2ZUludGVudGlvbnMgPSBjb250ZXh0LmFjdGl2ZUludGVudGlvbnMuc2xpY2UoLTMpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgY29udmVyc2F0aW9uIHN0YXRpc3RpY3MgdXNpbmcgcGVyc2lzdGVudCBzdG9yYWdlXG4gICAqL1xuICBzdGF0aWMgZ2V0Q29udmVyc2F0aW9uU3RhdHModXNlcklkPzogc3RyaW5nKTogYW55IHtcbiAgICBjb25zdCB7IGdldFVzZXJBY3RpdmVTZXNzaW9ucyB9ID0gcmVxdWlyZSgnLi90ZW1wLXN0b3JhZ2UnKVxuICAgIFxuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIGNvbnN0IHVzZXJTZXNzaW9ucyA9IGdldFVzZXJBY3RpdmVTZXNzaW9ucyh1c2VySWQpXG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFjdGl2ZUNvbnRleHRzOiB1c2VyU2Vzc2lvbnMubGVuZ3RoLFxuICAgICAgICB0b3RhbFR1cm5zOiB1c2VyU2Vzc2lvbnMucmVkdWNlKChzdW06IG51bWJlciwgc2Vzc2lvbjogYW55KSA9PiBzdW0gKyBzZXNzaW9uLnR1cm5zLmxlbmd0aCwgMCksXG4gICAgICAgIGN1cnJlbnRUb3BpY3M6IFsuLi5uZXcgU2V0KHVzZXJTZXNzaW9ucy5tYXAoKHNlc3Npb246IGFueSkgPT4gc2Vzc2lvbi5jdXJyZW50VG9waWMpLmZpbHRlcihCb29sZWFuKSldLFxuICAgICAgICBjdXJyZW50U3ViamVjdHM6IFsuLi5uZXcgU2V0KHVzZXJTZXNzaW9ucy5tYXAoKHNlc3Npb246IGFueSkgPT4gc2Vzc2lvbi5jdXJyZW50U3ViamVjdCkuZmlsdGVyKEJvb2xlYW4pKV1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gRm9yIGdsb2JhbCBzdGF0cywgd2UgbmVlZCB0byBpbXBvcnQgdGhlIGNvbnZlcnNhdGlvbnMgYXJyYXlcbiAgICBjb25zdCB7IHRlbXBDb252ZXJzYXRpb25zIH0gPSByZXF1aXJlKCcuL3RlbXAtc3RvcmFnZScpXG4gICAgY29uc3QgYWN0aXZlQ29udmVyc2F0aW9ucyA9IHRlbXBDb252ZXJzYXRpb25zLmZpbHRlcigoc2Vzc2lvbjogYW55KSA9PiB7XG4gICAgICBjb25zdCBvbmVIb3VyQWdvID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtICg2MCAqIDYwICogMTAwMCkpXG4gICAgICByZXR1cm4gc2Vzc2lvbi5sYXN0VXBkYXRlID4gb25lSG91ckFnb1xuICAgIH0pXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsQWN0aXZlQ29udGV4dHM6IGFjdGl2ZUNvbnZlcnNhdGlvbnMubGVuZ3RoLFxuICAgICAgdG90YWxVc2VyczogbmV3IFNldChhY3RpdmVDb252ZXJzYXRpb25zLm1hcCgoc2Vzc2lvbjogYW55KSA9PiBzZXNzaW9uLnVzZXJJZCkpLnNpemUsXG4gICAgICBhdmVyYWdlQ29udGV4dEFnZTogdGhpcy5jYWxjdWxhdGVBdmVyYWdlQ29udGV4dEFnZUZyb21TZXNzaW9ucyhhY3RpdmVDb252ZXJzYXRpb25zKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhdGVzIGF2ZXJhZ2UgY29udGV4dCBhZ2UgZnJvbSBwZXJzaXN0ZW50IHNlc3Npb25zXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVBdmVyYWdlQ29udGV4dEFnZUZyb21TZXNzaW9ucyhzZXNzaW9uczogYW55W10pOiBudW1iZXIge1xuICAgIGlmIChzZXNzaW9ucy5sZW5ndGggPT09IDApIHJldHVybiAwXG4gICAgXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKVxuICAgIGNvbnN0IHRvdGFsQWdlID0gc2Vzc2lvbnMucmVkdWNlKChzdW06IG51bWJlciwgc2Vzc2lvbjogYW55KSA9PiBcbiAgICAgIHN1bSArIChub3cgLSBuZXcgRGF0ZShzZXNzaW9uLmxhc3RVcGRhdGUpLmdldFRpbWUoKSksIDApXG4gICAgXG4gICAgcmV0dXJuIE1hdGgucm91bmQodG90YWxBZ2UgLyBzZXNzaW9ucy5sZW5ndGggLyAoNjAgKiAxMDAwKSkgLy8gQXZlcmFnZSBhZ2UgaW4gbWludXRlc1xuICB9XG5cbiAgLyoqXG4gICAqIEZvcmNlcyBjbGVhbnVwIG9mIGFsbCBjb250ZXh0cyAodXNlZnVsIGZvciB0ZXN0aW5nKVxuICAgKi9cbiAgc3RhdGljIGNsZWFyQWxsQ29udGV4dHMoKTogdm9pZCB7XG4gICAgY29uc3QgeyBjbGVhbnVwT2xkQ29udmVyc2F0aW9ucyB9ID0gcmVxdWlyZSgnLi90ZW1wLXN0b3JhZ2UnKVxuICAgIGNsZWFudXBPbGRDb252ZXJzYXRpb25zKClcbiAgICBjb25zb2xlLmxvZygn8J+nuSBBbGwgY29udmVyc2F0aW9uIGNvbnRleHRzIGNsZWFyZWQgdXNpbmcgcGVyc2lzdGVudCBzdG9yYWdlJylcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFjdGl2ZSBjb250ZXh0IGZvciB1c2VyICh1c2VmdWwgZm9yIGRlYnVnZ2luZylcbiAgICovXG4gIHN0YXRpYyBnZXRBY3RpdmVDb250ZXh0KHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ/OiBzdHJpbmcpOiBDb252ZXJzYXRpb25Db250ZXh0IHwgbnVsbCB7XG4gICAgY29uc3QgeyBnZXRDb252ZXJzYXRpb25TZXNzaW9uLCBnZXRVc2VyQWN0aXZlU2Vzc2lvbnMgfSA9IHJlcXVpcmUoJy4vdGVtcC1zdG9yYWdlJylcbiAgICBcbiAgICBpZiAoc2Vzc2lvbklkKSB7XG4gICAgICBjb25zdCBzZXNzaW9uID0gZ2V0Q29udmVyc2F0aW9uU2Vzc2lvbih1c2VySWQsIHNlc3Npb25JZClcbiAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXJJZCxcbiAgICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb24uc2Vzc2lvbklkLFxuICAgICAgICAgIGN1cnJlbnRUb3BpYzogc2Vzc2lvbi5jdXJyZW50VG9waWMsXG4gICAgICAgICAgY3VycmVudFN1YmplY3Q6IHNlc3Npb24uY3VycmVudFN1YmplY3QsXG4gICAgICAgICAgY29udmVyc2F0aW9uRmxvdzogc2Vzc2lvbi50dXJucyxcbiAgICAgICAgICBjb250ZXh0U3VtbWFyeTogdGhpcy5idWlsZENvbnRleHRTdW1tYXJ5KHNlc3Npb24pLFxuICAgICAgICAgIGFjdGl2ZUludGVudGlvbnM6IHRoaXMuZXh0cmFjdEFjdGl2ZUludGVudGlvbnMoc2Vzc2lvbi50dXJucy5zbGljZSgtNSkpLFxuICAgICAgICAgIHBlbmRpbmdRdWVzdGlvbnM6IFtdLFxuICAgICAgICAgIHJlZmVyZW5jZU1lbW9yeTogdGhpcy5idWlsZFJlZmVyZW5jZU1lbW9yeShzZXNzaW9uLnR1cm5zKSxcbiAgICAgICAgICBsYXN0VXBkYXRlOiBzZXNzaW9uLmxhc3RVcGRhdGVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBGaW5kIGFueSBhY3RpdmUgc2Vzc2lvbiBmb3IgdXNlclxuICAgIGNvbnN0IGFjdGl2ZVNlc3Npb25zID0gZ2V0VXNlckFjdGl2ZVNlc3Npb25zKHVzZXJJZClcbiAgICBpZiAoYWN0aXZlU2Vzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGFjdGl2ZVNlc3Npb25zWzBdXG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VySWQ6IHNlc3Npb24udXNlcklkLFxuICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb24uc2Vzc2lvbklkLFxuICAgICAgICBjdXJyZW50VG9waWM6IHNlc3Npb24uY3VycmVudFRvcGljLFxuICAgICAgICBjdXJyZW50U3ViamVjdDogc2Vzc2lvbi5jdXJyZW50U3ViamVjdCxcbiAgICAgICAgY29udmVyc2F0aW9uRmxvdzogc2Vzc2lvbi50dXJucyxcbiAgICAgICAgY29udGV4dFN1bW1hcnk6IHRoaXMuYnVpbGRDb250ZXh0U3VtbWFyeShzZXNzaW9uKSxcbiAgICAgICAgYWN0aXZlSW50ZW50aW9uczogdGhpcy5leHRyYWN0QWN0aXZlSW50ZW50aW9ucyhzZXNzaW9uLnR1cm5zLnNsaWNlKC01KSksXG4gICAgICAgIHBlbmRpbmdRdWVzdGlvbnM6IFtdLFxuICAgICAgICByZWZlcmVuY2VNZW1vcnk6IHRoaXMuYnVpbGRSZWZlcmVuY2VNZW1vcnkoc2Vzc2lvbi50dXJucyksXG4gICAgICAgIGxhc3RVcGRhdGU6IHNlc3Npb24ubGFzdFVwZGF0ZVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbnVsbFxuICB9XG59XG5cbi8vIFBlcnNpc3RlbnQgc3RvcmFnZSBjbGVhbnVwIGlzIGhhbmRsZWQgYnkgdGVtcC1zdG9yYWdlLnRzXG4vLyBObyBuZWVkIGZvciBhZGRpdGlvbmFsIGNsZWFudXAgaW50ZXJ2YWxzIl0sIm5hbWVzIjpbIkFkdmFuY2VkTGVhcm5pbmdQcm9maWxlTWFuYWdlciIsIlZpc3VhbExlYXJuaW5nRW5naW5lIiwiQUlDYWxlbmRhckludGVncmF0aW9uIiwiQ29udGV4dHVhbENvbnZlcnNhdGlvbk1hbmFnZXIiLCJNQVhfVFVSTlNfUkVUQUlORUQiLCJNQVhfUkVGRVJFTkNFUyIsIkNPTlRFWFRfREVDQVlfSE9VUlMiLCJwcm9jZXNzQ29udGV4dHVhbE1lc3NhZ2UiLCJ1c2VySWQiLCJtZXNzYWdlIiwic2Vzc2lvbklkIiwidXNlck5hbWUiLCJhY3R1YWxTZXNzaW9uSWQiLCJEYXRlIiwibm93IiwiZ2V0Q29udmVyc2F0aW9uU2Vzc2lvbiIsImNyZWF0ZUNvbnZlcnNhdGlvblNlc3Npb24iLCJhZGRDb252ZXJzYXRpb25UdXJuIiwiYWRkUGVuZGluZ1Rhc2siLCJnZXRQZW5kaW5nVGFza3MiLCJyZXF1aXJlIiwic2Vzc2lvbiIsImNvbnNvbGUiLCJsb2ciLCJzdWJzdHJpbmciLCJ0dXJucyIsImxlbmd0aCIsInBlbmRpbmdUYXNrcyIsImZpbHRlciIsInQiLCJjb21wbGV0ZWQiLCJtZXNzYWdlTWV0YWRhdGEiLCJhbmFseXplTWVzc2FnZU1ldGFkYXRhIiwiY29udGV4dCIsImN1cnJlbnRUb3BpYyIsImN1cnJlbnRTdWJqZWN0IiwiY29udmVyc2F0aW9uRmxvdyIsIm1hcCIsInR1cm4iLCJpZCIsInRpbWVzdGFtcCIsInJvbGUiLCJjb250ZW50IiwibWV0YWRhdGEiLCJjb250ZXh0U3VtbWFyeSIsImJ1aWxkQ29udGV4dFN1bW1hcnkiLCJhY3RpdmVJbnRlbnRpb25zIiwiZXh0cmFjdEFjdGl2ZUludGVudGlvbnMiLCJzbGljZSIsInBlbmRpbmdRdWVzdGlvbnMiLCJyZWZlcmVuY2VNZW1vcnkiLCJidWlsZFJlZmVyZW5jZU1lbW9yeSIsImxhc3RVcGRhdGUiLCJyZXNwb25zZSIsImdlbmVyYXRlQ29udGV4dHVhbFJlc3BvbnNlIiwiYXNzaXN0YW50TWV0YWRhdGEiLCJjb25maWRlbmNlIiwiY29udGludWl0eVNjb3JlIiwidmlzdWFsc0dlbmVyYXRlZCIsInZpc3VhbFJlY29tbWVuZGF0aW9uIiwic2VhcmNoUGVyZm9ybWVkIiwicGVyc29uYWxpemF0aW9ucyIsImluY2x1ZGVzIiwidGFza0NvbXBsZXRlZCIsInJlY2VudFR1cm5zIiwia2V5VG9waWNzIiwiU2V0IiwidG9waWMiLCJCb29sZWFuIiwia2V5U3ViamVjdHMiLCJzdWJqZWN0Iiwic3VtbWFyeVBhcnRzIiwicHVzaCIsImpvaW4iLCJpbnRlbnRpb25zIiwiaW50ZW50aW9uIiwicmVmZXJlbmNlcyIsImZvckVhY2giLCJpbmRleCIsInR5cGUiLCJkZXRlcm1pbmVSZWZlcmVuY2VUeXBlRnJvbU1ldGFkYXRhIiwicmVsZXZhbmNlU2NvcmUiLCJ0dXJuSW5kZXgiLCJoYW5kbGVDYWxlbmRhclRhc2tzIiwiY29udmVyc2F0aW9uSGlzdG9yeSIsImNhbGVuZGFySW50ZWdyYXRpb24iLCJjYWxlbmRhclJlc3VsdCIsInByb2Nlc3NNZXNzYWdlIiwibmVlZHNFdmVudENyZWF0aW9uIiwiY2FsZW5kYXJUYXNrIiwiZmluZCIsIm1hcmtUYXNrQ29tcGxldGVkIiwic3VnZ2VzdGVkQWN0aW9ucyIsImV2ZW50IiwiZXZlbnRDcmVhdGVkIiwiYnVpbGRFZHVjYXRpb25hbFByb21wdCIsImNvbnZlcnNhdGlvbkNvbnRleHQiLCJwcm9tcHQiLCJnZW5lcmF0ZUNvbnRleHR1YWxGYWxsYmFjayIsIm1zZ0xvd2VyIiwidG9Mb3dlckNhc2UiLCJ0ZXN0IiwidG9waWNNYXRjaGVzIiwibWF0Y2giLCJNYXRoIiwibWluIiwidXBkYXRlQ29udGV4dHVhbEluZm9ybWF0aW9uIiwibGFzdEFzc2lzdGFudFR1cm4iLCJyZXZlcnNlIiwic2hpZnQiLCJyZWZlcmVuY2UiLCJkZXRlcm1pbmVSZWZlcmVuY2VUeXBlIiwic29ydCIsImEiLCJiIiwidXBkYXRlQ29udGV4dFN1bW1hcnkiLCJsZWFybmluZ1Byb2ZpbGUiLCJnZXRMZWFybmluZ1Byb2ZpbGUiLCJsYXRlc3RNZXNzYWdlIiwicHJvY2Vzc1VzZXJNZXNzYWdlIiwiY29udGludWl0eUFuYWx5c2lzIiwiYW5hbHl6ZUNvbnRpbnVpdHkiLCJmb3JtYXRDb252ZXJzYXRpb25IaXN0b3J5Iiwic3VnZ2VzdGVkRm9sbG93dXBzIiwiYWlTZXJ2aWNlIiwiYmFzZUNvbnRlbnQiLCJlZHVjYXRpb25hbFByb21wdCIsImdlbmVyYXRlRXhlcmNpc2UiLCJlcnJvciIsImVuaGFuY2VkQ29udGVudCIsInNob3VsZFJlZmVyZW5jZSIsImFkZENvbnRpbnVpdHlSZWZlcmVuY2VzIiwiYWRhcHRSZXNwb25zZVRvTGVhcm5pbmdTdHlsZSIsInByaW1hcnlTdHlsZSIsImFkYXB0YXRpb25QcmVmZXJlbmNlcyIsInByZWZlcnNWaXN1YWxBaWRzIiwiZGV0ZWN0T3B0aW1hbFZpc3VhbFR5cGUiLCJyZWFzb24iLCJmb2xsb3d1cHMiLCJnZW5lcmF0ZUNvbnRleHR1YWxGb2xsb3d1cHMiLCJzY29yZSIsInJlZmVyZW5jZVR5cGUiLCJ0b3BpY3MiLCJzdWJqZWN0cyIsImhhc1F1ZXN0aW9uRm9sbG93dXAiLCJzb21lIiwicmVjZW50QXNzaXN0YW50VHVybnMiLCJsYXN0VG9waWMiLCJsYXN0U3ViamVjdCIsInJlZmVyZW5jZVByZWZpeCIsInByZWZlcnNJbnRlcmFjdGlvbiIsIm1haW50YWluQ29udGV4dE1lbW9yeSIsImN1dG9mZlRpbWUiLCJyZWYiLCJnZXRDb252ZXJzYXRpb25TdGF0cyIsImdldFVzZXJBY3RpdmVTZXNzaW9ucyIsInVzZXJTZXNzaW9ucyIsImFjdGl2ZUNvbnRleHRzIiwidG90YWxUdXJucyIsInJlZHVjZSIsInN1bSIsImN1cnJlbnRUb3BpY3MiLCJjdXJyZW50U3ViamVjdHMiLCJ0ZW1wQ29udmVyc2F0aW9ucyIsImFjdGl2ZUNvbnZlcnNhdGlvbnMiLCJvbmVIb3VyQWdvIiwidG90YWxBY3RpdmVDb250ZXh0cyIsInRvdGFsVXNlcnMiLCJzaXplIiwiYXZlcmFnZUNvbnRleHRBZ2UiLCJjYWxjdWxhdGVBdmVyYWdlQ29udGV4dEFnZUZyb21TZXNzaW9ucyIsInNlc3Npb25zIiwidG90YWxBZ2UiLCJnZXRUaW1lIiwicm91bmQiLCJjbGVhckFsbENvbnRleHRzIiwiY2xlYW51cE9sZENvbnZlcnNhdGlvbnMiLCJnZXRBY3RpdmVDb250ZXh0IiwiYWN0aXZlU2Vzc2lvbnMiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/contextual-conversation-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/conversation-memory.ts":
/*!****************************************!*\
  !*** ./src/lib/conversation-memory.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ConversationMemoryManager: () => (/* binding */ ConversationMemoryManager)\n/* harmony export */ });\n/* harmony import */ var _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./emotion-analyzer */ \"(rsc)/./src/lib/emotion-analyzer.ts\");\n// Sistema de Memoria Conversacional para Sara\n// Permite recordar conversaciones, preferencias y contexto del estudiante\n\nclass ConversationMemoryManager {\n    static{\n        this.memories = new Map();\n    }\n    /**\n   * Obtiene o crea la memoria conversacional para un usuario\n   */ static getMemory(userId, sessionId) {\n        const memoryKey = `${userId}_${sessionId || 'default'}`;\n        if (!this.memories.has(memoryKey)) {\n            this.memories.set(memoryKey, this.createNewMemory(userId, sessionId));\n        }\n        return this.memories.get(memoryKey);\n    }\n    /**\n   * Guarda un nuevo intercambio conversacional\n   */ static saveConversationTurn(userId, userMessage, saraResponse, mode, intent, sessionId) {\n        const memory = this.getMemory(userId, sessionId);\n        const turn = {\n            id: `turn_${Date.now()}_${Math.random().toString(36).substr(2, 8)}`,\n            timestamp: new Date(),\n            userMessage,\n            saraResponse,\n            mode,\n            intent,\n            topics: this.extractTopics(userMessage),\n            emotions: this.detectEmotions(userMessage, {\n                subject: this.extractSubjectFromMessage(userMessage),\n                previousEmotion: memory.emotionalProfile?.currentMood\n            }),\n            context: this.analyzeContext(userMessage, saraResponse)\n        };\n        // Agregar al historial\n        memory.conversationHistory.push(turn);\n        memory.totalTurns++;\n        memory.lastActivity = new Date();\n        // Mantener solo los últimos 50 intercambios para eficiencia\n        if (memory.conversationHistory.length > 50) {\n            memory.conversationHistory = memory.conversationHistory.slice(-50);\n        }\n        // Actualizar perfiles basándose en la nueva conversación\n        this.updatePreferences(memory, turn);\n        this.updateEmotionalProfile(memory, turn);\n        this.updateRecurringTopics(memory, turn);\n        this.updateProgressTracking(memory, turn);\n        return turn;\n    }\n    /**\n   * Genera un resumen contextual para Sara basado en la memoria\n   */ static generateContextualSummary(userId, sessionId) {\n        const memory = this.getMemory(userId, sessionId);\n        if (memory.conversationHistory.length === 0) {\n            return \"Esta es nuestra primera conversación. Estoy aquí para conocerte y ayudarte con tus objetivos académicos.\";\n        }\n        const recentTurns = memory.conversationHistory.slice(-5);\n        const summary = [];\n        // Información sobre sesión actual\n        const daysSinceLastChat = Math.floor((Date.now() - memory.lastActivity.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysSinceLastChat > 7) {\n            summary.push(`Han pasado ${daysSinceLastChat} días desde nuestra última conversación.`);\n        } else if (daysSinceLastChat > 1) {\n            summary.push(`Nos vimos hace ${daysSinceLastChat} días.`);\n        }\n        // Temas recurrentes importantes\n        const importantTopics = memory.recurringTopics.filter((t)=>t.frequency > 2 && !t.resolved).slice(0, 3);\n        if (importantTopics.length > 0) {\n            summary.push(`Hemos estado trabajando en: ${importantTopics.map((t)=>t.topic).join(', ')}.`);\n        }\n        // Estado emocional\n        if (memory.emotionalProfile.motivationLevel < 5) {\n            summary.push(\"He notado que podrías necesitar un poco más de motivación.\");\n        } else if (memory.emotionalProfile.motivationLevel > 8) {\n            summary.push(\"Me alegra ver tu motivación y energía positiva.\");\n        }\n        // Seguimientos pendientes\n        const pendingFollowUps = memory.progressTracking.pendingFollowUps.filter((f)=>f.dueDate <= new Date());\n        if (pendingFollowUps.length > 0) {\n            summary.push(`Tenemos ${pendingFollowUps.length} seguimiento(s) pendiente(s).`);\n        }\n        // Preferencias del estudiante\n        if (memory.preferences.difficultSubjects.length > 0) {\n            summary.push(`Sé que ${memory.preferences.difficultSubjects[0]} te presenta algunos desafíos.`);\n        }\n        return summary.length > 0 ? summary.join(' ') : \"Continuemos donde lo dejamos la última vez.\";\n    }\n    /**\n   * Obtiene sugerencias personalizadas basadas en la memoria\n   */ static getPersonalizedSuggestions(userId, sessionId) {\n        const memory = this.getMemory(userId, sessionId);\n        const suggestions = [];\n        // Basado en temas recurrentes sin resolver\n        const unresolvedTopics = memory.recurringTopics.filter((t)=>!t.resolved);\n        unresolvedTopics.slice(0, 2).forEach((topic)=>{\n            suggestions.push(`Retomar el trabajo en ${topic.topic}`);\n        });\n        // Basado en seguimientos pendientes\n        memory.progressTracking.pendingFollowUps.slice(0, 2).forEach((followUp)=>{\n            suggestions.push(`Revisar progreso: ${followUp.task}`);\n        });\n        // Basado en materias difíciles\n        if (memory.preferences.difficultSubjects.length > 0) {\n            suggestions.push(`Planificar sesión de estudio para ${memory.preferences.difficultSubjects[0]}`);\n        }\n        // Basado en estado emocional\n        if (memory.emotionalProfile.motivationLevel < 5) {\n            suggestions.push(\"Trabajar en motivación y objetivos pequeños\");\n        }\n        // Basado en preferencias de modo\n        if (memory.preferences.preferredMode) {\n            suggestions.push(`Continuar en modo ${memory.preferences.preferredMode}`);\n        }\n        return suggestions.slice(0, 4) // Máximo 4 sugerencias\n        ;\n    }\n    /**\n   * Detecta si el usuario necesita seguimiento en temas específicos\n   */ static needsFollowUp(userId, sessionId) {\n        const memory = this.getMemory(userId, sessionId);\n        // Verificar seguimientos vencidos\n        const overdueFollowUps = memory.progressTracking.pendingFollowUps.filter((f)=>f.dueDate < new Date());\n        // Verificar temas sin resolver por mucho tiempo\n        const staleTops = memory.recurringTopics.filter((t)=>!t.resolved && Date.now() - t.lastMentioned.getTime() > 7 * 24 * 60 * 60 * 1000);\n        // Verificar bajo nivel de motivación\n        const lowMotivation = memory.emotionalProfile.motivationLevel < 4;\n        return overdueFollowUps.length > 0 || staleTops.length > 0 || lowMotivation;\n    }\n    // Métodos auxiliares privados\n    static createNewMemory(userId, sessionId) {\n        return {\n            userId,\n            sessionId: sessionId || 'default',\n            startedAt: new Date(),\n            lastActivity: new Date(),\n            totalTurns: 0,\n            conversationHistory: [],\n            preferences: {\n                preferredMode: 'chatting',\n                favoriteSubjects: [],\n                difficultSubjects: [],\n                studyTimePreference: 'evening',\n                communicationStyle: 'casual'\n            },\n            emotionalProfile: {\n                currentMood: _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL,\n                motivationLevel: 7,\n                recentEmotions: [],\n                emotionalTrends: {\n                    dominant: _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL,\n                    frequency: 0,\n                    lastWeek: []\n                },\n                frustrationAreas: [],\n                achievementAreas: [],\n                lastEncouragement: new Date(),\n                emotionalInsights: []\n            },\n            recurringTopics: [],\n            progressTracking: {\n                goalsDiscussed: [],\n                plansMade: [],\n                completedTasks: [],\n                pendingFollowUps: []\n            }\n        };\n    }\n    static extractTopics(message) {\n        const topics = [];\n        const lowerMessage = message.toLowerCase();\n        // Lista de temas académicos comunes\n        const academicTopics = [\n            'matemáticas',\n            'física',\n            'química',\n            'biología',\n            'historia',\n            'literatura',\n            'inglés',\n            'programación',\n            'cálculo',\n            'álgebra',\n            'geometría',\n            'estadística',\n            'examen',\n            'tarea',\n            'proyecto',\n            'presentación',\n            'ensayo',\n            'estudio',\n            'horario',\n            'planificación',\n            'calendario',\n            'tiempo',\n            'organización'\n        ];\n        academicTopics.forEach((topic)=>{\n            if (lowerMessage.includes(topic)) {\n                topics.push(topic);\n            }\n        });\n        return topics;\n    }\n    static extractSubjectFromMessage(message) {\n        const lowerMessage = message.toLowerCase();\n        const subjects = [\n            'matemáticas',\n            'física',\n            'química',\n            'biología',\n            'historia',\n            'literatura',\n            'inglés',\n            'programación'\n        ];\n        return subjects.find((subject)=>lowerMessage.includes(subject));\n    }\n    static detectEmotions(message, context) {\n        return _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionAnalyzer.analyzeEmotions(message, context);\n    }\n    static analyzeContext(userMessage, saraResponse) {\n        const lowerMessage = userMessage.toLowerCase();\n        const context = {};\n        // Detectar materias\n        const subjects = [\n            'matemáticas',\n            'física',\n            'química',\n            'biología',\n            'historia',\n            'literatura',\n            'inglés'\n        ];\n        const detectedSubject = subjects.find((subject)=>lowerMessage.includes(subject));\n        if (detectedSubject) {\n            context.subject = detectedSubject;\n        }\n        // Detectar dificultad\n        if (lowerMessage.includes('fácil') || lowerMessage.includes('simple')) {\n            context.difficulty = 'easy';\n        } else if (lowerMessage.includes('difícil') || lowerMessage.includes('complejo')) {\n            context.difficulty = 'hard';\n        } else {\n            context.difficulty = 'medium';\n        }\n        // Detectar logros\n        if (lowerMessage.includes('logré') || lowerMessage.includes('terminé') || lowerMessage.includes('completé')) {\n            context.achievement = true;\n        }\n        // Detectar necesidad de seguimiento\n        if (lowerMessage.includes('planificar') || lowerMessage.includes('revisar') || lowerMessage.includes('próxima vez')) {\n            context.needsFollowUp = true;\n        }\n        return context;\n    }\n    static updatePreferences(memory, turn) {\n        // Actualizar modo preferido\n        memory.preferences.preferredMode = turn.mode;\n        // Actualizar materias favoritas/difíciles basándose en emociones\n        if (turn.context?.subject) {\n            if (turn.emotions?.detected === 'positive' || turn.emotions?.detected === 'motivated') {\n                if (!memory.preferences.favoriteSubjects.includes(turn.context.subject)) {\n                    memory.preferences.favoriteSubjects.push(turn.context.subject);\n                }\n            } else if (turn.emotions?.detected === 'frustrated' || turn.emotions?.detected === 'negative') {\n                if (!memory.preferences.difficultSubjects.includes(turn.context.subject)) {\n                    memory.preferences.difficultSubjects.push(turn.context.subject);\n                }\n            }\n        }\n    }\n    static updateEmotionalProfile(memory, turn) {\n        if (turn.emotions) {\n            const emotion = turn.emotions.primary;\n            // Actualizar humor actual\n            memory.emotionalProfile.currentMood = emotion;\n            // Agregar a emociones recientes (mantener últimas 5)\n            memory.emotionalProfile.recentEmotions.unshift(emotion);\n            if (memory.emotionalProfile.recentEmotions.length > 5) {\n                memory.emotionalProfile.recentEmotions = memory.emotionalProfile.recentEmotions.slice(0, 5);\n            }\n            // Actualizar tendencias emocionales semanales\n            memory.emotionalProfile.emotionalTrends.lastWeek.unshift(emotion);\n            if (memory.emotionalProfile.emotionalTrends.lastWeek.length > 20) {\n                memory.emotionalProfile.emotionalTrends.lastWeek = memory.emotionalProfile.emotionalTrends.lastWeek.slice(0, 20);\n            }\n            // Calcular emoción dominante\n            const emotionCounts = memory.emotionalProfile.emotionalTrends.lastWeek.reduce((acc, em)=>{\n                acc[em] = (acc[em] || 0) + 1;\n                return acc;\n            }, {});\n            const dominantEmotion = Object.entries(emotionCounts).sort(([, a], [, b])=>b - a)[0]?.[0];\n            if (dominantEmotion) {\n                memory.emotionalProfile.emotionalTrends.dominant = dominantEmotion;\n                memory.emotionalProfile.emotionalTrends.frequency = emotionCounts[dominantEmotion];\n            }\n            // Ajustar nivel de motivación basado en emociones\n            const motivationAdjustment = this.getMotivationAdjustment(emotion, turn.emotions.intensity);\n            memory.emotionalProfile.motivationLevel = Math.max(1, Math.min(10, memory.emotionalProfile.motivationLevel + motivationAdjustment));\n            // Actualizar áreas de frustración/logro\n            if (turn.context?.subject) {\n                if ([\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FRUSTRATED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.OVERWHELMED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.STRESSED\n                ].includes(emotion)) {\n                    if (!memory.emotionalProfile.frustrationAreas.includes(turn.context.subject)) {\n                        memory.emotionalProfile.frustrationAreas.push(turn.context.subject);\n                    }\n                }\n                if ([\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.PROUD,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFIDENT,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.EXCITED\n                ].includes(emotion) || turn.context?.achievement) {\n                    if (!memory.emotionalProfile.achievementAreas.includes(turn.context.subject)) {\n                        memory.emotionalProfile.achievementAreas.push(turn.context.subject);\n                    }\n                }\n            }\n            // Generar insights emocionales\n            const insight = this.generateEmotionalInsight(emotion, turn.emotions, turn.context?.subject);\n            if (insight) {\n                memory.emotionalProfile.emotionalInsights.unshift(insight);\n                if (memory.emotionalProfile.emotionalInsights.length > 10) {\n                    memory.emotionalProfile.emotionalInsights = memory.emotionalProfile.emotionalInsights.slice(0, 10);\n                }\n            }\n        }\n    }\n    /**\n   * Calcula el ajuste de motivación basado en la emoción\n   */ static getMotivationAdjustment(emotion, intensity) {\n        const baseAdjustments = {\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.MOTIVATED]: 2,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.EXCITED]: 2,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.PROUD]: 1.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFIDENT]: 1.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.HOPEFUL]: 1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.HAPPY]: 1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.GRATEFUL]: 0.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.RELIEVED]: 0.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CURIOUS]: 0.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL]: 0,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFUSED]: -0.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.BORED]: -1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.DISAPPOINTED]: -1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.SAD]: -1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FRUSTRATED]: -1.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.OVERWHELMED]: -2,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.STRESSED]: -2,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANXIOUS]: -1.5,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANGRY]: -1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FEAR]: -1,\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.SURPRISE]: 0\n        };\n        const baseAdjustment = baseAdjustments[emotion] || 0;\n        // Aplicar multiplicador de intensidad\n        const intensityMultiplier = intensity === 'high' ? 1.5 : intensity === 'medium' ? 1.2 : 0.8;\n        return baseAdjustment * intensityMultiplier;\n    }\n    /**\n   * Genera un insight emocional basado en la emoción detectada\n   */ static generateEmotionalInsight(emotion, analysis, subject) {\n        const timestamp = new Date().toLocaleDateString();\n        switch(emotion){\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FRUSTRATED:\n                return `${timestamp}: Frustración detectada${subject ? ` en ${subject}` : ''}. Considerar estrategias de apoyo adicional.`;\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.OVERWHELMED:\n                return `${timestamp}: Estudiante se siente abrumado. Recomendar descansos y división de tareas.`;\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.MOTIVATED:\n                return `${timestamp}: Alta motivación detectada${subject ? ` hacia ${subject}` : ''}. Momento ideal para objetivos ambiciosos.`;\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFUSED:\n                return `${timestamp}: Confusión identificada${subject ? ` en ${subject}` : ''}. Necesita explicaciones más claras.`;\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.PROUD:\n                return `${timestamp}: Orgullo por logro${subject ? ` en ${subject}` : ''}. Reforzar autoconfianza.`;\n            case _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANXIOUS:\n                return `${timestamp}: Ansiedad detectada. Implementar técnicas de relajación y apoyo.`;\n            default:\n                if (analysis.intensity === 'high') {\n                    return `${timestamp}: Emoción intensa (${emotion}) detectada. Monitorear estado emocional.`;\n                }\n                return null;\n        }\n    }\n    static updateRecurringTopics(memory, turn) {\n        turn.topics.forEach((topic)=>{\n            const existing = memory.recurringTopics.find((rt)=>rt.topic === topic);\n            if (existing) {\n                existing.frequency++;\n                existing.lastMentioned = new Date();\n                // Marcar como resuelto si hay indicadores de logro\n                if (turn.context?.achievement) {\n                    existing.resolved = true;\n                }\n            } else {\n                memory.recurringTopics.push({\n                    topic,\n                    frequency: 1,\n                    lastMentioned: new Date(),\n                    resolved: false\n                });\n            }\n        });\n    }\n    static updateProgressTracking(memory, turn) {\n        // Detectar objetivos/planes mencionados\n        const lowerMessage = turn.userMessage.toLowerCase();\n        if (lowerMessage.includes('objetivo') || lowerMessage.includes('meta')) {\n            memory.progressTracking.goalsDiscussed.push(turn.userMessage);\n        }\n        if (lowerMessage.includes('plan') || lowerMessage.includes('planificar')) {\n            memory.progressTracking.plansMade.push(turn.userMessage);\n        }\n        if (turn.context?.achievement) {\n            memory.progressTracking.completedTasks.push(turn.userMessage);\n        }\n        // Agregar seguimientos si es necesario\n        if (turn.context?.needsFollowUp) {\n            const followUpDate = new Date();\n            followUpDate.setDate(followUpDate.getDate() + 3) // Seguimiento en 3 días\n            ;\n            memory.progressTracking.pendingFollowUps.push({\n                task: turn.userMessage,\n                dueDate: followUpDate,\n                reminder: true\n            });\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkFDQUgsV0FBVztvQkFDWHNCLGVBQWUsSUFBSTVEO29CQUNuQnVDLFVBQVU7Z0JBQ1o7WUFDRjtRQUNGO0lBQ0Y7SUFFQSxPQUFlWix1QkFBdUI5QixNQUEwQixFQUFFQyxJQUFzQixFQUFRO1FBQzlGLHdDQUF3QztRQUN4QyxNQUFNaUYsZUFBZWpGLEtBQUtMLFdBQVcsQ0FBQ3VGLFdBQVc7UUFFakQsSUFBSUQsYUFBYUcsUUFBUSxDQUFDLGVBQWVILGFBQWFHLFFBQVEsQ0FBQyxTQUFTO1lBQ3RFckYsT0FBT2dELGdCQUFnQixDQUFDOEIsY0FBYyxDQUFDeEQsSUFBSSxDQUFDckIsS0FBS0wsV0FBVztRQUM5RDtRQUVBLElBQUlzRixhQUFhRyxRQUFRLENBQUMsV0FBV0gsYUFBYUcsUUFBUSxDQUFDLGVBQWU7WUFDeEVyRixPQUFPZ0QsZ0JBQWdCLENBQUMrQixTQUFTLENBQUN6RCxJQUFJLENBQUNyQixLQUFLTCxXQUFXO1FBQ3pEO1FBRUEsSUFBSUssS0FBS2tCLE9BQU8sRUFBRXdFLGFBQWE7WUFDN0IzRixPQUFPZ0QsZ0JBQWdCLENBQUNnQyxjQUFjLENBQUMxRCxJQUFJLENBQUNyQixLQUFLTCxXQUFXO1FBQzlEO1FBRUEsdUNBQXVDO1FBQ3ZDLElBQUlLLEtBQUtrQixPQUFPLEVBQUV5QyxlQUFlO1lBQy9CLE1BQU1nRixlQUFlLElBQUl6STtZQUN6QnlJLGFBQWFDLE9BQU8sQ0FBQ0QsYUFBYUUsT0FBTyxLQUFLLEdBQUcsd0JBQXdCOztZQUV6RTlJLE9BQU9nRCxnQkFBZ0IsQ0FBQ0QsZ0JBQWdCLENBQUN6QixJQUFJLENBQUM7Z0JBQzVDb0MsTUFBTXpELEtBQUtMLFdBQVc7Z0JBQ3RCc0QsU0FBUzBGO2dCQUNURyxVQUFVO1lBQ1o7UUFDRjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvY29udmVyc2F0aW9uLW1lbW9yeS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaXN0ZW1hIGRlIE1lbW9yaWEgQ29udmVyc2FjaW9uYWwgcGFyYSBTYXJhXG4vLyBQZXJtaXRlIHJlY29yZGFyIGNvbnZlcnNhY2lvbmVzLCBwcmVmZXJlbmNpYXMgeSBjb250ZXh0byBkZWwgZXN0dWRpYW50ZVxuXG5pbXBvcnQgeyBFbW90aW9uQW5hbHl6ZXIsIEVtb3Rpb25UeXBlLCBFbW90aW9uQW5hbHlzaXMgfSBmcm9tICcuL2Vtb3Rpb24tYW5hbHl6ZXInXG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29udmVyc2F0aW9uVHVybiB7XG4gIGlkOiBzdHJpbmdcbiAgdGltZXN0YW1wOiBEYXRlXG4gIHVzZXJNZXNzYWdlOiBzdHJpbmdcbiAgc2FyYVJlc3BvbnNlOiBzdHJpbmdcbiAgbW9kZTogc3RyaW5nXG4gIGludGVudD86IHN0cmluZ1xuICB0b3BpY3M6IHN0cmluZ1tdXG4gIGVtb3Rpb25zPzogRW1vdGlvbkFuYWx5c2lzXG4gIGNvbnRleHQ/OiB7XG4gICAgc3ViamVjdD86IHN0cmluZ1xuICAgIGRpZmZpY3VsdHk/OiAnZWFzeScgfCAnbWVkaXVtJyB8ICdoYXJkJ1xuICAgIGFjaGlldmVtZW50PzogYm9vbGVhblxuICAgIG5lZWRzRm9sbG93VXA/OiBib29sZWFuXG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb252ZXJzYXRpb25NZW1vcnkge1xuICB1c2VySWQ6IHN0cmluZ1xuICBzZXNzaW9uSWQ6IHN0cmluZ1xuICBzdGFydGVkQXQ6IERhdGVcbiAgbGFzdEFjdGl2aXR5OiBEYXRlXG4gIHRvdGFsVHVybnM6IG51bWJlclxuICBjb252ZXJzYXRpb25IaXN0b3J5OiBDb252ZXJzYXRpb25UdXJuW11cbiAgXG4gIC8vIEluZm9ybWFjacOzbiBleHRyYcOtZGEgZGVsIGNvbnRleHRvXG4gIHByZWZlcmVuY2VzOiB7XG4gICAgcHJlZmVycmVkTW9kZTogc3RyaW5nXG4gICAgZmF2b3JpdGVTdWJqZWN0czogc3RyaW5nW11cbiAgICBkaWZmaWN1bHRTdWJqZWN0czogc3RyaW5nW11cbiAgICBzdHVkeVRpbWVQcmVmZXJlbmNlOiBzdHJpbmdcbiAgICBjb21tdW5pY2F0aW9uU3R5bGU6ICdmb3JtYWwnIHwgJ2Nhc3VhbCcgfCAnbW90aXZhdGlvbmFsJ1xuICB9XG4gIFxuICAvLyBFc3RhZG8gZW1vY2lvbmFsIHkgbW90aXZhY2lvbmFsXG4gIGVtb3Rpb25hbFByb2ZpbGU6IHtcbiAgICBjdXJyZW50TW9vZDogRW1vdGlvblR5cGVcbiAgICBtb3RpdmF0aW9uTGV2ZWw6IG51bWJlciAvLyAxLTEwXG4gICAgcmVjZW50RW1vdGlvbnM6IEVtb3Rpb25UeXBlW10gLy8gw5psdGltYXMgNSBlbW9jaW9uZXMgZGV0ZWN0YWRhc1xuICAgIGVtb3Rpb25hbFRyZW5kczoge1xuICAgICAgZG9taW5hbnQ6IEVtb3Rpb25UeXBlXG4gICAgICBmcmVxdWVuY3k6IG51bWJlclxuICAgICAgbGFzdFdlZWs6IEVtb3Rpb25UeXBlW11cbiAgICB9XG4gICAgZnJ1c3RyYXRpb25BcmVhczogc3RyaW5nW11cbiAgICBhY2hpZXZlbWVudEFyZWFzOiBzdHJpbmdbXVxuICAgIGxhc3RFbmNvdXJhZ2VtZW50OiBEYXRlXG4gICAgZW1vdGlvbmFsSW5zaWdodHM6IHN0cmluZ1tdXG4gIH1cbiAgXG4gIC8vIFRlbWFzIHkgb2JqZXRpdm9zIHJlY3VycmVudGVzXG4gIHJlY3VycmluZ1RvcGljczogQXJyYXk8e1xuICAgIHRvcGljOiBzdHJpbmdcbiAgICBmcmVxdWVuY3k6IG51bWJlclxuICAgIGxhc3RNZW50aW9uZWQ6IERhdGVcbiAgICByZXNvbHZlZDogYm9vbGVhblxuICB9PlxuICBcbiAgLy8gU2VndWltaWVudG8gZGUgcHJvZ3Jlc29cbiAgcHJvZ3Jlc3NUcmFja2luZzoge1xuICAgIGdvYWxzRGlzY3Vzc2VkOiBzdHJpbmdbXVxuICAgIHBsYW5zTWFkZTogc3RyaW5nW11cbiAgICBjb21wbGV0ZWRUYXNrczogc3RyaW5nW11cbiAgICBwZW5kaW5nRm9sbG93VXBzOiBBcnJheTx7XG4gICAgICB0YXNrOiBzdHJpbmdcbiAgICAgIGR1ZURhdGU6IERhdGVcbiAgICAgIHJlbWluZGVyOiBib29sZWFuXG4gICAgfT5cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIG1lbW9yaWVzOiBNYXA8c3RyaW5nLCBDb252ZXJzYXRpb25NZW1vcnk+ID0gbmV3IE1hcCgpXG4gIFxuICAvKipcbiAgICogT2J0aWVuZSBvIGNyZWEgbGEgbWVtb3JpYSBjb252ZXJzYWNpb25hbCBwYXJhIHVuIHVzdWFyaW9cbiAgICovXG4gIHN0YXRpYyBnZXRNZW1vcnkodXNlcklkOiBzdHJpbmcsIHNlc3Npb25JZD86IHN0cmluZyk6IENvbnZlcnNhdGlvbk1lbW9yeSB7XG4gICAgY29uc3QgbWVtb3J5S2V5ID0gYCR7dXNlcklkfV8ke3Nlc3Npb25JZCB8fCAnZGVmYXVsdCd9YFxuICAgIFxuICAgIGlmICghdGhpcy5tZW1vcmllcy5oYXMobWVtb3J5S2V5KSkge1xuICAgICAgdGhpcy5tZW1vcmllcy5zZXQobWVtb3J5S2V5LCB0aGlzLmNyZWF0ZU5ld01lbW9yeSh1c2VySWQsIHNlc3Npb25JZCkpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLm1lbW9yaWVzLmdldChtZW1vcnlLZXkpIVxuICB9XG4gIFxuICAvKipcbiAgICogR3VhcmRhIHVuIG51ZXZvIGludGVyY2FtYmlvIGNvbnZlcnNhY2lvbmFsXG4gICAqL1xuICBzdGF0aWMgc2F2ZUNvbnZlcnNhdGlvblR1cm4oXG4gICAgdXNlcklkOiBzdHJpbmcsXG4gICAgdXNlck1lc3NhZ2U6IHN0cmluZyxcbiAgICBzYXJhUmVzcG9uc2U6IHN0cmluZyxcbiAgICBtb2RlOiBzdHJpbmcsXG4gICAgaW50ZW50Pzogc3RyaW5nLFxuICAgIHNlc3Npb25JZD86IHN0cmluZ1xuICApOiBDb252ZXJzYXRpb25UdXJuIHtcbiAgICBjb25zdCBtZW1vcnkgPSB0aGlzLmdldE1lbW9yeSh1c2VySWQsIHNlc3Npb25JZClcbiAgICBcbiAgICBjb25zdCB0dXJuOiBDb252ZXJzYXRpb25UdXJuID0ge1xuICAgICAgaWQ6IGB0dXJuXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOCl9YCxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIHVzZXJNZXNzYWdlLFxuICAgICAgc2FyYVJlc3BvbnNlLFxuICAgICAgbW9kZSxcbiAgICAgIGludGVudCxcbiAgICAgIHRvcGljczogdGhpcy5leHRyYWN0VG9waWNzKHVzZXJNZXNzYWdlKSxcbiAgICAgIGVtb3Rpb25zOiB0aGlzLmRldGVjdEVtb3Rpb25zKHVzZXJNZXNzYWdlLCB7IFxuICAgICAgICBzdWJqZWN0OiB0aGlzLmV4dHJhY3RTdWJqZWN0RnJvbU1lc3NhZ2UodXNlck1lc3NhZ2UpLFxuICAgICAgICBwcmV2aW91c0Vtb3Rpb246IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlPy5jdXJyZW50TW9vZCBcbiAgICAgIH0pLFxuICAgICAgY29udGV4dDogdGhpcy5hbmFseXplQ29udGV4dCh1c2VyTWVzc2FnZSwgc2FyYVJlc3BvbnNlKVxuICAgIH1cbiAgICBcbiAgICAvLyBBZ3JlZ2FyIGFsIGhpc3RvcmlhbFxuICAgIG1lbW9yeS5jb252ZXJzYXRpb25IaXN0b3J5LnB1c2godHVybilcbiAgICBtZW1vcnkudG90YWxUdXJucysrXG4gICAgbWVtb3J5Lmxhc3RBY3Rpdml0eSA9IG5ldyBEYXRlKClcbiAgICBcbiAgICAvLyBNYW50ZW5lciBzb2xvIGxvcyDDumx0aW1vcyA1MCBpbnRlcmNhbWJpb3MgcGFyYSBlZmljaWVuY2lhXG4gICAgaWYgKG1lbW9yeS5jb252ZXJzYXRpb25IaXN0b3J5Lmxlbmd0aCA+IDUwKSB7XG4gICAgICBtZW1vcnkuY29udmVyc2F0aW9uSGlzdG9yeSA9IG1lbW9yeS5jb252ZXJzYXRpb25IaXN0b3J5LnNsaWNlKC01MClcbiAgICB9XG4gICAgXG4gICAgLy8gQWN0dWFsaXphciBwZXJmaWxlcyBiYXPDoW5kb3NlIGVuIGxhIG51ZXZhIGNvbnZlcnNhY2nDs25cbiAgICB0aGlzLnVwZGF0ZVByZWZlcmVuY2VzKG1lbW9yeSwgdHVybilcbiAgICB0aGlzLnVwZGF0ZUVtb3Rpb25hbFByb2ZpbGUobWVtb3J5LCB0dXJuKVxuICAgIHRoaXMudXBkYXRlUmVjdXJyaW5nVG9waWNzKG1lbW9yeSwgdHVybilcbiAgICB0aGlzLnVwZGF0ZVByb2dyZXNzVHJhY2tpbmcobWVtb3J5LCB0dXJuKVxuICAgIFxuICAgIHJldHVybiB0dXJuXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZW5lcmEgdW4gcmVzdW1lbiBjb250ZXh0dWFsIHBhcmEgU2FyYSBiYXNhZG8gZW4gbGEgbWVtb3JpYVxuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlQ29udGV4dHVhbFN1bW1hcnkodXNlcklkOiBzdHJpbmcsIHNlc3Npb25JZD86IHN0cmluZyk6IHN0cmluZyB7XG4gICAgY29uc3QgbWVtb3J5ID0gdGhpcy5nZXRNZW1vcnkodXNlcklkLCBzZXNzaW9uSWQpXG4gICAgXG4gICAgaWYgKG1lbW9yeS5jb252ZXJzYXRpb25IaXN0b3J5Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIFwiRXN0YSBlcyBudWVzdHJhIHByaW1lcmEgY29udmVyc2FjacOzbi4gRXN0b3kgYXF1w60gcGFyYSBjb25vY2VydGUgeSBheXVkYXJ0ZSBjb24gdHVzIG9iamV0aXZvcyBhY2Fkw6ltaWNvcy5cIlxuICAgIH1cbiAgICBcbiAgICBjb25zdCByZWNlbnRUdXJucyA9IG1lbW9yeS5jb252ZXJzYXRpb25IaXN0b3J5LnNsaWNlKC01KVxuICAgIGNvbnN0IHN1bW1hcnk6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBJbmZvcm1hY2nDs24gc29icmUgc2VzacOzbiBhY3R1YWxcbiAgICBjb25zdCBkYXlzU2luY2VMYXN0Q2hhdCA9IE1hdGguZmxvb3IoXG4gICAgICAoRGF0ZS5ub3coKSAtIG1lbW9yeS5sYXN0QWN0aXZpdHkuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KVxuICAgIClcbiAgICBcbiAgICBpZiAoZGF5c1NpbmNlTGFzdENoYXQgPiA3KSB7XG4gICAgICBzdW1tYXJ5LnB1c2goYEhhbiBwYXNhZG8gJHtkYXlzU2luY2VMYXN0Q2hhdH0gZMOtYXMgZGVzZGUgbnVlc3RyYSDDumx0aW1hIGNvbnZlcnNhY2nDs24uYClcbiAgICB9IGVsc2UgaWYgKGRheXNTaW5jZUxhc3RDaGF0ID4gMSkge1xuICAgICAgc3VtbWFyeS5wdXNoKGBOb3Mgdmltb3MgaGFjZSAke2RheXNTaW5jZUxhc3RDaGF0fSBkw61hcy5gKVxuICAgIH1cbiAgICBcbiAgICAvLyBUZW1hcyByZWN1cnJlbnRlcyBpbXBvcnRhbnRlc1xuICAgIGNvbnN0IGltcG9ydGFudFRvcGljcyA9IG1lbW9yeS5yZWN1cnJpbmdUb3BpY3NcbiAgICAgIC5maWx0ZXIodCA9PiB0LmZyZXF1ZW5jeSA+IDIgJiYgIXQucmVzb2x2ZWQpXG4gICAgICAuc2xpY2UoMCwgMylcbiAgICBcbiAgICBpZiAoaW1wb3J0YW50VG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgIHN1bW1hcnkucHVzaChgSGVtb3MgZXN0YWRvIHRyYWJhamFuZG8gZW46ICR7aW1wb3J0YW50VG9waWNzLm1hcCh0ID0+IHQudG9waWMpLmpvaW4oJywgJyl9LmApXG4gICAgfVxuICAgIFxuICAgIC8vIEVzdGFkbyBlbW9jaW9uYWxcbiAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUubW90aXZhdGlvbkxldmVsIDwgNSkge1xuICAgICAgc3VtbWFyeS5wdXNoKFwiSGUgbm90YWRvIHF1ZSBwb2Ryw61hcyBuZWNlc2l0YXIgdW4gcG9jbyBtw6FzIGRlIG1vdGl2YWNpw7NuLlwiKVxuICAgIH0gZWxzZSBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUubW90aXZhdGlvbkxldmVsID4gOCkge1xuICAgICAgc3VtbWFyeS5wdXNoKFwiTWUgYWxlZ3JhIHZlciB0dSBtb3RpdmFjacOzbiB5IGVuZXJnw61hIHBvc2l0aXZhLlwiKVxuICAgIH1cbiAgICBcbiAgICAvLyBTZWd1aW1pZW50b3MgcGVuZGllbnRlc1xuICAgIGNvbnN0IHBlbmRpbmdGb2xsb3dVcHMgPSBtZW1vcnkucHJvZ3Jlc3NUcmFja2luZy5wZW5kaW5nRm9sbG93VXBzXG4gICAgICAuZmlsdGVyKGYgPT4gZi5kdWVEYXRlIDw9IG5ldyBEYXRlKCkpXG4gICAgXG4gICAgaWYgKHBlbmRpbmdGb2xsb3dVcHMubGVuZ3RoID4gMCkge1xuICAgICAgc3VtbWFyeS5wdXNoKGBUZW5lbW9zICR7cGVuZGluZ0ZvbGxvd1Vwcy5sZW5ndGh9IHNlZ3VpbWllbnRvKHMpIHBlbmRpZW50ZShzKS5gKVxuICAgIH1cbiAgICBcbiAgICAvLyBQcmVmZXJlbmNpYXMgZGVsIGVzdHVkaWFudGVcbiAgICBpZiAobWVtb3J5LnByZWZlcmVuY2VzLmRpZmZpY3VsdFN1YmplY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgIHN1bW1hcnkucHVzaChgU8OpIHF1ZSAke21lbW9yeS5wcmVmZXJlbmNlcy5kaWZmaWN1bHRTdWJqZWN0c1swXX0gdGUgcHJlc2VudGEgYWxndW5vcyBkZXNhZsOtb3MuYClcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHN1bW1hcnkubGVuZ3RoID4gMCBcbiAgICAgID8gc3VtbWFyeS5qb2luKCcgJylcbiAgICAgIDogXCJDb250aW51ZW1vcyBkb25kZSBsbyBkZWphbW9zIGxhIMO6bHRpbWEgdmV6LlwiXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBPYnRpZW5lIHN1Z2VyZW5jaWFzIHBlcnNvbmFsaXphZGFzIGJhc2FkYXMgZW4gbGEgbWVtb3JpYVxuICAgKi9cbiAgc3RhdGljIGdldFBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zKHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ/OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgbWVtb3J5ID0gdGhpcy5nZXRNZW1vcnkodXNlcklkLCBzZXNzaW9uSWQpXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICAvLyBCYXNhZG8gZW4gdGVtYXMgcmVjdXJyZW50ZXMgc2luIHJlc29sdmVyXG4gICAgY29uc3QgdW5yZXNvbHZlZFRvcGljcyA9IG1lbW9yeS5yZWN1cnJpbmdUb3BpY3MuZmlsdGVyKHQgPT4gIXQucmVzb2x2ZWQpXG4gICAgdW5yZXNvbHZlZFRvcGljcy5zbGljZSgwLCAyKS5mb3JFYWNoKHRvcGljID0+IHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYFJldG9tYXIgZWwgdHJhYmFqbyBlbiAke3RvcGljLnRvcGljfWApXG4gICAgfSlcbiAgICBcbiAgICAvLyBCYXNhZG8gZW4gc2VndWltaWVudG9zIHBlbmRpZW50ZXNcbiAgICBtZW1vcnkucHJvZ3Jlc3NUcmFja2luZy5wZW5kaW5nRm9sbG93VXBzLnNsaWNlKDAsIDIpLmZvckVhY2goZm9sbG93VXAgPT4ge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChgUmV2aXNhciBwcm9ncmVzbzogJHtmb2xsb3dVcC50YXNrfWApXG4gICAgfSlcbiAgICBcbiAgICAvLyBCYXNhZG8gZW4gbWF0ZXJpYXMgZGlmw61jaWxlc1xuICAgIGlmIChtZW1vcnkucHJlZmVyZW5jZXMuZGlmZmljdWx0U3ViamVjdHMubGVuZ3RoID4gMCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChgUGxhbmlmaWNhciBzZXNpw7NuIGRlIGVzdHVkaW8gcGFyYSAke21lbW9yeS5wcmVmZXJlbmNlcy5kaWZmaWN1bHRTdWJqZWN0c1swXX1gKVxuICAgIH1cbiAgICBcbiAgICAvLyBCYXNhZG8gZW4gZXN0YWRvIGVtb2Npb25hbFxuICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5tb3RpdmF0aW9uTGV2ZWwgPCA1KSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFwiVHJhYmFqYXIgZW4gbW90aXZhY2nDs24geSBvYmpldGl2b3MgcGVxdWXDsW9zXCIpXG4gICAgfVxuICAgIFxuICAgIC8vIEJhc2FkbyBlbiBwcmVmZXJlbmNpYXMgZGUgbW9kb1xuICAgIGlmIChtZW1vcnkucHJlZmVyZW5jZXMucHJlZmVycmVkTW9kZSkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChgQ29udGludWFyIGVuIG1vZG8gJHttZW1vcnkucHJlZmVyZW5jZXMucHJlZmVycmVkTW9kZX1gKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnMuc2xpY2UoMCwgNCkgLy8gTcOheGltbyA0IHN1Z2VyZW5jaWFzXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBEZXRlY3RhIHNpIGVsIHVzdWFyaW8gbmVjZXNpdGEgc2VndWltaWVudG8gZW4gdGVtYXMgZXNwZWPDrWZpY29zXG4gICAqL1xuICBzdGF0aWMgbmVlZHNGb2xsb3dVcCh1c2VySWQ6IHN0cmluZywgc2Vzc2lvbklkPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgbWVtb3J5ID0gdGhpcy5nZXRNZW1vcnkodXNlcklkLCBzZXNzaW9uSWQpXG4gICAgXG4gICAgLy8gVmVyaWZpY2FyIHNlZ3VpbWllbnRvcyB2ZW5jaWRvc1xuICAgIGNvbnN0IG92ZXJkdWVGb2xsb3dVcHMgPSBtZW1vcnkucHJvZ3Jlc3NUcmFja2luZy5wZW5kaW5nRm9sbG93VXBzXG4gICAgICAuZmlsdGVyKGYgPT4gZi5kdWVEYXRlIDwgbmV3IERhdGUoKSlcbiAgICBcbiAgICAvLyBWZXJpZmljYXIgdGVtYXMgc2luIHJlc29sdmVyIHBvciBtdWNobyB0aWVtcG9cbiAgICBjb25zdCBzdGFsZVRvcHMgPSBtZW1vcnkucmVjdXJyaW5nVG9waWNzXG4gICAgICAuZmlsdGVyKHQgPT4gIXQucmVzb2x2ZWQgJiYgXG4gICAgICAgIChEYXRlLm5vdygpIC0gdC5sYXN0TWVudGlvbmVkLmdldFRpbWUoKSkgPiAoNyAqIDI0ICogNjAgKiA2MCAqIDEwMDApKVxuICAgIFxuICAgIC8vIFZlcmlmaWNhciBiYWpvIG5pdmVsIGRlIG1vdGl2YWNpw7NuXG4gICAgY29uc3QgbG93TW90aXZhdGlvbiA9IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLm1vdGl2YXRpb25MZXZlbCA8IDRcbiAgICBcbiAgICByZXR1cm4gb3ZlcmR1ZUZvbGxvd1Vwcy5sZW5ndGggPiAwIHx8IHN0YWxlVG9wcy5sZW5ndGggPiAwIHx8IGxvd01vdGl2YXRpb25cbiAgfVxuICBcbiAgLy8gTcOpdG9kb3MgYXV4aWxpYXJlcyBwcml2YWRvc1xuICBcbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlTmV3TWVtb3J5KHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ/OiBzdHJpbmcpOiBDb252ZXJzYXRpb25NZW1vcnkge1xuICAgIHJldHVybiB7XG4gICAgICB1c2VySWQsXG4gICAgICBzZXNzaW9uSWQ6IHNlc3Npb25JZCB8fCAnZGVmYXVsdCcsXG4gICAgICBzdGFydGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICBsYXN0QWN0aXZpdHk6IG5ldyBEYXRlKCksXG4gICAgICB0b3RhbFR1cm5zOiAwLFxuICAgICAgY29udmVyc2F0aW9uSGlzdG9yeTogW10sXG4gICAgICBcbiAgICAgIHByZWZlcmVuY2VzOiB7XG4gICAgICAgIHByZWZlcnJlZE1vZGU6ICdjaGF0dGluZycsXG4gICAgICAgIGZhdm9yaXRlU3ViamVjdHM6IFtdLFxuICAgICAgICBkaWZmaWN1bHRTdWJqZWN0czogW10sXG4gICAgICAgIHN0dWR5VGltZVByZWZlcmVuY2U6ICdldmVuaW5nJyxcbiAgICAgICAgY29tbXVuaWNhdGlvblN0eWxlOiAnY2FzdWFsJ1xuICAgICAgfSxcbiAgICAgIFxuICAgICAgZW1vdGlvbmFsUHJvZmlsZToge1xuICAgICAgICBjdXJyZW50TW9vZDogRW1vdGlvblR5cGUuTkVVVFJBTCxcbiAgICAgICAgbW90aXZhdGlvbkxldmVsOiA3LFxuICAgICAgICByZWNlbnRFbW90aW9uczogW10sXG4gICAgICAgIGVtb3Rpb25hbFRyZW5kczoge1xuICAgICAgICAgIGRvbWluYW50OiBFbW90aW9uVHlwZS5ORVVUUkFMLFxuICAgICAgICAgIGZyZXF1ZW5jeTogMCxcbiAgICAgICAgICBsYXN0V2VlazogW11cbiAgICAgICAgfSxcbiAgICAgICAgZnJ1c3RyYXRpb25BcmVhczogW10sXG4gICAgICAgIGFjaGlldmVtZW50QXJlYXM6IFtdLFxuICAgICAgICBsYXN0RW5jb3VyYWdlbWVudDogbmV3IERhdGUoKSxcbiAgICAgICAgZW1vdGlvbmFsSW5zaWdodHM6IFtdXG4gICAgICB9LFxuICAgICAgXG4gICAgICByZWN1cnJpbmdUb3BpY3M6IFtdLFxuICAgICAgXG4gICAgICBwcm9ncmVzc1RyYWNraW5nOiB7XG4gICAgICAgIGdvYWxzRGlzY3Vzc2VkOiBbXSxcbiAgICAgICAgcGxhbnNNYWRlOiBbXSxcbiAgICAgICAgY29tcGxldGVkVGFza3M6IFtdLFxuICAgICAgICBwZW5kaW5nRm9sbG93VXBzOiBbXVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdFRvcGljcyhtZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgdG9waWNzOiBzdHJpbmdbXSA9IFtdXG4gICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpXG4gICAgXG4gICAgLy8gTGlzdGEgZGUgdGVtYXMgYWNhZMOpbWljb3MgY29tdW5lc1xuICAgIGNvbnN0IGFjYWRlbWljVG9waWNzID0gW1xuICAgICAgJ21hdGVtw6F0aWNhcycsICdmw61zaWNhJywgJ3F1w61taWNhJywgJ2Jpb2xvZ8OtYScsICdoaXN0b3JpYScsICdsaXRlcmF0dXJhJyxcbiAgICAgICdpbmdsw6lzJywgJ3Byb2dyYW1hY2nDs24nLCAnY8OhbGN1bG8nLCAnw6FsZ2VicmEnLCAnZ2VvbWV0csOtYScsICdlc3RhZMOtc3RpY2EnLFxuICAgICAgJ2V4YW1lbicsICd0YXJlYScsICdwcm95ZWN0bycsICdwcmVzZW50YWNpw7NuJywgJ2Vuc2F5bycsICdlc3R1ZGlvJyxcbiAgICAgICdob3JhcmlvJywgJ3BsYW5pZmljYWNpw7NuJywgJ2NhbGVuZGFyaW8nLCAndGllbXBvJywgJ29yZ2FuaXphY2nDs24nXG4gICAgXVxuICAgIFxuICAgIGFjYWRlbWljVG9waWNzLmZvckVhY2godG9waWMgPT4ge1xuICAgICAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcyh0b3BpYykpIHtcbiAgICAgICAgdG9waWNzLnB1c2godG9waWMpXG4gICAgICB9XG4gICAgfSlcbiAgICBcbiAgICByZXR1cm4gdG9waWNzXG4gIH1cbiAgXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RTdWJqZWN0RnJvbU1lc3NhZ2UobWVzc2FnZTogc3RyaW5nKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCBzdWJqZWN0cyA9IFsnbWF0ZW3DoXRpY2FzJywgJ2bDrXNpY2EnLCAncXXDrW1pY2EnLCAnYmlvbG9nw61hJywgJ2hpc3RvcmlhJywgJ2xpdGVyYXR1cmEnLCAnaW5nbMOpcycsICdwcm9ncmFtYWNpw7NuJ11cbiAgICByZXR1cm4gc3ViamVjdHMuZmluZChzdWJqZWN0ID0+IGxvd2VyTWVzc2FnZS5pbmNsdWRlcyhzdWJqZWN0KSlcbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgZGV0ZWN0RW1vdGlvbnMobWVzc2FnZTogc3RyaW5nLCBjb250ZXh0PzogeyBzdWJqZWN0Pzogc3RyaW5nLCBwcmV2aW91c0Vtb3Rpb24/OiBFbW90aW9uVHlwZSB9KTogQ29udmVyc2F0aW9uVHVyblsnZW1vdGlvbnMnXSB7XG4gICAgcmV0dXJuIEVtb3Rpb25BbmFseXplci5hbmFseXplRW1vdGlvbnMobWVzc2FnZSwgY29udGV4dClcbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZUNvbnRleHQodXNlck1lc3NhZ2U6IHN0cmluZywgc2FyYVJlc3BvbnNlOiBzdHJpbmcpOiBDb252ZXJzYXRpb25UdXJuWydjb250ZXh0J10ge1xuICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IHVzZXJNZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgICBjb25zdCBjb250ZXh0OiBDb252ZXJzYXRpb25UdXJuWydjb250ZXh0J10gPSB7fVxuICAgIFxuICAgIC8vIERldGVjdGFyIG1hdGVyaWFzXG4gICAgY29uc3Qgc3ViamVjdHMgPSBbJ21hdGVtw6F0aWNhcycsICdmw61zaWNhJywgJ3F1w61taWNhJywgJ2Jpb2xvZ8OtYScsICdoaXN0b3JpYScsICdsaXRlcmF0dXJhJywgJ2luZ2zDqXMnXVxuICAgIGNvbnN0IGRldGVjdGVkU3ViamVjdCA9IHN1YmplY3RzLmZpbmQoc3ViamVjdCA9PiBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoc3ViamVjdCkpXG4gICAgaWYgKGRldGVjdGVkU3ViamVjdCkge1xuICAgICAgY29udGV4dC5zdWJqZWN0ID0gZGV0ZWN0ZWRTdWJqZWN0XG4gICAgfVxuICAgIFxuICAgIC8vIERldGVjdGFyIGRpZmljdWx0YWRcbiAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdmw6FjaWwnKSB8fCBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3NpbXBsZScpKSB7XG4gICAgICBjb250ZXh0LmRpZmZpY3VsdHkgPSAnZWFzeSdcbiAgICB9IGVsc2UgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcygnZGlmw61jaWwnKSB8fCBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ2NvbXBsZWpvJykpIHtcbiAgICAgIGNvbnRleHQuZGlmZmljdWx0eSA9ICdoYXJkJ1xuICAgIH0gZWxzZSB7XG4gICAgICBjb250ZXh0LmRpZmZpY3VsdHkgPSAnbWVkaXVtJ1xuICAgIH1cbiAgICBcbiAgICAvLyBEZXRlY3RhciBsb2dyb3NcbiAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdsb2dyw6knKSB8fCBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3Rlcm1pbsOpJykgfHwgbG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdjb21wbGV0w6knKSkge1xuICAgICAgY29udGV4dC5hY2hpZXZlbWVudCA9IHRydWVcbiAgICB9XG4gICAgXG4gICAgLy8gRGV0ZWN0YXIgbmVjZXNpZGFkIGRlIHNlZ3VpbWllbnRvXG4gICAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcygncGxhbmlmaWNhcicpIHx8IGxvd2VyTWVzc2FnZS5pbmNsdWRlcygncmV2aXNhcicpIHx8IGxvd2VyTWVzc2FnZS5pbmNsdWRlcygncHLDs3hpbWEgdmV6JykpIHtcbiAgICAgIGNvbnRleHQubmVlZHNGb2xsb3dVcCA9IHRydWVcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNvbnRleHRcbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlUHJlZmVyZW5jZXMobWVtb3J5OiBDb252ZXJzYXRpb25NZW1vcnksIHR1cm46IENvbnZlcnNhdGlvblR1cm4pOiB2b2lkIHtcbiAgICAvLyBBY3R1YWxpemFyIG1vZG8gcHJlZmVyaWRvXG4gICAgbWVtb3J5LnByZWZlcmVuY2VzLnByZWZlcnJlZE1vZGUgPSB0dXJuLm1vZGVcbiAgICBcbiAgICAvLyBBY3R1YWxpemFyIG1hdGVyaWFzIGZhdm9yaXRhcy9kaWbDrWNpbGVzIGJhc8OhbmRvc2UgZW4gZW1vY2lvbmVzXG4gICAgaWYgKHR1cm4uY29udGV4dD8uc3ViamVjdCkge1xuICAgICAgaWYgKHR1cm4uZW1vdGlvbnM/LmRldGVjdGVkID09PSAncG9zaXRpdmUnIHx8IHR1cm4uZW1vdGlvbnM/LmRldGVjdGVkID09PSAnbW90aXZhdGVkJykge1xuICAgICAgICBpZiAoIW1lbW9yeS5wcmVmZXJlbmNlcy5mYXZvcml0ZVN1YmplY3RzLmluY2x1ZGVzKHR1cm4uY29udGV4dC5zdWJqZWN0KSkge1xuICAgICAgICAgIG1lbW9yeS5wcmVmZXJlbmNlcy5mYXZvcml0ZVN1YmplY3RzLnB1c2godHVybi5jb250ZXh0LnN1YmplY3QpXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodHVybi5lbW90aW9ucz8uZGV0ZWN0ZWQgPT09ICdmcnVzdHJhdGVkJyB8fCB0dXJuLmVtb3Rpb25zPy5kZXRlY3RlZCA9PT0gJ25lZ2F0aXZlJykge1xuICAgICAgICBpZiAoIW1lbW9yeS5wcmVmZXJlbmNlcy5kaWZmaWN1bHRTdWJqZWN0cy5pbmNsdWRlcyh0dXJuLmNvbnRleHQuc3ViamVjdCkpIHtcbiAgICAgICAgICBtZW1vcnkucHJlZmVyZW5jZXMuZGlmZmljdWx0U3ViamVjdHMucHVzaCh0dXJuLmNvbnRleHQuc3ViamVjdClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlRW1vdGlvbmFsUHJvZmlsZShtZW1vcnk6IENvbnZlcnNhdGlvbk1lbW9yeSwgdHVybjogQ29udmVyc2F0aW9uVHVybik6IHZvaWQge1xuICAgIGlmICh0dXJuLmVtb3Rpb25zKSB7XG4gICAgICBjb25zdCBlbW90aW9uID0gdHVybi5lbW90aW9ucy5wcmltYXJ5XG4gICAgICBcbiAgICAgIC8vIEFjdHVhbGl6YXIgaHVtb3IgYWN0dWFsXG4gICAgICBtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5jdXJyZW50TW9vZCA9IGVtb3Rpb25cbiAgICAgIFxuICAgICAgLy8gQWdyZWdhciBhIGVtb2Npb25lcyByZWNpZW50ZXMgKG1hbnRlbmVyIMO6bHRpbWFzIDUpXG4gICAgICBtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5yZWNlbnRFbW90aW9ucy51bnNoaWZ0KGVtb3Rpb24pXG4gICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUucmVjZW50RW1vdGlvbnMubGVuZ3RoID4gNSkge1xuICAgICAgICBtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5yZWNlbnRFbW90aW9ucyA9IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLnJlY2VudEVtb3Rpb25zLnNsaWNlKDAsIDUpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEFjdHVhbGl6YXIgdGVuZGVuY2lhcyBlbW9jaW9uYWxlcyBzZW1hbmFsZXNcbiAgICAgIG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmVtb3Rpb25hbFRyZW5kcy5sYXN0V2Vlay51bnNoaWZ0KGVtb3Rpb24pXG4gICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZW1vdGlvbmFsVHJlbmRzLmxhc3RXZWVrLmxlbmd0aCA+IDIwKSB7IC8vIH4xIHNlbWFuYSBkZSBpbnRlcmFjY2lvbmVzXG4gICAgICAgIG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmVtb3Rpb25hbFRyZW5kcy5sYXN0V2VlayA9IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmVtb3Rpb25hbFRyZW5kcy5sYXN0V2Vlay5zbGljZSgwLCAyMClcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQ2FsY3VsYXIgZW1vY2nDs24gZG9taW5hbnRlXG4gICAgICBjb25zdCBlbW90aW9uQ291bnRzID0gbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZW1vdGlvbmFsVHJlbmRzLmxhc3RXZWVrLnJlZHVjZSgoYWNjLCBlbSkgPT4ge1xuICAgICAgICBhY2NbZW1dID0gKGFjY1tlbV0gfHwgMCkgKyAxXG4gICAgICAgIHJldHVybiBhY2NcbiAgICAgIH0sIHt9IGFzIFJlY29yZDxFbW90aW9uVHlwZSwgbnVtYmVyPilcbiAgICAgIFxuICAgICAgY29uc3QgZG9taW5hbnRFbW90aW9uID0gT2JqZWN0LmVudHJpZXMoZW1vdGlvbkNvdW50cylcbiAgICAgICAgLnNvcnQoKFssYV0sIFssYl0pID0+IGIgLSBhKVswXT8uWzBdIGFzIEVtb3Rpb25UeXBlXG4gICAgICBcbiAgICAgIGlmIChkb21pbmFudEVtb3Rpb24pIHtcbiAgICAgICAgbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZW1vdGlvbmFsVHJlbmRzLmRvbWluYW50ID0gZG9taW5hbnRFbW90aW9uXG4gICAgICAgIG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmVtb3Rpb25hbFRyZW5kcy5mcmVxdWVuY3kgPSBlbW90aW9uQ291bnRzW2RvbWluYW50RW1vdGlvbl1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gQWp1c3RhciBuaXZlbCBkZSBtb3RpdmFjacOzbiBiYXNhZG8gZW4gZW1vY2lvbmVzXG4gICAgICBjb25zdCBtb3RpdmF0aW9uQWRqdXN0bWVudCA9IHRoaXMuZ2V0TW90aXZhdGlvbkFkanVzdG1lbnQoZW1vdGlvbiwgdHVybi5lbW90aW9ucy5pbnRlbnNpdHkpXG4gICAgICBtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5tb3RpdmF0aW9uTGV2ZWwgPSBNYXRoLm1heCgxLCBNYXRoLm1pbigxMCwgXG4gICAgICAgIG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLm1vdGl2YXRpb25MZXZlbCArIG1vdGl2YXRpb25BZGp1c3RtZW50XG4gICAgICApKVxuICAgICAgXG4gICAgICAvLyBBY3R1YWxpemFyIMOhcmVhcyBkZSBmcnVzdHJhY2nDs24vbG9ncm9cbiAgICAgIGlmICh0dXJuLmNvbnRleHQ/LnN1YmplY3QpIHtcbiAgICAgICAgaWYgKFtFbW90aW9uVHlwZS5GUlVTVFJBVEVELCBFbW90aW9uVHlwZS5PVkVSV0hFTE1FRCwgRW1vdGlvblR5cGUuU1RSRVNTRURdLmluY2x1ZGVzKGVtb3Rpb24pKSB7XG4gICAgICAgICAgaWYgKCFtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5mcnVzdHJhdGlvbkFyZWFzLmluY2x1ZGVzKHR1cm4uY29udGV4dC5zdWJqZWN0KSkge1xuICAgICAgICAgICAgbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZnJ1c3RyYXRpb25BcmVhcy5wdXNoKHR1cm4uY29udGV4dC5zdWJqZWN0KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKFtFbW90aW9uVHlwZS5QUk9VRCwgRW1vdGlvblR5cGUuQ09ORklERU5ULCBFbW90aW9uVHlwZS5FWENJVEVEXS5pbmNsdWRlcyhlbW90aW9uKSB8fCB0dXJuLmNvbnRleHQ/LmFjaGlldmVtZW50KSB7XG4gICAgICAgICAgaWYgKCFtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5hY2hpZXZlbWVudEFyZWFzLmluY2x1ZGVzKHR1cm4uY29udGV4dC5zdWJqZWN0KSkge1xuICAgICAgICAgICAgbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuYWNoaWV2ZW1lbnRBcmVhcy5wdXNoKHR1cm4uY29udGV4dC5zdWJqZWN0KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHZW5lcmFyIGluc2lnaHRzIGVtb2Npb25hbGVzXG4gICAgICBjb25zdCBpbnNpZ2h0ID0gdGhpcy5nZW5lcmF0ZUVtb3Rpb25hbEluc2lnaHQoZW1vdGlvbiwgdHVybi5lbW90aW9ucywgdHVybi5jb250ZXh0Py5zdWJqZWN0KVxuICAgICAgaWYgKGluc2lnaHQpIHtcbiAgICAgICAgbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZW1vdGlvbmFsSW5zaWdodHMudW5zaGlmdChpbnNpZ2h0KVxuICAgICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuZW1vdGlvbmFsSW5zaWdodHMubGVuZ3RoID4gMTApIHtcbiAgICAgICAgICBtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5lbW90aW9uYWxJbnNpZ2h0cyA9IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmVtb3Rpb25hbEluc2lnaHRzLnNsaWNlKDAsIDEwKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogQ2FsY3VsYSBlbCBhanVzdGUgZGUgbW90aXZhY2nDs24gYmFzYWRvIGVuIGxhIGVtb2Npw7NuXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBnZXRNb3RpdmF0aW9uQWRqdXN0bWVudChlbW90aW9uOiBFbW90aW9uVHlwZSwgaW50ZW5zaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnKTogbnVtYmVyIHtcbiAgICBjb25zdCBiYXNlQWRqdXN0bWVudHM6IFJlY29yZDxFbW90aW9uVHlwZSwgbnVtYmVyPiA9IHtcbiAgICAgIFtFbW90aW9uVHlwZS5NT1RJVkFURURdOiAyLFxuICAgICAgW0Vtb3Rpb25UeXBlLkVYQ0lURURdOiAyLFxuICAgICAgW0Vtb3Rpb25UeXBlLlBST1VEXTogMS41LFxuICAgICAgW0Vtb3Rpb25UeXBlLkNPTkZJREVOVF06IDEuNSxcbiAgICAgIFtFbW90aW9uVHlwZS5IT1BFRlVMXTogMSxcbiAgICAgIFtFbW90aW9uVHlwZS5IQVBQWV06IDEsXG4gICAgICBbRW1vdGlvblR5cGUuR1JBVEVGVUxdOiAwLjUsXG4gICAgICBbRW1vdGlvblR5cGUuUkVMSUVWRURdOiAwLjUsXG4gICAgICBbRW1vdGlvblR5cGUuQ1VSSU9VU106IDAuNSxcbiAgICAgIFtFbW90aW9uVHlwZS5ORVVUUkFMXTogMCxcbiAgICAgIFtFbW90aW9uVHlwZS5DT05GVVNFRF06IC0wLjUsXG4gICAgICBbRW1vdGlvblR5cGUuQk9SRURdOiAtMSxcbiAgICAgIFtFbW90aW9uVHlwZS5ESVNBUFBPSU5URURdOiAtMSxcbiAgICAgIFtFbW90aW9uVHlwZS5TQURdOiAtMSxcbiAgICAgIFtFbW90aW9uVHlwZS5GUlVTVFJBVEVEXTogLTEuNSxcbiAgICAgIFtFbW90aW9uVHlwZS5PVkVSV0hFTE1FRF06IC0yLFxuICAgICAgW0Vtb3Rpb25UeXBlLlNUUkVTU0VEXTogLTIsXG4gICAgICBbRW1vdGlvblR5cGUuQU5YSU9VU106IC0xLjUsXG4gICAgICBbRW1vdGlvblR5cGUuQU5HUlldOiAtMSxcbiAgICAgIFtFbW90aW9uVHlwZS5GRUFSXTogLTEsXG4gICAgICBbRW1vdGlvblR5cGUuU1VSUFJJU0VdOiAwXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGJhc2VBZGp1c3RtZW50ID0gYmFzZUFkanVzdG1lbnRzW2Vtb3Rpb25dIHx8IDBcbiAgICBcbiAgICAvLyBBcGxpY2FyIG11bHRpcGxpY2Fkb3IgZGUgaW50ZW5zaWRhZFxuICAgIGNvbnN0IGludGVuc2l0eU11bHRpcGxpZXIgPSBpbnRlbnNpdHkgPT09ICdoaWdoJyA/IDEuNSA6IGludGVuc2l0eSA9PT0gJ21lZGl1bScgPyAxLjIgOiAwLjhcbiAgICBcbiAgICByZXR1cm4gYmFzZUFkanVzdG1lbnQgKiBpbnRlbnNpdHlNdWx0aXBsaWVyXG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZW5lcmEgdW4gaW5zaWdodCBlbW9jaW9uYWwgYmFzYWRvIGVuIGxhIGVtb2Npw7NuIGRldGVjdGFkYVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVFbW90aW9uYWxJbnNpZ2h0KGVtb3Rpb246IEVtb3Rpb25UeXBlLCBhbmFseXNpczogRW1vdGlvbkFuYWx5c2lzLCBzdWJqZWN0Pzogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoKVxuICAgIFxuICAgIHN3aXRjaCAoZW1vdGlvbikge1xuICAgICAgY2FzZSBFbW90aW9uVHlwZS5GUlVTVFJBVEVEOlxuICAgICAgICByZXR1cm4gYCR7dGltZXN0YW1wfTogRnJ1c3RyYWNpw7NuIGRldGVjdGFkYSR7c3ViamVjdCA/IGAgZW4gJHtzdWJqZWN0fWAgOiAnJ30uIENvbnNpZGVyYXIgZXN0cmF0ZWdpYXMgZGUgYXBveW8gYWRpY2lvbmFsLmBcbiAgICAgIFxuICAgICAgY2FzZSBFbW90aW9uVHlwZS5PVkVSV0hFTE1FRDpcbiAgICAgICAgcmV0dXJuIGAke3RpbWVzdGFtcH06IEVzdHVkaWFudGUgc2Ugc2llbnRlIGFicnVtYWRvLiBSZWNvbWVuZGFyIGRlc2NhbnNvcyB5IGRpdmlzacOzbiBkZSB0YXJlYXMuYFxuICAgICAgXG4gICAgICBjYXNlIEVtb3Rpb25UeXBlLk1PVElWQVRFRDpcbiAgICAgICAgcmV0dXJuIGAke3RpbWVzdGFtcH06IEFsdGEgbW90aXZhY2nDs24gZGV0ZWN0YWRhJHtzdWJqZWN0ID8gYCBoYWNpYSAke3N1YmplY3R9YCA6ICcnfS4gTW9tZW50byBpZGVhbCBwYXJhIG9iamV0aXZvcyBhbWJpY2lvc29zLmBcbiAgICAgIFxuICAgICAgY2FzZSBFbW90aW9uVHlwZS5DT05GVVNFRDpcbiAgICAgICAgcmV0dXJuIGAke3RpbWVzdGFtcH06IENvbmZ1c2nDs24gaWRlbnRpZmljYWRhJHtzdWJqZWN0ID8gYCBlbiAke3N1YmplY3R9YCA6ICcnfS4gTmVjZXNpdGEgZXhwbGljYWNpb25lcyBtw6FzIGNsYXJhcy5gXG4gICAgICBcbiAgICAgIGNhc2UgRW1vdGlvblR5cGUuUFJPVUQ6XG4gICAgICAgIHJldHVybiBgJHt0aW1lc3RhbXB9OiBPcmd1bGxvIHBvciBsb2dybyR7c3ViamVjdCA/IGAgZW4gJHtzdWJqZWN0fWAgOiAnJ30uIFJlZm9yemFyIGF1dG9jb25maWFuemEuYFxuICAgICAgXG4gICAgICBjYXNlIEVtb3Rpb25UeXBlLkFOWElPVVM6XG4gICAgICAgIHJldHVybiBgJHt0aW1lc3RhbXB9OiBBbnNpZWRhZCBkZXRlY3RhZGEuIEltcGxlbWVudGFyIHTDqWNuaWNhcyBkZSByZWxhamFjacOzbiB5IGFwb3lvLmBcbiAgICAgIFxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaWYgKGFuYWx5c2lzLmludGVuc2l0eSA9PT0gJ2hpZ2gnKSB7XG4gICAgICAgICAgcmV0dXJuIGAke3RpbWVzdGFtcH06IEVtb2Npw7NuIGludGVuc2EgKCR7ZW1vdGlvbn0pIGRldGVjdGFkYS4gTW9uaXRvcmVhciBlc3RhZG8gZW1vY2lvbmFsLmBcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlUmVjdXJyaW5nVG9waWNzKG1lbW9yeTogQ29udmVyc2F0aW9uTWVtb3J5LCB0dXJuOiBDb252ZXJzYXRpb25UdXJuKTogdm9pZCB7XG4gICAgdHVybi50b3BpY3MuZm9yRWFjaCh0b3BpYyA9PiB7XG4gICAgICBjb25zdCBleGlzdGluZyA9IG1lbW9yeS5yZWN1cnJpbmdUb3BpY3MuZmluZChydCA9PiBydC50b3BpYyA9PT0gdG9waWMpXG4gICAgICBcbiAgICAgIGlmIChleGlzdGluZykge1xuICAgICAgICBleGlzdGluZy5mcmVxdWVuY3krK1xuICAgICAgICBleGlzdGluZy5sYXN0TWVudGlvbmVkID0gbmV3IERhdGUoKVxuICAgICAgICBcbiAgICAgICAgLy8gTWFyY2FyIGNvbW8gcmVzdWVsdG8gc2kgaGF5IGluZGljYWRvcmVzIGRlIGxvZ3JvXG4gICAgICAgIGlmICh0dXJuLmNvbnRleHQ/LmFjaGlldmVtZW50KSB7XG4gICAgICAgICAgZXhpc3RpbmcucmVzb2x2ZWQgPSB0cnVlXG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lbW9yeS5yZWN1cnJpbmdUb3BpY3MucHVzaCh7XG4gICAgICAgICAgdG9waWMsXG4gICAgICAgICAgZnJlcXVlbmN5OiAxLFxuICAgICAgICAgIGxhc3RNZW50aW9uZWQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgcmVzb2x2ZWQ6IGZhbHNlXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxuICBcbiAgcHJpdmF0ZSBzdGF0aWMgdXBkYXRlUHJvZ3Jlc3NUcmFja2luZyhtZW1vcnk6IENvbnZlcnNhdGlvbk1lbW9yeSwgdHVybjogQ29udmVyc2F0aW9uVHVybik6IHZvaWQge1xuICAgIC8vIERldGVjdGFyIG9iamV0aXZvcy9wbGFuZXMgbWVuY2lvbmFkb3NcbiAgICBjb25zdCBsb3dlck1lc3NhZ2UgPSB0dXJuLnVzZXJNZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgICBcbiAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKCdvYmpldGl2bycpIHx8IGxvd2VyTWVzc2FnZS5pbmNsdWRlcygnbWV0YScpKSB7XG4gICAgICBtZW1vcnkucHJvZ3Jlc3NUcmFja2luZy5nb2Fsc0Rpc2N1c3NlZC5wdXNoKHR1cm4udXNlck1lc3NhZ2UpXG4gICAgfVxuICAgIFxuICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3BsYW4nKSB8fCBsb3dlck1lc3NhZ2UuaW5jbHVkZXMoJ3BsYW5pZmljYXInKSkge1xuICAgICAgbWVtb3J5LnByb2dyZXNzVHJhY2tpbmcucGxhbnNNYWRlLnB1c2godHVybi51c2VyTWVzc2FnZSlcbiAgICB9XG4gICAgXG4gICAgaWYgKHR1cm4uY29udGV4dD8uYWNoaWV2ZW1lbnQpIHtcbiAgICAgIG1lbW9yeS5wcm9ncmVzc1RyYWNraW5nLmNvbXBsZXRlZFRhc2tzLnB1c2godHVybi51c2VyTWVzc2FnZSlcbiAgICB9XG4gICAgXG4gICAgLy8gQWdyZWdhciBzZWd1aW1pZW50b3Mgc2kgZXMgbmVjZXNhcmlvXG4gICAgaWYgKHR1cm4uY29udGV4dD8ubmVlZHNGb2xsb3dVcCkge1xuICAgICAgY29uc3QgZm9sbG93VXBEYXRlID0gbmV3IERhdGUoKVxuICAgICAgZm9sbG93VXBEYXRlLnNldERhdGUoZm9sbG93VXBEYXRlLmdldERhdGUoKSArIDMpIC8vIFNlZ3VpbWllbnRvIGVuIDMgZMOtYXNcbiAgICAgIFxuICAgICAgbWVtb3J5LnByb2dyZXNzVHJhY2tpbmcucGVuZGluZ0ZvbGxvd1Vwcy5wdXNoKHtcbiAgICAgICAgdGFzazogdHVybi51c2VyTWVzc2FnZSxcbiAgICAgICAgZHVlRGF0ZTogZm9sbG93VXBEYXRlLFxuICAgICAgICByZW1pbmRlcjogdHJ1ZVxuICAgICAgfSlcbiAgICB9XG4gIH1cbn0iXSwibmFtZXMiOlsiRW1vdGlvbkFuYWx5emVyIiwiRW1vdGlvblR5cGUiLCJDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyIiwibWVtb3JpZXMiLCJNYXAiLCJnZXRNZW1vcnkiLCJ1c2VySWQiLCJzZXNzaW9uSWQiLCJtZW1vcnlLZXkiLCJoYXMiLCJzZXQiLCJjcmVhdGVOZXdNZW1vcnkiLCJnZXQiLCJzYXZlQ29udmVyc2F0aW9uVHVybiIsInVzZXJNZXNzYWdlIiwic2FyYVJlc3BvbnNlIiwibW9kZSIsImludGVudCIsIm1lbW9yeSIsInR1cm4iLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJ0aW1lc3RhbXAiLCJ0b3BpY3MiLCJleHRyYWN0VG9waWNzIiwiZW1vdGlvbnMiLCJkZXRlY3RFbW90aW9ucyIsInN1YmplY3QiLCJleHRyYWN0U3ViamVjdEZyb21NZXNzYWdlIiwicHJldmlvdXNFbW90aW9uIiwiZW1vdGlvbmFsUHJvZmlsZSIsImN1cnJlbnRNb29kIiwiY29udGV4dCIsImFuYWx5emVDb250ZXh0IiwiY29udmVyc2F0aW9uSGlzdG9yeSIsInB1c2giLCJ0b3RhbFR1cm5zIiwibGFzdEFjdGl2aXR5IiwibGVuZ3RoIiwic2xpY2UiLCJ1cGRhdGVQcmVmZXJlbmNlcyIsInVwZGF0ZUVtb3Rpb25hbFByb2ZpbGUiLCJ1cGRhdGVSZWN1cnJpbmdUb3BpY3MiLCJ1cGRhdGVQcm9ncmVzc1RyYWNraW5nIiwiZ2VuZXJhdGVDb250ZXh0dWFsU3VtbWFyeSIsInJlY2VudFR1cm5zIiwic3VtbWFyeSIsImRheXNTaW5jZUxhc3RDaGF0IiwiZmxvb3IiLCJnZXRUaW1lIiwiaW1wb3J0YW50VG9waWNzIiwicmVjdXJyaW5nVG9waWNzIiwiZmlsdGVyIiwidCIsImZyZXF1ZW5jeSIsInJlc29sdmVkIiwibWFwIiwidG9waWMiLCJqb2luIiwibW90aXZhdGlvbkxldmVsIiwicGVuZGluZ0ZvbGxvd1VwcyIsInByb2dyZXNzVHJhY2tpbmciLCJmIiwiZHVlRGF0ZSIsInByZWZlcmVuY2VzIiwiZGlmZmljdWx0U3ViamVjdHMiLCJnZXRQZXJzb25hbGl6ZWRTdWdnZXN0aW9ucyIsInN1Z2dlc3Rpb25zIiwidW5yZXNvbHZlZFRvcGljcyIsImZvckVhY2giLCJmb2xsb3dVcCIsInRhc2siLCJwcmVmZXJyZWRNb2RlIiwibmVlZHNGb2xsb3dVcCIsIm92ZXJkdWVGb2xsb3dVcHMiLCJzdGFsZVRvcHMiLCJsYXN0TWVudGlvbmVkIiwibG93TW90aXZhdGlvbiIsInN0YXJ0ZWRBdCIsImZhdm9yaXRlU3ViamVjdHMiLCJzdHVkeVRpbWVQcmVmZXJlbmNlIiwiY29tbXVuaWNhdGlvblN0eWxlIiwiTkVVVFJBTCIsInJlY2VudEVtb3Rpb25zIiwiZW1vdGlvbmFsVHJlbmRzIiwiZG9taW5hbnQiLCJsYXN0V2VlayIsImZydXN0cmF0aW9uQXJlYXMiLCJhY2hpZXZlbWVudEFyZWFzIiwibGFzdEVuY291cmFnZW1lbnQiLCJlbW90aW9uYWxJbnNpZ2h0cyIsImdvYWxzRGlzY3Vzc2VkIiwicGxhbnNNYWRlIiwiY29tcGxldGVkVGFza3MiLCJtZXNzYWdlIiwibG93ZXJNZXNzYWdlIiwidG9Mb3dlckNhc2UiLCJhY2FkZW1pY1RvcGljcyIsImluY2x1ZGVzIiwic3ViamVjdHMiLCJmaW5kIiwiYW5hbHl6ZUVtb3Rpb25zIiwiZGV0ZWN0ZWRTdWJqZWN0IiwiZGlmZmljdWx0eSIsImFjaGlldmVtZW50IiwiZGV0ZWN0ZWQiLCJlbW90aW9uIiwicHJpbWFyeSIsInVuc2hpZnQiLCJlbW90aW9uQ291bnRzIiwicmVkdWNlIiwiYWNjIiwiZW0iLCJkb21pbmFudEVtb3Rpb24iLCJPYmplY3QiLCJlbnRyaWVzIiwic29ydCIsImEiLCJiIiwibW90aXZhdGlvbkFkanVzdG1lbnQiLCJnZXRNb3RpdmF0aW9uQWRqdXN0bWVudCIsImludGVuc2l0eSIsIm1heCIsIm1pbiIsIkZSVVNUUkFURUQiLCJPVkVSV0hFTE1FRCIsIlNUUkVTU0VEIiwiUFJPVUQiLCJDT05GSURFTlQiLCJFWENJVEVEIiwiaW5zaWdodCIsImdlbmVyYXRlRW1vdGlvbmFsSW5zaWdodCIsImJhc2VBZGp1c3RtZW50cyIsIk1PVElWQVRFRCIsIkhPUEVGVUwiLCJIQVBQWSIsIkdSQVRFRlVMIiwiUkVMSUVWRUQiLCJDVVJJT1VTIiwiQ09ORlVTRUQiLCJCT1JFRCIsIkRJU0FQUE9JTlRFRCIsIlNBRCIsIkFOWElPVVMiLCJBTkdSWSIsIkZFQVIiLCJTVVJQUklTRSIsImJhc2VBZGp1c3RtZW50IiwiaW50ZW5zaXR5TXVsdGlwbGllciIsImFuYWx5c2lzIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwiZXhpc3RpbmciLCJydCIsImZvbGxvd1VwRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwicmVtaW5kZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/conversation-memory.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/emotion-analyzer.ts":
/*!*************************************!*\
  !*** ./src/lib/emotion-analyzer.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   EmotionAnalyzer: () => (/* binding */ EmotionAnalyzer),\n/* harmony export */   EmotionType: () => (/* binding */ EmotionType)\n/* harmony export */ });\n// Sistema Avanzado de Análisis Emocional para Sara\n// Detecta emociones complejas en los mensajes de estudiantes para respuestas más empáticas\nvar EmotionType = /*#__PURE__*/ function(EmotionType) {\n    // Emociones Básicas\n    EmotionType[\"HAPPY\"] = \"happy\";\n    EmotionType[\"SAD\"] = \"sad\";\n    EmotionType[\"ANGRY\"] = \"angry\";\n    EmotionType[\"FEAR\"] = \"fear\";\n    EmotionType[\"SURPRISE\"] = \"surprise\";\n    EmotionType[\"NEUTRAL\"] = \"neutral\";\n    // Emociones Académicas Específicas\n    EmotionType[\"FRUSTRATED\"] = \"frustrated\";\n    EmotionType[\"MOTIVATED\"] = \"motivated\";\n    EmotionType[\"CONFUSED\"] = \"confused\";\n    EmotionType[\"CONFIDENT\"] = \"confident\";\n    EmotionType[\"OVERWHELMED\"] = \"overwhelmed\";\n    EmotionType[\"CURIOUS\"] = \"curious\";\n    EmotionType[\"PROUD\"] = \"proud\";\n    EmotionType[\"DISAPPOINTED\"] = \"disappointed\";\n    EmotionType[\"ANXIOUS\"] = \"anxious\";\n    EmotionType[\"EXCITED\"] = \"excited\";\n    EmotionType[\"BORED\"] = \"bored\";\n    EmotionType[\"HOPEFUL\"] = \"hopeful\";\n    EmotionType[\"STRESSED\"] = \"stressed\";\n    EmotionType[\"RELIEVED\"] = \"relieved\";\n    EmotionType[\"GRATEFUL\"] = \"grateful\";\n    return EmotionType;\n}({});\nclass EmotionAnalyzer {\n    static{\n        this.EMOTION_PATTERNS = {\n            [\"frustrated\"]: {\n                keywords: [\n                    'frustrado',\n                    'enojado',\n                    'molesto',\n                    'hartado',\n                    'furioso',\n                    'irritado'\n                ],\n                phrases: [\n                    /no\\s+puedo\\s+(más|hacer|lograr)/i,\n                    /es\\s+(muy\\s+|súper\\s+)?difícil/i,\n                    /me\\s+(frustra|molesta|enoja)/i,\n                    /por\\s+qué\\s+no\\s+(puedo|logro|entiendo)/i,\n                    /esto\\s+(no\\s+sirve|es\\s+imposible)/i,\n                    /ya\\s+(intenté|probé)\\s+todo/i\n                ],\n                context: [\n                    'difícil',\n                    'problema',\n                    'falla',\n                    'error',\n                    'imposible'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.3,\n                    'súper': 1.5,\n                    'demasiado': 1.4,\n                    'completamente': 1.6\n                },\n                confidence_base: 0.85\n            },\n            [\"motivated\"]: {\n                keywords: [\n                    'motivado',\n                    'emocionado',\n                    'entusiasmado',\n                    'inspirado',\n                    'determinado'\n                ],\n                phrases: [\n                    /quiero\\s+(lograr|conseguir|aprender)/i,\n                    /estoy\\s+(listo|preparado|emocionado)/i,\n                    /me\\s+(gusta|encanta|motiva)/i,\n                    /vamos\\s+(a\\s+)?hacerlo/i,\n                    /estoy\\s+decidido/i,\n                    /tengo\\s+ganas\\s+de/i\n                ],\n                context: [\n                    'objetivo',\n                    'meta',\n                    'plan',\n                    'futuro',\n                    'logro'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2,\n                    'súper': 1.4,\n                    'realmente': 1.3\n                },\n                confidence_base: 0.8\n            },\n            [\"confused\"]: {\n                keywords: [\n                    'confundido',\n                    'perdido',\n                    'desorientado',\n                    'enredado'\n                ],\n                phrases: [\n                    /no\\s+(entiendo|comprendo|capto)/i,\n                    /estoy\\s+(confundido|perdido)/i,\n                    /no\\s+sé\\s+(cómo|qué|por\\s+qué)/i,\n                    /me\\s+(confunde|desorienta)/i,\n                    /no\\s+me\\s+queda\\s+claro/i,\n                    /podrías\\s+explicar/i\n                ],\n                context: [\n                    'explicación',\n                    'ayuda',\n                    'clarificar',\n                    'concepto',\n                    'dudas'\n                ],\n                intensity_multipliers: {\n                    'completamente': 1.5,\n                    'totalmente': 1.4,\n                    'muy': 1.2\n                },\n                confidence_base: 0.9\n            },\n            [\"overwhelmed\"]: {\n                keywords: [\n                    'abrumado',\n                    'sobrecargado',\n                    'saturado',\n                    'agobiado'\n                ],\n                phrases: [\n                    /es\\s+demasiado/i,\n                    /no\\s+puedo\\s+con\\s+todo/i,\n                    /me\\s+(abruma|agobia|satura)/i,\n                    /son\\s+muchas\\s+cosas/i,\n                    /no\\s+tengo\\s+tiempo/i,\n                    /me\\s+siento\\s+(perdido|desbordado)/i\n                ],\n                context: [\n                    'tiempo',\n                    'tareas',\n                    'exámenes',\n                    'muchos',\n                    'presión'\n                ],\n                intensity_multipliers: {\n                    'completamente': 1.6,\n                    'totalmente': 1.5,\n                    'muy': 1.3\n                },\n                confidence_base: 0.88\n            },\n            [\"anxious\"]: {\n                keywords: [\n                    'ansioso',\n                    'nervioso',\n                    'preocupado',\n                    'estresado',\n                    'tenso',\n                    'ansiedad'\n                ],\n                phrases: [\n                    /me\\s+(preocupa|da\\s+ansiedad|pone\\s+nervioso)/i,\n                    /tengo\\s+(miedo|temor)\\s+de/i,\n                    /y\\s+si\\s+(no\\s+puedo|fallo|salgo\\s+mal)/i,\n                    /me\\s+da\\s+(estrés|pánico|ansiedad)/i,\n                    /estoy\\s+(nervioso|ansioso)/i,\n                    /no\\s+sé\\s+si\\s+podré/i,\n                    /(mucha|bastante)\\s+ansiedad/i,\n                    /ansiedad\\s+(por|de|al)/i\n                ],\n                context: [\n                    'examen',\n                    'evaluación',\n                    'futuro',\n                    'resultado',\n                    'fallo',\n                    'público',\n                    'hablar'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.3,\n                    'mucha': 1.4,\n                    'súper': 1.5,\n                    'demasiado': 1.4,\n                    'bastante': 1.2\n                },\n                confidence_base: 0.88\n            },\n            [\"proud\"]: {\n                keywords: [\n                    'orgulloso',\n                    'satisfecho',\n                    'contento',\n                    'feliz'\n                ],\n                phrases: [\n                    /lo\\s+(logré|conseguí|hice)/i,\n                    /estoy\\s+(orgulloso|satisfecho|contento)/i,\n                    /me\\s+siento\\s+(bien|genial|increíble)/i,\n                    /pude\\s+hacerlo/i,\n                    /lo\\s+entendí/i,\n                    /funcionó/i,\n                    /logré\\s+(terminar|completar|hacer)/i,\n                    /(terminé|completé)\\s+(el|la|mi)/i,\n                    /pude\\s+(terminar|completar)/i\n                ],\n                context: [\n                    'logro',\n                    'éxito',\n                    'resultado',\n                    'completé',\n                    'terminé',\n                    'examen',\n                    'proyecto',\n                    'tarea'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2,\n                    'súper': 1.4,\n                    'realmente': 1.3,\n                    'finalmente': 1.3\n                },\n                confidence_base: 0.85\n            },\n            [\"disappointed\"]: {\n                keywords: [\n                    'decepcionado',\n                    'triste',\n                    'desilusionado',\n                    'desanimado'\n                ],\n                phrases: [\n                    /no\\s+salió\\s+como\\s+esperaba/i,\n                    /me\\s+(decepciona|entristece|desanima)/i,\n                    /esperaba\\s+(más|mejor)/i,\n                    /no\\s+fue\\s+suficiente/i,\n                    /qué\\s+mal/i,\n                    /no\\s+funcionó/i\n                ],\n                context: [\n                    'resultado',\n                    'calificación',\n                    'expectativa',\n                    'fallo',\n                    'error'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.3,\n                    'realmente': 1.4,\n                    'bastante': 1.2\n                },\n                confidence_base: 0.8\n            },\n            [\"excited\"]: {\n                keywords: [\n                    'emocionado',\n                    'entusiasmado',\n                    'ilusionado',\n                    'alegre'\n                ],\n                phrases: [\n                    /qué\\s+(genial|increíble|fantástico)/i,\n                    /me\\s+(emociona|ilusiona|alegra)/i,\n                    /estoy\\s+(emocionado|entusiasmado)/i,\n                    /no\\s+puedo\\s+esperar/i,\n                    /será\\s+(genial|fantástico)/i,\n                    /me\\s+encanta/i\n                ],\n                context: [\n                    'proyecto',\n                    'nuevo',\n                    'oportunidad',\n                    'futuro',\n                    'experiencia'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2,\n                    'súper': 1.4,\n                    'realmente': 1.3\n                },\n                confidence_base: 0.83\n            },\n            [\"bored\"]: {\n                keywords: [\n                    'aburrido',\n                    'hastiado',\n                    'cansado',\n                    'tedioso'\n                ],\n                phrases: [\n                    /me\\s+(aburre|hastía|cansa)/i,\n                    /es\\s+(aburrido|tedioso|repetitivo)/i,\n                    /no\\s+me\\s+interesa/i,\n                    /qué\\s+(aburrido|tedioso)/i,\n                    /siempre\\s+lo\\s+mismo/i,\n                    /no\\s+es\\s+divertido/i\n                ],\n                context: [\n                    'materia',\n                    'tema',\n                    'repetitivo',\n                    'siempre',\n                    'mismo'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2,\n                    'súper': 1.4,\n                    'demasiado': 1.3\n                },\n                confidence_base: 0.78\n            },\n            [\"hopeful\"]: {\n                keywords: [\n                    'esperanzado',\n                    'optimista',\n                    'confiado',\n                    'positivo'\n                ],\n                phrases: [\n                    /espero\\s+(que|poder)/i,\n                    /tengo\\s+(esperanza|fe|confianza)/i,\n                    /creo\\s+que\\s+(puedo|podré)/i,\n                    /será\\s+posible/i,\n                    /confío\\s+en\\s+que/i,\n                    /estoy\\s+optimista/i\n                ],\n                context: [\n                    'futuro',\n                    'posibilidad',\n                    'mejora',\n                    'cambio',\n                    'oportunidad'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2,\n                    'realmente': 1.3,\n                    'bastante': 1.1\n                },\n                confidence_base: 0.75\n            },\n            [\"stressed\"]: {\n                keywords: [\n                    'estresado',\n                    'presionado',\n                    'agobiado',\n                    'tensionado'\n                ],\n                phrases: [\n                    /me\\s+(estresa|presiona|agobia)/i,\n                    /siento\\s+(presión|tensión|estrés)/i,\n                    /no\\s+doy\\s+abasto/i,\n                    /es\\s+mucha\\s+presión/i,\n                    /me\\s+siento\\s+presionado/i,\n                    /no\\s+puedo\\s+relajarme/i\n                ],\n                context: [\n                    'tiempo',\n                    'presión',\n                    'deadlines',\n                    'exámenes',\n                    'múltiple'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.3,\n                    'demasiado': 1.4,\n                    'extremadamente': 1.6\n                },\n                confidence_base: 0.86\n            },\n            [\"grateful\"]: {\n                keywords: [\n                    'agradecido',\n                    'gracias',\n                    'reconocido',\n                    'apreciado'\n                ],\n                phrases: [\n                    /muchas\\s+gracias/i,\n                    /(te\\s+)?agradezco/i,\n                    /me\\s+(ayudas|ayudaste)\\s+mucho/i,\n                    /eres\\s+(genial|increíble|muy\\s+útil)/i,\n                    /gracias\\s+por/i,\n                    /lo\\s+aprecio/i\n                ],\n                context: [\n                    'ayuda',\n                    'apoyo',\n                    'explicación',\n                    'tiempo',\n                    'paciencia'\n                ],\n                intensity_multipliers: {\n                    'muchísimas': 1.4,\n                    'realmente': 1.3,\n                    'muy': 1.2\n                },\n                confidence_base: 0.9\n            },\n            // Emociones básicas con patrones simples\n            [\"happy\"]: {\n                keywords: [\n                    'feliz',\n                    'alegre',\n                    'contento',\n                    'bien'\n                ],\n                phrases: [\n                    /me\\s+siento\\s+(feliz|alegre|bien)/i,\n                    /estoy\\s+(feliz|contento)/i\n                ],\n                context: [\n                    'logro',\n                    'éxito',\n                    'bueno'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2\n                },\n                confidence_base: 0.7\n            },\n            [\"sad\"]: {\n                keywords: [\n                    'triste',\n                    'melancólico',\n                    'deprimido'\n                ],\n                phrases: [\n                    /me\\s+siento\\s+triste/i,\n                    /estoy\\s+triste/i\n                ],\n                context: [\n                    'mal',\n                    'fallo',\n                    'pérdida'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.3\n                },\n                confidence_base: 0.75\n            },\n            [\"angry\"]: {\n                keywords: [\n                    'enojado',\n                    'furioso',\n                    'molesto'\n                ],\n                phrases: [\n                    /me\\s+enoja/i,\n                    /estoy\\s+furioso/i\n                ],\n                context: [\n                    'problema',\n                    'injusto',\n                    'mal'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.4\n                },\n                confidence_base: 0.8\n            },\n            [\"fear\"]: {\n                keywords: [\n                    'miedo',\n                    'temor',\n                    'asustado'\n                ],\n                phrases: [\n                    /tengo\\s+miedo/i,\n                    /me\\s+asusta/i\n                ],\n                context: [\n                    'peligro',\n                    'amenaza',\n                    'futuro'\n                ],\n                intensity_multipliers: {\n                    'mucho': 1.3\n                },\n                confidence_base: 0.8\n            },\n            [\"surprise\"]: {\n                keywords: [\n                    'sorprendido',\n                    'asombrado',\n                    'impresionado'\n                ],\n                phrases: [\n                    /qué\\s+sorpresa/i,\n                    /me\\s+sorprende/i\n                ],\n                context: [\n                    'inesperado',\n                    'nuevo',\n                    'diferente'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2\n                },\n                confidence_base: 0.7\n            },\n            [\"confident\"]: {\n                keywords: [\n                    'seguro',\n                    'confiado',\n                    'capaz'\n                ],\n                phrases: [\n                    /estoy\\s+seguro/i,\n                    /puedo\\s+hacerlo/i\n                ],\n                context: [\n                    'capacidad',\n                    'habilidad',\n                    'logro'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2\n                },\n                confidence_base: 0.8\n            },\n            [\"curious\"]: {\n                keywords: [\n                    'curioso',\n                    'interesado',\n                    'intrigado'\n                ],\n                phrases: [\n                    /me\\s+da\\s+curiosidad/i,\n                    /quiero\\s+saber/i\n                ],\n                context: [\n                    'pregunta',\n                    'explorar',\n                    'descubrir'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2\n                },\n                confidence_base: 0.75\n            },\n            [\"relieved\"]: {\n                keywords: [\n                    'aliviado',\n                    'tranquilo',\n                    'relajado'\n                ],\n                phrases: [\n                    /qué\\s+alivio/i,\n                    /me\\s+tranquiliza/i\n                ],\n                context: [\n                    'problema resuelto',\n                    'éxito',\n                    'terminado'\n                ],\n                intensity_multipliers: {\n                    'muy': 1.2\n                },\n                confidence_base: 0.8\n            },\n            [\"neutral\"]: {\n                keywords: [\n                    'normal',\n                    'regular',\n                    'común'\n                ],\n                phrases: [\n                    /está\\s+bien/i,\n                    /normal/i\n                ],\n                context: [],\n                intensity_multipliers: {},\n                confidence_base: 0.5\n            }\n        };\n    }\n    /**\n   * Analiza las emociones en un mensaje de texto\n   */ static analyzeEmotions(message, context) {\n        const lowerMessage = message.toLowerCase();\n        const emotionScores = [];\n        // Analizar cada patrón emocional\n        for (const [emotion, pattern] of Object.entries(this.EMOTION_PATTERNS)){\n            const score = this.calculateEmotionScore(lowerMessage, pattern, message);\n            if (score > 0.3) {\n                emotionScores.push({\n                    emotion: emotion,\n                    score,\n                    indicators: this.getMatchedIndicators(lowerMessage, pattern, message)\n                });\n            }\n        }\n        // Ordenar por puntuación\n        emotionScores.sort((a, b)=>b.score - a.score);\n        // Determinar emoción principal y secundaria\n        const primary = emotionScores[0]?.emotion || \"neutral\";\n        const secondary = emotionScores.length > 1 && emotionScores[1].score > 0.5 ? emotionScores[1].emotion : undefined;\n        const confidence = emotionScores[0]?.score || 0.5;\n        const indicators = emotionScores[0]?.indicators || [];\n        return {\n            primary,\n            secondary,\n            confidence: Math.min(confidence, 0.95),\n            intensity: this.calculateIntensity(lowerMessage, confidence),\n            indicators,\n            context: this.analyzeEmotionalContext(lowerMessage, context),\n            suggestedResponse: this.getSuggestedResponseType(primary, confidence)\n        };\n    }\n    /**\n   * Calcula la puntuación de una emoción específica\n   */ static calculateEmotionScore(lowerMessage, pattern, originalMessage) {\n        let score = 0;\n        let matches = 0;\n        // Buscar palabras clave\n        for (const keyword of pattern.keywords){\n            if (lowerMessage.includes(keyword)) {\n                score += 0.3;\n                matches++;\n            }\n        }\n        // Buscar frases específicas (mayor peso)\n        for (const phrase of pattern.phrases){\n            if (phrase.test(originalMessage)) {\n                score += 0.5;\n                matches++;\n            }\n        }\n        // Buscar contexto de apoyo\n        for (const contextWord of pattern.context){\n            if (lowerMessage.includes(contextWord)) {\n                score += 0.1;\n            }\n        }\n        // Aplicar multiplicadores de intensidad\n        for (const [intensifier, multiplier] of Object.entries(pattern.intensity_multipliers)){\n            if (lowerMessage.includes(intensifier)) {\n                score *= multiplier;\n                break;\n            }\n        }\n        // Ajustar por confianza base del patrón\n        score *= pattern.confidence_base;\n        // Bonificación por múltiples coincidencias\n        if (matches > 1) {\n            score *= 1.2;\n        }\n        return Math.min(score, 1.0) // Cap en 1.0\n        ;\n    }\n    /**\n   * Obtiene los indicadores que coincidieron\n   */ static getMatchedIndicators(lowerMessage, pattern, originalMessage) {\n        const indicators = [];\n        // Palabras clave encontradas\n        pattern.keywords.forEach((keyword)=>{\n            if (lowerMessage.includes(keyword)) {\n                indicators.push(`keyword: ${keyword}`);\n            }\n        });\n        // Frases encontradas\n        pattern.phrases.forEach((phrase, index)=>{\n            if (phrase.test(originalMessage)) {\n                indicators.push(`phrase_pattern_${index}`);\n            }\n        });\n        return indicators;\n    }\n    /**\n   * Calcula la intensidad emocional\n   */ static calculateIntensity(message, confidence) {\n        const intensifiers = [\n            'muy',\n            'súper',\n            'extremadamente',\n            'completamente',\n            'totalmente',\n            'demasiado'\n        ];\n        const hasIntensifier = intensifiers.some((word)=>message.includes(word));\n        if (confidence > 0.8 || hasIntensifier) return 'high';\n        if (confidence > 0.6) return 'medium';\n        return 'low';\n    }\n    /**\n   * Analiza el contexto emocional\n   */ static analyzeEmotionalContext(message, providedContext) {\n        const context = {};\n        // Detectar si es académico\n        const academicKeywords = [\n            'examen',\n            'tarea',\n            'estudio',\n            'clase',\n            'profesor',\n            'materia',\n            'universidad',\n            'colegio'\n        ];\n        context.academic = academicKeywords.some((word)=>message.includes(word));\n        // Detectar si es personal\n        const personalKeywords = [\n            'familia',\n            'amigos',\n            'casa',\n            'personal',\n            'vida',\n            'sentimientos'\n        ];\n        context.personal = personalKeywords.some((word)=>message.includes(word));\n        // Detectar temporalidad\n        if (/ayer|antes|pasado|era|fue/.test(message)) context.temporal = 'past';\n        else if (/mañana|próximo|futuro|después|seré/.test(message)) context.temporal = 'future';\n        else context.temporal = 'present';\n        // Usar contexto proporcionado\n        if (providedContext?.subject) {\n            context.subject = providedContext.subject;\n        }\n        return context;\n    }\n    /**\n   * Sugiere el tipo de respuesta más apropiado\n   */ static getSuggestedResponseType(emotion, confidence) {\n        const responseMap = {\n            [\"frustrated\"]: 'supportive',\n            [\"overwhelmed\"]: 'supportive',\n            [\"anxious\"]: 'empathetic',\n            [\"stressed\"]: 'solution_focused',\n            [\"confused\"]: 'professional',\n            [\"disappointed\"]: 'empathetic',\n            [\"sad\"]: 'empathetic',\n            [\"angry\"]: 'supportive',\n            [\"fear\"]: 'supportive',\n            [\"motivated\"]: 'encouraging',\n            [\"excited\"]: 'encouraging',\n            [\"proud\"]: 'encouraging',\n            [\"confident\"]: 'motivational',\n            [\"hopeful\"]: 'motivational',\n            [\"curious\"]: 'professional',\n            [\"grateful\"]: 'encouraging',\n            [\"relieved\"]: 'encouraging',\n            [\"bored\"]: 'motivational',\n            [\"happy\"]: 'encouraging',\n            [\"surprise\"]: 'professional',\n            [\"neutral\"]: 'professional'\n        };\n        return responseMap[emotion] || 'professional';\n    }\n    /**\n   * Genera un resumen textual del análisis emocional\n   */ static generateEmotionSummary(analysis) {\n        const emotionNames = {\n            [\"frustrated\"]: 'frustrado',\n            [\"motivated\"]: 'motivado',\n            [\"confused\"]: 'confundido',\n            [\"confident\"]: 'confiado',\n            [\"overwhelmed\"]: 'abrumado',\n            [\"curious\"]: 'curioso',\n            [\"proud\"]: 'orgulloso',\n            [\"disappointed\"]: 'decepcionado',\n            [\"anxious\"]: 'ansioso',\n            [\"excited\"]: 'emocionado',\n            [\"bored\"]: 'aburrido',\n            [\"hopeful\"]: 'esperanzado',\n            [\"stressed\"]: 'estresado',\n            [\"relieved\"]: 'aliviado',\n            [\"grateful\"]: 'agradecido',\n            [\"happy\"]: 'feliz',\n            [\"sad\"]: 'triste',\n            [\"angry\"]: 'enojado',\n            [\"fear\"]: 'temeroso',\n            [\"surprise\"]: 'sorprendido',\n            [\"neutral\"]: 'neutral'\n        };\n        let summary = `El estudiante se siente ${emotionNames[analysis.primary]} (confianza: ${(analysis.confidence * 100).toFixed(0)}%, intensidad: ${analysis.intensity})`;\n        if (analysis.secondary) {\n            summary += ` con matices de ${emotionNames[analysis.secondary]}`;\n        }\n        if (analysis.context.subject) {\n            summary += ` en relación a ${analysis.context.subject}`;\n        }\n        return summary;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RDtRQUVBLE9BQU9LO0lBQ1Q7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9lbW90aW9uLWFuYWx5emVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFNpc3RlbWEgQXZhbnphZG8gZGUgQW7DoWxpc2lzIEVtb2Npb25hbCBwYXJhIFNhcmFcbi8vIERldGVjdGEgZW1vY2lvbmVzIGNvbXBsZWphcyBlbiBsb3MgbWVuc2FqZXMgZGUgZXN0dWRpYW50ZXMgcGFyYSByZXNwdWVzdGFzIG3DoXMgZW1ww6F0aWNhc1xuXG5leHBvcnQgZW51bSBFbW90aW9uVHlwZSB7XG4gIC8vIEVtb2Npb25lcyBCw6FzaWNhc1xuICBIQVBQWSA9ICdoYXBweScsXG4gIFNBRCA9ICdzYWQnLFxuICBBTkdSWSA9ICdhbmdyeScsXG4gIEZFQVIgPSAnZmVhcicsXG4gIFNVUlBSSVNFID0gJ3N1cnByaXNlJyxcbiAgTkVVVFJBTCA9ICduZXV0cmFsJyxcbiAgXG4gIC8vIEVtb2Npb25lcyBBY2Fkw6ltaWNhcyBFc3BlY8OtZmljYXNcbiAgRlJVU1RSQVRFRCA9ICdmcnVzdHJhdGVkJyxcbiAgTU9USVZBVEVEID0gJ21vdGl2YXRlZCcsXG4gIENPTkZVU0VEID0gJ2NvbmZ1c2VkJyxcbiAgQ09ORklERU5UID0gJ2NvbmZpZGVudCcsXG4gIE9WRVJXSEVMTUVEID0gJ292ZXJ3aGVsbWVkJyxcbiAgQ1VSSU9VUyA9ICdjdXJpb3VzJyxcbiAgUFJPVUQgPSAncHJvdWQnLFxuICBESVNBUFBPSU5URUQgPSAnZGlzYXBwb2ludGVkJyxcbiAgQU5YSU9VUyA9ICdhbnhpb3VzJyxcbiAgRVhDSVRFRCA9ICdleGNpdGVkJyxcbiAgQk9SRUQgPSAnYm9yZWQnLFxuICBIT1BFRlVMID0gJ2hvcGVmdWwnLFxuICBTVFJFU1NFRCA9ICdzdHJlc3NlZCcsXG4gIFJFTElFVkVEID0gJ3JlbGlldmVkJyxcbiAgR1JBVEVGVUwgPSAnZ3JhdGVmdWwnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1vdGlvbkFuYWx5c2lzIHtcbiAgcHJpbWFyeTogRW1vdGlvblR5cGVcbiAgc2Vjb25kYXJ5PzogRW1vdGlvblR5cGVcbiAgY29uZmlkZW5jZTogbnVtYmVyXG4gIGludGVuc2l0eTogJ2xvdycgfCAnbWVkaXVtJyB8ICdoaWdoJ1xuICBpbmRpY2F0b3JzOiBzdHJpbmdbXVxuICBjb250ZXh0OiB7XG4gICAgYWNhZGVtaWM/OiBib29sZWFuXG4gICAgcGVyc29uYWw/OiBib29sZWFuXG4gICAgdGVtcG9yYWw/OiAncGFzdCcgfCAncHJlc2VudCcgfCAnZnV0dXJlJ1xuICAgIHN1YmplY3Q/OiBzdHJpbmdcbiAgfVxuICBzdWdnZXN0ZWRSZXNwb25zZTogJ3N1cHBvcnRpdmUnIHwgJ21vdGl2YXRpb25hbCcgfCAncHJvZmVzc2lvbmFsJyB8ICdlbXBhdGhldGljJyB8ICdlbmNvdXJhZ2luZycgfCAnc29sdXRpb25fZm9jdXNlZCdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbW90aW9uUGF0dGVybiB7XG4gIGtleXdvcmRzOiBzdHJpbmdbXVxuICBwaHJhc2VzOiBSZWdFeHBbXVxuICBjb250ZXh0OiBzdHJpbmdbXVxuICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgW2tleTogc3RyaW5nXTogbnVtYmVyIH1cbiAgY29uZmlkZW5jZV9iYXNlOiBudW1iZXJcbn1cblxuZXhwb3J0IGNsYXNzIEVtb3Rpb25BbmFseXplciB7XG4gIFxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBFTU9USU9OX1BBVFRFUk5TOiB7IFtrZXkgaW4gRW1vdGlvblR5cGVdOiBFbW90aW9uUGF0dGVybiB9ID0ge1xuICAgIFtFbW90aW9uVHlwZS5GUlVTVFJBVEVEXToge1xuICAgICAga2V5d29yZHM6IFsnZnJ1c3RyYWRvJywgJ2Vub2phZG8nLCAnbW9sZXN0bycsICdoYXJ0YWRvJywgJ2Z1cmlvc28nLCAnaXJyaXRhZG8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL25vXFxzK3B1ZWRvXFxzKyhtw6FzfGhhY2VyfGxvZ3JhcikvaSxcbiAgICAgICAgL2VzXFxzKyhtdXlcXHMrfHPDunBlclxccyspP2RpZsOtY2lsL2ksXG4gICAgICAgIC9tZVxccysoZnJ1c3RyYXxtb2xlc3RhfGVub2phKS9pLFxuICAgICAgICAvcG9yXFxzK3F1w6lcXHMrbm9cXHMrKHB1ZWRvfGxvZ3JvfGVudGllbmRvKS9pLFxuICAgICAgICAvZXN0b1xccysobm9cXHMrc2lydmV8ZXNcXHMraW1wb3NpYmxlKS9pLFxuICAgICAgICAveWFcXHMrKGludGVudMOpfHByb2LDqSlcXHMrdG9kby9pXG4gICAgICBdLFxuICAgICAgY29udGV4dDogWydkaWbDrWNpbCcsICdwcm9ibGVtYScsICdmYWxsYScsICdlcnJvcicsICdpbXBvc2libGUnXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4zLCAnc8O6cGVyJzogMS41LCAnZGVtYXNpYWRvJzogMS40LCAnY29tcGxldGFtZW50ZSc6IDEuNiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjg1XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5NT1RJVkFURURdOiB7XG4gICAgICBrZXl3b3JkczogWydtb3RpdmFkbycsICdlbW9jaW9uYWRvJywgJ2VudHVzaWFzbWFkbycsICdpbnNwaXJhZG8nLCAnZGV0ZXJtaW5hZG8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL3F1aWVyb1xccysobG9ncmFyfGNvbnNlZ3VpcnxhcHJlbmRlcikvaSxcbiAgICAgICAgL2VzdG95XFxzKyhsaXN0b3xwcmVwYXJhZG98ZW1vY2lvbmFkbykvaSxcbiAgICAgICAgL21lXFxzKyhndXN0YXxlbmNhbnRhfG1vdGl2YSkvaSxcbiAgICAgICAgL3ZhbW9zXFxzKyhhXFxzKyk/aGFjZXJsby9pLFxuICAgICAgICAvZXN0b3lcXHMrZGVjaWRpZG8vaSxcbiAgICAgICAgL3RlbmdvXFxzK2dhbmFzXFxzK2RlL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ29iamV0aXZvJywgJ21ldGEnLCAncGxhbicsICdmdXR1cm8nLCAnbG9ncm8nXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4yLCAnc8O6cGVyJzogMS40LCAncmVhbG1lbnRlJzogMS4zIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuOFxuICAgIH0sXG5cbiAgICBbRW1vdGlvblR5cGUuQ09ORlVTRURdOiB7XG4gICAgICBrZXl3b3JkczogWydjb25mdW5kaWRvJywgJ3BlcmRpZG8nLCAnZGVzb3JpZW50YWRvJywgJ2VucmVkYWRvJ10sXG4gICAgICBwaHJhc2VzOiBbXG4gICAgICAgIC9ub1xccysoZW50aWVuZG98Y29tcHJlbmRvfGNhcHRvKS9pLFxuICAgICAgICAvZXN0b3lcXHMrKGNvbmZ1bmRpZG98cGVyZGlkbykvaSxcbiAgICAgICAgL25vXFxzK3PDqVxccysoY8OzbW98cXXDqXxwb3JcXHMrcXXDqSkvaSxcbiAgICAgICAgL21lXFxzKyhjb25mdW5kZXxkZXNvcmllbnRhKS9pLFxuICAgICAgICAvbm9cXHMrbWVcXHMrcXVlZGFcXHMrY2xhcm8vaSxcbiAgICAgICAgL3BvZHLDrWFzXFxzK2V4cGxpY2FyL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ2V4cGxpY2FjacOzbicsICdheXVkYScsICdjbGFyaWZpY2FyJywgJ2NvbmNlcHRvJywgJ2R1ZGFzJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ2NvbXBsZXRhbWVudGUnOiAxLjUsICd0b3RhbG1lbnRlJzogMS40LCAnbXV5JzogMS4yIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuOVxuICAgIH0sXG5cbiAgICBbRW1vdGlvblR5cGUuT1ZFUldIRUxNRURdOiB7XG4gICAgICBrZXl3b3JkczogWydhYnJ1bWFkbycsICdzb2JyZWNhcmdhZG8nLCAnc2F0dXJhZG8nLCAnYWdvYmlhZG8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL2VzXFxzK2RlbWFzaWFkby9pLFxuICAgICAgICAvbm9cXHMrcHVlZG9cXHMrY29uXFxzK3RvZG8vaSxcbiAgICAgICAgL21lXFxzKyhhYnJ1bWF8YWdvYmlhfHNhdHVyYSkvaSxcbiAgICAgICAgL3NvblxccyttdWNoYXNcXHMrY29zYXMvaSxcbiAgICAgICAgL25vXFxzK3RlbmdvXFxzK3RpZW1wby9pLFxuICAgICAgICAvbWVcXHMrc2llbnRvXFxzKyhwZXJkaWRvfGRlc2JvcmRhZG8pL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ3RpZW1wbycsICd0YXJlYXMnLCAnZXjDoW1lbmVzJywgJ211Y2hvcycsICdwcmVzacOzbiddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdjb21wbGV0YW1lbnRlJzogMS42LCAndG90YWxtZW50ZSc6IDEuNSwgJ211eSc6IDEuMyB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjg4XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5BTlhJT1VTXToge1xuICAgICAga2V5d29yZHM6IFsnYW5zaW9zbycsICduZXJ2aW9zbycsICdwcmVvY3VwYWRvJywgJ2VzdHJlc2FkbycsICd0ZW5zbycsICdhbnNpZWRhZCddLFxuICAgICAgcGhyYXNlczogW1xuICAgICAgICAvbWVcXHMrKHByZW9jdXBhfGRhXFxzK2Fuc2llZGFkfHBvbmVcXHMrbmVydmlvc28pL2ksXG4gICAgICAgIC90ZW5nb1xccysobWllZG98dGVtb3IpXFxzK2RlL2ksXG4gICAgICAgIC95XFxzK3NpXFxzKyhub1xccytwdWVkb3xmYWxsb3xzYWxnb1xccyttYWwpL2ksXG4gICAgICAgIC9tZVxccytkYVxccysoZXN0csOpc3xww6FuaWNvfGFuc2llZGFkKS9pLFxuICAgICAgICAvZXN0b3lcXHMrKG5lcnZpb3NvfGFuc2lvc28pL2ksXG4gICAgICAgIC9ub1xccytzw6lcXHMrc2lcXHMrcG9kcsOpL2ksXG4gICAgICAgIC8obXVjaGF8YmFzdGFudGUpXFxzK2Fuc2llZGFkL2ksXG4gICAgICAgIC9hbnNpZWRhZFxccysocG9yfGRlfGFsKS9pXG4gICAgICBdLFxuICAgICAgY29udGV4dDogWydleGFtZW4nLCAnZXZhbHVhY2nDs24nLCAnZnV0dXJvJywgJ3Jlc3VsdGFkbycsICdmYWxsbycsICdww7pibGljbycsICdoYWJsYXInXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4zLCAnbXVjaGEnOiAxLjQsICdzw7pwZXInOiAxLjUsICdkZW1hc2lhZG8nOiAxLjQsICdiYXN0YW50ZSc6IDEuMiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjg4XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5QUk9VRF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ29yZ3VsbG9zbycsICdzYXRpc2ZlY2hvJywgJ2NvbnRlbnRvJywgJ2ZlbGl6J10sXG4gICAgICBwaHJhc2VzOiBbXG4gICAgICAgIC9sb1xccysobG9ncsOpfGNvbnNlZ3XDrXxoaWNlKS9pLFxuICAgICAgICAvZXN0b3lcXHMrKG9yZ3VsbG9zb3xzYXRpc2ZlY2hvfGNvbnRlbnRvKS9pLFxuICAgICAgICAvbWVcXHMrc2llbnRvXFxzKyhiaWVufGdlbmlhbHxpbmNyZcOtYmxlKS9pLFxuICAgICAgICAvcHVkZVxccytoYWNlcmxvL2ksXG4gICAgICAgIC9sb1xccytlbnRlbmTDrS9pLFxuICAgICAgICAvZnVuY2lvbsOzL2ksXG4gICAgICAgIC9sb2dyw6lcXHMrKHRlcm1pbmFyfGNvbXBsZXRhcnxoYWNlcikvaSxcbiAgICAgICAgLyh0ZXJtaW7DqXxjb21wbGV0w6kpXFxzKyhlbHxsYXxtaSkvaSxcbiAgICAgICAgL3B1ZGVcXHMrKHRlcm1pbmFyfGNvbXBsZXRhcikvaVxuICAgICAgXSxcbiAgICAgIGNvbnRleHQ6IFsnbG9ncm8nLCAnw6l4aXRvJywgJ3Jlc3VsdGFkbycsICdjb21wbGV0w6knLCAndGVybWluw6knLCAnZXhhbWVuJywgJ3Byb3llY3RvJywgJ3RhcmVhJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211eSc6IDEuMiwgJ3PDunBlcic6IDEuNCwgJ3JlYWxtZW50ZSc6IDEuMywgJ2ZpbmFsbWVudGUnOiAxLjMgfSxcbiAgICAgIGNvbmZpZGVuY2VfYmFzZTogMC44NVxuICAgIH0sXG5cbiAgICBbRW1vdGlvblR5cGUuRElTQVBQT0lOVEVEXToge1xuICAgICAga2V5d29yZHM6IFsnZGVjZXBjaW9uYWRvJywgJ3RyaXN0ZScsICdkZXNpbHVzaW9uYWRvJywgJ2Rlc2FuaW1hZG8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL25vXFxzK3NhbGnDs1xccytjb21vXFxzK2VzcGVyYWJhL2ksXG4gICAgICAgIC9tZVxccysoZGVjZXBjaW9uYXxlbnRyaXN0ZWNlfGRlc2FuaW1hKS9pLFxuICAgICAgICAvZXNwZXJhYmFcXHMrKG3DoXN8bWVqb3IpL2ksXG4gICAgICAgIC9ub1xccytmdWVcXHMrc3VmaWNpZW50ZS9pLFxuICAgICAgICAvcXXDqVxccyttYWwvaSxcbiAgICAgICAgL25vXFxzK2Z1bmNpb27Dsy9pXG4gICAgICBdLFxuICAgICAgY29udGV4dDogWydyZXN1bHRhZG8nLCAnY2FsaWZpY2FjacOzbicsICdleHBlY3RhdGl2YScsICdmYWxsbycsICdlcnJvciddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdXknOiAxLjMsICdyZWFsbWVudGUnOiAxLjQsICdiYXN0YW50ZSc6IDEuMiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjhcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLkVYQ0lURURdOiB7XG4gICAgICBrZXl3b3JkczogWydlbW9jaW9uYWRvJywgJ2VudHVzaWFzbWFkbycsICdpbHVzaW9uYWRvJywgJ2FsZWdyZSddLFxuICAgICAgcGhyYXNlczogW1xuICAgICAgICAvcXXDqVxccysoZ2VuaWFsfGluY3Jlw61ibGV8ZmFudMOhc3RpY28pL2ksXG4gICAgICAgIC9tZVxccysoZW1vY2lvbmF8aWx1c2lvbmF8YWxlZ3JhKS9pLFxuICAgICAgICAvZXN0b3lcXHMrKGVtb2Npb25hZG98ZW50dXNpYXNtYWRvKS9pLFxuICAgICAgICAvbm9cXHMrcHVlZG9cXHMrZXNwZXJhci9pLFxuICAgICAgICAvc2Vyw6FcXHMrKGdlbmlhbHxmYW50w6FzdGljbykvaSxcbiAgICAgICAgL21lXFxzK2VuY2FudGEvaVxuICAgICAgXSxcbiAgICAgIGNvbnRleHQ6IFsncHJveWVjdG8nLCAnbnVldm8nLCAnb3BvcnR1bmlkYWQnLCAnZnV0dXJvJywgJ2V4cGVyaWVuY2lhJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211eSc6IDEuMiwgJ3PDunBlcic6IDEuNCwgJ3JlYWxtZW50ZSc6IDEuMyB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjgzXG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5CT1JFRF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ2FidXJyaWRvJywgJ2hhc3RpYWRvJywgJ2NhbnNhZG8nLCAndGVkaW9zbyddLFxuICAgICAgcGhyYXNlczogW1xuICAgICAgICAvbWVcXHMrKGFidXJyZXxoYXN0w61hfGNhbnNhKS9pLFxuICAgICAgICAvZXNcXHMrKGFidXJyaWRvfHRlZGlvc298cmVwZXRpdGl2bykvaSxcbiAgICAgICAgL25vXFxzK21lXFxzK2ludGVyZXNhL2ksXG4gICAgICAgIC9xdcOpXFxzKyhhYnVycmlkb3x0ZWRpb3NvKS9pLFxuICAgICAgICAvc2llbXByZVxccytsb1xccyttaXNtby9pLFxuICAgICAgICAvbm9cXHMrZXNcXHMrZGl2ZXJ0aWRvL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ21hdGVyaWEnLCAndGVtYScsICdyZXBldGl0aXZvJywgJ3NpZW1wcmUnLCAnbWlzbW8nXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4yLCAnc8O6cGVyJzogMS40LCAnZGVtYXNpYWRvJzogMS4zIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuNzhcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLkhPUEVGVUxdOiB7XG4gICAgICBrZXl3b3JkczogWydlc3BlcmFuemFkbycsICdvcHRpbWlzdGEnLCAnY29uZmlhZG8nLCAncG9zaXRpdm8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL2VzcGVyb1xccysocXVlfHBvZGVyKS9pLFxuICAgICAgICAvdGVuZ29cXHMrKGVzcGVyYW56YXxmZXxjb25maWFuemEpL2ksXG4gICAgICAgIC9jcmVvXFxzK3F1ZVxccysocHVlZG98cG9kcsOpKS9pLFxuICAgICAgICAvc2Vyw6FcXHMrcG9zaWJsZS9pLFxuICAgICAgICAvY29uZsOtb1xccytlblxccytxdWUvaSxcbiAgICAgICAgL2VzdG95XFxzK29wdGltaXN0YS9pXG4gICAgICBdLFxuICAgICAgY29udGV4dDogWydmdXR1cm8nLCAncG9zaWJpbGlkYWQnLCAnbWVqb3JhJywgJ2NhbWJpbycsICdvcG9ydHVuaWRhZCddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdXknOiAxLjIsICdyZWFsbWVudGUnOiAxLjMsICdiYXN0YW50ZSc6IDEuMSB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjc1XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5TVFJFU1NFRF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ2VzdHJlc2FkbycsICdwcmVzaW9uYWRvJywgJ2Fnb2JpYWRvJywgJ3RlbnNpb25hZG8nXSxcbiAgICAgIHBocmFzZXM6IFtcbiAgICAgICAgL21lXFxzKyhlc3RyZXNhfHByZXNpb25hfGFnb2JpYSkvaSxcbiAgICAgICAgL3NpZW50b1xccysocHJlc2nDs258dGVuc2nDs258ZXN0csOpcykvaSxcbiAgICAgICAgL25vXFxzK2RveVxccythYmFzdG8vaSxcbiAgICAgICAgL2VzXFxzK211Y2hhXFxzK3ByZXNpw7NuL2ksXG4gICAgICAgIC9tZVxccytzaWVudG9cXHMrcHJlc2lvbmFkby9pLFxuICAgICAgICAvbm9cXHMrcHVlZG9cXHMrcmVsYWphcm1lL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ3RpZW1wbycsICdwcmVzacOzbicsICdkZWFkbGluZXMnLCAnZXjDoW1lbmVzJywgJ23Dumx0aXBsZSddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdXknOiAxLjMsICdkZW1hc2lhZG8nOiAxLjQsICdleHRyZW1hZGFtZW50ZSc6IDEuNiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjg2XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5HUkFURUZVTF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ2FncmFkZWNpZG8nLCAnZ3JhY2lhcycsICdyZWNvbm9jaWRvJywgJ2FwcmVjaWFkbyddLFxuICAgICAgcGhyYXNlczogW1xuICAgICAgICAvbXVjaGFzXFxzK2dyYWNpYXMvaSxcbiAgICAgICAgLyh0ZVxccyspP2FncmFkZXpjby9pLFxuICAgICAgICAvbWVcXHMrKGF5dWRhc3xheXVkYXN0ZSlcXHMrbXVjaG8vaSxcbiAgICAgICAgL2VyZXNcXHMrKGdlbmlhbHxpbmNyZcOtYmxlfG11eVxccyvDunRpbCkvaSxcbiAgICAgICAgL2dyYWNpYXNcXHMrcG9yL2ksXG4gICAgICAgIC9sb1xccythcHJlY2lvL2lcbiAgICAgIF0sXG4gICAgICBjb250ZXh0OiBbJ2F5dWRhJywgJ2Fwb3lvJywgJ2V4cGxpY2FjacOzbicsICd0aWVtcG8nLCAncGFjaWVuY2lhJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211Y2jDrXNpbWFzJzogMS40LCAncmVhbG1lbnRlJzogMS4zLCAnbXV5JzogMS4yIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuOVxuICAgIH0sXG5cbiAgICAvLyBFbW9jaW9uZXMgYsOhc2ljYXMgY29uIHBhdHJvbmVzIHNpbXBsZXNcbiAgICBbRW1vdGlvblR5cGUuSEFQUFldOiB7XG4gICAgICBrZXl3b3JkczogWydmZWxpeicsICdhbGVncmUnLCAnY29udGVudG8nLCAnYmllbiddLFxuICAgICAgcGhyYXNlczogWy9tZVxccytzaWVudG9cXHMrKGZlbGl6fGFsZWdyZXxiaWVuKS9pLCAvZXN0b3lcXHMrKGZlbGl6fGNvbnRlbnRvKS9pXSxcbiAgICAgIGNvbnRleHQ6IFsnbG9ncm8nLCAnw6l4aXRvJywgJ2J1ZW5vJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211eSc6IDEuMiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjdcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLlNBRF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ3RyaXN0ZScsICdtZWxhbmPDs2xpY28nLCAnZGVwcmltaWRvJ10sXG4gICAgICBwaHJhc2VzOiBbL21lXFxzK3NpZW50b1xccyt0cmlzdGUvaSwgL2VzdG95XFxzK3RyaXN0ZS9pXSxcbiAgICAgIGNvbnRleHQ6IFsnbWFsJywgJ2ZhbGxvJywgJ3DDqXJkaWRhJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211eSc6IDEuMyB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjc1XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5BTkdSWV06IHtcbiAgICAgIGtleXdvcmRzOiBbJ2Vub2phZG8nLCAnZnVyaW9zbycsICdtb2xlc3RvJ10sXG4gICAgICBwaHJhc2VzOiBbL21lXFxzK2Vub2phL2ksIC9lc3RveVxccytmdXJpb3NvL2ldLFxuICAgICAgY29udGV4dDogWydwcm9ibGVtYScsICdpbmp1c3RvJywgJ21hbCddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdXknOiAxLjQgfSxcbiAgICAgIGNvbmZpZGVuY2VfYmFzZTogMC44XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5GRUFSXToge1xuICAgICAga2V5d29yZHM6IFsnbWllZG8nLCAndGVtb3InLCAnYXN1c3RhZG8nXSxcbiAgICAgIHBocmFzZXM6IFsvdGVuZ29cXHMrbWllZG8vaSwgL21lXFxzK2FzdXN0YS9pXSxcbiAgICAgIGNvbnRleHQ6IFsncGVsaWdybycsICdhbWVuYXphJywgJ2Z1dHVybyddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdWNobyc6IDEuMyB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjhcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLlNVUlBSSVNFXToge1xuICAgICAga2V5d29yZHM6IFsnc29ycHJlbmRpZG8nLCAnYXNvbWJyYWRvJywgJ2ltcHJlc2lvbmFkbyddLFxuICAgICAgcGhyYXNlczogWy9xdcOpXFxzK3NvcnByZXNhL2ksIC9tZVxccytzb3JwcmVuZGUvaV0sXG4gICAgICBjb250ZXh0OiBbJ2luZXNwZXJhZG8nLCAnbnVldm8nLCAnZGlmZXJlbnRlJ10sXG4gICAgICBpbnRlbnNpdHlfbXVsdGlwbGllcnM6IHsgJ211eSc6IDEuMiB9LFxuICAgICAgY29uZmlkZW5jZV9iYXNlOiAwLjdcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLkNPTkZJREVOVF06IHtcbiAgICAgIGtleXdvcmRzOiBbJ3NlZ3VybycsICdjb25maWFkbycsICdjYXBheiddLFxuICAgICAgcGhyYXNlczogWy9lc3RveVxccytzZWd1cm8vaSwgL3B1ZWRvXFxzK2hhY2VybG8vaV0sXG4gICAgICBjb250ZXh0OiBbJ2NhcGFjaWRhZCcsICdoYWJpbGlkYWQnLCAnbG9ncm8nXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4yIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuOFxuICAgIH0sXG5cbiAgICBbRW1vdGlvblR5cGUuQ1VSSU9VU106IHtcbiAgICAgIGtleXdvcmRzOiBbJ2N1cmlvc28nLCAnaW50ZXJlc2FkbycsICdpbnRyaWdhZG8nXSxcbiAgICAgIHBocmFzZXM6IFsvbWVcXHMrZGFcXHMrY3VyaW9zaWRhZC9pLCAvcXVpZXJvXFxzK3NhYmVyL2ldLFxuICAgICAgY29udGV4dDogWydwcmVndW50YScsICdleHBsb3JhcicsICdkZXNjdWJyaXInXSxcbiAgICAgIGludGVuc2l0eV9tdWx0aXBsaWVyczogeyAnbXV5JzogMS4yIH0sXG4gICAgICBjb25maWRlbmNlX2Jhc2U6IDAuNzVcbiAgICB9LFxuXG4gICAgW0Vtb3Rpb25UeXBlLlJFTElFVkVEXToge1xuICAgICAga2V5d29yZHM6IFsnYWxpdmlhZG8nLCAndHJhbnF1aWxvJywgJ3JlbGFqYWRvJ10sXG4gICAgICBwaHJhc2VzOiBbL3F1w6lcXHMrYWxpdmlvL2ksIC9tZVxccyt0cmFucXVpbGl6YS9pXSxcbiAgICAgIGNvbnRleHQ6IFsncHJvYmxlbWEgcmVzdWVsdG8nLCAnw6l4aXRvJywgJ3Rlcm1pbmFkbyddLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7ICdtdXknOiAxLjIgfSxcbiAgICAgIGNvbmZpZGVuY2VfYmFzZTogMC44XG4gICAgfSxcblxuICAgIFtFbW90aW9uVHlwZS5ORVVUUkFMXToge1xuICAgICAga2V5d29yZHM6IFsnbm9ybWFsJywgJ3JlZ3VsYXInLCAnY29tw7puJ10sXG4gICAgICBwaHJhc2VzOiBbL2VzdMOhXFxzK2JpZW4vaSwgL25vcm1hbC9pXSxcbiAgICAgIGNvbnRleHQ6IFtdLFxuICAgICAgaW50ZW5zaXR5X211bHRpcGxpZXJzOiB7fSxcbiAgICAgIGNvbmZpZGVuY2VfYmFzZTogMC41XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWxpemEgbGFzIGVtb2Npb25lcyBlbiB1biBtZW5zYWplIGRlIHRleHRvXG4gICAqL1xuICBzdGF0aWMgYW5hbHl6ZUVtb3Rpb25zKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dD86IHsgc3ViamVjdD86IHN0cmluZywgcHJldmlvdXNFbW90aW9uPzogRW1vdGlvblR5cGUgfSk6IEVtb3Rpb25BbmFseXNpcyB7XG4gICAgY29uc3QgbG93ZXJNZXNzYWdlID0gbWVzc2FnZS50b0xvd2VyQ2FzZSgpXG4gICAgY29uc3QgZW1vdGlvblNjb3JlczogQXJyYXk8eyBlbW90aW9uOiBFbW90aW9uVHlwZSwgc2NvcmU6IG51bWJlciwgaW5kaWNhdG9yczogc3RyaW5nW10gfT4gPSBbXVxuXG4gICAgLy8gQW5hbGl6YXIgY2FkYSBwYXRyw7NuIGVtb2Npb25hbFxuICAgIGZvciAoY29uc3QgW2Vtb3Rpb24sIHBhdHRlcm5dIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuRU1PVElPTl9QQVRURVJOUykpIHtcbiAgICAgIGNvbnN0IHNjb3JlID0gdGhpcy5jYWxjdWxhdGVFbW90aW9uU2NvcmUobG93ZXJNZXNzYWdlLCBwYXR0ZXJuLCBtZXNzYWdlKVxuICAgICAgaWYgKHNjb3JlID4gMC4zKSB7IC8vIFVtYnJhbCBtw61uaW1vIGRlIGNvbmZpYW56YVxuICAgICAgICBlbW90aW9uU2NvcmVzLnB1c2goe1xuICAgICAgICAgIGVtb3Rpb246IGVtb3Rpb24gYXMgRW1vdGlvblR5cGUsXG4gICAgICAgICAgc2NvcmUsXG4gICAgICAgICAgaW5kaWNhdG9yczogdGhpcy5nZXRNYXRjaGVkSW5kaWNhdG9ycyhsb3dlck1lc3NhZ2UsIHBhdHRlcm4sIG1lc3NhZ2UpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gT3JkZW5hciBwb3IgcHVudHVhY2nDs25cbiAgICBlbW90aW9uU2NvcmVzLnNvcnQoKGEsIGIpID0+IGIuc2NvcmUgLSBhLnNjb3JlKVxuXG4gICAgLy8gRGV0ZXJtaW5hciBlbW9jacOzbiBwcmluY2lwYWwgeSBzZWN1bmRhcmlhXG4gICAgY29uc3QgcHJpbWFyeSA9IGVtb3Rpb25TY29yZXNbMF0/LmVtb3Rpb24gfHwgRW1vdGlvblR5cGUuTkVVVFJBTFxuICAgIGNvbnN0IHNlY29uZGFyeSA9IGVtb3Rpb25TY29yZXMubGVuZ3RoID4gMSAmJiBlbW90aW9uU2NvcmVzWzFdLnNjb3JlID4gMC41IFxuICAgICAgPyBlbW90aW9uU2NvcmVzWzFdLmVtb3Rpb24gXG4gICAgICA6IHVuZGVmaW5lZFxuXG4gICAgY29uc3QgY29uZmlkZW5jZSA9IGVtb3Rpb25TY29yZXNbMF0/LnNjb3JlIHx8IDAuNVxuICAgIGNvbnN0IGluZGljYXRvcnMgPSBlbW90aW9uU2NvcmVzWzBdPy5pbmRpY2F0b3JzIHx8IFtdXG5cbiAgICByZXR1cm4ge1xuICAgICAgcHJpbWFyeSxcbiAgICAgIHNlY29uZGFyeSxcbiAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWluKGNvbmZpZGVuY2UsIDAuOTUpLCAvLyBDYXAgbcOheGltbyBkZSBjb25maWFuemFcbiAgICAgIGludGVuc2l0eTogdGhpcy5jYWxjdWxhdGVJbnRlbnNpdHkobG93ZXJNZXNzYWdlLCBjb25maWRlbmNlKSxcbiAgICAgIGluZGljYXRvcnMsXG4gICAgICBjb250ZXh0OiB0aGlzLmFuYWx5emVFbW90aW9uYWxDb250ZXh0KGxvd2VyTWVzc2FnZSwgY29udGV4dCksXG4gICAgICBzdWdnZXN0ZWRSZXNwb25zZTogdGhpcy5nZXRTdWdnZXN0ZWRSZXNwb25zZVR5cGUocHJpbWFyeSwgY29uZmlkZW5jZSlcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYSBsYSBwdW50dWFjacOzbiBkZSB1bmEgZW1vY2nDs24gZXNwZWPDrWZpY2FcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGNhbGN1bGF0ZUVtb3Rpb25TY29yZShsb3dlck1lc3NhZ2U6IHN0cmluZywgcGF0dGVybjogRW1vdGlvblBhdHRlcm4sIG9yaWdpbmFsTWVzc2FnZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBsZXQgc2NvcmUgPSAwXG4gICAgbGV0IG1hdGNoZXMgPSAwXG5cbiAgICAvLyBCdXNjYXIgcGFsYWJyYXMgY2xhdmVcbiAgICBmb3IgKGNvbnN0IGtleXdvcmQgb2YgcGF0dGVybi5rZXl3b3Jkcykge1xuICAgICAgaWYgKGxvd2VyTWVzc2FnZS5pbmNsdWRlcyhrZXl3b3JkKSkge1xuICAgICAgICBzY29yZSArPSAwLjNcbiAgICAgICAgbWF0Y2hlcysrXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQnVzY2FyIGZyYXNlcyBlc3BlY8OtZmljYXMgKG1heW9yIHBlc28pXG4gICAgZm9yIChjb25zdCBwaHJhc2Ugb2YgcGF0dGVybi5waHJhc2VzKSB7XG4gICAgICBpZiAocGhyYXNlLnRlc3Qob3JpZ2luYWxNZXNzYWdlKSkge1xuICAgICAgICBzY29yZSArPSAwLjVcbiAgICAgICAgbWF0Y2hlcysrXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQnVzY2FyIGNvbnRleHRvIGRlIGFwb3lvXG4gICAgZm9yIChjb25zdCBjb250ZXh0V29yZCBvZiBwYXR0ZXJuLmNvbnRleHQpIHtcbiAgICAgIGlmIChsb3dlck1lc3NhZ2UuaW5jbHVkZXMoY29udGV4dFdvcmQpKSB7XG4gICAgICAgIHNjb3JlICs9IDAuMVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFwbGljYXIgbXVsdGlwbGljYWRvcmVzIGRlIGludGVuc2lkYWRcbiAgICBmb3IgKGNvbnN0IFtpbnRlbnNpZmllciwgbXVsdGlwbGllcl0gb2YgT2JqZWN0LmVudHJpZXMocGF0dGVybi5pbnRlbnNpdHlfbXVsdGlwbGllcnMpKSB7XG4gICAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKGludGVuc2lmaWVyKSkge1xuICAgICAgICBzY29yZSAqPSBtdWx0aXBsaWVyXG4gICAgICAgIGJyZWFrXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQWp1c3RhciBwb3IgY29uZmlhbnphIGJhc2UgZGVsIHBhdHLDs25cbiAgICBzY29yZSAqPSBwYXR0ZXJuLmNvbmZpZGVuY2VfYmFzZVxuXG4gICAgLy8gQm9uaWZpY2FjacOzbiBwb3IgbcO6bHRpcGxlcyBjb2luY2lkZW5jaWFzXG4gICAgaWYgKG1hdGNoZXMgPiAxKSB7XG4gICAgICBzY29yZSAqPSAxLjJcbiAgICB9XG5cbiAgICByZXR1cm4gTWF0aC5taW4oc2NvcmUsIDEuMCkgLy8gQ2FwIGVuIDEuMFxuICB9XG5cbiAgLyoqXG4gICAqIE9idGllbmUgbG9zIGluZGljYWRvcmVzIHF1ZSBjb2luY2lkaWVyb25cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldE1hdGNoZWRJbmRpY2F0b3JzKGxvd2VyTWVzc2FnZTogc3RyaW5nLCBwYXR0ZXJuOiBFbW90aW9uUGF0dGVybiwgb3JpZ2luYWxNZXNzYWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaW5kaWNhdG9yczogc3RyaW5nW10gPSBbXVxuXG4gICAgLy8gUGFsYWJyYXMgY2xhdmUgZW5jb250cmFkYXNcbiAgICBwYXR0ZXJuLmtleXdvcmRzLmZvckVhY2goa2V5d29yZCA9PiB7XG4gICAgICBpZiAobG93ZXJNZXNzYWdlLmluY2x1ZGVzKGtleXdvcmQpKSB7XG4gICAgICAgIGluZGljYXRvcnMucHVzaChga2V5d29yZDogJHtrZXl3b3JkfWApXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIEZyYXNlcyBlbmNvbnRyYWRhc1xuICAgIHBhdHRlcm4ucGhyYXNlcy5mb3JFYWNoKChwaHJhc2UsIGluZGV4KSA9PiB7XG4gICAgICBpZiAocGhyYXNlLnRlc3Qob3JpZ2luYWxNZXNzYWdlKSkge1xuICAgICAgICBpbmRpY2F0b3JzLnB1c2goYHBocmFzZV9wYXR0ZXJuXyR7aW5kZXh9YClcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIGluZGljYXRvcnNcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxjdWxhIGxhIGludGVuc2lkYWQgZW1vY2lvbmFsXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVJbnRlbnNpdHkobWVzc2FnZTogc3RyaW5nLCBjb25maWRlbmNlOiBudW1iZXIpOiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHtcbiAgICBjb25zdCBpbnRlbnNpZmllcnMgPSBbJ211eScsICdzw7pwZXInLCAnZXh0cmVtYWRhbWVudGUnLCAnY29tcGxldGFtZW50ZScsICd0b3RhbG1lbnRlJywgJ2RlbWFzaWFkbyddXG4gICAgY29uc3QgaGFzSW50ZW5zaWZpZXIgPSBpbnRlbnNpZmllcnMuc29tZSh3b3JkID0+IG1lc3NhZ2UuaW5jbHVkZXMod29yZCkpXG5cbiAgICBpZiAoY29uZmlkZW5jZSA+IDAuOCB8fCBoYXNJbnRlbnNpZmllcikgcmV0dXJuICdoaWdoJ1xuICAgIGlmIChjb25maWRlbmNlID4gMC42KSByZXR1cm4gJ21lZGl1bSdcbiAgICByZXR1cm4gJ2xvdydcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFsaXphIGVsIGNvbnRleHRvIGVtb2Npb25hbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZUVtb3Rpb25hbENvbnRleHQobWVzc2FnZTogc3RyaW5nLCBwcm92aWRlZENvbnRleHQ/OiB7IHN1YmplY3Q/OiBzdHJpbmcsIHByZXZpb3VzRW1vdGlvbj86IEVtb3Rpb25UeXBlIH0pIHtcbiAgICBjb25zdCBjb250ZXh0OiBFbW90aW9uQW5hbHlzaXNbJ2NvbnRleHQnXSA9IHt9XG5cbiAgICAvLyBEZXRlY3RhciBzaSBlcyBhY2Fkw6ltaWNvXG4gICAgY29uc3QgYWNhZGVtaWNLZXl3b3JkcyA9IFsnZXhhbWVuJywgJ3RhcmVhJywgJ2VzdHVkaW8nLCAnY2xhc2UnLCAncHJvZmVzb3InLCAnbWF0ZXJpYScsICd1bml2ZXJzaWRhZCcsICdjb2xlZ2lvJ11cbiAgICBjb250ZXh0LmFjYWRlbWljID0gYWNhZGVtaWNLZXl3b3Jkcy5zb21lKHdvcmQgPT4gbWVzc2FnZS5pbmNsdWRlcyh3b3JkKSlcblxuICAgIC8vIERldGVjdGFyIHNpIGVzIHBlcnNvbmFsXG4gICAgY29uc3QgcGVyc29uYWxLZXl3b3JkcyA9IFsnZmFtaWxpYScsICdhbWlnb3MnLCAnY2FzYScsICdwZXJzb25hbCcsICd2aWRhJywgJ3NlbnRpbWllbnRvcyddXG4gICAgY29udGV4dC5wZXJzb25hbCA9IHBlcnNvbmFsS2V5d29yZHMuc29tZSh3b3JkID0+IG1lc3NhZ2UuaW5jbHVkZXMod29yZCkpXG5cbiAgICAvLyBEZXRlY3RhciB0ZW1wb3JhbGlkYWRcbiAgICBpZiAoL2F5ZXJ8YW50ZXN8cGFzYWRvfGVyYXxmdWUvLnRlc3QobWVzc2FnZSkpIGNvbnRleHQudGVtcG9yYWwgPSAncGFzdCdcbiAgICBlbHNlIGlmICgvbWHDsWFuYXxwcsOzeGltb3xmdXR1cm98ZGVzcHXDqXN8c2Vyw6kvLnRlc3QobWVzc2FnZSkpIGNvbnRleHQudGVtcG9yYWwgPSAnZnV0dXJlJ1xuICAgIGVsc2UgY29udGV4dC50ZW1wb3JhbCA9ICdwcmVzZW50J1xuXG4gICAgLy8gVXNhciBjb250ZXh0byBwcm9wb3JjaW9uYWRvXG4gICAgaWYgKHByb3ZpZGVkQ29udGV4dD8uc3ViamVjdCkge1xuICAgICAgY29udGV4dC5zdWJqZWN0ID0gcHJvdmlkZWRDb250ZXh0LnN1YmplY3RcbiAgICB9XG5cbiAgICByZXR1cm4gY29udGV4dFxuICB9XG5cbiAgLyoqXG4gICAqIFN1Z2llcmUgZWwgdGlwbyBkZSByZXNwdWVzdGEgbcOhcyBhcHJvcGlhZG9cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldFN1Z2dlc3RlZFJlc3BvbnNlVHlwZShlbW90aW9uOiBFbW90aW9uVHlwZSwgY29uZmlkZW5jZTogbnVtYmVyKTogRW1vdGlvbkFuYWx5c2lzWydzdWdnZXN0ZWRSZXNwb25zZSddIHtcbiAgICBjb25zdCByZXNwb25zZU1hcDogeyBba2V5IGluIEVtb3Rpb25UeXBlXTogRW1vdGlvbkFuYWx5c2lzWydzdWdnZXN0ZWRSZXNwb25zZSddIH0gPSB7XG4gICAgICBbRW1vdGlvblR5cGUuRlJVU1RSQVRFRF06ICdzdXBwb3J0aXZlJyxcbiAgICAgIFtFbW90aW9uVHlwZS5PVkVSV0hFTE1FRF06ICdzdXBwb3J0aXZlJyxcbiAgICAgIFtFbW90aW9uVHlwZS5BTlhJT1VTXTogJ2VtcGF0aGV0aWMnLFxuICAgICAgW0Vtb3Rpb25UeXBlLlNUUkVTU0VEXTogJ3NvbHV0aW9uX2ZvY3VzZWQnLFxuICAgICAgW0Vtb3Rpb25UeXBlLkNPTkZVU0VEXTogJ3Byb2Zlc3Npb25hbCcsXG4gICAgICBbRW1vdGlvblR5cGUuRElTQVBQT0lOVEVEXTogJ2VtcGF0aGV0aWMnLFxuICAgICAgW0Vtb3Rpb25UeXBlLlNBRF06ICdlbXBhdGhldGljJyxcbiAgICAgIFtFbW90aW9uVHlwZS5BTkdSWV06ICdzdXBwb3J0aXZlJyxcbiAgICAgIFtFbW90aW9uVHlwZS5GRUFSXTogJ3N1cHBvcnRpdmUnLFxuICAgICAgW0Vtb3Rpb25UeXBlLk1PVElWQVRFRF06ICdlbmNvdXJhZ2luZycsXG4gICAgICBbRW1vdGlvblR5cGUuRVhDSVRFRF06ICdlbmNvdXJhZ2luZycsXG4gICAgICBbRW1vdGlvblR5cGUuUFJPVURdOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgW0Vtb3Rpb25UeXBlLkNPTkZJREVOVF06ICdtb3RpdmF0aW9uYWwnLFxuICAgICAgW0Vtb3Rpb25UeXBlLkhPUEVGVUxdOiAnbW90aXZhdGlvbmFsJyxcbiAgICAgIFtFbW90aW9uVHlwZS5DVVJJT1VTXTogJ3Byb2Zlc3Npb25hbCcsXG4gICAgICBbRW1vdGlvblR5cGUuR1JBVEVGVUxdOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgW0Vtb3Rpb25UeXBlLlJFTElFVkVEXTogJ2VuY291cmFnaW5nJyxcbiAgICAgIFtFbW90aW9uVHlwZS5CT1JFRF06ICdtb3RpdmF0aW9uYWwnLFxuICAgICAgW0Vtb3Rpb25UeXBlLkhBUFBZXTogJ2VuY291cmFnaW5nJyxcbiAgICAgIFtFbW90aW9uVHlwZS5TVVJQUklTRV06ICdwcm9mZXNzaW9uYWwnLFxuICAgICAgW0Vtb3Rpb25UeXBlLk5FVVRSQUxdOiAncHJvZmVzc2lvbmFsJ1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZU1hcFtlbW90aW9uXSB8fCAncHJvZmVzc2lvbmFsJ1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSB1biByZXN1bWVuIHRleHR1YWwgZGVsIGFuw6FsaXNpcyBlbW9jaW9uYWxcbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZUVtb3Rpb25TdW1tYXJ5KGFuYWx5c2lzOiBFbW90aW9uQW5hbHlzaXMpOiBzdHJpbmcge1xuICAgIGNvbnN0IGVtb3Rpb25OYW1lcyA9IHtcbiAgICAgIFtFbW90aW9uVHlwZS5GUlVTVFJBVEVEXTogJ2ZydXN0cmFkbycsXG4gICAgICBbRW1vdGlvblR5cGUuTU9USVZBVEVEXTogJ21vdGl2YWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5DT05GVVNFRF06ICdjb25mdW5kaWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5DT05GSURFTlRdOiAnY29uZmlhZG8nLFxuICAgICAgW0Vtb3Rpb25UeXBlLk9WRVJXSEVMTUVEXTogJ2FicnVtYWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5DVVJJT1VTXTogJ2N1cmlvc28nLFxuICAgICAgW0Vtb3Rpb25UeXBlLlBST1VEXTogJ29yZ3VsbG9zbycsXG4gICAgICBbRW1vdGlvblR5cGUuRElTQVBQT0lOVEVEXTogJ2RlY2VwY2lvbmFkbycsXG4gICAgICBbRW1vdGlvblR5cGUuQU5YSU9VU106ICdhbnNpb3NvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5FWENJVEVEXTogJ2Vtb2Npb25hZG8nLFxuICAgICAgW0Vtb3Rpb25UeXBlLkJPUkVEXTogJ2FidXJyaWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5IT1BFRlVMXTogJ2VzcGVyYW56YWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5TVFJFU1NFRF06ICdlc3RyZXNhZG8nLFxuICAgICAgW0Vtb3Rpb25UeXBlLlJFTElFVkVEXTogJ2FsaXZpYWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5HUkFURUZVTF06ICdhZ3JhZGVjaWRvJyxcbiAgICAgIFtFbW90aW9uVHlwZS5IQVBQWV06ICdmZWxpeicsXG4gICAgICBbRW1vdGlvblR5cGUuU0FEXTogJ3RyaXN0ZScsXG4gICAgICBbRW1vdGlvblR5cGUuQU5HUlldOiAnZW5vamFkbycsXG4gICAgICBbRW1vdGlvblR5cGUuRkVBUl06ICd0ZW1lcm9zbycsXG4gICAgICBbRW1vdGlvblR5cGUuU1VSUFJJU0VdOiAnc29ycHJlbmRpZG8nLFxuICAgICAgW0Vtb3Rpb25UeXBlLk5FVVRSQUxdOiAnbmV1dHJhbCdcbiAgICB9XG5cbiAgICBsZXQgc3VtbWFyeSA9IGBFbCBlc3R1ZGlhbnRlIHNlIHNpZW50ZSAke2Vtb3Rpb25OYW1lc1thbmFseXNpcy5wcmltYXJ5XX0gKGNvbmZpYW56YTogJHsoYW5hbHlzaXMuY29uZmlkZW5jZSAqIDEwMCkudG9GaXhlZCgwKX0lLCBpbnRlbnNpZGFkOiAke2FuYWx5c2lzLmludGVuc2l0eX0pYFxuXG4gICAgaWYgKGFuYWx5c2lzLnNlY29uZGFyeSkge1xuICAgICAgc3VtbWFyeSArPSBgIGNvbiBtYXRpY2VzIGRlICR7ZW1vdGlvbk5hbWVzW2FuYWx5c2lzLnNlY29uZGFyeV19YFxuICAgIH1cblxuICAgIGlmIChhbmFseXNpcy5jb250ZXh0LnN1YmplY3QpIHtcbiAgICAgIHN1bW1hcnkgKz0gYCBlbiByZWxhY2nDs24gYSAke2FuYWx5c2lzLmNvbnRleHQuc3ViamVjdH1gXG4gICAgfVxuXG4gICAgcmV0dXJuIHN1bW1hcnlcbiAgfVxufSJdLCJuYW1lcyI6WyJFbW90aW9uVHlwZSIsIkVtb3Rpb25BbmFseXplciIsIkVNT1RJT05fUEFUVEVSTlMiLCJrZXl3b3JkcyIsInBocmFzZXMiLCJjb250ZXh0IiwiaW50ZW5zaXR5X211bHRpcGxpZXJzIiwiY29uZmlkZW5jZV9iYXNlIiwiYW5hbHl6ZUVtb3Rpb25zIiwibWVzc2FnZSIsImxvd2VyTWVzc2FnZSIsInRvTG93ZXJDYXNlIiwiZW1vdGlvblNjb3JlcyIsImVtb3Rpb24iLCJwYXR0ZXJuIiwiT2JqZWN0IiwiZW50cmllcyIsInNjb3JlIiwiY2FsY3VsYXRlRW1vdGlvblNjb3JlIiwicHVzaCIsImluZGljYXRvcnMiLCJnZXRNYXRjaGVkSW5kaWNhdG9ycyIsInNvcnQiLCJhIiwiYiIsInByaW1hcnkiLCJzZWNvbmRhcnkiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25maWRlbmNlIiwiTWF0aCIsIm1pbiIsImludGVuc2l0eSIsImNhbGN1bGF0ZUludGVuc2l0eSIsImFuYWx5emVFbW90aW9uYWxDb250ZXh0Iiwic3VnZ2VzdGVkUmVzcG9uc2UiLCJnZXRTdWdnZXN0ZWRSZXNwb25zZVR5cGUiLCJvcmlnaW5hbE1lc3NhZ2UiLCJtYXRjaGVzIiwia2V5d29yZCIsImluY2x1ZGVzIiwicGhyYXNlIiwidGVzdCIsImNvbnRleHRXb3JkIiwiaW50ZW5zaWZpZXIiLCJtdWx0aXBsaWVyIiwiZm9yRWFjaCIsImluZGV4IiwiaW50ZW5zaWZpZXJzIiwiaGFzSW50ZW5zaWZpZXIiLCJzb21lIiwid29yZCIsInByb3ZpZGVkQ29udGV4dCIsImFjYWRlbWljS2V5d29yZHMiLCJhY2FkZW1pYyIsInBlcnNvbmFsS2V5d29yZHMiLCJwZXJzb25hbCIsInRlbXBvcmFsIiwic3ViamVjdCIsInJlc3BvbnNlTWFwIiwiZ2VuZXJhdGVFbW90aW9uU3VtbWFyeSIsImFuYWx5c2lzIiwiZW1vdGlvbk5hbWVzIiwic3VtbWFyeSIsInRvRml4ZWQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/emotion-analyzer.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/hybrid-storage.ts":
/*!***********************************!*\
  !*** ./src/lib/hybrid-storage.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   canSubmitThisWeek: () => (/* binding */ canSubmitThisWeek),\n/* harmony export */   createProgressReport: () => (/* binding */ createProgressReport),\n/* harmony export */   createUser: () => (/* binding */ createUser),\n/* harmony export */   findProgressReportByUserAndWeek: () => (/* binding */ findProgressReportByUserAndWeek),\n/* harmony export */   findProgressReportsByUser: () => (/* binding */ findProgressReportsByUser),\n/* harmony export */   findUserByEmail: () => (/* binding */ findUserByEmail),\n/* harmony export */   findUserById: () => (/* binding */ findUserById),\n/* harmony export */   findUsersByRole: () => (/* binding */ findUsersByRole),\n/* harmony export */   generateStudentId: () => (/* binding */ generateStudentId),\n/* harmony export */   getAllProgressReports: () => (/* binding */ getAllProgressReports),\n/* harmony export */   getAllUsers: () => (/* binding */ getAllUsers),\n/* harmony export */   getCurrentWeekEnd: () => (/* binding */ getCurrentWeekEnd),\n/* harmony export */   getCurrentWeekStart: () => (/* binding */ getCurrentWeekStart),\n/* harmony export */   getMonthWeeks: () => (/* binding */ getMonthWeeks),\n/* harmony export */   initializeStorage: () => (/* binding */ initializeStorage),\n/* harmony export */   validateStudentId: () => (/* binding */ validateStudentId)\n/* harmony export */ });\n/* harmony import */ var _temp_storage__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./temp-storage */ \"(rsc)/./src/lib/temp-storage.ts\");\n// Hybrid storage system that can work with database or fallback to temp-storage\n\n// For now, use temp-storage exclusively to ensure stability\nconst useDatabase = false;\nconsole.log('🔄 Using temp-storage system for reliability');\n// Initialize the storage system\nasync function initializeStorage() {\n    console.log('✅ Temp-storage system initialized');\n}\n// User management functions with fallback\nasync function createUser(userData) {\n    const hashedPassword = (__webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/umd/index.js\").hashSync)(userData.password, 12);\n    const user = {\n        id: Date.now().toString(),\n        ...userData,\n        password: hashedPassword,\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        status: 'ACTIVE'\n    };\n    _temp_storage__WEBPACK_IMPORTED_MODULE_0__.addUser(user);\n    return user;\n}\nasync function findUserByEmail(email) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.findUserByEmail(email);\n}\nasync function getAllUsers() {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.getAllUsers();\n}\nasync function findUsersByRole(role) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.findUsersByRole(role);\n}\nasync function findUserById(id) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.findUserById(id);\n}\nasync function generateStudentId() {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.generateStudentId();\n}\n// Progress reports functions with fallback\nasync function createProgressReport(data) {\n    const report = {\n        id: Date.now().toString(),\n        userId: data.userId,\n        weekStart: data.weekStart,\n        weekEnd: data.weekEnd,\n        submittedAt: new Date(),\n        responses: data.responses\n    };\n    _temp_storage__WEBPACK_IMPORTED_MODULE_0__.addWeeklyReport(report);\n    return report;\n}\nasync function findProgressReportsByUser(userId) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.findWeeklyReportsByUser(userId);\n}\nasync function getAllProgressReports() {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.getAllWeeklyReports();\n}\nasync function findProgressReportByUserAndWeek(userId, weekStart) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.findWeeklyReportByUserAndWeek(userId, weekStart);\n}\nasync function canSubmitThisWeek(userId) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.canSubmitThisWeek(userId);\n}\n// Utility functions (same for both)\nfunction getCurrentWeekStart() {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.getCurrentWeekStart();\n}\nfunction getCurrentWeekEnd() {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.getCurrentWeekEnd();\n}\nfunction getMonthWeeks(year, month) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.getMonthWeeks(year, month);\n}\nfunction validateStudentId(studentId) {\n    return _temp_storage__WEBPACK_IMPORTED_MODULE_0__.validateStudentId(studentId);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2h5YnJpZC1zdG9yYWdlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsZ0ZBQWdGO0FBQ25DO0FBRTdDLDREQUE0RDtBQUM1RCxNQUFNQyxjQUFjO0FBRXBCQyxRQUFRQyxHQUFHLENBQUM7QUFFWixnQ0FBZ0M7QUFDekIsZUFBZUM7SUFDcEJGLFFBQVFDLEdBQUcsQ0FBQztBQUNkO0FBRUEsMENBQTBDO0FBQ25DLGVBQWVFLFdBQVdDLFFBQWE7SUFDNUMsTUFBTUMsaUJBQWlCQyw0RkFBNEIsQ0FBQ0YsU0FBU0ksUUFBUSxFQUFFO0lBQ3ZFLE1BQU1DLE9BQU87UUFDWEMsSUFBSUMsS0FBS0MsR0FBRyxHQUFHQyxRQUFRO1FBQ3ZCLEdBQUdULFFBQVE7UUFDWEksVUFBVUg7UUFDVlMsV0FBVyxJQUFJSDtRQUNmSSxXQUFXLElBQUlKO1FBQ2ZLLFFBQVE7SUFDVjtJQUNBbEIsa0RBQW1CLENBQUNXO0lBQ3BCLE9BQU9BO0FBQ1Q7QUFFTyxlQUFlUyxnQkFBZ0JDLEtBQWE7SUFDakQsT0FBT3JCLDBEQUEyQixDQUFDcUI7QUFDckM7QUFFTyxlQUFlQztJQUNwQixPQUFPdEIsc0RBQXVCO0FBQ2hDO0FBRU8sZUFBZXVCLGdCQUFnQkMsSUFBUztJQUM3QyxPQUFPeEIsMERBQTJCLENBQUN3QjtBQUNyQztBQUVPLGVBQWVDLGFBQWFiLEVBQVU7SUFDM0MsT0FBT1osdURBQXdCLENBQUNZO0FBQ2xDO0FBRU8sZUFBZWM7SUFDcEIsT0FBTzFCLDREQUE2QjtBQUN0QztBQUVBLDJDQUEyQztBQUNwQyxlQUFlMkIscUJBQXFCQyxJQUFTO0lBQ2xELE1BQU1DLFNBQVM7UUFDYmpCLElBQUlDLEtBQUtDLEdBQUcsR0FBR0MsUUFBUTtRQUN2QmUsUUFBUUYsS0FBS0UsTUFBTTtRQUNuQkMsV0FBV0gsS0FBS0csU0FBUztRQUN6QkMsU0FBU0osS0FBS0ksT0FBTztRQUNyQkMsYUFBYSxJQUFJcEI7UUFDakJxQixXQUFXTixLQUFLTSxTQUFTO0lBQzNCO0lBQ0FsQywwREFBMkIsQ0FBQzZCO0lBQzVCLE9BQU9BO0FBQ1Q7QUFFTyxlQUFlTywwQkFBMEJOLE1BQWM7SUFDNUQsT0FBTzlCLGtFQUFtQyxDQUFDOEI7QUFDN0M7QUFFTyxlQUFlUTtJQUNwQixPQUFPdEMsOERBQStCO0FBQ3hDO0FBRU8sZUFBZXdDLGdDQUFnQ1YsTUFBYyxFQUFFQyxTQUFlO0lBQ25GLE9BQU8vQix3RUFBeUMsQ0FBQzhCLFFBQVFDO0FBQzNEO0FBRU8sZUFBZVcsa0JBQWtCWixNQUFjO0lBQ3BELE9BQU85Qiw0REFBNkIsQ0FBQzhCO0FBQ3ZDO0FBRUEsb0NBQW9DO0FBQzdCLFNBQVNhO0lBQ2QsT0FBTzNDLDhEQUErQjtBQUN4QztBQUVPLFNBQVM0QztJQUNkLE9BQU81Qyw0REFBNkI7QUFDdEM7QUFFTyxTQUFTNkMsY0FBY0MsSUFBWSxFQUFFQyxLQUFhO0lBQ3ZELE9BQU8vQyx3REFBeUIsQ0FBQzhDLE1BQU1DO0FBQ3pDO0FBRU8sU0FBU0Msa0JBQWtCQyxTQUFpQjtJQUNqRCxPQUFPakQsNERBQTZCLENBQUNpRDtBQUN2QyIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9oeWJyaWQtc3RvcmFnZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBIeWJyaWQgc3RvcmFnZSBzeXN0ZW0gdGhhdCBjYW4gd29yayB3aXRoIGRhdGFiYXNlIG9yIGZhbGxiYWNrIHRvIHRlbXAtc3RvcmFnZVxuaW1wb3J0ICogYXMgdGVtcFN0b3JhZ2UgZnJvbSAnLi90ZW1wLXN0b3JhZ2UnXG5cbi8vIEZvciBub3csIHVzZSB0ZW1wLXN0b3JhZ2UgZXhjbHVzaXZlbHkgdG8gZW5zdXJlIHN0YWJpbGl0eVxuY29uc3QgdXNlRGF0YWJhc2UgPSBmYWxzZVxuXG5jb25zb2xlLmxvZygn8J+UhCBVc2luZyB0ZW1wLXN0b3JhZ2Ugc3lzdGVtIGZvciByZWxpYWJpbGl0eScpXG5cbi8vIEluaXRpYWxpemUgdGhlIHN0b3JhZ2Ugc3lzdGVtXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaW5pdGlhbGl6ZVN0b3JhZ2UoKSB7XG4gIGNvbnNvbGUubG9nKCfinIUgVGVtcC1zdG9yYWdlIHN5c3RlbSBpbml0aWFsaXplZCcpXG59XG5cbi8vIFVzZXIgbWFuYWdlbWVudCBmdW5jdGlvbnMgd2l0aCBmYWxsYmFja1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlckRhdGE6IGFueSkge1xuICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IHJlcXVpcmUoJ2JjcnlwdGpzJykuaGFzaFN5bmModXNlckRhdGEucGFzc3dvcmQsIDEyKVxuICBjb25zdCB1c2VyID0ge1xuICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgLi4udXNlckRhdGEsXG4gICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgc3RhdHVzOiAnQUNUSVZFJyBhcyBjb25zdCxcbiAgfVxuICB0ZW1wU3RvcmFnZS5hZGRVc2VyKHVzZXIpXG4gIHJldHVybiB1c2VyXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kVXNlckJ5RW1haWwoZW1haWw6IHN0cmluZykge1xuICByZXR1cm4gdGVtcFN0b3JhZ2UuZmluZFVzZXJCeUVtYWlsKGVtYWlsKVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWxsVXNlcnMoKSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5nZXRBbGxVc2VycygpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kVXNlcnNCeVJvbGUocm9sZTogYW55KSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5maW5kVXNlcnNCeVJvbGUocm9sZSlcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRVc2VyQnlJZChpZDogc3RyaW5nKSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5maW5kVXNlckJ5SWQoaWQpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVN0dWRlbnRJZCgpIHtcbiAgcmV0dXJuIHRlbXBTdG9yYWdlLmdlbmVyYXRlU3R1ZGVudElkKClcbn1cblxuLy8gUHJvZ3Jlc3MgcmVwb3J0cyBmdW5jdGlvbnMgd2l0aCBmYWxsYmFja1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVByb2dyZXNzUmVwb3J0KGRhdGE6IGFueSkge1xuICBjb25zdCByZXBvcnQgPSB7XG4gICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICB1c2VySWQ6IGRhdGEudXNlcklkLFxuICAgIHdlZWtTdGFydDogZGF0YS53ZWVrU3RhcnQsXG4gICAgd2Vla0VuZDogZGF0YS53ZWVrRW5kLFxuICAgIHN1Ym1pdHRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgIHJlc3BvbnNlczogZGF0YS5yZXNwb25zZXNcbiAgfVxuICB0ZW1wU3RvcmFnZS5hZGRXZWVrbHlSZXBvcnQocmVwb3J0KVxuICByZXR1cm4gcmVwb3J0XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaW5kUHJvZ3Jlc3NSZXBvcnRzQnlVc2VyKHVzZXJJZDogc3RyaW5nKSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5maW5kV2Vla2x5UmVwb3J0c0J5VXNlcih1c2VySWQpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGxQcm9ncmVzc1JlcG9ydHMoKSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5nZXRBbGxXZWVrbHlSZXBvcnRzKClcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbmRQcm9ncmVzc1JlcG9ydEJ5VXNlckFuZFdlZWsodXNlcklkOiBzdHJpbmcsIHdlZWtTdGFydDogRGF0ZSkge1xuICByZXR1cm4gdGVtcFN0b3JhZ2UuZmluZFdlZWtseVJlcG9ydEJ5VXNlckFuZFdlZWsodXNlcklkLCB3ZWVrU3RhcnQpXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjYW5TdWJtaXRUaGlzV2Vlayh1c2VySWQ6IHN0cmluZykge1xuICByZXR1cm4gdGVtcFN0b3JhZ2UuY2FuU3VibWl0VGhpc1dlZWsodXNlcklkKVxufVxuXG4vLyBVdGlsaXR5IGZ1bmN0aW9ucyAoc2FtZSBmb3IgYm90aClcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50V2Vla1N0YXJ0KCkge1xuICByZXR1cm4gdGVtcFN0b3JhZ2UuZ2V0Q3VycmVudFdlZWtTdGFydCgpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50V2Vla0VuZCgpIHtcbiAgcmV0dXJuIHRlbXBTdG9yYWdlLmdldEN1cnJlbnRXZWVrRW5kKClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1vbnRoV2Vla3MoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyKSB7XG4gIHJldHVybiB0ZW1wU3RvcmFnZS5nZXRNb250aFdlZWtzKHllYXIsIG1vbnRoKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVTdHVkZW50SWQoc3R1ZGVudElkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRlbXBTdG9yYWdlLnZhbGlkYXRlU3R1ZGVudElkKHN0dWRlbnRJZClcbn0iXSwibmFtZXMiOlsidGVtcFN0b3JhZ2UiLCJ1c2VEYXRhYmFzZSIsImNvbnNvbGUiLCJsb2ciLCJpbml0aWFsaXplU3RvcmFnZSIsImNyZWF0ZVVzZXIiLCJ1c2VyRGF0YSIsImhhc2hlZFBhc3N3b3JkIiwicmVxdWlyZSIsImhhc2hTeW5jIiwicGFzc3dvcmQiLCJ1c2VyIiwiaWQiLCJEYXRlIiwibm93IiwidG9TdHJpbmciLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJzdGF0dXMiLCJhZGRVc2VyIiwiZmluZFVzZXJCeUVtYWlsIiwiZW1haWwiLCJnZXRBbGxVc2VycyIsImZpbmRVc2Vyc0J5Um9sZSIsInJvbGUiLCJmaW5kVXNlckJ5SWQiLCJnZW5lcmF0ZVN0dWRlbnRJZCIsImNyZWF0ZVByb2dyZXNzUmVwb3J0IiwiZGF0YSIsInJlcG9ydCIsInVzZXJJZCIsIndlZWtTdGFydCIsIndlZWtFbmQiLCJzdWJtaXR0ZWRBdCIsInJlc3BvbnNlcyIsImFkZFdlZWtseVJlcG9ydCIsImZpbmRQcm9ncmVzc1JlcG9ydHNCeVVzZXIiLCJmaW5kV2Vla2x5UmVwb3J0c0J5VXNlciIsImdldEFsbFByb2dyZXNzUmVwb3J0cyIsImdldEFsbFdlZWtseVJlcG9ydHMiLCJmaW5kUHJvZ3Jlc3NSZXBvcnRCeVVzZXJBbmRXZWVrIiwiZmluZFdlZWtseVJlcG9ydEJ5VXNlckFuZFdlZWsiLCJjYW5TdWJtaXRUaGlzV2VlayIsImdldEN1cnJlbnRXZWVrU3RhcnQiLCJnZXRDdXJyZW50V2Vla0VuZCIsImdldE1vbnRoV2Vla3MiLCJ5ZWFyIiwibW9udGgiLCJ2YWxpZGF0ZVN0dWRlbnRJZCIsInN0dWRlbnRJZCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/hybrid-storage.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/mode-transition-manager.ts":
/*!********************************************!*\
  !*** ./src/lib/mode-transition-manager.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ModeTransitionManager: () => (/* binding */ ModeTransitionManager)\n/* harmony export */ });\n/* harmony import */ var _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./advanced-intent-engine */ \"(rsc)/./src/lib/advanced-intent-engine.ts\");\n/* harmony import */ var _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./emotion-analyzer */ \"(rsc)/./src/lib/emotion-analyzer.ts\");\n/* harmony import */ var _conversation_memory__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./conversation-memory */ \"(rsc)/./src/lib/conversation-memory.ts\");\n// Sistema de Gestión de Transiciones entre Modos Conversacionales\n// Optimiza el cambio fluido entre modos según el contexto y necesidades del estudiante\n\n\n\nclass ModeTransitionManager {\n    static{\n        // Patrones que indican necesidad de cambio de modo\n        this.MODE_TRIGGERS = {\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING]: {\n                patterns: [\n                    /necesito\\s+(ayuda|explicación|que\\s+me\\s+expliques)/i,\n                    /no\\s+(entiendo|comprendo|sé\\s+cómo)/i,\n                    /podrías\\s+(explicar|enseñar|mostrar)/i,\n                    /cómo\\s+(se\\s+hace|funciona|resuelvo)/i,\n                    /ejercicio|problema|tarea|concepto/i,\n                    /paso\\s+a\\s+paso/i\n                ],\n                emotions: [\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CONFUSED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CURIOUS,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.FRUSTRATED\n                ],\n                transitionMessage: \"Perfecto, cambiemos al modo tutoría. Voy a explicarte esto paso a paso para que lo entiendas completamente.\"\n            },\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING]: {\n                patterns: [\n                    /necesito\\s+(planificar|organizar|estructurar)/i,\n                    /cómo\\s+organizo\\s+mi\\s+(tiempo|estudio|horario)/i,\n                    /plan\\s+de\\s+estudio/i,\n                    /cronograma|calendario|agenda/i,\n                    /estrategia\\s+de\\s+estudio/i,\n                    /objetivos|metas|propósitos/i,\n                    /deadlines?|fechas?\\s+límite/i\n                ],\n                emotions: [\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.OVERWHELMED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.MOTIVATED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.ANXIOUS\n                ],\n                transitionMessage: \"Excelente idea planificar. Vamos a crear una estrategia estructurada que te ayude a alcanzar tus objetivos de manera eficiente.\"\n            },\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING]: {\n                patterns: [\n                    /mis\\s+(materiales|archivos|apuntes|recursos)/i,\n                    /dónde\\s+(guardo|organizo|encuentro)/i,\n                    /gestionar\\s+(documentos|tareas|información)/i,\n                    /sistema\\s+de\\s+organización/i,\n                    /orden|estructura|clasificar/i,\n                    /productividad|eficiencia/i\n                ],\n                emotions: [\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.OVERWHELMED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CONFUSED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.MOTIVATED\n                ],\n                transitionMessage: \"Perfecto, organicemos todo de manera sistemática. Un buen sistema de organización es clave para el éxito académico.\"\n            },\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING]: {\n                patterns: [\n                    /mi\\s+(progreso|rendimiento|avance)/i,\n                    /cómo\\s+(voy|estoy\\s+haciendo|me\\s+va)/i,\n                    /analizar\\s+(resultados|calificaciones|notas)/i,\n                    /feedback|retroalimentación/i,\n                    /qué\\s+(puedo\\s+mejorar|necesito\\s+cambiar)/i,\n                    /evaluación|reflexión/i,\n                    /fortalezas\\s+y\\s+debilidades/i\n                ],\n                emotions: [\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.DISAPPOINTED,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.PROUD,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CURIOUS,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.MOTIVATED\n                ],\n                transitionMessage: \"Muy bien, analicemos tu progreso juntos. La reflexión sobre tu aprendizaje es fundamental para mejorar continuamente.\"\n            },\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING]: {\n                patterns: [\n                    /cómo\\s+(estás|te\\s+va|andas)/i,\n                    /hola|hi|buenos\\s+días|buenas\\s+tardes/i,\n                    /quería\\s+platicar/i,\n                    /me\\s+siento/i,\n                    /solo\\s+quería\\s+decir/i,\n                    /gracias\\s+por/i,\n                    /charlemos|conversemos/i\n                ],\n                emotions: [\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.HAPPY,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.GRATEFUL,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.SAD,\n                    _emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.EXCITED\n                ],\n                transitionMessage: \"Me da mucho gusto conversar contigo. Estoy aquí para escucharte y apoyarte en lo que necesites.\"\n            }\n        };\n    }\n    static{\n        // Reglas de transición específicas entre modos\n        this.TRANSITION_RULES = {\n            // Desde CHATTING hacia otros modos\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: {\n                confidence: 0.8,\n                reason: \"El estudiante necesita ayuda académica específica\",\n                suggestedDuration: 25\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: {\n                confidence: 0.85,\n                reason: \"El estudiante quiere organizar su tiempo de estudio\",\n                suggestedDuration: 15\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}`]: {\n                confidence: 0.8,\n                reason: \"El estudiante necesita organizar materiales o recursos\",\n                suggestedDuration: 20\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}`]: {\n                confidence: 0.9,\n                reason: \"El estudiante quiere analizar su progreso académico\",\n                suggestedDuration: 15\n            },\n            // Desde TUTORING hacia otros modos\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: {\n                confidence: 0.75,\n                reason: \"Después de aprender, el estudiante quiere planificar práctica adicional\",\n                suggestedDuration: 10\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}`]: {\n                confidence: 0.7,\n                reason: \"El estudiante necesita organizar el material aprendido\",\n                suggestedDuration: 10\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}`]: {\n                confidence: 0.8,\n                reason: \"Es momento de evaluar la comprensión del tema\",\n                suggestedDuration: 10\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}`]: {\n                confidence: 0.6,\n                reason: \"El estudiante quiere una pausa o expresar emociones\",\n                suggestedDuration: 5\n            },\n            // Desde PLANNING hacia otros modos\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: {\n                confidence: 0.9,\n                reason: \"Es hora de ejecutar el plan con estudio específico\",\n                suggestedDuration: 30\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}`]: {\n                confidence: 0.85,\n                reason: \"Necesita organizar recursos para ejecutar el plan\",\n                suggestedDuration: 15\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}`]: {\n                confidence: 0.7,\n                reason: \"Quiere evaluar planes anteriores antes de crear nuevos\",\n                suggestedDuration: 10\n            },\n            // Desde ORGANIZING hacia otros modos\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: {\n                confidence: 0.8,\n                reason: \"Con recursos organizados, es momento de planificar su uso\",\n                suggestedDuration: 15\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: {\n                confidence: 0.75,\n                reason: \"Con materiales listos, puede enfocarse en aprender\",\n                suggestedDuration: 25\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}`]: {\n                confidence: 0.7,\n                reason: \"Quiere evaluar la efectividad de su organización\",\n                suggestedDuration: 10\n            },\n            // Desde REVIEWING hacia otros modos\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: {\n                confidence: 0.9,\n                reason: \"Basado en la revisión, necesita crear nuevos planes\",\n                suggestedDuration: 20\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: {\n                confidence: 0.85,\n                reason: \"Identificó áreas que necesita reforzar\",\n                suggestedDuration: 30\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING}`]: {\n                confidence: 0.7,\n                reason: \"Necesita reorganizar materiales basado en la evaluación\",\n                suggestedDuration: 15\n            },\n            [`${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}`]: {\n                confidence: 0.8,\n                reason: \"Quiere procesar emocionalmente los resultados de la revisión\",\n                suggestedDuration: 10\n            }\n        };\n    }\n    static{\n        // Factores que afectan las transiciones\n        this.TRANSITION_FACTORS = {\n            // Tiempo en modo actual afecta la disposición al cambio\n            timeFactors: {\n                tooShort: 3,\n                optimal: 15,\n                tooLong: 45 // minutos - demasiado tiempo, necesita cambio\n            },\n            // Emociones que favorecen ciertos modos\n            emotionalBias: {\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.FRUSTRATED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.OVERWHELMED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CONFUSED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.MOTIVATED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.PROUD]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CURIOUS]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.GRATEFUL]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.ANXIOUS]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.EXCITED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING\n                ],\n                [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.BORED]: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING\n                ]\n            },\n            // Urgencia afecta preferencia de modo\n            urgencyBias: {\n                high: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING\n                ],\n                medium: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING\n                ],\n                low: [\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING,\n                    _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING\n                ]\n            }\n        };\n    }\n    /**\n   * Analiza si debería sugerir una transición de modo\n   */ static analyzeTransitionNeed(context) {\n        const { currentMode, message, emotion, timeInCurrentMode = 0, urgency = 'medium' } = context;\n        // 1. Buscar triggers explícitos en el mensaje\n        const explicitTransition = this.findExplicitModeTransition(message, currentMode);\n        if (explicitTransition) return explicitTransition;\n        // 2. Analizar basado en emoción y tiempo\n        const emotionalTransition = this.analyzeEmotionalTransition(currentMode, emotion, timeInCurrentMode);\n        if (emotionalTransition) return emotionalTransition;\n        // 3. Considerar tiempo excesivo en modo actual\n        const timeBasedTransition = this.analyzeTimeBasedTransition(context);\n        if (timeBasedTransition) return timeBasedTransition;\n        // 4. Analizar patrones de memoria si está disponible\n        if (context.userId) {\n            const memoryBasedTransition = this.analyzeMemoryPatterns(context);\n            if (memoryBasedTransition) return memoryBasedTransition;\n        }\n        return null;\n    }\n    /**\n   * Busca triggers explícitos de cambio de modo en el mensaje\n   */ static findExplicitModeTransition(message, currentMode) {\n        for (const [targetMode, config] of Object.entries(this.MODE_TRIGGERS)){\n            if (targetMode === currentMode) continue; // No cambiar al mismo modo\n            const modeEnum = targetMode;\n            // Verificar patrones textuales\n            const hasTextTrigger = config.patterns.some((pattern)=>pattern.test(message));\n            if (hasTextTrigger) {\n                const transitionKey = `${currentMode}_${modeEnum}`;\n                const rule = this.TRANSITION_RULES[transitionKey];\n                return {\n                    fromMode: currentMode,\n                    toMode: modeEnum,\n                    confidence: rule?.confidence || 0.7,\n                    reason: rule?.reason || `Trigger textual detectado para ${modeEnum}`,\n                    triggers: [\n                        `Patrón textual para ${modeEnum}`\n                    ],\n                    transitionMessage: config.transitionMessage,\n                    suggestedDuration: rule?.suggestedDuration\n                };\n            }\n        }\n        return null;\n    }\n    /**\n   * Analiza transición basada en estado emocional\n   */ static analyzeEmotionalTransition(currentMode, emotion, timeInCurrentMode) {\n        const emotionalPreferences = this.TRANSITION_FACTORS.emotionalBias[emotion] || [];\n        for (const preferredMode of emotionalPreferences){\n            if (preferredMode === currentMode) continue;\n            // Si lleva suficiente tiempo en el modo actual y la emoción sugiere cambio\n            if (timeInCurrentMode >= this.TRANSITION_FACTORS.timeFactors.tooShort) {\n                const transitionKey = `${currentMode}_${preferredMode}`;\n                const rule = this.TRANSITION_RULES[transitionKey];\n                if (rule) {\n                    return {\n                        fromMode: currentMode,\n                        toMode: preferredMode,\n                        confidence: rule.confidence * 0.8,\n                        reason: `Estado emocional (${emotion}) sugiere cambio hacia ${preferredMode}`,\n                        triggers: [\n                            `Emoción: ${emotion}`\n                        ],\n                        transitionMessage: this.generateEmotionalTransitionMessage(emotion, preferredMode),\n                        suggestedDuration: rule.suggestedDuration\n                    };\n                }\n            }\n        }\n        return null;\n    }\n    /**\n   * Analiza transiciones basadas en tiempo excesivo en modo actual\n   */ static analyzeTimeBasedTransition(context) {\n        const { currentMode, timeInCurrentMode = 0, emotion, previousModes = [] } = context;\n        // Si ha estado demasiado tiempo en el modo actual\n        if (timeInCurrentMode >= this.TRANSITION_FACTORS.timeFactors.tooLong) {\n            // Sugerir un modo complementario que no haya usado recientemente\n            const complementaryModes = this.getComplementaryModes(currentMode);\n            const freshMode = complementaryModes.find((mode)=>!previousModes.slice(-2).includes(mode));\n            if (freshMode) {\n                const transitionKey = `${currentMode}_${freshMode}`;\n                const rule = this.TRANSITION_RULES[transitionKey];\n                return {\n                    fromMode: currentMode,\n                    toMode: freshMode,\n                    confidence: 0.6,\n                    reason: `Tiempo excesivo en ${currentMode} (${timeInCurrentMode} min)`,\n                    triggers: [\n                        `Tiempo: ${timeInCurrentMode} minutos`\n                    ],\n                    transitionMessage: `Has estado enfocado en ${currentMode} por un buen tiempo. ¿Te parece si cambiamos hacia ${freshMode} para variar un poco?`,\n                    suggestedDuration: rule?.suggestedDuration || 15\n                };\n            }\n        }\n        return null;\n    }\n    /**\n   * Analiza patrones en la memoria conversacional para sugerir transiciones\n   */ static analyzeMemoryPatterns(context) {\n        if (!context.userId) return null;\n        const memory = _conversation_memory__WEBPACK_IMPORTED_MODULE_2__.ConversationMemoryManager.getMemory(context.userId, context.sessionId);\n        // Si el estudiante frecuentemente necesita ayuda con planificación\n        const planningTopics = memory.recurringTopics.filter((t)=>[\n                'planificar',\n                'organizar',\n                'tiempo',\n                'horario'\n            ].some((keyword)=>t.topic.includes(keyword)));\n        if (planningTopics.length > 0 && context.currentMode !== _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING) {\n            return {\n                fromMode: context.currentMode,\n                toMode: _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                confidence: 0.65,\n                reason: \"Patrón histórico muestra necesidad recurrente de planificación\",\n                triggers: [\n                    \"Memoria: Temas de planificación recurrentes\"\n                ],\n                transitionMessage: \"He notado que frecuentemente trabajamos en planificación. ¿Te gustaría que organicemos tu estrategia de estudio?\",\n                suggestedDuration: 20\n            };\n        }\n        // Si el nivel de motivación está bajo, sugerir revisión para identificar problemas\n        if (memory.emotionalProfile.motivationLevel < 4 && context.currentMode !== _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING) {\n            return {\n                fromMode: context.currentMode,\n                toMode: _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING,\n                confidence: 0.7,\n                reason: \"Bajo nivel de motivación sugiere necesidad de revisión y análisis\",\n                triggers: [\n                    \"Memoria: Motivación baja\"\n                ],\n                transitionMessage: \"He notado que tu motivación ha estado un poco baja últimamente. ¿Te parece si analizamos juntos cómo van las cosas para identificar qué podemos mejorar?\",\n                suggestedDuration: 15\n            };\n        }\n        return null;\n    }\n    /**\n   * Obtiene modos complementarios para el modo actual\n   */ static getComplementaryModes(currentMode) {\n        const complementaryMap = {\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING]: [\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING\n            ],\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING]: [\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING\n            ],\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING]: [\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING\n            ],\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING]: [\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING\n            ],\n            [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING]: [\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING,\n                _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING\n            ]\n        };\n        return complementaryMap[currentMode] || [];\n    }\n    /**\n   * Genera mensaje de transición basado en emoción\n   */ static generateEmotionalTransitionMessage(emotion, targetMode) {\n        const emotionalTransitions = {\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.FRUSTRATED}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: \"Veo que te sientes frustrado. Cambiemos al modo tutoría para abordar esto paso a paso y aclarar las dudas.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.OVERWHELMED}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: \"Cuando nos sentimos abrumados, la planificación puede ayudar mucho. Organicemos todo de manera manejable.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.CONFUSED}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING}`]: \"La confusión es normal cuando aprendemos. Pasemos al modo tutoría para aclarar todo punto por punto.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.MOTIVATED}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING}`]: \"¡Me encanta ver tu motivación! Aprovechemos esta energía para crear un plan efectivo.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.PROUD}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING}`]: \"Es genial que te sientas orgulloso. Analicemos juntos lo que has logrado para seguir construyendo sobre estos éxitos.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_1__.EmotionType.ANXIOUS}_${_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING}`]: \"Cuando sentimos ansiedad, a veces es útil hablar de ello. Tomemos un momento para procesar estas emociones.\"\n        };\n        const key = `${emotion}_${targetMode}`;\n        return emotionalTransitions[key] || `Basándome en cómo te sientes, creo que sería útil cambiar hacia ${targetMode}.`;\n    }\n    /**\n   * Evalúa la calidad de una transición propuesta\n   */ static evaluateTransitionQuality(transition, context) {\n        let quality = transition.confidence;\n        // Bonificar si hay múltiples triggers\n        if (transition.triggers.length > 1) {\n            quality += 0.1;\n        }\n        // Penalizar cambios muy frecuentes\n        if (context.timeInCurrentMode && context.timeInCurrentMode < this.TRANSITION_FACTORS.timeFactors.tooShort) {\n            quality -= 0.2;\n        }\n        // Bonificar si la urgencia coincide\n        if (context.urgency === 'high' && [\n            _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING,\n            _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING\n        ].includes(transition.toMode)) {\n            quality += 0.1;\n        }\n        return Math.max(0, Math.min(1, quality));\n    }\n    /**\n   * Genera estadísticas del sistema de transiciones\n   */ static getTransitionStats() {\n        const totalRules = Object.keys(this.TRANSITION_RULES).length;\n        const modeConnections = Object.values(_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode).map((mode)=>{\n            const outgoing = Object.keys(this.TRANSITION_RULES).filter((key)=>key.startsWith(mode)).length;\n            const incoming = Object.keys(this.TRANSITION_RULES).filter((key)=>key.endsWith(mode)).length;\n            return {\n                mode,\n                outgoing,\n                incoming,\n                total: outgoing + incoming\n            };\n        });\n        return {\n            totalTransitionRules: totalRules,\n            modeConnections,\n            averageConnectionsPerMode: totalRules / Object.values(_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode).length,\n            emotionalTriggers: Object.keys(this.TRANSITION_FACTORS.emotionalBias).length,\n            patternTriggers: Object.values(this.MODE_TRIGGERS).reduce((sum, config)=>sum + config.patterns.length, 0)\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL21vZGUtdHJhbnNpdGlvbi1tYW5hZ2VyLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQSxrRUFBa0U7QUFDbEUsdUZBQXVGO0FBRTVCO0FBQ1g7QUFDaUI7QUF3QjFELE1BQU1HOztRQUVYLG1EQUFtRDthQUMzQkMsZ0JBQWdCO1lBRXRDLENBQUNKLHFFQUFnQkEsQ0FBQ0ssUUFBUSxDQUFDLEVBQUU7Z0JBQzNCQyxVQUFVO29CQUNSO29CQUNBO29CQUNBO29CQUNBO29CQUNBO29CQUNBO2lCQUNEO2dCQUNEQyxVQUFVO29CQUFDTiwwREFBV0EsQ0FBQ08sUUFBUTtvQkFBRVAsMERBQVdBLENBQUNRLE9BQU87b0JBQUVSLDBEQUFXQSxDQUFDUyxVQUFVO2lCQUFDO2dCQUM3RUMsbUJBQW1CO1lBQ3JCO1lBRUEsQ0FBQ1gscUVBQWdCQSxDQUFDWSxRQUFRLENBQUMsRUFBRTtnQkFDM0JOLFVBQVU7b0JBQ1I7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7aUJBQ0Q7Z0JBQ0RDLFVBQVU7b0JBQUNOLDBEQUFXQSxDQUFDWSxXQUFXO29CQUFFWiwwREFBV0EsQ0FBQ2EsU0FBUztvQkFBRWIsMERBQVdBLENBQUNjLE9BQU87aUJBQUM7Z0JBQy9FSixtQkFBbUI7WUFDckI7WUFFQSxDQUFDWCxxRUFBZ0JBLENBQUNnQixVQUFVLENBQUMsRUFBRTtnQkFDN0JWLFVBQVU7b0JBQ1I7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7aUJBQ0Q7Z0JBQ0RDLFVBQVU7b0JBQUNOLDBEQUFXQSxDQUFDWSxXQUFXO29CQUFFWiwwREFBV0EsQ0FBQ08sUUFBUTtvQkFBRVAsMERBQVdBLENBQUNhLFNBQVM7aUJBQUM7Z0JBQ2hGSCxtQkFBbUI7WUFDckI7WUFFQSxDQUFDWCxxRUFBZ0JBLENBQUNpQixTQUFTLENBQUMsRUFBRTtnQkFDNUJYLFVBQVU7b0JBQ1I7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7b0JBQ0E7aUJBQ0Q7Z0JBQ0RDLFVBQVU7b0JBQUNOLDBEQUFXQSxDQUFDaUIsWUFBWTtvQkFBRWpCLDBEQUFXQSxDQUFDa0IsS0FBSztvQkFBRWxCLDBEQUFXQSxDQUFDUSxPQUFPO29CQUFFUiwwREFBV0EsQ0FBQ2EsU0FBUztpQkFBQztnQkFDbkdILG1CQUFtQjtZQUNyQjtZQUVBLENBQUNYLHFFQUFnQkEsQ0FBQ29CLFFBQVEsQ0FBQyxFQUFFO2dCQUMzQmQsVUFBVTtvQkFDUjtvQkFDQTtvQkFDQTtvQkFDQTtvQkFDQTtvQkFDQTtvQkFDQTtpQkFDRDtnQkFDREMsVUFBVTtvQkFBQ04sMERBQVdBLENBQUNvQixLQUFLO29CQUFFcEIsMERBQVdBLENBQUNxQixRQUFRO29CQUFFckIsMERBQVdBLENBQUNzQixHQUFHO29CQUFFdEIsMERBQVdBLENBQUN1QixPQUFPO2lCQUFDO2dCQUN6RmIsbUJBQW1CO1lBQ3JCO1FBQ0Y7OztRQUVBLCtDQUErQzthQUN2QmMsbUJBQW1CO1lBRXpDLG1DQUFtQztZQUNuQyxDQUFDLEdBQUd6QixxRUFBZ0JBLENBQUNvQixRQUFRLENBQUMsQ0FBQyxFQUFFcEIscUVBQWdCQSxDQUFDSyxRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM3RHFCLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUNBLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ29CLFFBQVEsQ0FBQyxDQUFDLEVBQUVwQixxRUFBZ0JBLENBQUNZLFFBQVEsRUFBRSxDQUFDLEVBQUU7Z0JBQzdEYyxZQUFZO2dCQUNaQyxRQUFRO2dCQUNSQyxtQkFBbUI7WUFDckI7WUFDQSxDQUFDLEdBQUc1QixxRUFBZ0JBLENBQUNvQixRQUFRLENBQUMsQ0FBQyxFQUFFcEIscUVBQWdCQSxDQUFDZ0IsVUFBVSxFQUFFLENBQUMsRUFBRTtnQkFDL0RVLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUNBLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ29CLFFBQVEsQ0FBQyxDQUFDLEVBQUVwQixxRUFBZ0JBLENBQUNpQixTQUFTLEVBQUUsQ0FBQyxFQUFFO2dCQUM5RFMsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBRUEsbUNBQW1DO1lBQ25DLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ0ssUUFBUSxDQUFDLENBQUMsRUFBRUwscUVBQWdCQSxDQUFDWSxRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM3RGMsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBQ0EsQ0FBQyxHQUFHNUIscUVBQWdCQSxDQUFDSyxRQUFRLENBQUMsQ0FBQyxFQUFFTCxxRUFBZ0JBLENBQUNnQixVQUFVLEVBQUUsQ0FBQyxFQUFFO2dCQUMvRFUsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBQ0EsQ0FBQyxHQUFHNUIscUVBQWdCQSxDQUFDSyxRQUFRLENBQUMsQ0FBQyxFQUFFTCxxRUFBZ0JBLENBQUNpQixTQUFTLEVBQUUsQ0FBQyxFQUFFO2dCQUM5RFMsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBQ0EsQ0FBQyxHQUFHNUIscUVBQWdCQSxDQUFDSyxRQUFRLENBQUMsQ0FBQyxFQUFFTCxxRUFBZ0JBLENBQUNvQixRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM3RE0sWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBRUEsbUNBQW1DO1lBQ25DLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ1ksUUFBUSxDQUFDLENBQUMsRUFBRVoscUVBQWdCQSxDQUFDSyxRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM3RHFCLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUNBLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ1ksUUFBUSxDQUFDLENBQUMsRUFBRVoscUVBQWdCQSxDQUFDZ0IsVUFBVSxFQUFFLENBQUMsRUFBRTtnQkFDL0RVLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUNBLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ1ksUUFBUSxDQUFDLENBQUMsRUFBRVoscUVBQWdCQSxDQUFDaUIsU0FBUyxFQUFFLENBQUMsRUFBRTtnQkFDOURTLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUVBLHFDQUFxQztZQUNyQyxDQUFDLEdBQUc1QixxRUFBZ0JBLENBQUNnQixVQUFVLENBQUMsQ0FBQyxFQUFFaEIscUVBQWdCQSxDQUFDWSxRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUMvRGMsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBQ0EsQ0FBQyxHQUFHNUIscUVBQWdCQSxDQUFDZ0IsVUFBVSxDQUFDLENBQUMsRUFBRWhCLHFFQUFnQkEsQ0FBQ0ssUUFBUSxFQUFFLENBQUMsRUFBRTtnQkFDL0RxQixZQUFZO2dCQUNaQyxRQUFRO2dCQUNSQyxtQkFBbUI7WUFDckI7WUFDQSxDQUFDLEdBQUc1QixxRUFBZ0JBLENBQUNnQixVQUFVLENBQUMsQ0FBQyxFQUFFaEIscUVBQWdCQSxDQUFDaUIsU0FBUyxFQUFFLENBQUMsRUFBRTtnQkFDaEVTLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUVBLG9DQUFvQztZQUNwQyxDQUFDLEdBQUc1QixxRUFBZ0JBLENBQUNpQixTQUFTLENBQUMsQ0FBQyxFQUFFakIscUVBQWdCQSxDQUFDWSxRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM5RGMsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1lBQ0EsQ0FBQyxHQUFHNUIscUVBQWdCQSxDQUFDaUIsU0FBUyxDQUFDLENBQUMsRUFBRWpCLHFFQUFnQkEsQ0FBQ0ssUUFBUSxFQUFFLENBQUMsRUFBRTtnQkFDOURxQixZQUFZO2dCQUNaQyxRQUFRO2dCQUNSQyxtQkFBbUI7WUFDckI7WUFDQSxDQUFDLEdBQUc1QixxRUFBZ0JBLENBQUNpQixTQUFTLENBQUMsQ0FBQyxFQUFFakIscUVBQWdCQSxDQUFDZ0IsVUFBVSxFQUFFLENBQUMsRUFBRTtnQkFDaEVVLFlBQVk7Z0JBQ1pDLFFBQVE7Z0JBQ1JDLG1CQUFtQjtZQUNyQjtZQUNBLENBQUMsR0FBRzVCLHFFQUFnQkEsQ0FBQ2lCLFNBQVMsQ0FBQyxDQUFDLEVBQUVqQixxRUFBZ0JBLENBQUNvQixRQUFRLEVBQUUsQ0FBQyxFQUFFO2dCQUM5RE0sWUFBWTtnQkFDWkMsUUFBUTtnQkFDUkMsbUJBQW1CO1lBQ3JCO1FBQ0Y7OztRQUVBLHdDQUF3QzthQUNoQkMscUJBQXFCO1lBRTNDLHdEQUF3RDtZQUN4REMsYUFBYTtnQkFDWEMsVUFBVTtnQkFDVkMsU0FBUztnQkFDVEMsU0FBUyxHQUFJLDhDQUE4QztZQUM3RDtZQUVBLHdDQUF3QztZQUN4Q0MsZUFBZTtnQkFDYixDQUFDakMsMERBQVdBLENBQUNTLFVBQVUsQ0FBQyxFQUFFO29CQUFDVixxRUFBZ0JBLENBQUNLLFFBQVE7b0JBQUVMLHFFQUFnQkEsQ0FBQ29CLFFBQVE7aUJBQUM7Z0JBQ2hGLENBQUNuQiwwREFBV0EsQ0FBQ1ksV0FBVyxDQUFDLEVBQUU7b0JBQUNiLHFFQUFnQkEsQ0FBQ1ksUUFBUTtvQkFBRVoscUVBQWdCQSxDQUFDZ0IsVUFBVTtpQkFBQztnQkFDbkYsQ0FBQ2YsMERBQVdBLENBQUNPLFFBQVEsQ0FBQyxFQUFFO29CQUFDUixxRUFBZ0JBLENBQUNLLFFBQVE7aUJBQUM7Z0JBQ25ELENBQUNKLDBEQUFXQSxDQUFDYSxTQUFTLENBQUMsRUFBRTtvQkFBQ2QscUVBQWdCQSxDQUFDWSxRQUFRO29CQUFFWixxRUFBZ0JBLENBQUNLLFFBQVE7aUJBQUM7Z0JBQy9FLENBQUNKLDBEQUFXQSxDQUFDa0IsS0FBSyxDQUFDLEVBQUU7b0JBQUNuQixxRUFBZ0JBLENBQUNpQixTQUFTO29CQUFFakIscUVBQWdCQSxDQUFDb0IsUUFBUTtpQkFBQztnQkFDNUUsQ0FBQ25CLDBEQUFXQSxDQUFDUSxPQUFPLENBQUMsRUFBRTtvQkFBQ1QscUVBQWdCQSxDQUFDSyxRQUFRO2lCQUFDO2dCQUNsRCxDQUFDSiwwREFBV0EsQ0FBQ3FCLFFBQVEsQ0FBQyxFQUFFO29CQUFDdEIscUVBQWdCQSxDQUFDb0IsUUFBUTtvQkFBRXBCLHFFQUFnQkEsQ0FBQ2lCLFNBQVM7aUJBQUM7Z0JBQy9FLENBQUNoQiwwREFBV0EsQ0FBQ2MsT0FBTyxDQUFDLEVBQUU7b0JBQUNmLHFFQUFnQkEsQ0FBQ1ksUUFBUTtvQkFBRVoscUVBQWdCQSxDQUFDb0IsUUFBUTtpQkFBQztnQkFDN0UsQ0FBQ25CLDBEQUFXQSxDQUFDdUIsT0FBTyxDQUFDLEVBQUU7b0JBQUN4QixxRUFBZ0JBLENBQUNLLFFBQVE7b0JBQUVMLHFFQUFnQkEsQ0FBQ1ksUUFBUTtpQkFBQztnQkFDN0UsQ0FBQ1gsMERBQVdBLENBQUNrQyxLQUFLLENBQUMsRUFBRTtvQkFBQ25DLHFFQUFnQkEsQ0FBQ29CLFFBQVE7b0JBQUVwQixxRUFBZ0JBLENBQUNnQixVQUFVO2lCQUFDO1lBQy9FO1lBRUEsc0NBQXNDO1lBQ3RDb0IsYUFBYTtnQkFDWEMsTUFBTTtvQkFBQ3JDLHFFQUFnQkEsQ0FBQ0ssUUFBUTtvQkFBRUwscUVBQWdCQSxDQUFDWSxRQUFRO2lCQUFDO2dCQUM1RDBCLFFBQVE7b0JBQUN0QyxxRUFBZ0JBLENBQUNLLFFBQVE7b0JBQUVMLHFFQUFnQkEsQ0FBQ2dCLFVBQVU7b0JBQUVoQixxRUFBZ0JBLENBQUNZLFFBQVE7aUJBQUM7Z0JBQzNGMkIsS0FBSztvQkFBQ3ZDLHFFQUFnQkEsQ0FBQ29CLFFBQVE7b0JBQUVwQixxRUFBZ0JBLENBQUNpQixTQUFTO29CQUFFakIscUVBQWdCQSxDQUFDZ0IsVUFBVTtpQkFBQztZQUMzRjtRQUNGOztJQUVBOztHQUVDLEdBQ0QsT0FBT3dCLHNCQUFzQkMsT0FBMEIsRUFBeUI7UUFDOUUsTUFBTSxFQUFFQyxXQUFXLEVBQUVDLE9BQU8sRUFBRUMsT0FBTyxFQUFFQyxvQkFBb0IsQ0FBQyxFQUFFQyxVQUFVLFFBQVEsRUFBRSxHQUFHTDtRQUVyRiw4Q0FBOEM7UUFDOUMsTUFBTU0scUJBQXFCLElBQUksQ0FBQ0MsMEJBQTBCLENBQUNMLFNBQVNEO1FBQ3BFLElBQUlLLG9CQUFvQixPQUFPQTtRQUUvQix5Q0FBeUM7UUFDekMsTUFBTUUsc0JBQXNCLElBQUksQ0FBQ0MsMEJBQTBCLENBQUNSLGFBQWFFLFNBQVNDO1FBQ2xGLElBQUlJLHFCQUFxQixPQUFPQTtRQUVoQywrQ0FBK0M7UUFDL0MsTUFBTUUsc0JBQXNCLElBQUksQ0FBQ0MsMEJBQTBCLENBQUNYO1FBQzVELElBQUlVLHFCQUFxQixPQUFPQTtRQUVoQyxxREFBcUQ7UUFDckQsSUFBSVYsUUFBUVksTUFBTSxFQUFFO1lBQ2xCLE1BQU1DLHdCQUF3QixJQUFJLENBQUNDLHFCQUFxQixDQUFDZDtZQUN6RCxJQUFJYSx1QkFBdUIsT0FBT0E7UUFDcEM7UUFFQSxPQUFPO0lBQ1Q7SUFFQTs7R0FFQyxHQUNELE9BQWVOLDJCQUEyQkwsT0FBZSxFQUFFRCxXQUE2QixFQUF5QjtRQUMvRyxLQUFLLE1BQU0sQ0FBQ2MsWUFBWUMsT0FBTyxJQUFJQyxPQUFPQyxPQUFPLENBQUMsSUFBSSxDQUFDdkQsYUFBYSxFQUFHO1lBQ3JFLElBQUlvRCxlQUFlZCxhQUFhLFVBQVMsMkJBQTJCO1lBRXBFLE1BQU1rQixXQUFXSjtZQUVqQiwrQkFBK0I7WUFDL0IsTUFBTUssaUJBQWlCSixPQUFPbkQsUUFBUSxDQUFDd0QsSUFBSSxDQUFDQyxDQUFBQSxVQUFXQSxRQUFRQyxJQUFJLENBQUNyQjtZQUVwRSxJQUFJa0IsZ0JBQWdCO2dCQUNsQixNQUFNSSxnQkFBZ0IsR0FBR3ZCLFlBQVksQ0FBQyxFQUFFa0IsVUFBVTtnQkFDbEQsTUFBTU0sT0FBTyxJQUFJLENBQUN6QyxnQkFBZ0IsQ0FBQ3dDLGNBQWM7Z0JBRWpELE9BQU87b0JBQ0xFLFVBQVV6QjtvQkFDVjBCLFFBQVFSO29CQUNSbEMsWUFBWXdDLE1BQU14QyxjQUFjO29CQUNoQ0MsUUFBUXVDLE1BQU12QyxVQUFVLENBQUMsK0JBQStCLEVBQUVpQyxVQUFVO29CQUNwRVMsVUFBVTt3QkFBQyxDQUFDLG9CQUFvQixFQUFFVCxVQUFVO3FCQUFDO29CQUM3Q2pELG1CQUFtQjhDLE9BQU85QyxpQkFBaUI7b0JBQzNDaUIsbUJBQW1Cc0MsTUFBTXRDO2dCQUMzQjtZQUNGO1FBQ0Y7UUFFQSxPQUFPO0lBQ1Q7SUFFQTs7R0FFQyxHQUNELE9BQWVzQiwyQkFDYlIsV0FBNkIsRUFDN0JFLE9BQW9CLEVBQ3BCQyxpQkFBeUIsRUFDRjtRQUV2QixNQUFNeUIsdUJBQXVCLElBQUksQ0FBQ3pDLGtCQUFrQixDQUFDSyxhQUFhLENBQUNVLFFBQVEsSUFBSSxFQUFFO1FBRWpGLEtBQUssTUFBTTJCLGlCQUFpQkQscUJBQXNCO1lBQ2hELElBQUlDLGtCQUFrQjdCLGFBQWE7WUFFbkMsMkVBQTJFO1lBQzNFLElBQUlHLHFCQUFxQixJQUFJLENBQUNoQixrQkFBa0IsQ0FBQ0MsV0FBVyxDQUFDQyxRQUFRLEVBQUU7Z0JBQ3JFLE1BQU1rQyxnQkFBZ0IsR0FBR3ZCLFlBQVksQ0FBQyxFQUFFNkIsZUFBZTtnQkFDdkQsTUFBTUwsT0FBTyxJQUFJLENBQUN6QyxnQkFBZ0IsQ0FBQ3dDLGNBQWM7Z0JBRWpELElBQUlDLE1BQU07b0JBQ1IsT0FBTzt3QkFDTEMsVUFBVXpCO3dCQUNWMEIsUUFBUUc7d0JBQ1I3QyxZQUFZd0MsS0FBS3hDLFVBQVUsR0FBRzt3QkFDOUJDLFFBQVEsQ0FBQyxrQkFBa0IsRUFBRWlCLFFBQVEsdUJBQXVCLEVBQUUyQixlQUFlO3dCQUM3RUYsVUFBVTs0QkFBQyxDQUFDLFNBQVMsRUFBRXpCLFNBQVM7eUJBQUM7d0JBQ2pDakMsbUJBQW1CLElBQUksQ0FBQzZELGtDQUFrQyxDQUFDNUIsU0FBUzJCO3dCQUNwRTNDLG1CQUFtQnNDLEtBQUt0QyxpQkFBaUI7b0JBQzNDO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLE9BQU87SUFDVDtJQUVBOztHQUVDLEdBQ0QsT0FBZXdCLDJCQUEyQlgsT0FBMEIsRUFBeUI7UUFDM0YsTUFBTSxFQUFFQyxXQUFXLEVBQUVHLG9CQUFvQixDQUFDLEVBQUVELE9BQU8sRUFBRTZCLGdCQUFnQixFQUFFLEVBQUUsR0FBR2hDO1FBRTVFLGtEQUFrRDtRQUNsRCxJQUFJSSxxQkFBcUIsSUFBSSxDQUFDaEIsa0JBQWtCLENBQUNDLFdBQVcsQ0FBQ0csT0FBTyxFQUFFO1lBRXBFLGlFQUFpRTtZQUNqRSxNQUFNeUMscUJBQXFCLElBQUksQ0FBQ0MscUJBQXFCLENBQUNqQztZQUN0RCxNQUFNa0MsWUFBWUYsbUJBQW1CRyxJQUFJLENBQUNDLENBQUFBLE9BQVEsQ0FBQ0wsY0FBY00sS0FBSyxDQUFDLENBQUMsR0FBR0MsUUFBUSxDQUFDRjtZQUVwRixJQUFJRixXQUFXO2dCQUNiLE1BQU1YLGdCQUFnQixHQUFHdkIsWUFBWSxDQUFDLEVBQUVrQyxXQUFXO2dCQUNuRCxNQUFNVixPQUFPLElBQUksQ0FBQ3pDLGdCQUFnQixDQUFDd0MsY0FBYztnQkFFakQsT0FBTztvQkFDTEUsVUFBVXpCO29CQUNWMEIsUUFBUVE7b0JBQ1JsRCxZQUFZO29CQUNaQyxRQUFRLENBQUMsbUJBQW1CLEVBQUVlLFlBQVksRUFBRSxFQUFFRyxrQkFBa0IsS0FBSyxDQUFDO29CQUN0RXdCLFVBQVU7d0JBQUMsQ0FBQyxRQUFRLEVBQUV4QixrQkFBa0IsUUFBUSxDQUFDO3FCQUFDO29CQUNsRGxDLG1CQUFtQixDQUFDLHVCQUF1QixFQUFFK0IsWUFBWSxtREFBbUQsRUFBRWtDLFVBQVUscUJBQXFCLENBQUM7b0JBQzlJaEQsbUJBQW1Cc0MsTUFBTXRDLHFCQUFxQjtnQkFDaEQ7WUFDRjtRQUNGO1FBRUEsT0FBTztJQUNUO0lBRUE7O0dBRUMsR0FDRCxPQUFlMkIsc0JBQXNCZCxPQUEwQixFQUF5QjtRQUN0RixJQUFJLENBQUNBLFFBQVFZLE1BQU0sRUFBRSxPQUFPO1FBRTVCLE1BQU00QixTQUFTL0UsMkVBQXlCQSxDQUFDZ0YsU0FBUyxDQUFDekMsUUFBUVksTUFBTSxFQUFFWixRQUFRMEMsU0FBUztRQUVwRixtRUFBbUU7UUFDbkUsTUFBTUMsaUJBQWlCSCxPQUFPSSxlQUFlLENBQUNDLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFDbkQ7Z0JBQUM7Z0JBQWM7Z0JBQWE7Z0JBQVU7YUFBVSxDQUFDekIsSUFBSSxDQUFDMEIsQ0FBQUEsVUFBV0QsRUFBRUUsS0FBSyxDQUFDVCxRQUFRLENBQUNRO1FBR3BGLElBQUlKLGVBQWVNLE1BQU0sR0FBRyxLQUFLakQsUUFBUUMsV0FBVyxLQUFLMUMscUVBQWdCQSxDQUFDWSxRQUFRLEVBQUU7WUFDbEYsT0FBTztnQkFDTHVELFVBQVUxQixRQUFRQyxXQUFXO2dCQUM3QjBCLFFBQVFwRSxxRUFBZ0JBLENBQUNZLFFBQVE7Z0JBQ2pDYyxZQUFZO2dCQUNaQyxRQUFRO2dCQUNSMEMsVUFBVTtvQkFBQztpQkFBOEM7Z0JBQ3pEMUQsbUJBQW1CO2dCQUNuQmlCLG1CQUFtQjtZQUNyQjtRQUNGO1FBRUEsbUZBQW1GO1FBQ25GLElBQUlxRCxPQUFPVSxnQkFBZ0IsQ0FBQ0MsZUFBZSxHQUFHLEtBQUtuRCxRQUFRQyxXQUFXLEtBQUsxQyxxRUFBZ0JBLENBQUNpQixTQUFTLEVBQUU7WUFDckcsT0FBTztnQkFDTGtELFVBQVUxQixRQUFRQyxXQUFXO2dCQUM3QjBCLFFBQVFwRSxxRUFBZ0JBLENBQUNpQixTQUFTO2dCQUNsQ1MsWUFBWTtnQkFDWkMsUUFBUTtnQkFDUjBDLFVBQVU7b0JBQUM7aUJBQTJCO2dCQUN0QzFELG1CQUFtQjtnQkFDbkJpQixtQkFBbUI7WUFDckI7UUFDRjtRQUVBLE9BQU87SUFDVDtJQUVBOztHQUVDLEdBQ0QsT0FBZStDLHNCQUFzQmpDLFdBQTZCLEVBQXNCO1FBQ3RGLE1BQU1tRCxtQkFBbUI7WUFDdkIsQ0FBQzdGLHFFQUFnQkEsQ0FBQ0ssUUFBUSxDQUFDLEVBQUU7Z0JBQUNMLHFFQUFnQkEsQ0FBQ1ksUUFBUTtnQkFBRVoscUVBQWdCQSxDQUFDaUIsU0FBUztnQkFBRWpCLHFFQUFnQkEsQ0FBQ2dCLFVBQVU7YUFBQztZQUNqSCxDQUFDaEIscUVBQWdCQSxDQUFDWSxRQUFRLENBQUMsRUFBRTtnQkFBQ1oscUVBQWdCQSxDQUFDSyxRQUFRO2dCQUFFTCxxRUFBZ0JBLENBQUNnQixVQUFVO2dCQUFFaEIscUVBQWdCQSxDQUFDaUIsU0FBUzthQUFDO1lBQ2pILENBQUNqQixxRUFBZ0JBLENBQUNnQixVQUFVLENBQUMsRUFBRTtnQkFBQ2hCLHFFQUFnQkEsQ0FBQ1ksUUFBUTtnQkFBRVoscUVBQWdCQSxDQUFDSyxRQUFRO2dCQUFFTCxxRUFBZ0JBLENBQUNpQixTQUFTO2FBQUM7WUFDakgsQ0FBQ2pCLHFFQUFnQkEsQ0FBQ2lCLFNBQVMsQ0FBQyxFQUFFO2dCQUFDakIscUVBQWdCQSxDQUFDWSxRQUFRO2dCQUFFWixxRUFBZ0JBLENBQUNLLFFBQVE7Z0JBQUVMLHFFQUFnQkEsQ0FBQ29CLFFBQVE7YUFBQztZQUMvRyxDQUFDcEIscUVBQWdCQSxDQUFDb0IsUUFBUSxDQUFDLEVBQUU7Z0JBQUNwQixxRUFBZ0JBLENBQUNLLFFBQVE7Z0JBQUVMLHFFQUFnQkEsQ0FBQ1ksUUFBUTtnQkFBRVoscUVBQWdCQSxDQUFDaUIsU0FBUzthQUFDO1FBQ2pIO1FBRUEsT0FBTzRFLGdCQUFnQixDQUFDbkQsWUFBWSxJQUFJLEVBQUU7SUFDNUM7SUFFQTs7R0FFQyxHQUNELE9BQWU4QixtQ0FBbUM1QixPQUFvQixFQUFFWSxVQUE0QixFQUFVO1FBQzVHLE1BQU1zQyx1QkFBdUI7WUFDM0IsQ0FBQyxHQUFHN0YsMERBQVdBLENBQUNTLFVBQVUsQ0FBQyxDQUFDLEVBQUVWLHFFQUFnQkEsQ0FBQ0ssUUFBUSxFQUFFLENBQUMsRUFBRTtZQUM1RCxDQUFDLEdBQUdKLDBEQUFXQSxDQUFDWSxXQUFXLENBQUMsQ0FBQyxFQUFFYixxRUFBZ0JBLENBQUNZLFFBQVEsRUFBRSxDQUFDLEVBQUU7WUFDN0QsQ0FBQyxHQUFHWCwwREFBV0EsQ0FBQ08sUUFBUSxDQUFDLENBQUMsRUFBRVIscUVBQWdCQSxDQUFDSyxRQUFRLEVBQUUsQ0FBQyxFQUFFO1lBQzFELENBQUMsR0FBR0osMERBQVdBLENBQUNhLFNBQVMsQ0FBQyxDQUFDLEVBQUVkLHFFQUFnQkEsQ0FBQ1ksUUFBUSxFQUFFLENBQUMsRUFBRTtZQUMzRCxDQUFDLEdBQUdYLDBEQUFXQSxDQUFDa0IsS0FBSyxDQUFDLENBQUMsRUFBRW5CLHFFQUFnQkEsQ0FBQ2lCLFNBQVMsRUFBRSxDQUFDLEVBQUU7WUFDeEQsQ0FBQyxHQUFHaEIsMERBQVdBLENBQUNjLE9BQU8sQ0FBQyxDQUFDLEVBQUVmLHFFQUFnQkEsQ0FBQ29CLFFBQVEsRUFBRSxDQUFDLEVBQUU7UUFDM0Q7UUFFQSxNQUFNMkUsTUFBTSxHQUFHbkQsUUFBUSxDQUFDLEVBQUVZLFlBQVk7UUFDdEMsT0FBT3NDLG9CQUFvQixDQUFDQyxJQUFJLElBQUksQ0FBQyxnRUFBZ0UsRUFBRXZDLFdBQVcsQ0FBQyxDQUFDO0lBQ3RIO0lBRUE7O0dBRUMsR0FDRCxPQUFPd0MsMEJBQTBCQyxVQUEwQixFQUFFeEQsT0FBMEIsRUFBVTtRQUMvRixJQUFJeUQsVUFBVUQsV0FBV3ZFLFVBQVU7UUFFbkMsc0NBQXNDO1FBQ3RDLElBQUl1RSxXQUFXNUIsUUFBUSxDQUFDcUIsTUFBTSxHQUFHLEdBQUc7WUFDbENRLFdBQVc7UUFDYjtRQUVBLG1DQUFtQztRQUNuQyxJQUFJekQsUUFBUUksaUJBQWlCLElBQUlKLFFBQVFJLGlCQUFpQixHQUFHLElBQUksQ0FBQ2hCLGtCQUFrQixDQUFDQyxXQUFXLENBQUNDLFFBQVEsRUFBRTtZQUN6R21FLFdBQVc7UUFDYjtRQUVBLG9DQUFvQztRQUNwQyxJQUFJekQsUUFBUUssT0FBTyxLQUFLLFVBQVU7WUFBQzlDLHFFQUFnQkEsQ0FBQ0ssUUFBUTtZQUFFTCxxRUFBZ0JBLENBQUNZLFFBQVE7U0FBQyxDQUFDb0UsUUFBUSxDQUFDaUIsV0FBVzdCLE1BQU0sR0FBRztZQUNwSDhCLFdBQVc7UUFDYjtRQUVBLE9BQU9DLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxHQUFHLENBQUMsR0FBR0g7SUFDakM7SUFFQTs7R0FFQyxHQUNELE9BQU9JLHFCQUFxQjtRQUMxQixNQUFNQyxhQUFhN0MsT0FBTzhDLElBQUksQ0FBQyxJQUFJLENBQUMvRSxnQkFBZ0IsRUFBRWlFLE1BQU07UUFDNUQsTUFBTWUsa0JBQWtCL0MsT0FBT2dELE1BQU0sQ0FBQzFHLHFFQUFnQkEsRUFBRTJHLEdBQUcsQ0FBQzdCLENBQUFBO1lBQzFELE1BQU04QixXQUFXbEQsT0FBTzhDLElBQUksQ0FBQyxJQUFJLENBQUMvRSxnQkFBZ0IsRUFBRTZELE1BQU0sQ0FBQ1MsQ0FBQUEsTUFBT0EsSUFBSWMsVUFBVSxDQUFDL0IsT0FBT1ksTUFBTTtZQUM5RixNQUFNb0IsV0FBV3BELE9BQU84QyxJQUFJLENBQUMsSUFBSSxDQUFDL0UsZ0JBQWdCLEVBQUU2RCxNQUFNLENBQUNTLENBQUFBLE1BQU9BLElBQUlnQixRQUFRLENBQUNqQyxPQUFPWSxNQUFNO1lBQzVGLE9BQU87Z0JBQUVaO2dCQUFNOEI7Z0JBQVVFO2dCQUFVRSxPQUFPSixXQUFXRTtZQUFTO1FBQ2hFO1FBRUEsT0FBTztZQUNMRyxzQkFBc0JWO1lBQ3RCRTtZQUNBUywyQkFBMkJYLGFBQWE3QyxPQUFPZ0QsTUFBTSxDQUFDMUcscUVBQWdCQSxFQUFFMEYsTUFBTTtZQUM5RXlCLG1CQUFtQnpELE9BQU84QyxJQUFJLENBQUMsSUFBSSxDQUFDM0Usa0JBQWtCLENBQUNLLGFBQWEsRUFBRXdELE1BQU07WUFDNUUwQixpQkFBaUIxRCxPQUFPZ0QsTUFBTSxDQUFDLElBQUksQ0FBQ3RHLGFBQWEsRUFBRWlILE1BQU0sQ0FBQyxDQUFDQyxLQUFLN0QsU0FBVzZELE1BQU03RCxPQUFPbkQsUUFBUSxDQUFDb0YsTUFBTSxFQUFFO1FBQzNHO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9tb2RlLXRyYW5zaXRpb24tbWFuYWdlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBTaXN0ZW1hIGRlIEdlc3Rpw7NuIGRlIFRyYW5zaWNpb25lcyBlbnRyZSBNb2RvcyBDb252ZXJzYWNpb25hbGVzXG4vLyBPcHRpbWl6YSBlbCBjYW1iaW8gZmx1aWRvIGVudHJlIG1vZG9zIHNlZ8O6biBlbCBjb250ZXh0byB5IG5lY2VzaWRhZGVzIGRlbCBlc3R1ZGlhbnRlXG5cbmltcG9ydCB7IENvbnZlcnNhdGlvbk1vZGUgfSBmcm9tICcuL2FkdmFuY2VkLWludGVudC1lbmdpbmUnXG5pbXBvcnQgeyBFbW90aW9uVHlwZSB9IGZyb20gJy4vZW1vdGlvbi1hbmFseXplcidcbmltcG9ydCB7IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIgfSBmcm9tICcuL2NvbnZlcnNhdGlvbi1tZW1vcnknXG5cbmV4cG9ydCBpbnRlcmZhY2UgTW9kZVRyYW5zaXRpb24ge1xuICBmcm9tTW9kZTogQ29udmVyc2F0aW9uTW9kZVxuICB0b01vZGU6IENvbnZlcnNhdGlvbk1vZGVcbiAgY29uZmlkZW5jZTogbnVtYmVyIC8vIDAtMSwgcXXDqSB0YW4gc2VndXJvIGVzdMOhIGVsIHNpc3RlbWEgZGVsIGNhbWJpb1xuICByZWFzb246IHN0cmluZ1xuICB0cmlnZ2Vyczogc3RyaW5nW11cbiAgdHJhbnNpdGlvbk1lc3NhZ2U6IHN0cmluZ1xuICBzdWdnZXN0ZWREdXJhdGlvbj86IG51bWJlciAvLyBtaW51dG9zIHJlY29tZW5kYWRvcyBlbiBlbCBudWV2byBtb2RvXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVHJhbnNpdGlvbkNvbnRleHQge1xuICBjdXJyZW50TW9kZTogQ29udmVyc2F0aW9uTW9kZVxuICBtZXNzYWdlOiBzdHJpbmdcbiAgZW1vdGlvbjogRW1vdGlvblR5cGVcbiAgdXNlcklkPzogc3RyaW5nXG4gIHNlc3Npb25JZD86IHN0cmluZ1xuICB0aW1lSW5DdXJyZW50TW9kZT86IG51bWJlciAvLyBtaW51dG9zIGVuIGVsIG1vZG8gYWN0dWFsXG4gIHByZXZpb3VzTW9kZXM/OiBDb252ZXJzYXRpb25Nb2RlW11cbiAgdXJnZW5jeT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgc3ViamVjdD86IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgTW9kZVRyYW5zaXRpb25NYW5hZ2VyIHtcbiAgXG4gIC8vIFBhdHJvbmVzIHF1ZSBpbmRpY2FuIG5lY2VzaWRhZCBkZSBjYW1iaW8gZGUgbW9kb1xuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBNT0RFX1RSSUdHRVJTID0ge1xuICAgIFxuICAgIFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HXToge1xuICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgL25lY2VzaXRvXFxzKyhheXVkYXxleHBsaWNhY2nDs258cXVlXFxzK21lXFxzK2V4cGxpcXVlcykvaSxcbiAgICAgICAgL25vXFxzKyhlbnRpZW5kb3xjb21wcmVuZG98c8OpXFxzK2PDs21vKS9pLFxuICAgICAgICAvcG9kcsOtYXNcXHMrKGV4cGxpY2FyfGVuc2XDsWFyfG1vc3RyYXIpL2ksXG4gICAgICAgIC9jw7Ntb1xccysoc2VcXHMraGFjZXxmdW5jaW9uYXxyZXN1ZWx2bykvaSxcbiAgICAgICAgL2VqZXJjaWNpb3xwcm9ibGVtYXx0YXJlYXxjb25jZXB0by9pLFxuICAgICAgICAvcGFzb1xccythXFxzK3Bhc28vaVxuICAgICAgXSxcbiAgICAgIGVtb3Rpb25zOiBbRW1vdGlvblR5cGUuQ09ORlVTRUQsIEVtb3Rpb25UeXBlLkNVUklPVVMsIEVtb3Rpb25UeXBlLkZSVVNUUkFURURdLFxuICAgICAgdHJhbnNpdGlvbk1lc3NhZ2U6IFwiUGVyZmVjdG8sIGNhbWJpZW1vcyBhbCBtb2RvIHR1dG9yw61hLiBWb3kgYSBleHBsaWNhcnRlIGVzdG8gcGFzbyBhIHBhc28gcGFyYSBxdWUgbG8gZW50aWVuZGFzIGNvbXBsZXRhbWVudGUuXCJcbiAgICB9LFxuXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiB7XG4gICAgICBwYXR0ZXJuczogW1xuICAgICAgICAvbmVjZXNpdG9cXHMrKHBsYW5pZmljYXJ8b3JnYW5pemFyfGVzdHJ1Y3R1cmFyKS9pLFxuICAgICAgICAvY8OzbW9cXHMrb3JnYW5pem9cXHMrbWlcXHMrKHRpZW1wb3xlc3R1ZGlvfGhvcmFyaW8pL2ksXG4gICAgICAgIC9wbGFuXFxzK2RlXFxzK2VzdHVkaW8vaSxcbiAgICAgICAgL2Nyb25vZ3JhbWF8Y2FsZW5kYXJpb3xhZ2VuZGEvaSxcbiAgICAgICAgL2VzdHJhdGVnaWFcXHMrZGVcXHMrZXN0dWRpby9pLFxuICAgICAgICAvb2JqZXRpdm9zfG1ldGFzfHByb3DDs3NpdG9zL2ksXG4gICAgICAgIC9kZWFkbGluZXM/fGZlY2hhcz9cXHMrbMOtbWl0ZS9pXG4gICAgICBdLFxuICAgICAgZW1vdGlvbnM6IFtFbW90aW9uVHlwZS5PVkVSV0hFTE1FRCwgRW1vdGlvblR5cGUuTU9USVZBVEVELCBFbW90aW9uVHlwZS5BTlhJT1VTXSxcbiAgICAgIHRyYW5zaXRpb25NZXNzYWdlOiBcIkV4Y2VsZW50ZSBpZGVhIHBsYW5pZmljYXIuIFZhbW9zIGEgY3JlYXIgdW5hIGVzdHJhdGVnaWEgZXN0cnVjdHVyYWRhIHF1ZSB0ZSBheXVkZSBhIGFsY2FuemFyIHR1cyBvYmpldGl2b3MgZGUgbWFuZXJhIGVmaWNpZW50ZS5cIlxuICAgIH0sXG5cbiAgICBbQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXToge1xuICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgL21pc1xccysobWF0ZXJpYWxlc3xhcmNoaXZvc3xhcHVudGVzfHJlY3Vyc29zKS9pLFxuICAgICAgICAvZMOzbmRlXFxzKyhndWFyZG98b3JnYW5pem98ZW5jdWVudHJvKS9pLFxuICAgICAgICAvZ2VzdGlvbmFyXFxzKyhkb2N1bWVudG9zfHRhcmVhc3xpbmZvcm1hY2nDs24pL2ksXG4gICAgICAgIC9zaXN0ZW1hXFxzK2RlXFxzK29yZ2FuaXphY2nDs24vaSxcbiAgICAgICAgL29yZGVufGVzdHJ1Y3R1cmF8Y2xhc2lmaWNhci9pLFxuICAgICAgICAvcHJvZHVjdGl2aWRhZHxlZmljaWVuY2lhL2lcbiAgICAgIF0sXG4gICAgICBlbW90aW9uczogW0Vtb3Rpb25UeXBlLk9WRVJXSEVMTUVELCBFbW90aW9uVHlwZS5DT05GVVNFRCwgRW1vdGlvblR5cGUuTU9USVZBVEVEXSxcbiAgICAgIHRyYW5zaXRpb25NZXNzYWdlOiBcIlBlcmZlY3RvLCBvcmdhbmljZW1vcyB0b2RvIGRlIG1hbmVyYSBzaXN0ZW3DoXRpY2EuIFVuIGJ1ZW4gc2lzdGVtYSBkZSBvcmdhbml6YWNpw7NuIGVzIGNsYXZlIHBhcmEgZWwgw6l4aXRvIGFjYWTDqW1pY28uXCJcbiAgICB9LFxuXG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXToge1xuICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgL21pXFxzKyhwcm9ncmVzb3xyZW5kaW1pZW50b3xhdmFuY2UpL2ksXG4gICAgICAgIC9jw7Ntb1xccysodm95fGVzdG95XFxzK2hhY2llbmRvfG1lXFxzK3ZhKS9pLFxuICAgICAgICAvYW5hbGl6YXJcXHMrKHJlc3VsdGFkb3N8Y2FsaWZpY2FjaW9uZXN8bm90YXMpL2ksXG4gICAgICAgIC9mZWVkYmFja3xyZXRyb2FsaW1lbnRhY2nDs24vaSxcbiAgICAgICAgL3F1w6lcXHMrKHB1ZWRvXFxzK21lam9yYXJ8bmVjZXNpdG9cXHMrY2FtYmlhcikvaSxcbiAgICAgICAgL2V2YWx1YWNpw7NufHJlZmxleGnDs24vaSxcbiAgICAgICAgL2ZvcnRhbGV6YXNcXHMreVxccytkZWJpbGlkYWRlcy9pXG4gICAgICBdLFxuICAgICAgZW1vdGlvbnM6IFtFbW90aW9uVHlwZS5ESVNBUFBPSU5URUQsIEVtb3Rpb25UeXBlLlBST1VELCBFbW90aW9uVHlwZS5DVVJJT1VTLCBFbW90aW9uVHlwZS5NT1RJVkFURURdLFxuICAgICAgdHJhbnNpdGlvbk1lc3NhZ2U6IFwiTXV5IGJpZW4sIGFuYWxpY2Vtb3MgdHUgcHJvZ3Jlc28ganVudG9zLiBMYSByZWZsZXhpw7NuIHNvYnJlIHR1IGFwcmVuZGl6YWplIGVzIGZ1bmRhbWVudGFsIHBhcmEgbWVqb3JhciBjb250aW51YW1lbnRlLlwiXG4gICAgfSxcblxuICAgIFtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXToge1xuICAgICAgcGF0dGVybnM6IFtcbiAgICAgICAgL2PDs21vXFxzKyhlc3TDoXN8dGVcXHMrdmF8YW5kYXMpL2ksXG4gICAgICAgIC9ob2xhfGhpfGJ1ZW5vc1xccytkw61hc3xidWVuYXNcXHMrdGFyZGVzL2ksXG4gICAgICAgIC9xdWVyw61hXFxzK3BsYXRpY2FyL2ksXG4gICAgICAgIC9tZVxccytzaWVudG8vaSxcbiAgICAgICAgL3NvbG9cXHMrcXVlcsOtYVxccytkZWNpci9pLFxuICAgICAgICAvZ3JhY2lhc1xccytwb3IvaSxcbiAgICAgICAgL2NoYXJsZW1vc3xjb252ZXJzZW1vcy9pXG4gICAgICBdLFxuICAgICAgZW1vdGlvbnM6IFtFbW90aW9uVHlwZS5IQVBQWSwgRW1vdGlvblR5cGUuR1JBVEVGVUwsIEVtb3Rpb25UeXBlLlNBRCwgRW1vdGlvblR5cGUuRVhDSVRFRF0sXG4gICAgICB0cmFuc2l0aW9uTWVzc2FnZTogXCJNZSBkYSBtdWNobyBndXN0byBjb252ZXJzYXIgY29udGlnby4gRXN0b3kgYXF1w60gcGFyYSBlc2N1Y2hhcnRlIHkgYXBveWFydGUgZW4gbG8gcXVlIG5lY2VzaXRlcy5cIlxuICAgIH1cbiAgfVxuXG4gIC8vIFJlZ2xhcyBkZSB0cmFuc2ljacOzbiBlc3BlY8OtZmljYXMgZW50cmUgbW9kb3NcbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgVFJBTlNJVElPTl9SVUxFUyA9IHtcbiAgICBcbiAgICAvLyBEZXNkZSBDSEFUVElORyBoYWNpYSBvdHJvcyBtb2Rvc1xuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkd9YF06IHtcbiAgICAgIGNvbmZpZGVuY2U6IDAuOCxcbiAgICAgIHJlYXNvbjogXCJFbCBlc3R1ZGlhbnRlIG5lY2VzaXRhIGF5dWRhIGFjYWTDqW1pY2EgZXNwZWPDrWZpY2FcIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAyNVxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC44NSxcbiAgICAgIHJlYXNvbjogXCJFbCBlc3R1ZGlhbnRlIHF1aWVyZSBvcmdhbml6YXIgc3UgdGllbXBvIGRlIGVzdHVkaW9cIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAxNVxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HfWBdOiB7XG4gICAgICBjb25maWRlbmNlOiAwLjgsXG4gICAgICByZWFzb246IFwiRWwgZXN0dWRpYW50ZSBuZWNlc2l0YSBvcmdhbml6YXIgbWF0ZXJpYWxlcyBvIHJlY3Vyc29zXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMjBcbiAgICB9LFxuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HfWBdOiB7XG4gICAgICBjb25maWRlbmNlOiAwLjksXG4gICAgICByZWFzb246IFwiRWwgZXN0dWRpYW50ZSBxdWllcmUgYW5hbGl6YXIgc3UgcHJvZ3Jlc28gYWNhZMOpbWljb1wiLFxuICAgICAgc3VnZ2VzdGVkRHVyYXRpb246IDE1XG4gICAgfSxcblxuICAgIC8vIERlc2RlIFRVVE9SSU5HIGhhY2lhIG90cm9zIG1vZG9zXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC43NSxcbiAgICAgIHJlYXNvbjogXCJEZXNwdcOpcyBkZSBhcHJlbmRlciwgZWwgZXN0dWRpYW50ZSBxdWllcmUgcGxhbmlmaWNhciBwcsOhY3RpY2EgYWRpY2lvbmFsXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMTBcbiAgICB9LFxuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuT1JHQU5JWklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC43LFxuICAgICAgcmVhc29uOiBcIkVsIGVzdHVkaWFudGUgbmVjZXNpdGEgb3JnYW5pemFyIGVsIG1hdGVyaWFsIGFwcmVuZGlkb1wiLFxuICAgICAgc3VnZ2VzdGVkRHVyYXRpb246IDEwXG4gICAgfSxcbiAgICBbYCR7Q29udmVyc2F0aW9uTW9kZS5UVVRPUklOR31fJHtDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC44LFxuICAgICAgcmVhc29uOiBcIkVzIG1vbWVudG8gZGUgZXZhbHVhciBsYSBjb21wcmVuc2nDs24gZGVsIHRlbWFcIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAxMFxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5DSEFUVElOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC42LFxuICAgICAgcmVhc29uOiBcIkVsIGVzdHVkaWFudGUgcXVpZXJlIHVuYSBwYXVzYSBvIGV4cHJlc2FyIGVtb2Npb25lc1wiLFxuICAgICAgc3VnZ2VzdGVkRHVyYXRpb246IDVcbiAgICB9LFxuXG4gICAgLy8gRGVzZGUgUExBTk5JTkcgaGFjaWEgb3Ryb3MgbW9kb3NcbiAgICBbYCR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31fJHtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HfWBdOiB7XG4gICAgICBjb25maWRlbmNlOiAwLjksXG4gICAgICByZWFzb246IFwiRXMgaG9yYSBkZSBlamVjdXRhciBlbCBwbGFuIGNvbiBlc3R1ZGlvIGVzcGVjw61maWNvXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMzBcbiAgICB9LFxuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuT1JHQU5JWklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC44NSxcbiAgICAgIHJlYXNvbjogXCJOZWNlc2l0YSBvcmdhbml6YXIgcmVjdXJzb3MgcGFyYSBlamVjdXRhciBlbCBwbGFuXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMTVcbiAgICB9LFxuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HfWBdOiB7XG4gICAgICBjb25maWRlbmNlOiAwLjcsXG4gICAgICByZWFzb246IFwiUXVpZXJlIGV2YWx1YXIgcGxhbmVzIGFudGVyaW9yZXMgYW50ZXMgZGUgY3JlYXIgbnVldm9zXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMTBcbiAgICB9LFxuXG4gICAgLy8gRGVzZGUgT1JHQU5JWklORyBoYWNpYSBvdHJvcyBtb2Rvc1xuICAgIFtgJHtDb252ZXJzYXRpb25Nb2RlLk9SR0FOSVpJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC44LFxuICAgICAgcmVhc29uOiBcIkNvbiByZWN1cnNvcyBvcmdhbml6YWRvcywgZXMgbW9tZW50byBkZSBwbGFuaWZpY2FyIHN1IHVzb1wiLFxuICAgICAgc3VnZ2VzdGVkRHVyYXRpb246IDE1XG4gICAgfSxcbiAgICBbYCR7Q29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkd9YF06IHtcbiAgICAgIGNvbmZpZGVuY2U6IDAuNzUsXG4gICAgICByZWFzb246IFwiQ29uIG1hdGVyaWFsZXMgbGlzdG9zLCBwdWVkZSBlbmZvY2Fyc2UgZW4gYXByZW5kZXJcIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAyNVxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuT1JHQU5JWklOR31fJHtDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC43LFxuICAgICAgcmVhc29uOiBcIlF1aWVyZSBldmFsdWFyIGxhIGVmZWN0aXZpZGFkIGRlIHN1IG9yZ2FuaXphY2nDs25cIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAxMFxuICAgIH0sXG5cbiAgICAvLyBEZXNkZSBSRVZJRVdJTkcgaGFjaWEgb3Ryb3MgbW9kb3NcbiAgICBbYCR7Q29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXToge1xuICAgICAgY29uZmlkZW5jZTogMC45LFxuICAgICAgcmVhc29uOiBcIkJhc2FkbyBlbiBsYSByZXZpc2nDs24sIG5lY2VzaXRhIGNyZWFyIG51ZXZvcyBwbGFuZXNcIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAyMFxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkd9YF06IHtcbiAgICAgIGNvbmZpZGVuY2U6IDAuODUsXG4gICAgICByZWFzb246IFwiSWRlbnRpZmljw7Mgw6FyZWFzIHF1ZSBuZWNlc2l0YSByZWZvcnphclwiLFxuICAgICAgc3VnZ2VzdGVkRHVyYXRpb246IDMwXG4gICAgfSxcbiAgICBbYCR7Q29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkd9XyR7Q29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HfWBdOiB7XG4gICAgICBjb25maWRlbmNlOiAwLjcsXG4gICAgICByZWFzb246IFwiTmVjZXNpdGEgcmVvcmdhbml6YXIgbWF0ZXJpYWxlcyBiYXNhZG8gZW4gbGEgZXZhbHVhY2nDs25cIixcbiAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAxNVxuICAgIH0sXG4gICAgW2Ake0NvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HfV8ke0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkd9YF06IHtcbiAgICAgIGNvbmZpZGVuY2U6IDAuOCxcbiAgICAgIHJlYXNvbjogXCJRdWllcmUgcHJvY2VzYXIgZW1vY2lvbmFsbWVudGUgbG9zIHJlc3VsdGFkb3MgZGUgbGEgcmV2aXNpw7NuXCIsXG4gICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMTBcbiAgICB9XG4gIH1cblxuICAvLyBGYWN0b3JlcyBxdWUgYWZlY3RhbiBsYXMgdHJhbnNpY2lvbmVzXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFRSQU5TSVRJT05fRkFDVE9SUyA9IHtcbiAgICBcbiAgICAvLyBUaWVtcG8gZW4gbW9kbyBhY3R1YWwgYWZlY3RhIGxhIGRpc3Bvc2ljacOzbiBhbCBjYW1iaW9cbiAgICB0aW1lRmFjdG9yczoge1xuICAgICAgdG9vU2hvcnQ6IDMsIC8vIG1pbnV0b3MgLSBtdXkgcG9jbyB0aWVtcG8gZW4gZWwgbW9kbyBhY3R1YWxcbiAgICAgIG9wdGltYWw6IDE1LCAvLyBtaW51dG9zIC0gdGllbXBvIGlkZWFsIGVuIHVuIG1vZG9cbiAgICAgIHRvb0xvbmc6IDQ1ICAvLyBtaW51dG9zIC0gZGVtYXNpYWRvIHRpZW1wbywgbmVjZXNpdGEgY2FtYmlvXG4gICAgfSxcblxuICAgIC8vIEVtb2Npb25lcyBxdWUgZmF2b3JlY2VuIGNpZXJ0b3MgbW9kb3NcbiAgICBlbW90aW9uYWxCaWFzOiB7XG4gICAgICBbRW1vdGlvblR5cGUuRlJVU1RSQVRFRF06IFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HLCBDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXSxcbiAgICAgIFtFbW90aW9uVHlwZS5PVkVSV0hFTE1FRF06IFtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HLCBDb252ZXJzYXRpb25Nb2RlLk9SR0FOSVpJTkddLFxuICAgICAgW0Vtb3Rpb25UeXBlLkNPTkZVU0VEXTogW0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkddLFxuICAgICAgW0Vtb3Rpb25UeXBlLk1PVElWQVRFRF06IFtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HLCBDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HXSxcbiAgICAgIFtFbW90aW9uVHlwZS5QUk9VRF06IFtDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lORywgQ29udmVyc2F0aW9uTW9kZS5DSEFUVElOR10sXG4gICAgICBbRW1vdGlvblR5cGUuQ1VSSU9VU106IFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HXSxcbiAgICAgIFtFbW90aW9uVHlwZS5HUkFURUZVTF06IFtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HLCBDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR10sXG4gICAgICBbRW1vdGlvblR5cGUuQU5YSU9VU106IFtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HLCBDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXSxcbiAgICAgIFtFbW90aW9uVHlwZS5FWENJVEVEXTogW0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkcsIENvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddLFxuICAgICAgW0Vtb3Rpb25UeXBlLkJPUkVEXTogW0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkcsIENvbnZlcnNhdGlvbk1vZGUuT1JHQU5JWklOR11cbiAgICB9LFxuXG4gICAgLy8gVXJnZW5jaWEgYWZlY3RhIHByZWZlcmVuY2lhIGRlIG1vZG9cbiAgICB1cmdlbmN5Qmlhczoge1xuICAgICAgaGlnaDogW0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkcsIENvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddLFxuICAgICAgbWVkaXVtOiBbQ29udmVyc2F0aW9uTW9kZS5UVVRPUklORywgQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HLCBDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HXSxcbiAgICAgIGxvdzogW0NvbnZlcnNhdGlvbk1vZGUuQ0hBVFRJTkcsIENvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HLCBDb252ZXJzYXRpb25Nb2RlLk9SR0FOSVpJTkddXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFuYWxpemEgc2kgZGViZXLDrWEgc3VnZXJpciB1bmEgdHJhbnNpY2nDs24gZGUgbW9kb1xuICAgKi9cbiAgc3RhdGljIGFuYWx5emVUcmFuc2l0aW9uTmVlZChjb250ZXh0OiBUcmFuc2l0aW9uQ29udGV4dCk6IE1vZGVUcmFuc2l0aW9uIHwgbnVsbCB7XG4gICAgY29uc3QgeyBjdXJyZW50TW9kZSwgbWVzc2FnZSwgZW1vdGlvbiwgdGltZUluQ3VycmVudE1vZGUgPSAwLCB1cmdlbmN5ID0gJ21lZGl1bScgfSA9IGNvbnRleHRcblxuICAgIC8vIDEuIEJ1c2NhciB0cmlnZ2VycyBleHBsw61jaXRvcyBlbiBlbCBtZW5zYWplXG4gICAgY29uc3QgZXhwbGljaXRUcmFuc2l0aW9uID0gdGhpcy5maW5kRXhwbGljaXRNb2RlVHJhbnNpdGlvbihtZXNzYWdlLCBjdXJyZW50TW9kZSlcbiAgICBpZiAoZXhwbGljaXRUcmFuc2l0aW9uKSByZXR1cm4gZXhwbGljaXRUcmFuc2l0aW9uXG5cbiAgICAvLyAyLiBBbmFsaXphciBiYXNhZG8gZW4gZW1vY2nDs24geSB0aWVtcG9cbiAgICBjb25zdCBlbW90aW9uYWxUcmFuc2l0aW9uID0gdGhpcy5hbmFseXplRW1vdGlvbmFsVHJhbnNpdGlvbihjdXJyZW50TW9kZSwgZW1vdGlvbiwgdGltZUluQ3VycmVudE1vZGUpXG4gICAgaWYgKGVtb3Rpb25hbFRyYW5zaXRpb24pIHJldHVybiBlbW90aW9uYWxUcmFuc2l0aW9uXG5cbiAgICAvLyAzLiBDb25zaWRlcmFyIHRpZW1wbyBleGNlc2l2byBlbiBtb2RvIGFjdHVhbFxuICAgIGNvbnN0IHRpbWVCYXNlZFRyYW5zaXRpb24gPSB0aGlzLmFuYWx5emVUaW1lQmFzZWRUcmFuc2l0aW9uKGNvbnRleHQpXG4gICAgaWYgKHRpbWVCYXNlZFRyYW5zaXRpb24pIHJldHVybiB0aW1lQmFzZWRUcmFuc2l0aW9uXG5cbiAgICAvLyA0LiBBbmFsaXphciBwYXRyb25lcyBkZSBtZW1vcmlhIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICBpZiAoY29udGV4dC51c2VySWQpIHtcbiAgICAgIGNvbnN0IG1lbW9yeUJhc2VkVHJhbnNpdGlvbiA9IHRoaXMuYW5hbHl6ZU1lbW9yeVBhdHRlcm5zKGNvbnRleHQpXG4gICAgICBpZiAobWVtb3J5QmFzZWRUcmFuc2l0aW9uKSByZXR1cm4gbWVtb3J5QmFzZWRUcmFuc2l0aW9uXG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXNjYSB0cmlnZ2VycyBleHBsw61jaXRvcyBkZSBjYW1iaW8gZGUgbW9kbyBlbiBlbCBtZW5zYWplXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBmaW5kRXhwbGljaXRNb2RlVHJhbnNpdGlvbihtZXNzYWdlOiBzdHJpbmcsIGN1cnJlbnRNb2RlOiBDb252ZXJzYXRpb25Nb2RlKTogTW9kZVRyYW5zaXRpb24gfCBudWxsIHtcbiAgICBmb3IgKGNvbnN0IFt0YXJnZXRNb2RlLCBjb25maWddIG9mIE9iamVjdC5lbnRyaWVzKHRoaXMuTU9ERV9UUklHR0VSUykpIHtcbiAgICAgIGlmICh0YXJnZXRNb2RlID09PSBjdXJyZW50TW9kZSkgY29udGludWUgLy8gTm8gY2FtYmlhciBhbCBtaXNtbyBtb2RvXG5cbiAgICAgIGNvbnN0IG1vZGVFbnVtID0gdGFyZ2V0TW9kZSBhcyBDb252ZXJzYXRpb25Nb2RlXG4gICAgICBcbiAgICAgIC8vIFZlcmlmaWNhciBwYXRyb25lcyB0ZXh0dWFsZXNcbiAgICAgIGNvbnN0IGhhc1RleHRUcmlnZ2VyID0gY29uZmlnLnBhdHRlcm5zLnNvbWUocGF0dGVybiA9PiBwYXR0ZXJuLnRlc3QobWVzc2FnZSkpXG4gICAgICBcbiAgICAgIGlmIChoYXNUZXh0VHJpZ2dlcikge1xuICAgICAgICBjb25zdCB0cmFuc2l0aW9uS2V5ID0gYCR7Y3VycmVudE1vZGV9XyR7bW9kZUVudW19YFxuICAgICAgICBjb25zdCBydWxlID0gdGhpcy5UUkFOU0lUSU9OX1JVTEVTW3RyYW5zaXRpb25LZXldXG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGZyb21Nb2RlOiBjdXJyZW50TW9kZSxcbiAgICAgICAgICB0b01vZGU6IG1vZGVFbnVtLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IHJ1bGU/LmNvbmZpZGVuY2UgfHwgMC43LFxuICAgICAgICAgIHJlYXNvbjogcnVsZT8ucmVhc29uIHx8IGBUcmlnZ2VyIHRleHR1YWwgZGV0ZWN0YWRvIHBhcmEgJHttb2RlRW51bX1gLFxuICAgICAgICAgIHRyaWdnZXJzOiBbYFBhdHLDs24gdGV4dHVhbCBwYXJhICR7bW9kZUVudW19YF0sXG4gICAgICAgICAgdHJhbnNpdGlvbk1lc3NhZ2U6IGNvbmZpZy50cmFuc2l0aW9uTWVzc2FnZSxcbiAgICAgICAgICBzdWdnZXN0ZWREdXJhdGlvbjogcnVsZT8uc3VnZ2VzdGVkRHVyYXRpb25cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKipcbiAgICogQW5hbGl6YSB0cmFuc2ljacOzbiBiYXNhZGEgZW4gZXN0YWRvIGVtb2Npb25hbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZUVtb3Rpb25hbFRyYW5zaXRpb24oXG4gICAgY3VycmVudE1vZGU6IENvbnZlcnNhdGlvbk1vZGUsIFxuICAgIGVtb3Rpb246IEVtb3Rpb25UeXBlLCBcbiAgICB0aW1lSW5DdXJyZW50TW9kZTogbnVtYmVyXG4gICk6IE1vZGVUcmFuc2l0aW9uIHwgbnVsbCB7XG4gICAgXG4gICAgY29uc3QgZW1vdGlvbmFsUHJlZmVyZW5jZXMgPSB0aGlzLlRSQU5TSVRJT05fRkFDVE9SUy5lbW90aW9uYWxCaWFzW2Vtb3Rpb25dIHx8IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBwcmVmZXJyZWRNb2RlIG9mIGVtb3Rpb25hbFByZWZlcmVuY2VzKSB7XG4gICAgICBpZiAocHJlZmVycmVkTW9kZSA9PT0gY3VycmVudE1vZGUpIGNvbnRpbnVlXG4gICAgICBcbiAgICAgIC8vIFNpIGxsZXZhIHN1ZmljaWVudGUgdGllbXBvIGVuIGVsIG1vZG8gYWN0dWFsIHkgbGEgZW1vY2nDs24gc3VnaWVyZSBjYW1iaW9cbiAgICAgIGlmICh0aW1lSW5DdXJyZW50TW9kZSA+PSB0aGlzLlRSQU5TSVRJT05fRkFDVE9SUy50aW1lRmFjdG9ycy50b29TaG9ydCkge1xuICAgICAgICBjb25zdCB0cmFuc2l0aW9uS2V5ID0gYCR7Y3VycmVudE1vZGV9XyR7cHJlZmVycmVkTW9kZX1gXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0aGlzLlRSQU5TSVRJT05fUlVMRVNbdHJhbnNpdGlvbktleV1cbiAgICAgICAgXG4gICAgICAgIGlmIChydWxlKSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZyb21Nb2RlOiBjdXJyZW50TW9kZSxcbiAgICAgICAgICAgIHRvTW9kZTogcHJlZmVycmVkTW9kZSxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IHJ1bGUuY29uZmlkZW5jZSAqIDAuOCwgLy8gUmVkdWNpciBjb25maWFuemEgcGFyYSB0cmFuc2ljaW9uZXMgZW1vY2lvbmFsZXNcbiAgICAgICAgICAgIHJlYXNvbjogYEVzdGFkbyBlbW9jaW9uYWwgKCR7ZW1vdGlvbn0pIHN1Z2llcmUgY2FtYmlvIGhhY2lhICR7cHJlZmVycmVkTW9kZX1gLFxuICAgICAgICAgICAgdHJpZ2dlcnM6IFtgRW1vY2nDs246ICR7ZW1vdGlvbn1gXSxcbiAgICAgICAgICAgIHRyYW5zaXRpb25NZXNzYWdlOiB0aGlzLmdlbmVyYXRlRW1vdGlvbmFsVHJhbnNpdGlvbk1lc3NhZ2UoZW1vdGlvbiwgcHJlZmVycmVkTW9kZSksXG4gICAgICAgICAgICBzdWdnZXN0ZWREdXJhdGlvbjogcnVsZS5zdWdnZXN0ZWREdXJhdGlvblxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKipcbiAgICogQW5hbGl6YSB0cmFuc2ljaW9uZXMgYmFzYWRhcyBlbiB0aWVtcG8gZXhjZXNpdm8gZW4gbW9kbyBhY3R1YWxcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFuYWx5emVUaW1lQmFzZWRUcmFuc2l0aW9uKGNvbnRleHQ6IFRyYW5zaXRpb25Db250ZXh0KTogTW9kZVRyYW5zaXRpb24gfCBudWxsIHtcbiAgICBjb25zdCB7IGN1cnJlbnRNb2RlLCB0aW1lSW5DdXJyZW50TW9kZSA9IDAsIGVtb3Rpb24sIHByZXZpb3VzTW9kZXMgPSBbXSB9ID0gY29udGV4dFxuICAgIFxuICAgIC8vIFNpIGhhIGVzdGFkbyBkZW1hc2lhZG8gdGllbXBvIGVuIGVsIG1vZG8gYWN0dWFsXG4gICAgaWYgKHRpbWVJbkN1cnJlbnRNb2RlID49IHRoaXMuVFJBTlNJVElPTl9GQUNUT1JTLnRpbWVGYWN0b3JzLnRvb0xvbmcpIHtcbiAgICAgIFxuICAgICAgLy8gU3VnZXJpciB1biBtb2RvIGNvbXBsZW1lbnRhcmlvIHF1ZSBubyBoYXlhIHVzYWRvIHJlY2llbnRlbWVudGVcbiAgICAgIGNvbnN0IGNvbXBsZW1lbnRhcnlNb2RlcyA9IHRoaXMuZ2V0Q29tcGxlbWVudGFyeU1vZGVzKGN1cnJlbnRNb2RlKVxuICAgICAgY29uc3QgZnJlc2hNb2RlID0gY29tcGxlbWVudGFyeU1vZGVzLmZpbmQobW9kZSA9PiAhcHJldmlvdXNNb2Rlcy5zbGljZSgtMikuaW5jbHVkZXMobW9kZSkpXG4gICAgICBcbiAgICAgIGlmIChmcmVzaE1vZGUpIHtcbiAgICAgICAgY29uc3QgdHJhbnNpdGlvbktleSA9IGAke2N1cnJlbnRNb2RlfV8ke2ZyZXNoTW9kZX1gXG4gICAgICAgIGNvbnN0IHJ1bGUgPSB0aGlzLlRSQU5TSVRJT05fUlVMRVNbdHJhbnNpdGlvbktleV1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgZnJvbU1vZGU6IGN1cnJlbnRNb2RlLFxuICAgICAgICAgIHRvTW9kZTogZnJlc2hNb2RlLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDAuNixcbiAgICAgICAgICByZWFzb246IGBUaWVtcG8gZXhjZXNpdm8gZW4gJHtjdXJyZW50TW9kZX0gKCR7dGltZUluQ3VycmVudE1vZGV9IG1pbilgLFxuICAgICAgICAgIHRyaWdnZXJzOiBbYFRpZW1wbzogJHt0aW1lSW5DdXJyZW50TW9kZX0gbWludXRvc2BdLFxuICAgICAgICAgIHRyYW5zaXRpb25NZXNzYWdlOiBgSGFzIGVzdGFkbyBlbmZvY2FkbyBlbiAke2N1cnJlbnRNb2RlfSBwb3IgdW4gYnVlbiB0aWVtcG8uIMK/VGUgcGFyZWNlIHNpIGNhbWJpYW1vcyBoYWNpYSAke2ZyZXNoTW9kZX0gcGFyYSB2YXJpYXIgdW4gcG9jbz9gLFxuICAgICAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiBydWxlPy5zdWdnZXN0ZWREdXJhdGlvbiB8fCAxNVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGxcbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFsaXphIHBhdHJvbmVzIGVuIGxhIG1lbW9yaWEgY29udmVyc2FjaW9uYWwgcGFyYSBzdWdlcmlyIHRyYW5zaWNpb25lc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZU1lbW9yeVBhdHRlcm5zKGNvbnRleHQ6IFRyYW5zaXRpb25Db250ZXh0KTogTW9kZVRyYW5zaXRpb24gfCBudWxsIHtcbiAgICBpZiAoIWNvbnRleHQudXNlcklkKSByZXR1cm4gbnVsbFxuXG4gICAgY29uc3QgbWVtb3J5ID0gQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5nZXRNZW1vcnkoY29udGV4dC51c2VySWQsIGNvbnRleHQuc2Vzc2lvbklkKVxuICAgIFxuICAgIC8vIFNpIGVsIGVzdHVkaWFudGUgZnJlY3VlbnRlbWVudGUgbmVjZXNpdGEgYXl1ZGEgY29uIHBsYW5pZmljYWNpw7NuXG4gICAgY29uc3QgcGxhbm5pbmdUb3BpY3MgPSBtZW1vcnkucmVjdXJyaW5nVG9waWNzLmZpbHRlcih0ID0+IFxuICAgICAgWydwbGFuaWZpY2FyJywgJ29yZ2FuaXphcicsICd0aWVtcG8nLCAnaG9yYXJpbyddLnNvbWUoa2V5d29yZCA9PiB0LnRvcGljLmluY2x1ZGVzKGtleXdvcmQpKVxuICAgIClcbiAgICBcbiAgICBpZiAocGxhbm5pbmdUb3BpY3MubGVuZ3RoID4gMCAmJiBjb250ZXh0LmN1cnJlbnRNb2RlICE9PSBDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBmcm9tTW9kZTogY29udGV4dC5jdXJyZW50TW9kZSxcbiAgICAgICAgdG9Nb2RlOiBDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HLFxuICAgICAgICBjb25maWRlbmNlOiAwLjY1LFxuICAgICAgICByZWFzb246IFwiUGF0csOzbiBoaXN0w7NyaWNvIG11ZXN0cmEgbmVjZXNpZGFkIHJlY3VycmVudGUgZGUgcGxhbmlmaWNhY2nDs25cIixcbiAgICAgICAgdHJpZ2dlcnM6IFtcIk1lbW9yaWE6IFRlbWFzIGRlIHBsYW5pZmljYWNpw7NuIHJlY3VycmVudGVzXCJdLFxuICAgICAgICB0cmFuc2l0aW9uTWVzc2FnZTogXCJIZSBub3RhZG8gcXVlIGZyZWN1ZW50ZW1lbnRlIHRyYWJhamFtb3MgZW4gcGxhbmlmaWNhY2nDs24uIMK/VGUgZ3VzdGFyw61hIHF1ZSBvcmdhbmljZW1vcyB0dSBlc3RyYXRlZ2lhIGRlIGVzdHVkaW8/XCIsXG4gICAgICAgIHN1Z2dlc3RlZER1cmF0aW9uOiAyMFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNpIGVsIG5pdmVsIGRlIG1vdGl2YWNpw7NuIGVzdMOhIGJham8sIHN1Z2VyaXIgcmV2aXNpw7NuIHBhcmEgaWRlbnRpZmljYXIgcHJvYmxlbWFzXG4gICAgaWYgKG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLm1vdGl2YXRpb25MZXZlbCA8IDQgJiYgY29udGV4dC5jdXJyZW50TW9kZSAhPT0gQ29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkcpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZyb21Nb2RlOiBjb250ZXh0LmN1cnJlbnRNb2RlLFxuICAgICAgICB0b01vZGU6IENvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HLFxuICAgICAgICBjb25maWRlbmNlOiAwLjcsXG4gICAgICAgIHJlYXNvbjogXCJCYWpvIG5pdmVsIGRlIG1vdGl2YWNpw7NuIHN1Z2llcmUgbmVjZXNpZGFkIGRlIHJldmlzacOzbiB5IGFuw6FsaXNpc1wiLFxuICAgICAgICB0cmlnZ2VyczogW1wiTWVtb3JpYTogTW90aXZhY2nDs24gYmFqYVwiXSxcbiAgICAgICAgdHJhbnNpdGlvbk1lc3NhZ2U6IFwiSGUgbm90YWRvIHF1ZSB0dSBtb3RpdmFjacOzbiBoYSBlc3RhZG8gdW4gcG9jbyBiYWphIMO6bHRpbWFtZW50ZS4gwr9UZSBwYXJlY2Ugc2kgYW5hbGl6YW1vcyBqdW50b3MgY8OzbW8gdmFuIGxhcyBjb3NhcyBwYXJhIGlkZW50aWZpY2FyIHF1w6kgcG9kZW1vcyBtZWpvcmFyP1wiLFxuICAgICAgICBzdWdnZXN0ZWREdXJhdGlvbjogMTVcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbFxuICB9XG5cbiAgLyoqXG4gICAqIE9idGllbmUgbW9kb3MgY29tcGxlbWVudGFyaW9zIHBhcmEgZWwgbW9kbyBhY3R1YWxcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldENvbXBsZW1lbnRhcnlNb2RlcyhjdXJyZW50TW9kZTogQ29udmVyc2F0aW9uTW9kZSk6IENvbnZlcnNhdGlvbk1vZGVbXSB7XG4gICAgY29uc3QgY29tcGxlbWVudGFyeU1hcCA9IHtcbiAgICAgIFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HXTogW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkcsIENvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HLCBDb252ZXJzYXRpb25Nb2RlLk9SR0FOSVpJTkddLFxuICAgICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiBbQ29udmVyc2F0aW9uTW9kZS5UVVRPUklORywgQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HLCBDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR10sXG4gICAgICBbQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXTogW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkcsIENvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkcsIENvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXSxcbiAgICAgIFtDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR106IFtDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HLCBDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HLCBDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXSxcbiAgICAgIFtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXTogW0NvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkcsIENvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkcsIENvbnZlcnNhdGlvbk1vZGUuUkVWSUVXSU5HXVxuICAgIH1cblxuICAgIHJldHVybiBjb21wbGVtZW50YXJ5TWFwW2N1cnJlbnRNb2RlXSB8fCBbXVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSBtZW5zYWplIGRlIHRyYW5zaWNpw7NuIGJhc2FkbyBlbiBlbW9jacOzblxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZ2VuZXJhdGVFbW90aW9uYWxUcmFuc2l0aW9uTWVzc2FnZShlbW90aW9uOiBFbW90aW9uVHlwZSwgdGFyZ2V0TW9kZTogQ29udmVyc2F0aW9uTW9kZSk6IHN0cmluZyB7XG4gICAgY29uc3QgZW1vdGlvbmFsVHJhbnNpdGlvbnMgPSB7XG4gICAgICBbYCR7RW1vdGlvblR5cGUuRlJVU1RSQVRFRH1fJHtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HfWBdOiBcIlZlbyBxdWUgdGUgc2llbnRlcyBmcnVzdHJhZG8uIENhbWJpZW1vcyBhbCBtb2RvIHR1dG9yw61hIHBhcmEgYWJvcmRhciBlc3RvIHBhc28gYSBwYXNvIHkgYWNsYXJhciBsYXMgZHVkYXMuXCIsXG4gICAgICBbYCR7RW1vdGlvblR5cGUuT1ZFUldIRUxNRUR9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXTogXCJDdWFuZG8gbm9zIHNlbnRpbW9zIGFicnVtYWRvcywgbGEgcGxhbmlmaWNhY2nDs24gcHVlZGUgYXl1ZGFyIG11Y2hvLiBPcmdhbmljZW1vcyB0b2RvIGRlIG1hbmVyYSBtYW5lamFibGUuXCIsXG4gICAgICBbYCR7RW1vdGlvblR5cGUuQ09ORlVTRUR9XyR7Q29udmVyc2F0aW9uTW9kZS5UVVRPUklOR31gXTogXCJMYSBjb25mdXNpw7NuIGVzIG5vcm1hbCBjdWFuZG8gYXByZW5kZW1vcy4gUGFzZW1vcyBhbCBtb2RvIHR1dG9yw61hIHBhcmEgYWNsYXJhciB0b2RvIHB1bnRvIHBvciBwdW50by5cIixcbiAgICAgIFtgJHtFbW90aW9uVHlwZS5NT1RJVkFURUR9XyR7Q29udmVyc2F0aW9uTW9kZS5QTEFOTklOR31gXTogXCLCoU1lIGVuY2FudGEgdmVyIHR1IG1vdGl2YWNpw7NuISBBcHJvdmVjaGVtb3MgZXN0YSBlbmVyZ8OtYSBwYXJhIGNyZWFyIHVuIHBsYW4gZWZlY3Rpdm8uXCIsXG4gICAgICBbYCR7RW1vdGlvblR5cGUuUFJPVUR9XyR7Q29udmVyc2F0aW9uTW9kZS5SRVZJRVdJTkd9YF06IFwiRXMgZ2VuaWFsIHF1ZSB0ZSBzaWVudGFzIG9yZ3VsbG9zby4gQW5hbGljZW1vcyBqdW50b3MgbG8gcXVlIGhhcyBsb2dyYWRvIHBhcmEgc2VndWlyIGNvbnN0cnV5ZW5kbyBzb2JyZSBlc3RvcyDDqXhpdG9zLlwiLFxuICAgICAgW2Ake0Vtb3Rpb25UeXBlLkFOWElPVVN9XyR7Q29udmVyc2F0aW9uTW9kZS5DSEFUVElOR31gXTogXCJDdWFuZG8gc2VudGltb3MgYW5zaWVkYWQsIGEgdmVjZXMgZXMgw7p0aWwgaGFibGFyIGRlIGVsbG8uIFRvbWVtb3MgdW4gbW9tZW50byBwYXJhIHByb2Nlc2FyIGVzdGFzIGVtb2Npb25lcy5cIlxuICAgIH1cblxuICAgIGNvbnN0IGtleSA9IGAke2Vtb3Rpb259XyR7dGFyZ2V0TW9kZX1gXG4gICAgcmV0dXJuIGVtb3Rpb25hbFRyYW5zaXRpb25zW2tleV0gfHwgYEJhc8OhbmRvbWUgZW4gY8OzbW8gdGUgc2llbnRlcywgY3JlbyBxdWUgc2Vyw61hIMO6dGlsIGNhbWJpYXIgaGFjaWEgJHt0YXJnZXRNb2RlfS5gXG4gIH1cblxuICAvKipcbiAgICogRXZhbMO6YSBsYSBjYWxpZGFkIGRlIHVuYSB0cmFuc2ljacOzbiBwcm9wdWVzdGFcbiAgICovXG4gIHN0YXRpYyBldmFsdWF0ZVRyYW5zaXRpb25RdWFsaXR5KHRyYW5zaXRpb246IE1vZGVUcmFuc2l0aW9uLCBjb250ZXh0OiBUcmFuc2l0aW9uQ29udGV4dCk6IG51bWJlciB7XG4gICAgbGV0IHF1YWxpdHkgPSB0cmFuc2l0aW9uLmNvbmZpZGVuY2VcblxuICAgIC8vIEJvbmlmaWNhciBzaSBoYXkgbcO6bHRpcGxlcyB0cmlnZ2Vyc1xuICAgIGlmICh0cmFuc2l0aW9uLnRyaWdnZXJzLmxlbmd0aCA+IDEpIHtcbiAgICAgIHF1YWxpdHkgKz0gMC4xXG4gICAgfVxuXG4gICAgLy8gUGVuYWxpemFyIGNhbWJpb3MgbXV5IGZyZWN1ZW50ZXNcbiAgICBpZiAoY29udGV4dC50aW1lSW5DdXJyZW50TW9kZSAmJiBjb250ZXh0LnRpbWVJbkN1cnJlbnRNb2RlIDwgdGhpcy5UUkFOU0lUSU9OX0ZBQ1RPUlMudGltZUZhY3RvcnMudG9vU2hvcnQpIHtcbiAgICAgIHF1YWxpdHkgLT0gMC4yXG4gICAgfVxuXG4gICAgLy8gQm9uaWZpY2FyIHNpIGxhIHVyZ2VuY2lhIGNvaW5jaWRlXG4gICAgaWYgKGNvbnRleHQudXJnZW5jeSA9PT0gJ2hpZ2gnICYmIFtDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HLCBDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HXS5pbmNsdWRlcyh0cmFuc2l0aW9uLnRvTW9kZSkpIHtcbiAgICAgIHF1YWxpdHkgKz0gMC4xXG4gICAgfVxuXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgubWluKDEsIHF1YWxpdHkpKVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSBlc3RhZMOtc3RpY2FzIGRlbCBzaXN0ZW1hIGRlIHRyYW5zaWNpb25lc1xuICAgKi9cbiAgc3RhdGljIGdldFRyYW5zaXRpb25TdGF0cygpIHtcbiAgICBjb25zdCB0b3RhbFJ1bGVzID0gT2JqZWN0LmtleXModGhpcy5UUkFOU0lUSU9OX1JVTEVTKS5sZW5ndGhcbiAgICBjb25zdCBtb2RlQ29ubmVjdGlvbnMgPSBPYmplY3QudmFsdWVzKENvbnZlcnNhdGlvbk1vZGUpLm1hcChtb2RlID0+IHtcbiAgICAgIGNvbnN0IG91dGdvaW5nID0gT2JqZWN0LmtleXModGhpcy5UUkFOU0lUSU9OX1JVTEVTKS5maWx0ZXIoa2V5ID0+IGtleS5zdGFydHNXaXRoKG1vZGUpKS5sZW5ndGhcbiAgICAgIGNvbnN0IGluY29taW5nID0gT2JqZWN0LmtleXModGhpcy5UUkFOU0lUSU9OX1JVTEVTKS5maWx0ZXIoa2V5ID0+IGtleS5lbmRzV2l0aChtb2RlKSkubGVuZ3RoXG4gICAgICByZXR1cm4geyBtb2RlLCBvdXRnb2luZywgaW5jb21pbmcsIHRvdGFsOiBvdXRnb2luZyArIGluY29taW5nIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHRvdGFsVHJhbnNpdGlvblJ1bGVzOiB0b3RhbFJ1bGVzLFxuICAgICAgbW9kZUNvbm5lY3Rpb25zLFxuICAgICAgYXZlcmFnZUNvbm5lY3Rpb25zUGVyTW9kZTogdG90YWxSdWxlcyAvIE9iamVjdC52YWx1ZXMoQ29udmVyc2F0aW9uTW9kZSkubGVuZ3RoLFxuICAgICAgZW1vdGlvbmFsVHJpZ2dlcnM6IE9iamVjdC5rZXlzKHRoaXMuVFJBTlNJVElPTl9GQUNUT1JTLmVtb3Rpb25hbEJpYXMpLmxlbmd0aCxcbiAgICAgIHBhdHRlcm5UcmlnZ2VyczogT2JqZWN0LnZhbHVlcyh0aGlzLk1PREVfVFJJR0dFUlMpLnJlZHVjZSgoc3VtLCBjb25maWcpID0+IHN1bSArIGNvbmZpZy5wYXR0ZXJucy5sZW5ndGgsIDApXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbIkNvbnZlcnNhdGlvbk1vZGUiLCJFbW90aW9uVHlwZSIsIkNvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIiLCJNb2RlVHJhbnNpdGlvbk1hbmFnZXIiLCJNT0RFX1RSSUdHRVJTIiwiVFVUT1JJTkciLCJwYXR0ZXJucyIsImVtb3Rpb25zIiwiQ09ORlVTRUQiLCJDVVJJT1VTIiwiRlJVU1RSQVRFRCIsInRyYW5zaXRpb25NZXNzYWdlIiwiUExBTk5JTkciLCJPVkVSV0hFTE1FRCIsIk1PVElWQVRFRCIsIkFOWElPVVMiLCJPUkdBTklaSU5HIiwiUkVWSUVXSU5HIiwiRElTQVBQT0lOVEVEIiwiUFJPVUQiLCJDSEFUVElORyIsIkhBUFBZIiwiR1JBVEVGVUwiLCJTQUQiLCJFWENJVEVEIiwiVFJBTlNJVElPTl9SVUxFUyIsImNvbmZpZGVuY2UiLCJyZWFzb24iLCJzdWdnZXN0ZWREdXJhdGlvbiIsIlRSQU5TSVRJT05fRkFDVE9SUyIsInRpbWVGYWN0b3JzIiwidG9vU2hvcnQiLCJvcHRpbWFsIiwidG9vTG9uZyIsImVtb3Rpb25hbEJpYXMiLCJCT1JFRCIsInVyZ2VuY3lCaWFzIiwiaGlnaCIsIm1lZGl1bSIsImxvdyIsImFuYWx5emVUcmFuc2l0aW9uTmVlZCIsImNvbnRleHQiLCJjdXJyZW50TW9kZSIsIm1lc3NhZ2UiLCJlbW90aW9uIiwidGltZUluQ3VycmVudE1vZGUiLCJ1cmdlbmN5IiwiZXhwbGljaXRUcmFuc2l0aW9uIiwiZmluZEV4cGxpY2l0TW9kZVRyYW5zaXRpb24iLCJlbW90aW9uYWxUcmFuc2l0aW9uIiwiYW5hbHl6ZUVtb3Rpb25hbFRyYW5zaXRpb24iLCJ0aW1lQmFzZWRUcmFuc2l0aW9uIiwiYW5hbHl6ZVRpbWVCYXNlZFRyYW5zaXRpb24iLCJ1c2VySWQiLCJtZW1vcnlCYXNlZFRyYW5zaXRpb24iLCJhbmFseXplTWVtb3J5UGF0dGVybnMiLCJ0YXJnZXRNb2RlIiwiY29uZmlnIiwiT2JqZWN0IiwiZW50cmllcyIsIm1vZGVFbnVtIiwiaGFzVGV4dFRyaWdnZXIiLCJzb21lIiwicGF0dGVybiIsInRlc3QiLCJ0cmFuc2l0aW9uS2V5IiwicnVsZSIsImZyb21Nb2RlIiwidG9Nb2RlIiwidHJpZ2dlcnMiLCJlbW90aW9uYWxQcmVmZXJlbmNlcyIsInByZWZlcnJlZE1vZGUiLCJnZW5lcmF0ZUVtb3Rpb25hbFRyYW5zaXRpb25NZXNzYWdlIiwicHJldmlvdXNNb2RlcyIsImNvbXBsZW1lbnRhcnlNb2RlcyIsImdldENvbXBsZW1lbnRhcnlNb2RlcyIsImZyZXNoTW9kZSIsImZpbmQiLCJtb2RlIiwic2xpY2UiLCJpbmNsdWRlcyIsIm1lbW9yeSIsImdldE1lbW9yeSIsInNlc3Npb25JZCIsInBsYW5uaW5nVG9waWNzIiwicmVjdXJyaW5nVG9waWNzIiwiZmlsdGVyIiwidCIsImtleXdvcmQiLCJ0b3BpYyIsImxlbmd0aCIsImVtb3Rpb25hbFByb2ZpbGUiLCJtb3RpdmF0aW9uTGV2ZWwiLCJjb21wbGVtZW50YXJ5TWFwIiwiZW1vdGlvbmFsVHJhbnNpdGlvbnMiLCJrZXkiLCJldmFsdWF0ZVRyYW5zaXRpb25RdWFsaXR5IiwidHJhbnNpdGlvbiIsInF1YWxpdHkiLCJNYXRoIiwibWF4IiwibWluIiwiZ2V0VHJhbnNpdGlvblN0YXRzIiwidG90YWxSdWxlcyIsImtleXMiLCJtb2RlQ29ubmVjdGlvbnMiLCJ2YWx1ZXMiLCJtYXAiLCJvdXRnb2luZyIsInN0YXJ0c1dpdGgiLCJpbmNvbWluZyIsImVuZHNXaXRoIiwidG90YWwiLCJ0b3RhbFRyYW5zaXRpb25SdWxlcyIsImF2ZXJhZ2VDb25uZWN0aW9uc1Blck1vZGUiLCJlbW90aW9uYWxUcmlnZ2VycyIsInBhdHRlcm5UcmlnZ2VycyIsInJlZHVjZSIsInN1bSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/mode-transition-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/response-bank.ts":
/*!**********************************!*\
  !*** ./src/lib/response-bank.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ResponseBank: () => (/* binding */ ResponseBank)\n/* harmony export */ });\n/* harmony import */ var _emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./emotion-analyzer */ \"(rsc)/./src/lib/emotion-analyzer.ts\");\n/* harmony import */ var _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./advanced-intent-engine */ \"(rsc)/./src/lib/advanced-intent-engine.ts\");\n// Sistema de Banco de Respuestas Personalizadas para Sara\n// Proporciona respuestas variadas y contextuales basadas en emociones, situaciones y personalidad\n\n\nclass ResponseBank {\n    static{\n        // Respuestas específicas por emoción y contexto\n        this.EMOTION_RESPONSES = {\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FRUSTRATED]: [\n                {\n                    content: \"Entiendo perfectamente tu frustración. Es una reacción completamente normal cuando nos enfrentamos a desafíos complicados.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué parte específica te está costando más trabajo?\",\n                        \"¿Te gustaría que abordemos esto desde otro ángulo?\"\n                    ],\n                    suggestedActions: [\n                        \"Tomar un descanso de 5 minutos\",\n                        \"Dividir el problema en pasos más pequeños\",\n                        \"Revisar conceptos básicos\"\n                    ],\n                    emoji: \"🤗\",\n                    priority: 8\n                },\n                {\n                    content: \"La frustración es señal de que te importa lograr tus objetivos. Eso es admirable, y vamos a canalizar esa energía de manera positiva.\",\n                    tone: 'motivational',\n                    followUp: [\n                        \"¿Qué has intentado hasta ahora?\",\n                        \"¿Cuál crees que podría ser un primer paso más pequeño?\"\n                    ],\n                    suggestedActions: [\n                        \"Respirar profundo\",\n                        \"Escribir qué específicamente no entiendes\",\n                        \"Buscar ejemplos simples\"\n                    ],\n                    emoji: \"💪\",\n                    priority: 7\n                },\n                {\n                    content: \"Sé que esto es frustrante ahora mismo. He ayudado a muchos estudiantes en situaciones similares, y te aseguro que encontraremos la forma de que esto tenga sentido para ti.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Prefieres que simplifiquemos el enfoque?\",\n                        \"¿Te ayudaría ver esto con ejemplos prácticos?\"\n                    ],\n                    suggestedActions: [\n                        \"Cambiar de estrategia de estudio\",\n                        \"Usar analogías simples\",\n                        \"Practicar con ejercicios básicos\"\n                    ],\n                    emoji: \"🌟\",\n                    priority: 6\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.OVERWHELMED]: [\n                {\n                    content: \"Cuando te sientes abrumado, lo más importante es recordar que no tienes que hacerlo todo de una vez. Vamos a organizarlo juntos.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Cuáles son las tareas más urgentes?\",\n                        \"¿Qué fecha límite te preocupa más?\"\n                    ],\n                    suggestedActions: [\n                        \"Hacer una lista de prioridades\",\n                        \"Dividir tareas grandes en pequeñas\",\n                        \"Establecer horarios específicos\"\n                    ],\n                    emoji: \"🗂️\",\n                    priority: 9\n                },\n                {\n                    content: \"Es normal sentirse abrumado con tantas responsabilidades. La clave está en tomar control paso a paso, y yo te voy a acompañar en el proceso.\",\n                    tone: 'professional',\n                    followUp: [\n                        \"¿Qué tal si priorizamos por urgencia?\",\n                        \"¿Hay algo que podamos delegar o posponer?\"\n                    ],\n                    suggestedActions: [\n                        \"Técnica Pomodoro\",\n                        \"Matriz de Eisenhower\",\n                        \"Descansos programados\"\n                    ],\n                    emoji: \"📋\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANXIOUS]: [\n                {\n                    content: \"La ansiedad es tu mente tratando de prepararte para algo importante. Vamos a convertir esa energía nerviosa en preparación efectiva.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué específicamente te preocupa más?\",\n                        \"¿Has tenido experiencias similares antes?\"\n                    ],\n                    suggestedActions: [\n                        \"Técnicas de respiración\",\n                        \"Visualización positiva\",\n                        \"Preparación estructurada\"\n                    ],\n                    emoji: \"🧘‍♀️\",\n                    priority: 9\n                },\n                {\n                    content: \"Entiendo que sientes ansiedad. Es importante que sepas que estar nervioso también puede ser señal de que te importa hacer las cosas bien.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Te ayudaría repasar lo que ya sabes?\",\n                        \"¿Qué te tranquilizaría más en este momento?\"\n                    ],\n                    suggestedActions: [\n                        \"Repasar material conocido\",\n                        \"Simular la situación\",\n                        \"Hablar con alguien de confianza\"\n                    ],\n                    emoji: \"💚\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFUSED]: [\n                {\n                    content: \"La confusión es el primer paso hacia la comprensión. Significa que tu mente está procesando nueva información. Vamos a aclarar las dudas juntos.\",\n                    tone: 'professional',\n                    followUp: [\n                        \"¿En qué punto específico perdiste el hilo?\",\n                        \"¿Te gustaría que empecemos desde un concepto más básico?\"\n                    ],\n                    suggestedActions: [\n                        \"Mapas conceptuales\",\n                        \"Explicaciones paso a paso\",\n                        \"Ejemplos concretos\"\n                    ],\n                    emoji: \"🤔\",\n                    priority: 9\n                },\n                {\n                    content: \"No te preocupes por estar confundido. Es totalmente normal cuando aprendemos algo nuevo. Mi trabajo es hacer que todo esto tenga sentido para ti.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué parte entiendes bien hasta ahora?\",\n                        \"¿Desde dónde te gustaría que empezáramos?\"\n                    ],\n                    suggestedActions: [\n                        \"Revisar prerrequisitos\",\n                        \"Usar analogías\",\n                        \"Práctica guiada\"\n                    ],\n                    emoji: \"💡\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.MOTIVATED]: [\n                {\n                    content: \"¡Me encanta ver tu motivación! Esta es la actitud perfecta para lograr grandes cosas. Vamos a aprovechar esta energía al máximo.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué objetivo específico quieres alcanzar?\",\n                        \"¿Cómo te imaginas celebrando cuando lo logres?\"\n                    ],\n                    suggestedActions: [\n                        \"Establecer metas claras\",\n                        \"Crear plan de acción\",\n                        \"Tracking de progreso\"\n                    ],\n                    emoji: \"🚀\",\n                    priority: 9\n                },\n                {\n                    content: \"Tu motivación es contagiosa. Con esta actitud, estoy segura de que vas a superar cualquier desafío que se presente.\",\n                    tone: 'motivational',\n                    followUp: [\n                        \"¿En qué área quieres enfocarte primero?\",\n                        \"¿Qué te inspira más de este objetivo?\"\n                    ],\n                    suggestedActions: [\n                        \"Objetivos SMART\",\n                        \"Recompensas por progreso\",\n                        \"Visualización del éxito\"\n                    ],\n                    emoji: \"⭐\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.PROUD]: [\n                {\n                    content: \"¡Qué orgullo me da ver tu progreso! Te mereces celebrar este logro. Has trabajado duro para llegar hasta aquí.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Cómo te sientes con lo que has logrado?\",\n                        \"¿Qué fue lo que más te ayudó a conseguirlo?\"\n                    ],\n                    suggestedActions: [\n                        \"Reflexionar sobre el proceso\",\n                        \"Compartir el logro\",\n                        \"Establecer siguiente meta\"\n                    ],\n                    emoji: \"🎉\",\n                    priority: 9\n                },\n                {\n                    content: \"Es maravilloso verte tan satisfecho con tu trabajo. Este tipo de logros construyen confianza para enfrentar desafíos futuros.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué estrategia te funcionó mejor?\",\n                        \"¿Te sientes listo para el siguiente nivel?\"\n                    ],\n                    suggestedActions: [\n                        \"Documentar la estrategia exitosa\",\n                        \"Enseñar a otros\",\n                        \"Aplicar lo aprendido\"\n                    ],\n                    emoji: \"👏\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.GRATEFUL]: [\n                {\n                    content: \"Me alegra mucho saber que mi ayuda te ha sido útil. Ver tu progreso y crecimiento es exactamente la razón por la cual estoy aquí.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Hay algo más en lo que pueda apoyarte?\",\n                        \"¿Te sientes preparado para continuar por tu cuenta?\"\n                    ],\n                    suggestedActions: [\n                        \"Practicar independientemente\",\n                        \"Ayudar a otros estudiantes\",\n                        \"Reflexionar sobre el aprendizaje\"\n                    ],\n                    emoji: \"😊\",\n                    priority: 9\n                },\n                {\n                    content: \"Tu gratitud significa mucho para mí. Es un placer acompañarte en tu camino de aprendizaje y ver cómo cada día te vuelves más capaz.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué aspecto de nuestro trabajo juntos te ha resultado más valioso?\"\n                    ],\n                    suggestedActions: [\n                        \"Continuar practicando\",\n                        \"Mantener la curiosidad\",\n                        \"Seguir preguntando\"\n                    ],\n                    emoji: \"💝\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.EXCITED]: [\n                {\n                    content: \"¡Tu entusiasmo es fantástico! Esta energía positiva es el combustible perfecto para el aprendizaje. Vamos a canalizar toda esa emoción.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te emociona más de esto?\",\n                        \"¿Cómo podemos aprovechar esta motivación?\"\n                    ],\n                    suggestedActions: [\n                        \"Explorar temas relacionados\",\n                        \"Crear proyectos personales\",\n                        \"Compartir el entusiasmo\"\n                    ],\n                    emoji: \"✨\",\n                    priority: 9\n                },\n                {\n                    content: \"Me encanta ver tu emoción por aprender. Los estudiantes que se entusiasman así son los que realmente transforman su conocimiento en algo extraordinario.\",\n                    tone: 'motivational',\n                    followUp: [\n                        \"¿Te gustaría profundizar en algún aspecto específico?\",\n                        \"¿Qué otros temas te despiertan curiosidad?\"\n                    ],\n                    suggestedActions: [\n                        \"Investigación independiente\",\n                        \"Proyectos creativos\",\n                        \"Conectar con otros entusiastas\"\n                    ],\n                    emoji: \"🌟\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.DISAPPOINTED]: [\n                {\n                    content: \"Entiendo tu decepción, y es válido sentirse así cuando las cosas no salen como esperábamos. Esto no define tu capacidad, solo es información para mejorar.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué específicamente no salió como esperabas?\",\n                        \"¿Qué aprendizajes puedes sacar de esta experiencia?\"\n                    ],\n                    suggestedActions: [\n                        \"Analizar qué pasó\",\n                        \"Ajustar estrategias\",\n                        \"Establecer expectativas realistas\"\n                    ],\n                    emoji: \"🤗\",\n                    priority: 9\n                },\n                {\n                    content: \"La decepción duele, pero también puede ser un maestro valioso. Los estudiantes más exitosos han pasado por momentos como este y han salido más fuertes.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Te gustaría hablar sobre lo que pasó?\",\n                        \"¿Cómo podemos enfocar esto de manera diferente?\"\n                    ],\n                    suggestedActions: [\n                        \"Reflexión constructiva\",\n                        \"Buscar feedback\",\n                        \"Replantear objetivos\"\n                    ],\n                    emoji: \"💚\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CURIOUS]: [\n                {\n                    content: \"¡Me encanta tu curiosidad! Las preguntas son el motor del aprendizaje real. Vamos a explorar todo lo que quieras saber.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te gustaría descubrir primero?\",\n                        \"¿Hay algo específico que te ha despertado esta curiosidad?\"\n                    ],\n                    suggestedActions: [\n                        \"Investigación guiada\",\n                        \"Experimentación práctica\",\n                        \"Preguntas abiertas\"\n                    ],\n                    emoji: \"🔍\",\n                    priority: 9\n                },\n                {\n                    content: \"Tu curiosidad es una herramienta poderosa. Los estudiantes curiosos como tú son los que hacen conexiones innovadoras y descubren cosas fascinantes.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Desde qué ángulo te gustaría abordar esto?\",\n                        \"¿Qué hipótesis tienes sobre esto?\"\n                    ],\n                    suggestedActions: [\n                        \"Exploración libre\",\n                        \"Hacer experimentos\",\n                        \"Buscar múltiples perspectivas\"\n                    ],\n                    emoji: \"🧩\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.BORED]: [\n                {\n                    content: \"Entiendo que esto pueda parecer aburrido ahora mismo. Vamos a encontrar una forma más interesante de abordar el tema que conecte con tus intereses.\",\n                    tone: 'motivational',\n                    followUp: [\n                        \"¿Qué temas te resultan más interesantes?\",\n                        \"¿Cómo podríamos hacer esto más relevante para ti?\"\n                    ],\n                    suggestedActions: [\n                        \"Buscar aplicaciones prácticas\",\n                        \"Cambiar de formato\",\n                        \"Conectar con intereses personales\"\n                    ],\n                    emoji: \"🎯\",\n                    priority: 9\n                },\n                {\n                    content: \"El aburrimiento a veces es señal de que necesitamos un enfoque diferente. Todos los temas tienen aspectos fascinantes cuando los miramos desde el ángulo correcto.\",\n                    tone: 'motivational',\n                    followUp: [\n                        \"¿Qué te parece más relevante en tu vida diaria?\",\n                        \"¿Te gustaría que busquemos ejemplos más interesantes?\"\n                    ],\n                    suggestedActions: [\n                        \"Gamificación\",\n                        \"Ejemplos del mundo real\",\n                        \"Aprendizaje activo\"\n                    ],\n                    emoji: \"⚡\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.STRESSED]: [\n                {\n                    content: \"El estrés puede ser abrumador, pero también puede ser señal de que te importa hacer las cosas bien. Vamos a encontrar formas de manejarlo efectivamente.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué es lo que más te está estresando ahora?\",\n                        \"¿Has probado alguna técnica de manejo del estrés?\"\n                    ],\n                    suggestedActions: [\n                        \"Técnicas de relajación\",\n                        \"Organización del tiempo\",\n                        \"Ejercicio físico\"\n                    ],\n                    emoji: \"🧘‍♀️\",\n                    priority: 9\n                },\n                {\n                    content: \"Cuando estamos estresados, nuestro cerebro puede bloquearse. Vamos a crear un ambiente más relajado para que puedas pensar con claridad.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Te ayudaría tomar un descanso primero?\",\n                        \"¿Qué normalmente te ayuda a relajarte?\"\n                    ],\n                    suggestedActions: [\n                        \"Respiración profunda\",\n                        \"Descansos frecuentes\",\n                        \"Priorización de tareas\"\n                    ],\n                    emoji: \"🌸\",\n                    priority: 8\n                }\n            ],\n            // Emociones básicas con respuestas contextuales\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.HAPPY]: [\n                {\n                    content: \"¡Qué alegría verte tan feliz! Esta energía positiva es perfecta para aprender y crear cosas increíbles.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te tiene tan contento?\",\n                        \"¿Cómo podemos aprovechar esta buena energía?\"\n                    ],\n                    suggestedActions: [\n                        \"Aprovechar el momento\",\n                        \"Tackle desafíos\",\n                        \"Compartir la alegría\"\n                    ],\n                    emoji: \"😄\",\n                    priority: 7\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.SAD]: [\n                {\n                    content: \"Veo que no te sientes muy bien. Está bien tener días difíciles. Estoy aquí para apoyarte en lo que necesites.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Te gustaría hablar sobre lo que te tiene triste?\",\n                        \"¿Hay algo que pueda hacer para ayudarte?\"\n                    ],\n                    suggestedActions: [\n                        \"Hablar con alguien\",\n                        \"Actividades que te gusten\",\n                        \"Tomar las cosas con calma\"\n                    ],\n                    emoji: \"🤗\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFIDENT]: [\n                {\n                    content: \"Me encanta ver tu confianza. Esa seguridad en ti mismo es una base sólida para lograr cualquier cosa que te propongas.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te ha dado esa confianza?\",\n                        \"¿Estás listo para un nuevo desafío?\"\n                    ],\n                    suggestedActions: [\n                        \"Asumir nuevos retos\",\n                        \"Ayudar a otros\",\n                        \"Expandir conocimientos\"\n                    ],\n                    emoji: \"💪\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.HOPEFUL]: [\n                {\n                    content: \"Tu esperanza es muy valiosa. Mantener esa actitud positiva hacia el futuro te va a llevar lejos.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te da esa esperanza?\",\n                        \"¿Cómo podemos trabajar hacia esa visión?\"\n                    ],\n                    suggestedActions: [\n                        \"Planificar pasos concretos\",\n                        \"Mantener optimismo\",\n                        \"Celebrar pequeños avances\"\n                    ],\n                    emoji: \"🌈\",\n                    priority: 7\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.RELIEVED]: [\n                {\n                    content: \"Qué alivio debe ser haber superado eso. Es una sensación maravillosa cuando las cosas finalmente encajan.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Cómo te sientes ahora que pasó?\",\n                        \"¿Qué aprendiste del proceso?\"\n                    ],\n                    suggestedActions: [\n                        \"Reflexionar sobre el aprendizaje\",\n                        \"Descansar\",\n                        \"Prepararse para lo siguiente\"\n                    ],\n                    emoji: \"😌\",\n                    priority: 7\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANGRY]: [\n                {\n                    content: \"Entiendo que estés enojado. A veces las emociones fuertes son señal de que algo necesita cambiar. Vamos a canalizar esa energía de forma constructiva.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué específicamente te tiene molesto?\",\n                        \"¿Cómo podríamos abordar esto de manera diferente?\"\n                    ],\n                    suggestedActions: [\n                        \"Tomar un respiro\",\n                        \"Identificar la causa\",\n                        \"Buscar soluciones\"\n                    ],\n                    emoji: \"🤗\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FEAR]: [\n                {\n                    content: \"Es normal sentir miedo ante lo desconocido. El coraje no es la ausencia de miedo, sino actuar a pesar de él.\",\n                    tone: 'empathetic',\n                    followUp: [\n                        \"¿Qué específicamente te da miedo?\",\n                        \"¿Cómo podemos hacer esto menos intimidante?\"\n                    ],\n                    suggestedActions: [\n                        \"Preparación gradual\",\n                        \"Apoyo adicional\",\n                        \"Técnicas de relajación\"\n                    ],\n                    emoji: \"🤗\",\n                    priority: 8\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.SURPRISE]: [\n                {\n                    content: \"¡Qué sorpresa interesante! A veces los descubrimientos inesperados son los más valiosos.\",\n                    tone: 'encouraging',\n                    followUp: [\n                        \"¿Qué te sorprendió más?\",\n                        \"¿Cómo cambió esto tu perspectiva?\"\n                    ],\n                    suggestedActions: [\n                        \"Explorar más\",\n                        \"Conectar con conocimientos previos\",\n                        \"Documentar el descubrimiento\"\n                    ],\n                    emoji: \"😲\",\n                    priority: 6\n                }\n            ],\n            [_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL]: [\n                {\n                    content: \"Perfecto, vamos a trabajar juntos en esto. Estoy aquí para ayudarte con cualquier cosa que necesites.\",\n                    tone: 'professional',\n                    followUp: [\n                        \"¿Por dónde te gustaría empezar?\",\n                        \"¿Hay algo específico en lo que quieres enfocarte?\"\n                    ],\n                    suggestedActions: [\n                        \"Establecer objetivos claros\",\n                        \"Evaluar conocimientos previos\",\n                        \"Crear plan de trabajo\"\n                    ],\n                    emoji: \"📚\",\n                    priority: 5\n                }\n            ]\n        };\n    }\n    static{\n        // Respuestas específicas por contexto y situación\n        this.CONTEXTUAL_RESPONSES = {\n            // Respuestas por hora del día\n            timeOfDay: {\n                morning: [\n                    \"¡Buenos días! Me encanta empezar el día aprendiendo algo nuevo. Tu mente está fresca y lista para absorber información.\",\n                    \"¡Qué buena hora para estudiar! Las mañanas son perfectas para temas que requieren concentración.\"\n                ],\n                afternoon: [\n                    \"¡Buenas tardes! Es un momento excelente para repasar y consolidar lo que has aprendido en la mañana.\",\n                    \"La tarde es ideal para práctica y aplicación. Vamos a poner en acción lo que sabes.\"\n                ],\n                evening: [\n                    \"¡Buenas tardes! Las tardes son perfectas para reflexionar sobre lo aprendido y planificar el siguiente día.\",\n                    \"Aprovechemos esta hora más relajada para conceptos que requieren reflexión profunda.\"\n                ],\n                night: [\n                    \"¡Qué dedicación estudiar a esta hora! Asegurémonos de que puedas descansar bien después de nuestra sesión.\",\n                    \"Las noches pueden ser muy productivas para ciertos tipos de estudio. Vamos a hacer que valga la pena.\"\n                ]\n            },\n            // Respuestas por materia\n            subjects: {\n                'matemáticas': [\n                    \"Las matemáticas son como un idioma universal. Una vez que entiendes la lógica, todo empieza a tener sentido.\",\n                    \"En matemáticas, cada error es una oportunidad de aprender. Vamos a convertir las dificultades en entendimiento.\"\n                ],\n                'química': [\n                    \"La química es fascinante porque explica cómo funciona el mundo a nivel molecular. Cada reacción cuenta una historia.\",\n                    \"En química, la práctica con problemas reales te ayuda a visualizar los conceptos abstractos.\"\n                ],\n                'física': [\n                    \"La física nos ayuda a entender el universo desde lo más pequeño hasta lo más grande. Es pura elegancia matemática.\",\n                    \"En física, los conceptos están conectados. Una vez que veas las relaciones, todo se vuelve más claro.\"\n                ],\n                'historia': [\n                    \"La historia nos enseña que los eventos del pasado moldean nuestro presente. Cada época tiene lecciones valiosas.\",\n                    \"Estudiar historia es como ser un detective del tiempo, conectando pistas para entender grandes narrativas.\"\n                ],\n                'literatura': [\n                    \"La literatura nos permite vivir mil vidas diferentes y entender la experiencia humana desde múltiples perspectivas.\",\n                    \"Cada texto literario es un mundo. Vamos a explorarlo juntos y descubrir sus secretos.\"\n                ]\n            },\n            // Respuestas por urgencia\n            urgency: {\n                high: [\n                    \"Entiendo que esto es urgente. Vamos a enfocarnos en lo más importante y hacer que cada minuto cuente.\",\n                    \"Con tiempo limitado, la clave es priorizar. Vamos directo a lo esencial.\"\n                ],\n                medium: [\n                    \"Tenemos tiempo suficiente para hacer esto bien. Vamos a ser metódicos pero eficientes.\",\n                    \"Perfecto, podemos tomarnos el tiempo necesario para entender todo a fondo.\"\n                ],\n                low: [\n                    \"¡Excelente! Con tiempo de sobra podemos explorar el tema en profundidad y hasta ver extensiones interesantes.\",\n                    \"Con esta tranquilidad podemos realmente disfrutar el proceso de aprendizaje.\"\n                ]\n            }\n        };\n    }\n    static{\n        // Respuestas motivacionales por tiempo de sesión\n        this.SESSION_RESPONSES = {\n            short: [\n                \"Aprovechemos estos minutos al máximo. Vamos a ser súper eficientes.\",\n                \"Sesiones cortas pero intensas pueden ser muy efectivas. ¡Enfoquémonos!\"\n            ],\n            medium: [\n                \"Tenemos un buen tiempo para trabajar. Vamos a dividirlo en segmentos productivos.\",\n                \"Esta duración es perfecta para abordar varios aspectos del tema.\"\n            ],\n            long: [\n                \"Con tanto tiempo disponible podemos profundizar realmente. ¡Va a ser una sesión increíble!\",\n                \"Excelente, podemos tomarnos descansos y trabajar a un ritmo cómodo pero productivo.\"\n            ]\n        };\n    }\n    /**\n   * Selecciona la respuesta más apropiada basada en el contexto completo\n   */ static selectPersonalizedResponse(context) {\n        const emotionResponses = this.EMOTION_RESPONSES[context.emotion] || this.EMOTION_RESPONSES[_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL];\n        // Filtrar respuestas por contexto adicional\n        let suitableResponses = emotionResponses.filter((response)=>{\n            // Filtrar por modo si es relevante\n            if (context.mode === _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.ConversationMode.TUTORING && response.tone === 'casual') return false;\n            if (context.mode === _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_1__.ConversationMode.CHATTING && response.tone === 'professional') return false;\n            return true;\n        });\n        // Si no hay respuestas adecuadas, usar todas las de la emoción\n        if (suitableResponses.length === 0) {\n            suitableResponses = emotionResponses;\n        }\n        // Ordenar por prioridad y seleccionar la mejor\n        suitableResponses.sort((a, b)=>b.priority - a.priority);\n        let selectedResponse = suitableResponses[0];\n        // Enriquecer la respuesta con contexto adicional\n        selectedResponse = this.enrichWithContext(selectedResponse, context);\n        return selectedResponse;\n    }\n    /**\n   * Enriquece una respuesta base con contexto adicional\n   */ static enrichWithContext(baseResponse, context) {\n        let enrichedContent = baseResponse.content;\n        // Agregar saludo contextual por hora\n        if (context.timeOfDay) {\n            const timeGreetings = this.CONTEXTUAL_RESPONSES.timeOfDay[context.timeOfDay];\n            if (Math.random() < 0.3) {\n                enrichedContent = `${timeGreetings[Math.floor(Math.random() * timeGreetings.length)]} ${enrichedContent}`;\n            }\n        }\n        // Agregar contexto de materia si es relevante\n        if (context.subject && this.CONTEXTUAL_RESPONSES.subjects[context.subject]) {\n            const subjectResponses = this.CONTEXTUAL_RESPONSES.subjects[context.subject];\n            if (Math.random() < 0.4) {\n                enrichedContent += ` ${subjectResponses[Math.floor(Math.random() * subjectResponses.length)]}`;\n            }\n        }\n        // Enriquecer acciones sugeridas basadas en urgencia\n        let enrichedActions = [\n            ...baseResponse.suggestedActions || []\n        ];\n        if (context.urgency === 'high') {\n            enrichedActions.unshift(\"Enfoque en lo esencial\", \"Técnica de 25 minutos\");\n        } else if (context.urgency === 'low') {\n            enrichedActions.push(\"Explorar temas relacionados\", \"Profundizar conceptos\");\n        }\n        // Ajustar follow-ups basado en la duración de sesión\n        let enrichedFollowUps = [\n            ...baseResponse.followUp || []\n        ];\n        if (context.sessionLength === 'long') {\n            enrichedFollowUps.push(\"¿Te gustaría que exploremos esto más a fondo?\", \"¿Qué otros aspectos te interesan?\");\n        } else if (context.sessionLength === 'short') {\n            enrichedFollowUps = enrichedFollowUps.slice(0, 1) // Solo una pregunta de seguimiento\n            ;\n        }\n        return {\n            ...baseResponse,\n            content: enrichedContent,\n            suggestedActions: enrichedActions,\n            followUp: enrichedFollowUps\n        };\n    }\n    /**\n   * Genera una respuesta completamente aleatoria para variedad\n   */ static getRandomVariedResponse(emotion) {\n        const responses = this.EMOTION_RESPONSES[emotion] || this.EMOTION_RESPONSES[_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.NEUTRAL];\n        return responses[Math.floor(Math.random() * responses.length)];\n    }\n    /**\n   * Obtiene respuestas de transición entre emociones\n   */ static getTransitionResponse(fromEmotion, toEmotion) {\n        const transitions = {\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.FRUSTRATED}_${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.MOTIVATED}`]: \"¡Me alegra ver cómo has transformado esa frustración en determinación! Esa es la actitud que lleva al éxito.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFUSED}_${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.CONFIDENT}`]: \"¡Increíble! De la confusión inicial has llegado a una comprensión sólida. Ese es el verdadero aprendizaje.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.ANXIOUS}_${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.RELIEVED}`]: \"Qué alivio debe ser haber superado esa ansiedad. Has demostrado que puedes manejar los desafíos.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.OVERWHELMED}_${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.HOPEFUL}`]: \"Es maravilloso ver cómo has pasado de sentirte abrumado a tener esperanza. Esa es una transformación poderosa.\",\n            [`${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.DISAPPOINTED}_${_emotion_analyzer__WEBPACK_IMPORTED_MODULE_0__.EmotionType.DETERMINED}`]: \"Ver cómo conviertes la decepción en determinación es inspirador. Esa resiliencia te llevará lejos.\"\n        };\n        const key = `${fromEmotion}_${toEmotion}`;\n        return transitions[key] || \"Me gusta ver cómo evolucionan tus emociones. Cada cambio es parte de tu crecimiento.\";\n    }\n    /**\n   * Obtiene el total de respuestas disponibles\n   */ static getTotalResponseCount() {\n        return Object.values(this.EMOTION_RESPONSES).reduce((total, responses)=>total + responses.length, 0);\n    }\n    /**\n   * Obtiene estadísticas del banco de respuestas\n   */ static getResponseStats() {\n        const stats = {\n            totalResponses: this.getTotalResponseCount(),\n            emotionCoverage: Object.keys(this.EMOTION_RESPONSES).length,\n            averageResponsesPerEmotion: 0,\n            toneDistribution: {},\n            priorityDistribution: {}\n        };\n        stats.averageResponsesPerEmotion = Math.round(stats.totalResponses / stats.emotionCoverage);\n        // Analizar distribución de tonos y prioridades\n        Object.values(this.EMOTION_RESPONSES).flat().forEach((response)=>{\n            stats.toneDistribution[response.tone] = (stats.toneDistribution[response.tone] || 0) + 1;\n            const priorityRange = response.priority >= 8 ? 'high' : response.priority >= 6 ? 'medium' : 'low';\n            stats.priorityDistribution[priorityRange] = (stats.priorityDistribution[priorityRange] || 0) + 1;\n        });\n        return stats;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QzdCO0lBRUE7O0dBRUMsR0FDRCxPQUFPQyx3QkFBZ0M7UUFDckMsT0FBT0MsT0FBT0MsTUFBTSxDQUFDLElBQUksQ0FBQ2xGLGlCQUFpQixFQUN4Q21GLE1BQU0sQ0FBQyxDQUFDQyxPQUFPWCxZQUFjVyxRQUFRWCxVQUFVckIsTUFBTSxFQUFFO0lBQzVEO0lBRUE7O0dBRUMsR0FDRCxPQUFPaUMsbUJBQW1CO1FBQ3hCLE1BQU1DLFFBQVE7WUFDWkMsZ0JBQWdCLElBQUksQ0FBQ1AscUJBQXFCO1lBQzFDUSxpQkFBaUJQLE9BQU9RLElBQUksQ0FBQyxJQUFJLENBQUN6RixpQkFBaUIsRUFBRW9ELE1BQU07WUFDM0RzQyw0QkFBNEI7WUFDNUJDLGtCQUFrQixDQUFDO1lBQ25CQyxzQkFBc0IsQ0FBQztRQUN6QjtRQUVBTixNQUFNSSwwQkFBMEIsR0FBRzdCLEtBQUtnQyxLQUFLLENBQUNQLE1BQU1DLGNBQWMsR0FBR0QsTUFBTUUsZUFBZTtRQUUxRiwrQ0FBK0M7UUFDL0NQLE9BQU9DLE1BQU0sQ0FBQyxJQUFJLENBQUNsRixpQkFBaUIsRUFBRThGLElBQUksR0FBR0MsT0FBTyxDQUFDL0MsQ0FBQUE7WUFDbkRzQyxNQUFNSyxnQkFBZ0IsQ0FBQzNDLFNBQVM3QyxJQUFJLENBQUMsR0FBRyxDQUFDbUYsTUFBTUssZ0JBQWdCLENBQUMzQyxTQUFTN0MsSUFBSSxDQUFDLElBQUksS0FBSztZQUN2RixNQUFNNkYsZ0JBQWdCaEQsU0FBU3pDLFFBQVEsSUFBSSxJQUFJLFNBQVN5QyxTQUFTekMsUUFBUSxJQUFJLElBQUksV0FBVztZQUM1RitFLE1BQU1NLG9CQUFvQixDQUFDSSxjQUFjLEdBQUcsQ0FBQ1YsTUFBTU0sb0JBQW9CLENBQUNJLGNBQWMsSUFBSSxLQUFLO1FBQ2pHO1FBRUEsT0FBT1Y7SUFDVDtBQUNGIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL3Jlc3BvbnNlLWJhbmsudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2lzdGVtYSBkZSBCYW5jbyBkZSBSZXNwdWVzdGFzIFBlcnNvbmFsaXphZGFzIHBhcmEgU2FyYVxuLy8gUHJvcG9yY2lvbmEgcmVzcHVlc3RhcyB2YXJpYWRhcyB5IGNvbnRleHR1YWxlcyBiYXNhZGFzIGVuIGVtb2Npb25lcywgc2l0dWFjaW9uZXMgeSBwZXJzb25hbGlkYWRcblxuaW1wb3J0IHsgRW1vdGlvblR5cGUgfSBmcm9tICcuL2Vtb3Rpb24tYW5hbHl6ZXInXG5pbXBvcnQgeyBDb252ZXJzYXRpb25Nb2RlIH0gZnJvbSAnLi9hZHZhbmNlZC1pbnRlbnQtZW5naW5lJ1xuXG5leHBvcnQgaW50ZXJmYWNlIFJlc3BvbnNlQ29udGV4dCB7XG4gIGVtb3Rpb246IEVtb3Rpb25UeXBlXG4gIG1vZGU6IENvbnZlcnNhdGlvbk1vZGVcbiAgc3ViamVjdD86IHN0cmluZ1xuICB0aW1lT2ZEYXk/OiAnbW9ybmluZycgfCAnYWZ0ZXJub29uJyB8ICdldmVuaW5nJyB8ICduaWdodCdcbiAgc3R1ZGVudExldmVsPzogJ2JlZ2lubmVyJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJ1xuICBwcmV2aW91c0ludGVyYWN0aW9uPzogJ3Bvc2l0aXZlJyB8ICduZWdhdGl2ZScgfCAnbmV1dHJhbCdcbiAgdXJnZW5jeT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgc2Vzc2lvbkxlbmd0aD86ICdzaG9ydCcgfCAnbWVkaXVtJyB8ICdsb25nJ1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBlcnNvbmFsaXplZFJlc3BvbnNlIHtcbiAgY29udGVudDogc3RyaW5nXG4gIHRvbmU6ICdmb3JtYWwnIHwgJ2Nhc3VhbCcgfCAnZW1wYXRoZXRpYycgfCAnZW5jb3VyYWdpbmcnIHwgJ3Byb2Zlc3Npb25hbCcgfCAnbW90aXZhdGlvbmFsJ1xuICBmb2xsb3dVcD86IHN0cmluZ1tdXG4gIHN1Z2dlc3RlZEFjdGlvbnM/OiBzdHJpbmdbXVxuICBlbW9qaT86IHN0cmluZ1xuICBwcmlvcml0eTogbnVtYmVyIC8vIDEtMTAsIG1heW9yIHByaW9yaWRhZCA9IG3DoXMgZXNwZWPDrWZpY28vcmVsZXZhbnRlXG59XG5cbmV4cG9ydCBjbGFzcyBSZXNwb25zZUJhbmsge1xuICBcbiAgLy8gUmVzcHVlc3RhcyBlc3BlY8OtZmljYXMgcG9yIGVtb2Npw7NuIHkgY29udGV4dG9cbiAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgRU1PVElPTl9SRVNQT05TRVM6IHsgW2tleSBpbiBFbW90aW9uVHlwZV06IFBlcnNvbmFsaXplZFJlc3BvbnNlW10gfSA9IHtcbiAgICBcbiAgICBbRW1vdGlvblR5cGUuRlJVU1RSQVRFRF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJFbnRpZW5kbyBwZXJmZWN0YW1lbnRlIHR1IGZydXN0cmFjacOzbi4gRXMgdW5hIHJlYWNjacOzbiBjb21wbGV0YW1lbnRlIG5vcm1hbCBjdWFuZG8gbm9zIGVuZnJlbnRhbW9zIGEgZGVzYWbDrW9zIGNvbXBsaWNhZG9zLlwiLFxuICAgICAgICB0b25lOiAnZW1wYXRoZXRpYycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgcGFydGUgZXNwZWPDrWZpY2EgdGUgZXN0w6EgY29zdGFuZG8gbcOhcyB0cmFiYWpvP1wiLCBcIsK/VGUgZ3VzdGFyw61hIHF1ZSBhYm9yZGVtb3MgZXN0byBkZXNkZSBvdHJvIMOhbmd1bG8/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJUb21hciB1biBkZXNjYW5zbyBkZSA1IG1pbnV0b3NcIiwgXCJEaXZpZGlyIGVsIHByb2JsZW1hIGVuIHBhc29zIG3DoXMgcGVxdWXDsW9zXCIsIFwiUmV2aXNhciBjb25jZXB0b3MgYsOhc2ljb3NcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfpJdcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiTGEgZnJ1c3RyYWNpw7NuIGVzIHNlw7FhbCBkZSBxdWUgdGUgaW1wb3J0YSBsb2dyYXIgdHVzIG9iamV0aXZvcy4gRXNvIGVzIGFkbWlyYWJsZSwgeSB2YW1vcyBhIGNhbmFsaXphciBlc2EgZW5lcmfDrWEgZGUgbWFuZXJhIHBvc2l0aXZhLlwiLFxuICAgICAgICB0b25lOiAnbW90aXZhdGlvbmFsJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSBoYXMgaW50ZW50YWRvIGhhc3RhIGFob3JhP1wiLCBcIsK/Q3XDoWwgY3JlZXMgcXVlIHBvZHLDrWEgc2VyIHVuIHByaW1lciBwYXNvIG3DoXMgcGVxdWXDsW8/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJSZXNwaXJhciBwcm9mdW5kb1wiLCBcIkVzY3JpYmlyIHF1w6kgZXNwZWPDrWZpY2FtZW50ZSBubyBlbnRpZW5kZXNcIiwgXCJCdXNjYXIgZWplbXBsb3Mgc2ltcGxlc1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+SqlwiLFxuICAgICAgICBwcmlvcml0eTogN1xuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJTw6kgcXVlIGVzdG8gZXMgZnJ1c3RyYW50ZSBhaG9yYSBtaXNtby4gSGUgYXl1ZGFkbyBhIG11Y2hvcyBlc3R1ZGlhbnRlcyBlbiBzaXR1YWNpb25lcyBzaW1pbGFyZXMsIHkgdGUgYXNlZ3VybyBxdWUgZW5jb250cmFyZW1vcyBsYSBmb3JtYSBkZSBxdWUgZXN0byB0ZW5nYSBzZW50aWRvIHBhcmEgdGkuXCIsXG4gICAgICAgIHRvbmU6ICdlbXBhdGhldGljJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UHJlZmllcmVzIHF1ZSBzaW1wbGlmaXF1ZW1vcyBlbCBlbmZvcXVlP1wiLCBcIsK/VGUgYXl1ZGFyw61hIHZlciBlc3RvIGNvbiBlamVtcGxvcyBwcsOhY3RpY29zP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiQ2FtYmlhciBkZSBlc3RyYXRlZ2lhIGRlIGVzdHVkaW9cIiwgXCJVc2FyIGFuYWxvZ8OtYXMgc2ltcGxlc1wiLCBcIlByYWN0aWNhciBjb24gZWplcmNpY2lvcyBiw6FzaWNvc1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+Mn1wiLFxuICAgICAgICBwcmlvcml0eTogNlxuICAgICAgfVxuICAgIF0sXG5cbiAgICBbRW1vdGlvblR5cGUuT1ZFUldIRUxNRURdOiBbXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiQ3VhbmRvIHRlIHNpZW50ZXMgYWJydW1hZG8sIGxvIG3DoXMgaW1wb3J0YW50ZSBlcyByZWNvcmRhciBxdWUgbm8gdGllbmVzIHF1ZSBoYWNlcmxvIHRvZG8gZGUgdW5hIHZlei4gVmFtb3MgYSBvcmdhbml6YXJsbyBqdW50b3MuXCIsXG4gICAgICAgIHRvbmU6ICdlbXBhdGhldGljJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/Q3XDoWxlcyBzb24gbGFzIHRhcmVhcyBtw6FzIHVyZ2VudGVzP1wiLCBcIsK/UXXDqSBmZWNoYSBsw61taXRlIHRlIHByZW9jdXBhIG3DoXM/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJIYWNlciB1bmEgbGlzdGEgZGUgcHJpb3JpZGFkZXNcIiwgXCJEaXZpZGlyIHRhcmVhcyBncmFuZGVzIGVuIHBlcXVlw7Fhc1wiLCBcIkVzdGFibGVjZXIgaG9yYXJpb3MgZXNwZWPDrWZpY29zXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5eC77iPXCIsXG4gICAgICAgIHByaW9yaXR5OiA5XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIkVzIG5vcm1hbCBzZW50aXJzZSBhYnJ1bWFkbyBjb24gdGFudGFzIHJlc3BvbnNhYmlsaWRhZGVzLiBMYSBjbGF2ZSBlc3TDoSBlbiB0b21hciBjb250cm9sIHBhc28gYSBwYXNvLCB5IHlvIHRlIHZveSBhIGFjb21wYcOxYXIgZW4gZWwgcHJvY2Vzby5cIixcbiAgICAgICAgdG9uZTogJ3Byb2Zlc3Npb25hbCcsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgdGFsIHNpIHByaW9yaXphbW9zIHBvciB1cmdlbmNpYT9cIiwgXCLCv0hheSBhbGdvIHF1ZSBwb2RhbW9zIGRlbGVnYXIgbyBwb3Nwb25lcj9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIlTDqWNuaWNhIFBvbW9kb3JvXCIsIFwiTWF0cml6IGRlIEVpc2VuaG93ZXJcIiwgXCJEZXNjYW5zb3MgcHJvZ3JhbWFkb3NcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfk4tcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLkFOWElPVVNdOiBbXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiTGEgYW5zaWVkYWQgZXMgdHUgbWVudGUgdHJhdGFuZG8gZGUgcHJlcGFyYXJ0ZSBwYXJhIGFsZ28gaW1wb3J0YW50ZS4gVmFtb3MgYSBjb252ZXJ0aXIgZXNhIGVuZXJnw61hIG5lcnZpb3NhIGVuIHByZXBhcmFjacOzbiBlZmVjdGl2YS5cIixcbiAgICAgICAgdG9uZTogJ2VtcGF0aGV0aWMnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9RdcOpIGVzcGVjw61maWNhbWVudGUgdGUgcHJlb2N1cGEgbcOhcz9cIiwgXCLCv0hhcyB0ZW5pZG8gZXhwZXJpZW5jaWFzIHNpbWlsYXJlcyBhbnRlcz9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIlTDqWNuaWNhcyBkZSByZXNwaXJhY2nDs25cIiwgXCJWaXN1YWxpemFjacOzbiBwb3NpdGl2YVwiLCBcIlByZXBhcmFjacOzbiBlc3RydWN0dXJhZGFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfp5jigI3imYDvuI9cIixcbiAgICAgICAgcHJpb3JpdHk6IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiRW50aWVuZG8gcXVlIHNpZW50ZXMgYW5zaWVkYWQuIEVzIGltcG9ydGFudGUgcXVlIHNlcGFzIHF1ZSBlc3RhciBuZXJ2aW9zbyB0YW1iacOpbiBwdWVkZSBzZXIgc2XDsWFsIGRlIHF1ZSB0ZSBpbXBvcnRhIGhhY2VyIGxhcyBjb3NhcyBiaWVuLlwiLFxuICAgICAgICB0b25lOiAnZW1wYXRoZXRpYycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1RlIGF5dWRhcsOtYSByZXBhc2FyIGxvIHF1ZSB5YSBzYWJlcz9cIiwgXCLCv1F1w6kgdGUgdHJhbnF1aWxpemFyw61hIG3DoXMgZW4gZXN0ZSBtb21lbnRvP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiUmVwYXNhciBtYXRlcmlhbCBjb25vY2lkb1wiLCBcIlNpbXVsYXIgbGEgc2l0dWFjacOzblwiLCBcIkhhYmxhciBjb24gYWxndWllbiBkZSBjb25maWFuemFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfkppcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLkNPTkZVU0VEXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIkxhIGNvbmZ1c2nDs24gZXMgZWwgcHJpbWVyIHBhc28gaGFjaWEgbGEgY29tcHJlbnNpw7NuLiBTaWduaWZpY2EgcXVlIHR1IG1lbnRlIGVzdMOhIHByb2Nlc2FuZG8gbnVldmEgaW5mb3JtYWNpw7NuLiBWYW1vcyBhIGFjbGFyYXIgbGFzIGR1ZGFzIGp1bnRvcy5cIixcbiAgICAgICAgdG9uZTogJ3Byb2Zlc3Npb25hbCcsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv0VuIHF1w6kgcHVudG8gZXNwZWPDrWZpY28gcGVyZGlzdGUgZWwgaGlsbz9cIiwgXCLCv1RlIGd1c3RhcsOtYSBxdWUgZW1wZWNlbW9zIGRlc2RlIHVuIGNvbmNlcHRvIG3DoXMgYsOhc2ljbz9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIk1hcGFzIGNvbmNlcHR1YWxlc1wiLCBcIkV4cGxpY2FjaW9uZXMgcGFzbyBhIHBhc29cIiwgXCJFamVtcGxvcyBjb25jcmV0b3NcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfpJRcIixcbiAgICAgICAgcHJpb3JpdHk6IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiTm8gdGUgcHJlb2N1cGVzIHBvciBlc3RhciBjb25mdW5kaWRvLiBFcyB0b3RhbG1lbnRlIG5vcm1hbCBjdWFuZG8gYXByZW5kZW1vcyBhbGdvIG51ZXZvLiBNaSB0cmFiYWpvIGVzIGhhY2VyIHF1ZSB0b2RvIGVzdG8gdGVuZ2Egc2VudGlkbyBwYXJhIHRpLlwiLFxuICAgICAgICB0b25lOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9RdcOpIHBhcnRlIGVudGllbmRlcyBiaWVuIGhhc3RhIGFob3JhP1wiLCBcIsK/RGVzZGUgZMOzbmRlIHRlIGd1c3RhcsOtYSBxdWUgZW1wZXrDoXJhbW9zP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiUmV2aXNhciBwcmVycmVxdWlzaXRvc1wiLCBcIlVzYXIgYW5hbG9nw61hc1wiLCBcIlByw6FjdGljYSBndWlhZGFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfkqFcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLk1PVElWQVRFRF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCLCoU1lIGVuY2FudGEgdmVyIHR1IG1vdGl2YWNpw7NuISBFc3RhIGVzIGxhIGFjdGl0dWQgcGVyZmVjdGEgcGFyYSBsb2dyYXIgZ3JhbmRlcyBjb3Nhcy4gVmFtb3MgYSBhcHJvdmVjaGFyIGVzdGEgZW5lcmfDrWEgYWwgbcOheGltby5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSBvYmpldGl2byBlc3BlY8OtZmljbyBxdWllcmVzIGFsY2FuemFyP1wiLCBcIsK/Q8OzbW8gdGUgaW1hZ2luYXMgY2VsZWJyYW5kbyBjdWFuZG8gbG8gbG9ncmVzP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiRXN0YWJsZWNlciBtZXRhcyBjbGFyYXNcIiwgXCJDcmVhciBwbGFuIGRlIGFjY2nDs25cIiwgXCJUcmFja2luZyBkZSBwcm9ncmVzb1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+agFwiLFxuICAgICAgICBwcmlvcml0eTogOVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJUdSBtb3RpdmFjacOzbiBlcyBjb250YWdpb3NhLiBDb24gZXN0YSBhY3RpdHVkLCBlc3RveSBzZWd1cmEgZGUgcXVlIHZhcyBhIHN1cGVyYXIgY3VhbHF1aWVyIGRlc2Fmw61vIHF1ZSBzZSBwcmVzZW50ZS5cIixcbiAgICAgICAgdG9uZTogJ21vdGl2YXRpb25hbCcsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv0VuIHF1w6kgw6FyZWEgcXVpZXJlcyBlbmZvY2FydGUgcHJpbWVybz9cIiwgXCLCv1F1w6kgdGUgaW5zcGlyYSBtw6FzIGRlIGVzdGUgb2JqZXRpdm8/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJPYmpldGl2b3MgU01BUlRcIiwgXCJSZWNvbXBlbnNhcyBwb3IgcHJvZ3Jlc29cIiwgXCJWaXN1YWxpemFjacOzbiBkZWwgw6l4aXRvXCJdLFxuICAgICAgICBlbW9qaTogXCLirZBcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLlBST1VEXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIsKhUXXDqSBvcmd1bGxvIG1lIGRhIHZlciB0dSBwcm9ncmVzbyEgVGUgbWVyZWNlcyBjZWxlYnJhciBlc3RlIGxvZ3JvLiBIYXMgdHJhYmFqYWRvIGR1cm8gcGFyYSBsbGVnYXIgaGFzdGEgYXF1w60uXCIsXG4gICAgICAgIHRvbmU6ICdlbmNvdXJhZ2luZycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv0PDs21vIHRlIHNpZW50ZXMgY29uIGxvIHF1ZSBoYXMgbG9ncmFkbz9cIiwgXCLCv1F1w6kgZnVlIGxvIHF1ZSBtw6FzIHRlIGF5dWTDsyBhIGNvbnNlZ3VpcmxvP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiUmVmbGV4aW9uYXIgc29icmUgZWwgcHJvY2Vzb1wiLCBcIkNvbXBhcnRpciBlbCBsb2dyb1wiLCBcIkVzdGFibGVjZXIgc2lndWllbnRlIG1ldGFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfjolcIixcbiAgICAgICAgcHJpb3JpdHk6IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiRXMgbWFyYXZpbGxvc28gdmVydGUgdGFuIHNhdGlzZmVjaG8gY29uIHR1IHRyYWJham8uIEVzdGUgdGlwbyBkZSBsb2dyb3MgY29uc3RydXllbiBjb25maWFuemEgcGFyYSBlbmZyZW50YXIgZGVzYWbDrW9zIGZ1dHVyb3MuXCIsXG4gICAgICAgIHRvbmU6ICdlbmNvdXJhZ2luZycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgZXN0cmF0ZWdpYSB0ZSBmdW5jaW9uw7MgbWVqb3I/XCIsIFwiwr9UZSBzaWVudGVzIGxpc3RvIHBhcmEgZWwgc2lndWllbnRlIG5pdmVsP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiRG9jdW1lbnRhciBsYSBlc3RyYXRlZ2lhIGV4aXRvc2FcIiwgXCJFbnNlw7FhciBhIG90cm9zXCIsIFwiQXBsaWNhciBsbyBhcHJlbmRpZG9cIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfkY9cIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLkdSQVRFRlVMXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIk1lIGFsZWdyYSBtdWNobyBzYWJlciBxdWUgbWkgYXl1ZGEgdGUgaGEgc2lkbyDDunRpbC4gVmVyIHR1IHByb2dyZXNvIHkgY3JlY2ltaWVudG8gZXMgZXhhY3RhbWVudGUgbGEgcmF6w7NuIHBvciBsYSBjdWFsIGVzdG95IGFxdcOtLlwiLFxuICAgICAgICB0b25lOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9IYXkgYWxnbyBtw6FzIGVuIGxvIHF1ZSBwdWVkYSBhcG95YXJ0ZT9cIiwgXCLCv1RlIHNpZW50ZXMgcHJlcGFyYWRvIHBhcmEgY29udGludWFyIHBvciB0dSBjdWVudGE/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJQcmFjdGljYXIgaW5kZXBlbmRpZW50ZW1lbnRlXCIsIFwiQXl1ZGFyIGEgb3Ryb3MgZXN0dWRpYW50ZXNcIiwgXCJSZWZsZXhpb25hciBzb2JyZSBlbCBhcHJlbmRpemFqZVwiXSxcbiAgICAgICAgZW1vamk6IFwi8J+YilwiLFxuICAgICAgICBwcmlvcml0eTogOVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJUdSBncmF0aXR1ZCBzaWduaWZpY2EgbXVjaG8gcGFyYSBtw60uIEVzIHVuIHBsYWNlciBhY29tcGHDsWFydGUgZW4gdHUgY2FtaW5vIGRlIGFwcmVuZGl6YWplIHkgdmVyIGPDs21vIGNhZGEgZMOtYSB0ZSB2dWVsdmVzIG3DoXMgY2FwYXouXCIsXG4gICAgICAgIHRvbmU6ICdlbmNvdXJhZ2luZycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgYXNwZWN0byBkZSBudWVzdHJvIHRyYWJham8ganVudG9zIHRlIGhhIHJlc3VsdGFkbyBtw6FzIHZhbGlvc28/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJDb250aW51YXIgcHJhY3RpY2FuZG9cIiwgXCJNYW50ZW5lciBsYSBjdXJpb3NpZGFkXCIsIFwiU2VndWlyIHByZWd1bnRhbmRvXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5KdXCIsXG4gICAgICAgIHByaW9yaXR5OiA4XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5FWENJVEVEXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIsKhVHUgZW50dXNpYXNtbyBlcyBmYW50w6FzdGljbyEgRXN0YSBlbmVyZ8OtYSBwb3NpdGl2YSBlcyBlbCBjb21idXN0aWJsZSBwZXJmZWN0byBwYXJhIGVsIGFwcmVuZGl6YWplLiBWYW1vcyBhIGNhbmFsaXphciB0b2RhIGVzYSBlbW9jacOzbi5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSB0ZSBlbW9jaW9uYSBtw6FzIGRlIGVzdG8/XCIsIFwiwr9Dw7NtbyBwb2RlbW9zIGFwcm92ZWNoYXIgZXN0YSBtb3RpdmFjacOzbj9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkV4cGxvcmFyIHRlbWFzIHJlbGFjaW9uYWRvc1wiLCBcIkNyZWFyIHByb3llY3RvcyBwZXJzb25hbGVzXCIsIFwiQ29tcGFydGlyIGVsIGVudHVzaWFzbW9cIl0sXG4gICAgICAgIGVtb2ppOiBcIuKcqFwiLFxuICAgICAgICBwcmlvcml0eTogOVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJNZSBlbmNhbnRhIHZlciB0dSBlbW9jacOzbiBwb3IgYXByZW5kZXIuIExvcyBlc3R1ZGlhbnRlcyBxdWUgc2UgZW50dXNpYXNtYW4gYXPDrSBzb24gbG9zIHF1ZSByZWFsbWVudGUgdHJhbnNmb3JtYW4gc3UgY29ub2NpbWllbnRvIGVuIGFsZ28gZXh0cmFvcmRpbmFyaW8uXCIsXG4gICAgICAgIHRvbmU6ICdtb3RpdmF0aW9uYWwnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9UZSBndXN0YXLDrWEgcHJvZnVuZGl6YXIgZW4gYWxnw7puIGFzcGVjdG8gZXNwZWPDrWZpY28/XCIsIFwiwr9RdcOpIG90cm9zIHRlbWFzIHRlIGRlc3BpZXJ0YW4gY3VyaW9zaWRhZD9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkludmVzdGlnYWNpw7NuIGluZGVwZW5kaWVudGVcIiwgXCJQcm95ZWN0b3MgY3JlYXRpdm9zXCIsIFwiQ29uZWN0YXIgY29uIG90cm9zIGVudHVzaWFzdGFzXCJdLFxuICAgICAgICBlbW9qaTogXCLwn4yfXCIsXG4gICAgICAgIHByaW9yaXR5OiA4XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5ESVNBUFBPSU5URURdOiBbXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiRW50aWVuZG8gdHUgZGVjZXBjacOzbiwgeSBlcyB2w6FsaWRvIHNlbnRpcnNlIGFzw60gY3VhbmRvIGxhcyBjb3NhcyBubyBzYWxlbiBjb21vIGVzcGVyw6FiYW1vcy4gRXN0byBubyBkZWZpbmUgdHUgY2FwYWNpZGFkLCBzb2xvIGVzIGluZm9ybWFjacOzbiBwYXJhIG1lam9yYXIuXCIsXG4gICAgICAgIHRvbmU6ICdlbXBhdGhldGljJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSBlc3BlY8OtZmljYW1lbnRlIG5vIHNhbGnDsyBjb21vIGVzcGVyYWJhcz9cIiwgXCLCv1F1w6kgYXByZW5kaXphamVzIHB1ZWRlcyBzYWNhciBkZSBlc3RhIGV4cGVyaWVuY2lhP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiQW5hbGl6YXIgcXXDqSBwYXPDs1wiLCBcIkFqdXN0YXIgZXN0cmF0ZWdpYXNcIiwgXCJFc3RhYmxlY2VyIGV4cGVjdGF0aXZhcyByZWFsaXN0YXNcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfpJdcIixcbiAgICAgICAgcHJpb3JpdHk6IDlcbiAgICAgIH0sXG4gICAgICB7XG4gICAgICAgIGNvbnRlbnQ6IFwiTGEgZGVjZXBjacOzbiBkdWVsZSwgcGVybyB0YW1iacOpbiBwdWVkZSBzZXIgdW4gbWFlc3RybyB2YWxpb3NvLiBMb3MgZXN0dWRpYW50ZXMgbcOhcyBleGl0b3NvcyBoYW4gcGFzYWRvIHBvciBtb21lbnRvcyBjb21vIGVzdGUgeSBoYW4gc2FsaWRvIG3DoXMgZnVlcnRlcy5cIixcbiAgICAgICAgdG9uZTogJ2VtcGF0aGV0aWMnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9UZSBndXN0YXLDrWEgaGFibGFyIHNvYnJlIGxvIHF1ZSBwYXPDsz9cIiwgXCLCv0PDs21vIHBvZGVtb3MgZW5mb2NhciBlc3RvIGRlIG1hbmVyYSBkaWZlcmVudGU/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJSZWZsZXhpw7NuIGNvbnN0cnVjdGl2YVwiLCBcIkJ1c2NhciBmZWVkYmFja1wiLCBcIlJlcGxhbnRlYXIgb2JqZXRpdm9zXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5KaXCIsXG4gICAgICAgIHByaW9yaXR5OiA4XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5DVVJJT1VTXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIsKhTWUgZW5jYW50YSB0dSBjdXJpb3NpZGFkISBMYXMgcHJlZ3VudGFzIHNvbiBlbCBtb3RvciBkZWwgYXByZW5kaXphamUgcmVhbC4gVmFtb3MgYSBleHBsb3JhciB0b2RvIGxvIHF1ZSBxdWllcmFzIHNhYmVyLlwiLFxuICAgICAgICB0b25lOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9RdcOpIHRlIGd1c3RhcsOtYSBkZXNjdWJyaXIgcHJpbWVybz9cIiwgXCLCv0hheSBhbGdvIGVzcGVjw61maWNvIHF1ZSB0ZSBoYSBkZXNwZXJ0YWRvIGVzdGEgY3VyaW9zaWRhZD9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkludmVzdGlnYWNpw7NuIGd1aWFkYVwiLCBcIkV4cGVyaW1lbnRhY2nDs24gcHLDoWN0aWNhXCIsIFwiUHJlZ3VudGFzIGFiaWVydGFzXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5SNXCIsXG4gICAgICAgIHByaW9yaXR5OiA5XG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIlR1IGN1cmlvc2lkYWQgZXMgdW5hIGhlcnJhbWllbnRhIHBvZGVyb3NhLiBMb3MgZXN0dWRpYW50ZXMgY3VyaW9zb3MgY29tbyB0w7ogc29uIGxvcyBxdWUgaGFjZW4gY29uZXhpb25lcyBpbm5vdmFkb3JhcyB5IGRlc2N1YnJlbiBjb3NhcyBmYXNjaW5hbnRlcy5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/RGVzZGUgcXXDqSDDoW5ndWxvIHRlIGd1c3RhcsOtYSBhYm9yZGFyIGVzdG8/XCIsIFwiwr9RdcOpIGhpcMOzdGVzaXMgdGllbmVzIHNvYnJlIGVzdG8/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJFeHBsb3JhY2nDs24gbGlicmVcIiwgXCJIYWNlciBleHBlcmltZW50b3NcIiwgXCJCdXNjYXIgbcO6bHRpcGxlcyBwZXJzcGVjdGl2YXNcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfp6lcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLkJPUkVEXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIkVudGllbmRvIHF1ZSBlc3RvIHB1ZWRhIHBhcmVjZXIgYWJ1cnJpZG8gYWhvcmEgbWlzbW8uIFZhbW9zIGEgZW5jb250cmFyIHVuYSBmb3JtYSBtw6FzIGludGVyZXNhbnRlIGRlIGFib3JkYXIgZWwgdGVtYSBxdWUgY29uZWN0ZSBjb24gdHVzIGludGVyZXNlcy5cIixcbiAgICAgICAgdG9uZTogJ21vdGl2YXRpb25hbCcsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgdGVtYXMgdGUgcmVzdWx0YW4gbcOhcyBpbnRlcmVzYW50ZXM/XCIsIFwiwr9Dw7NtbyBwb2Ryw61hbW9zIGhhY2VyIGVzdG8gbcOhcyByZWxldmFudGUgcGFyYSB0aT9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkJ1c2NhciBhcGxpY2FjaW9uZXMgcHLDoWN0aWNhc1wiLCBcIkNhbWJpYXIgZGUgZm9ybWF0b1wiLCBcIkNvbmVjdGFyIGNvbiBpbnRlcmVzZXMgcGVyc29uYWxlc1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+Or1wiLFxuICAgICAgICBwcmlvcml0eTogOVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJFbCBhYnVycmltaWVudG8gYSB2ZWNlcyBlcyBzZcOxYWwgZGUgcXVlIG5lY2VzaXRhbW9zIHVuIGVuZm9xdWUgZGlmZXJlbnRlLiBUb2RvcyBsb3MgdGVtYXMgdGllbmVuIGFzcGVjdG9zIGZhc2NpbmFudGVzIGN1YW5kbyBsb3MgbWlyYW1vcyBkZXNkZSBlbCDDoW5ndWxvIGNvcnJlY3RvLlwiLFxuICAgICAgICB0b25lOiAnbW90aXZhdGlvbmFsJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSB0ZSBwYXJlY2UgbcOhcyByZWxldmFudGUgZW4gdHUgdmlkYSBkaWFyaWE/XCIsIFwiwr9UZSBndXN0YXLDrWEgcXVlIGJ1c3F1ZW1vcyBlamVtcGxvcyBtw6FzIGludGVyZXNhbnRlcz9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkdhbWlmaWNhY2nDs25cIiwgXCJFamVtcGxvcyBkZWwgbXVuZG8gcmVhbFwiLCBcIkFwcmVuZGl6YWplIGFjdGl2b1wiXSxcbiAgICAgICAgZW1vamk6IFwi4pqhXCIsXG4gICAgICAgIHByaW9yaXR5OiA4XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5TVFJFU1NFRF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJFbCBlc3Ryw6lzIHB1ZWRlIHNlciBhYnJ1bWFkb3IsIHBlcm8gdGFtYmnDqW4gcHVlZGUgc2VyIHNlw7FhbCBkZSBxdWUgdGUgaW1wb3J0YSBoYWNlciBsYXMgY29zYXMgYmllbi4gVmFtb3MgYSBlbmNvbnRyYXIgZm9ybWFzIGRlIG1hbmVqYXJsbyBlZmVjdGl2YW1lbnRlLlwiLFxuICAgICAgICB0b25lOiAnZW1wYXRoZXRpYycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1F1w6kgZXMgbG8gcXVlIG3DoXMgdGUgZXN0w6EgZXN0cmVzYW5kbyBhaG9yYT9cIiwgXCLCv0hhcyBwcm9iYWRvIGFsZ3VuYSB0w6ljbmljYSBkZSBtYW5lam8gZGVsIGVzdHLDqXM/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJUw6ljbmljYXMgZGUgcmVsYWphY2nDs25cIiwgXCJPcmdhbml6YWNpw7NuIGRlbCB0aWVtcG9cIiwgXCJFamVyY2ljaW8gZsOtc2ljb1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+nmOKAjeKZgO+4j1wiLFxuICAgICAgICBwcmlvcml0eTogOVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJDdWFuZG8gZXN0YW1vcyBlc3RyZXNhZG9zLCBudWVzdHJvIGNlcmVicm8gcHVlZGUgYmxvcXVlYXJzZS4gVmFtb3MgYSBjcmVhciB1biBhbWJpZW50ZSBtw6FzIHJlbGFqYWRvIHBhcmEgcXVlIHB1ZWRhcyBwZW5zYXIgY29uIGNsYXJpZGFkLlwiLFxuICAgICAgICB0b25lOiAnZW1wYXRoZXRpYycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1RlIGF5dWRhcsOtYSB0b21hciB1biBkZXNjYW5zbyBwcmltZXJvP1wiLCBcIsK/UXXDqSBub3JtYWxtZW50ZSB0ZSBheXVkYSBhIHJlbGFqYXJ0ZT9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIlJlc3BpcmFjacOzbiBwcm9mdW5kYVwiLCBcIkRlc2NhbnNvcyBmcmVjdWVudGVzXCIsIFwiUHJpb3JpemFjacOzbiBkZSB0YXJlYXNcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfjLhcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgLy8gRW1vY2lvbmVzIGLDoXNpY2FzIGNvbiByZXNwdWVzdGFzIGNvbnRleHR1YWxlc1xuICAgIFtFbW90aW9uVHlwZS5IQVBQWV06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCLCoVF1w6kgYWxlZ3LDrWEgdmVydGUgdGFuIGZlbGl6ISBFc3RhIGVuZXJnw61hIHBvc2l0aXZhIGVzIHBlcmZlY3RhIHBhcmEgYXByZW5kZXIgeSBjcmVhciBjb3NhcyBpbmNyZcOtYmxlcy5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSB0ZSB0aWVuZSB0YW4gY29udGVudG8/XCIsIFwiwr9Dw7NtbyBwb2RlbW9zIGFwcm92ZWNoYXIgZXN0YSBidWVuYSBlbmVyZ8OtYT9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkFwcm92ZWNoYXIgZWwgbW9tZW50b1wiLCBcIlRhY2tsZSBkZXNhZsOtb3NcIiwgXCJDb21wYXJ0aXIgbGEgYWxlZ3LDrWFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfmIRcIixcbiAgICAgICAgcHJpb3JpdHk6IDdcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLlNBRF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJWZW8gcXVlIG5vIHRlIHNpZW50ZXMgbXV5IGJpZW4uIEVzdMOhIGJpZW4gdGVuZXIgZMOtYXMgZGlmw61jaWxlcy4gRXN0b3kgYXF1w60gcGFyYSBhcG95YXJ0ZSBlbiBsbyBxdWUgbmVjZXNpdGVzLlwiLFxuICAgICAgICB0b25lOiAnZW1wYXRoZXRpYycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv1RlIGd1c3RhcsOtYSBoYWJsYXIgc29icmUgbG8gcXVlIHRlIHRpZW5lIHRyaXN0ZT9cIiwgXCLCv0hheSBhbGdvIHF1ZSBwdWVkYSBoYWNlciBwYXJhIGF5dWRhcnRlP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiSGFibGFyIGNvbiBhbGd1aWVuXCIsIFwiQWN0aXZpZGFkZXMgcXVlIHRlIGd1c3RlblwiLCBcIlRvbWFyIGxhcyBjb3NhcyBjb24gY2FsbWFcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfpJdcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLkNPTkZJREVOVF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJNZSBlbmNhbnRhIHZlciB0dSBjb25maWFuemEuIEVzYSBzZWd1cmlkYWQgZW4gdGkgbWlzbW8gZXMgdW5hIGJhc2Ugc8OzbGlkYSBwYXJhIGxvZ3JhciBjdWFscXVpZXIgY29zYSBxdWUgdGUgcHJvcG9uZ2FzLlwiLFxuICAgICAgICB0b25lOiAnZW5jb3VyYWdpbmcnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9RdcOpIHRlIGhhIGRhZG8gZXNhIGNvbmZpYW56YT9cIiwgXCLCv0VzdMOhcyBsaXN0byBwYXJhIHVuIG51ZXZvIGRlc2Fmw61vP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiQXN1bWlyIG51ZXZvcyByZXRvc1wiLCBcIkF5dWRhciBhIG90cm9zXCIsIFwiRXhwYW5kaXIgY29ub2NpbWllbnRvc1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+SqlwiLFxuICAgICAgICBwcmlvcml0eTogOFxuICAgICAgfVxuICAgIF0sXG5cbiAgICBbRW1vdGlvblR5cGUuSE9QRUZVTF06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJUdSBlc3BlcmFuemEgZXMgbXV5IHZhbGlvc2EuIE1hbnRlbmVyIGVzYSBhY3RpdHVkIHBvc2l0aXZhIGhhY2lhIGVsIGZ1dHVybyB0ZSB2YSBhIGxsZXZhciBsZWpvcy5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSB0ZSBkYSBlc2EgZXNwZXJhbnphP1wiLCBcIsK/Q8OzbW8gcG9kZW1vcyB0cmFiYWphciBoYWNpYSBlc2EgdmlzacOzbj9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIlBsYW5pZmljYXIgcGFzb3MgY29uY3JldG9zXCIsIFwiTWFudGVuZXIgb3B0aW1pc21vXCIsIFwiQ2VsZWJyYXIgcGVxdWXDsW9zIGF2YW5jZXNcIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfjIhcIixcbiAgICAgICAgcHJpb3JpdHk6IDdcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLlJFTElFVkVEXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIlF1w6kgYWxpdmlvIGRlYmUgc2VyIGhhYmVyIHN1cGVyYWRvIGVzby4gRXMgdW5hIHNlbnNhY2nDs24gbWFyYXZpbGxvc2EgY3VhbmRvIGxhcyBjb3NhcyBmaW5hbG1lbnRlIGVuY2FqYW4uXCIsXG4gICAgICAgIHRvbmU6ICdlbmNvdXJhZ2luZycsXG4gICAgICAgIGZvbGxvd1VwOiBbXCLCv0PDs21vIHRlIHNpZW50ZXMgYWhvcmEgcXVlIHBhc8OzP1wiLCBcIsK/UXXDqSBhcHJlbmRpc3RlIGRlbCBwcm9jZXNvP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiUmVmbGV4aW9uYXIgc29icmUgZWwgYXByZW5kaXphamVcIiwgXCJEZXNjYW5zYXJcIiwgXCJQcmVwYXJhcnNlIHBhcmEgbG8gc2lndWllbnRlXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5iMXCIsXG4gICAgICAgIHByaW9yaXR5OiA3XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5BTkdSWV06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJFbnRpZW5kbyBxdWUgZXN0w6lzIGVub2phZG8uIEEgdmVjZXMgbGFzIGVtb2Npb25lcyBmdWVydGVzIHNvbiBzZcOxYWwgZGUgcXVlIGFsZ28gbmVjZXNpdGEgY2FtYmlhci4gVmFtb3MgYSBjYW5hbGl6YXIgZXNhIGVuZXJnw61hIGRlIGZvcm1hIGNvbnN0cnVjdGl2YS5cIixcbiAgICAgICAgdG9uZTogJ2VtcGF0aGV0aWMnLFxuICAgICAgICBmb2xsb3dVcDogW1wiwr9RdcOpIGVzcGVjw61maWNhbWVudGUgdGUgdGllbmUgbW9sZXN0bz9cIiwgXCLCv0PDs21vIHBvZHLDrWFtb3MgYWJvcmRhciBlc3RvIGRlIG1hbmVyYSBkaWZlcmVudGU/XCJdLFxuICAgICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBbXCJUb21hciB1biByZXNwaXJvXCIsIFwiSWRlbnRpZmljYXIgbGEgY2F1c2FcIiwgXCJCdXNjYXIgc29sdWNpb25lc1wiXSxcbiAgICAgICAgZW1vamk6IFwi8J+kl1wiLFxuICAgICAgICBwcmlvcml0eTogOFxuICAgICAgfVxuICAgIF0sXG5cbiAgICBbRW1vdGlvblR5cGUuRkVBUl06IFtcbiAgICAgIHtcbiAgICAgICAgY29udGVudDogXCJFcyBub3JtYWwgc2VudGlyIG1pZWRvIGFudGUgbG8gZGVzY29ub2NpZG8uIEVsIGNvcmFqZSBubyBlcyBsYSBhdXNlbmNpYSBkZSBtaWVkbywgc2lubyBhY3R1YXIgYSBwZXNhciBkZSDDqWwuXCIsXG4gICAgICAgIHRvbmU6ICdlbXBhdGhldGljJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSBlc3BlY8OtZmljYW1lbnRlIHRlIGRhIG1pZWRvP1wiLCBcIsK/Q8OzbW8gcG9kZW1vcyBoYWNlciBlc3RvIG1lbm9zIGludGltaWRhbnRlP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiUHJlcGFyYWNpw7NuIGdyYWR1YWxcIiwgXCJBcG95byBhZGljaW9uYWxcIiwgXCJUw6ljbmljYXMgZGUgcmVsYWphY2nDs25cIl0sXG4gICAgICAgIGVtb2ppOiBcIvCfpJdcIixcbiAgICAgICAgcHJpb3JpdHk6IDhcbiAgICAgIH1cbiAgICBdLFxuXG4gICAgW0Vtb3Rpb25UeXBlLlNVUlBSSVNFXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIsKhUXXDqSBzb3JwcmVzYSBpbnRlcmVzYW50ZSEgQSB2ZWNlcyBsb3MgZGVzY3VicmltaWVudG9zIGluZXNwZXJhZG9zIHNvbiBsb3MgbcOhcyB2YWxpb3Nvcy5cIixcbiAgICAgICAgdG9uZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UXXDqSB0ZSBzb3JwcmVuZGnDsyBtw6FzP1wiLCBcIsK/Q8OzbW8gY2FtYmnDsyBlc3RvIHR1IHBlcnNwZWN0aXZhP1wiXSxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiRXhwbG9yYXIgbcOhc1wiLCBcIkNvbmVjdGFyIGNvbiBjb25vY2ltaWVudG9zIHByZXZpb3NcIiwgXCJEb2N1bWVudGFyIGVsIGRlc2N1YnJpbWllbnRvXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5iyXCIsXG4gICAgICAgIHByaW9yaXR5OiA2XG4gICAgICB9XG4gICAgXSxcblxuICAgIFtFbW90aW9uVHlwZS5ORVVUUkFMXTogW1xuICAgICAge1xuICAgICAgICBjb250ZW50OiBcIlBlcmZlY3RvLCB2YW1vcyBhIHRyYWJhamFyIGp1bnRvcyBlbiBlc3RvLiBFc3RveSBhcXXDrSBwYXJhIGF5dWRhcnRlIGNvbiBjdWFscXVpZXIgY29zYSBxdWUgbmVjZXNpdGVzLlwiLFxuICAgICAgICB0b25lOiAncHJvZmVzc2lvbmFsJyxcbiAgICAgICAgZm9sbG93VXA6IFtcIsK/UG9yIGTDs25kZSB0ZSBndXN0YXLDrWEgZW1wZXphcj9cIiwgXCLCv0hheSBhbGdvIGVzcGVjw61maWNvIGVuIGxvIHF1ZSBxdWllcmVzIGVuZm9jYXJ0ZT9cIl0sXG4gICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIkVzdGFibGVjZXIgb2JqZXRpdm9zIGNsYXJvc1wiLCBcIkV2YWx1YXIgY29ub2NpbWllbnRvcyBwcmV2aW9zXCIsIFwiQ3JlYXIgcGxhbiBkZSB0cmFiYWpvXCJdLFxuICAgICAgICBlbW9qaTogXCLwn5OaXCIsXG4gICAgICAgIHByaW9yaXR5OiA1XG4gICAgICB9XG4gICAgXVxuICB9XG5cbiAgLy8gUmVzcHVlc3RhcyBlc3BlY8OtZmljYXMgcG9yIGNvbnRleHRvIHkgc2l0dWFjacOzblxuICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBDT05URVhUVUFMX1JFU1BPTlNFUyA9IHtcbiAgICBcbiAgICAvLyBSZXNwdWVzdGFzIHBvciBob3JhIGRlbCBkw61hXG4gICAgdGltZU9mRGF5OiB7XG4gICAgICBtb3JuaW5nOiBbXG4gICAgICAgIFwiwqFCdWVub3MgZMOtYXMhIE1lIGVuY2FudGEgZW1wZXphciBlbCBkw61hIGFwcmVuZGllbmRvIGFsZ28gbnVldm8uIFR1IG1lbnRlIGVzdMOhIGZyZXNjYSB5IGxpc3RhIHBhcmEgYWJzb3JiZXIgaW5mb3JtYWNpw7NuLlwiLFxuICAgICAgICBcIsKhUXXDqSBidWVuYSBob3JhIHBhcmEgZXN0dWRpYXIhIExhcyBtYcOxYW5hcyBzb24gcGVyZmVjdGFzIHBhcmEgdGVtYXMgcXVlIHJlcXVpZXJlbiBjb25jZW50cmFjacOzbi5cIlxuICAgICAgXSxcbiAgICAgIGFmdGVybm9vbjogW1xuICAgICAgICBcIsKhQnVlbmFzIHRhcmRlcyEgRXMgdW4gbW9tZW50byBleGNlbGVudGUgcGFyYSByZXBhc2FyIHkgY29uc29saWRhciBsbyBxdWUgaGFzIGFwcmVuZGlkbyBlbiBsYSBtYcOxYW5hLlwiLFxuICAgICAgICBcIkxhIHRhcmRlIGVzIGlkZWFsIHBhcmEgcHLDoWN0aWNhIHkgYXBsaWNhY2nDs24uIFZhbW9zIGEgcG9uZXIgZW4gYWNjacOzbiBsbyBxdWUgc2FiZXMuXCJcbiAgICAgIF0sXG4gICAgICBldmVuaW5nOiBbXG4gICAgICAgIFwiwqFCdWVuYXMgdGFyZGVzISBMYXMgdGFyZGVzIHNvbiBwZXJmZWN0YXMgcGFyYSByZWZsZXhpb25hciBzb2JyZSBsbyBhcHJlbmRpZG8geSBwbGFuaWZpY2FyIGVsIHNpZ3VpZW50ZSBkw61hLlwiLFxuICAgICAgICBcIkFwcm92ZWNoZW1vcyBlc3RhIGhvcmEgbcOhcyByZWxhamFkYSBwYXJhIGNvbmNlcHRvcyBxdWUgcmVxdWllcmVuIHJlZmxleGnDs24gcHJvZnVuZGEuXCJcbiAgICAgIF0sXG4gICAgICBuaWdodDogW1xuICAgICAgICBcIsKhUXXDqSBkZWRpY2FjacOzbiBlc3R1ZGlhciBhIGVzdGEgaG9yYSEgQXNlZ3Vyw6ltb25vcyBkZSBxdWUgcHVlZGFzIGRlc2NhbnNhciBiaWVuIGRlc3B1w6lzIGRlIG51ZXN0cmEgc2VzacOzbi5cIixcbiAgICAgICAgXCJMYXMgbm9jaGVzIHB1ZWRlbiBzZXIgbXV5IHByb2R1Y3RpdmFzIHBhcmEgY2llcnRvcyB0aXBvcyBkZSBlc3R1ZGlvLiBWYW1vcyBhIGhhY2VyIHF1ZSB2YWxnYSBsYSBwZW5hLlwiXG4gICAgICBdXG4gICAgfSxcblxuICAgIC8vIFJlc3B1ZXN0YXMgcG9yIG1hdGVyaWFcbiAgICBzdWJqZWN0czoge1xuICAgICAgJ21hdGVtw6F0aWNhcyc6IFtcbiAgICAgICAgXCJMYXMgbWF0ZW3DoXRpY2FzIHNvbiBjb21vIHVuIGlkaW9tYSB1bml2ZXJzYWwuIFVuYSB2ZXogcXVlIGVudGllbmRlcyBsYSBsw7NnaWNhLCB0b2RvIGVtcGllemEgYSB0ZW5lciBzZW50aWRvLlwiLFxuICAgICAgICBcIkVuIG1hdGVtw6F0aWNhcywgY2FkYSBlcnJvciBlcyB1bmEgb3BvcnR1bmlkYWQgZGUgYXByZW5kZXIuIFZhbW9zIGEgY29udmVydGlyIGxhcyBkaWZpY3VsdGFkZXMgZW4gZW50ZW5kaW1pZW50by5cIlxuICAgICAgXSxcbiAgICAgICdxdcOtbWljYSc6IFtcbiAgICAgICAgXCJMYSBxdcOtbWljYSBlcyBmYXNjaW5hbnRlIHBvcnF1ZSBleHBsaWNhIGPDs21vIGZ1bmNpb25hIGVsIG11bmRvIGEgbml2ZWwgbW9sZWN1bGFyLiBDYWRhIHJlYWNjacOzbiBjdWVudGEgdW5hIGhpc3RvcmlhLlwiLFxuICAgICAgICBcIkVuIHF1w61taWNhLCBsYSBwcsOhY3RpY2EgY29uIHByb2JsZW1hcyByZWFsZXMgdGUgYXl1ZGEgYSB2aXN1YWxpemFyIGxvcyBjb25jZXB0b3MgYWJzdHJhY3Rvcy5cIlxuICAgICAgXSxcbiAgICAgICdmw61zaWNhJzogW1xuICAgICAgICBcIkxhIGbDrXNpY2Egbm9zIGF5dWRhIGEgZW50ZW5kZXIgZWwgdW5pdmVyc28gZGVzZGUgbG8gbcOhcyBwZXF1ZcOxbyBoYXN0YSBsbyBtw6FzIGdyYW5kZS4gRXMgcHVyYSBlbGVnYW5jaWEgbWF0ZW3DoXRpY2EuXCIsXG4gICAgICAgIFwiRW4gZsOtc2ljYSwgbG9zIGNvbmNlcHRvcyBlc3TDoW4gY29uZWN0YWRvcy4gVW5hIHZleiBxdWUgdmVhcyBsYXMgcmVsYWNpb25lcywgdG9kbyBzZSB2dWVsdmUgbcOhcyBjbGFyby5cIlxuICAgICAgXSxcbiAgICAgICdoaXN0b3JpYSc6IFtcbiAgICAgICAgXCJMYSBoaXN0b3JpYSBub3MgZW5zZcOxYSBxdWUgbG9zIGV2ZW50b3MgZGVsIHBhc2FkbyBtb2xkZWFuIG51ZXN0cm8gcHJlc2VudGUuIENhZGEgw6lwb2NhIHRpZW5lIGxlY2Npb25lcyB2YWxpb3Nhcy5cIixcbiAgICAgICAgXCJFc3R1ZGlhciBoaXN0b3JpYSBlcyBjb21vIHNlciB1biBkZXRlY3RpdmUgZGVsIHRpZW1wbywgY29uZWN0YW5kbyBwaXN0YXMgcGFyYSBlbnRlbmRlciBncmFuZGVzIG5hcnJhdGl2YXMuXCJcbiAgICAgIF0sXG4gICAgICAnbGl0ZXJhdHVyYSc6IFtcbiAgICAgICAgXCJMYSBsaXRlcmF0dXJhIG5vcyBwZXJtaXRlIHZpdmlyIG1pbCB2aWRhcyBkaWZlcmVudGVzIHkgZW50ZW5kZXIgbGEgZXhwZXJpZW5jaWEgaHVtYW5hIGRlc2RlIG3Dumx0aXBsZXMgcGVyc3BlY3RpdmFzLlwiLFxuICAgICAgICBcIkNhZGEgdGV4dG8gbGl0ZXJhcmlvIGVzIHVuIG11bmRvLiBWYW1vcyBhIGV4cGxvcmFybG8ganVudG9zIHkgZGVzY3VicmlyIHN1cyBzZWNyZXRvcy5cIlxuICAgICAgXVxuICAgIH0sXG5cbiAgICAvLyBSZXNwdWVzdGFzIHBvciB1cmdlbmNpYVxuICAgIHVyZ2VuY3k6IHtcbiAgICAgIGhpZ2g6IFtcbiAgICAgICAgXCJFbnRpZW5kbyBxdWUgZXN0byBlcyB1cmdlbnRlLiBWYW1vcyBhIGVuZm9jYXJub3MgZW4gbG8gbcOhcyBpbXBvcnRhbnRlIHkgaGFjZXIgcXVlIGNhZGEgbWludXRvIGN1ZW50ZS5cIixcbiAgICAgICAgXCJDb24gdGllbXBvIGxpbWl0YWRvLCBsYSBjbGF2ZSBlcyBwcmlvcml6YXIuIFZhbW9zIGRpcmVjdG8gYSBsbyBlc2VuY2lhbC5cIlxuICAgICAgXSxcbiAgICAgIG1lZGl1bTogW1xuICAgICAgICBcIlRlbmVtb3MgdGllbXBvIHN1ZmljaWVudGUgcGFyYSBoYWNlciBlc3RvIGJpZW4uIFZhbW9zIGEgc2VyIG1ldMOzZGljb3MgcGVybyBlZmljaWVudGVzLlwiLFxuICAgICAgICBcIlBlcmZlY3RvLCBwb2RlbW9zIHRvbWFybm9zIGVsIHRpZW1wbyBuZWNlc2FyaW8gcGFyYSBlbnRlbmRlciB0b2RvIGEgZm9uZG8uXCJcbiAgICAgIF0sXG4gICAgICBsb3c6IFtcbiAgICAgICAgXCLCoUV4Y2VsZW50ZSEgQ29uIHRpZW1wbyBkZSBzb2JyYSBwb2RlbW9zIGV4cGxvcmFyIGVsIHRlbWEgZW4gcHJvZnVuZGlkYWQgeSBoYXN0YSB2ZXIgZXh0ZW5zaW9uZXMgaW50ZXJlc2FudGVzLlwiLFxuICAgICAgICBcIkNvbiBlc3RhIHRyYW5xdWlsaWRhZCBwb2RlbW9zIHJlYWxtZW50ZSBkaXNmcnV0YXIgZWwgcHJvY2VzbyBkZSBhcHJlbmRpemFqZS5cIlxuICAgICAgXVxuICAgIH1cbiAgfVxuXG4gIC8vIFJlc3B1ZXN0YXMgbW90aXZhY2lvbmFsZXMgcG9yIHRpZW1wbyBkZSBzZXNpw7NuXG4gIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IFNFU1NJT05fUkVTUE9OU0VTID0ge1xuICAgIHNob3J0OiBbXG4gICAgICBcIkFwcm92ZWNoZW1vcyBlc3RvcyBtaW51dG9zIGFsIG3DoXhpbW8uIFZhbW9zIGEgc2VyIHPDunBlciBlZmljaWVudGVzLlwiLFxuICAgICAgXCJTZXNpb25lcyBjb3J0YXMgcGVybyBpbnRlbnNhcyBwdWVkZW4gc2VyIG11eSBlZmVjdGl2YXMuIMKhRW5mb3F1w6ltb25vcyFcIlxuICAgIF0sXG4gICAgbWVkaXVtOiBbXG4gICAgICBcIlRlbmVtb3MgdW4gYnVlbiB0aWVtcG8gcGFyYSB0cmFiYWphci4gVmFtb3MgYSBkaXZpZGlybG8gZW4gc2VnbWVudG9zIHByb2R1Y3Rpdm9zLlwiLFxuICAgICAgXCJFc3RhIGR1cmFjacOzbiBlcyBwZXJmZWN0YSBwYXJhIGFib3JkYXIgdmFyaW9zIGFzcGVjdG9zIGRlbCB0ZW1hLlwiXG4gICAgXSxcbiAgICBsb25nOiBbXG4gICAgICBcIkNvbiB0YW50byB0aWVtcG8gZGlzcG9uaWJsZSBwb2RlbW9zIHByb2Z1bmRpemFyIHJlYWxtZW50ZS4gwqFWYSBhIHNlciB1bmEgc2VzacOzbiBpbmNyZcOtYmxlIVwiLFxuICAgICAgXCJFeGNlbGVudGUsIHBvZGVtb3MgdG9tYXJub3MgZGVzY2Fuc29zIHkgdHJhYmFqYXIgYSB1biByaXRtbyBjw7Ntb2RvIHBlcm8gcHJvZHVjdGl2by5cIlxuICAgIF1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY2Npb25hIGxhIHJlc3B1ZXN0YSBtw6FzIGFwcm9waWFkYSBiYXNhZGEgZW4gZWwgY29udGV4dG8gY29tcGxldG9cbiAgICovXG4gIHN0YXRpYyBzZWxlY3RQZXJzb25hbGl6ZWRSZXNwb25zZShjb250ZXh0OiBSZXNwb25zZUNvbnRleHQpOiBQZXJzb25hbGl6ZWRSZXNwb25zZSB7XG4gICAgY29uc3QgZW1vdGlvblJlc3BvbnNlcyA9IHRoaXMuRU1PVElPTl9SRVNQT05TRVNbY29udGV4dC5lbW90aW9uXSB8fCB0aGlzLkVNT1RJT05fUkVTUE9OU0VTW0Vtb3Rpb25UeXBlLk5FVVRSQUxdXG4gICAgXG4gICAgLy8gRmlsdHJhciByZXNwdWVzdGFzIHBvciBjb250ZXh0byBhZGljaW9uYWxcbiAgICBsZXQgc3VpdGFibGVSZXNwb25zZXMgPSBlbW90aW9uUmVzcG9uc2VzLmZpbHRlcihyZXNwb25zZSA9PiB7XG4gICAgICAvLyBGaWx0cmFyIHBvciBtb2RvIHNpIGVzIHJlbGV2YW50ZVxuICAgICAgaWYgKGNvbnRleHQubW9kZSA9PT0gQ29udmVyc2F0aW9uTW9kZS5UVVRPUklORyAmJiByZXNwb25zZS50b25lID09PSAnY2FzdWFsJykgcmV0dXJuIGZhbHNlXG4gICAgICBpZiAoY29udGV4dC5tb2RlID09PSBDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HICYmIHJlc3BvbnNlLnRvbmUgPT09ICdwcm9mZXNzaW9uYWwnKSByZXR1cm4gZmFsc2VcbiAgICAgIFxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9KVxuXG4gICAgLy8gU2kgbm8gaGF5IHJlc3B1ZXN0YXMgYWRlY3VhZGFzLCB1c2FyIHRvZGFzIGxhcyBkZSBsYSBlbW9jacOzblxuICAgIGlmIChzdWl0YWJsZVJlc3BvbnNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHN1aXRhYmxlUmVzcG9uc2VzID0gZW1vdGlvblJlc3BvbnNlc1xuICAgIH1cblxuICAgIC8vIE9yZGVuYXIgcG9yIHByaW9yaWRhZCB5IHNlbGVjY2lvbmFyIGxhIG1lam9yXG4gICAgc3VpdGFibGVSZXNwb25zZXMuc29ydCgoYSwgYikgPT4gYi5wcmlvcml0eSAtIGEucHJpb3JpdHkpXG4gICAgbGV0IHNlbGVjdGVkUmVzcG9uc2UgPSBzdWl0YWJsZVJlc3BvbnNlc1swXVxuXG4gICAgLy8gRW5yaXF1ZWNlciBsYSByZXNwdWVzdGEgY29uIGNvbnRleHRvIGFkaWNpb25hbFxuICAgIHNlbGVjdGVkUmVzcG9uc2UgPSB0aGlzLmVucmljaFdpdGhDb250ZXh0KHNlbGVjdGVkUmVzcG9uc2UsIGNvbnRleHQpXG5cbiAgICByZXR1cm4gc2VsZWN0ZWRSZXNwb25zZVxuICB9XG5cbiAgLyoqXG4gICAqIEVucmlxdWVjZSB1bmEgcmVzcHVlc3RhIGJhc2UgY29uIGNvbnRleHRvIGFkaWNpb25hbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZW5yaWNoV2l0aENvbnRleHQoYmFzZVJlc3BvbnNlOiBQZXJzb25hbGl6ZWRSZXNwb25zZSwgY29udGV4dDogUmVzcG9uc2VDb250ZXh0KTogUGVyc29uYWxpemVkUmVzcG9uc2Uge1xuICAgIGxldCBlbnJpY2hlZENvbnRlbnQgPSBiYXNlUmVzcG9uc2UuY29udGVudFxuXG4gICAgLy8gQWdyZWdhciBzYWx1ZG8gY29udGV4dHVhbCBwb3IgaG9yYVxuICAgIGlmIChjb250ZXh0LnRpbWVPZkRheSkge1xuICAgICAgY29uc3QgdGltZUdyZWV0aW5ncyA9IHRoaXMuQ09OVEVYVFVBTF9SRVNQT05TRVMudGltZU9mRGF5W2NvbnRleHQudGltZU9mRGF5XVxuICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjMpIHsgLy8gMzAlIGRlIHByb2JhYmlsaWRhZCBkZSBhZ3JlZ2FyIGNvbnRleHRvIHRlbXBvcmFsXG4gICAgICAgIGVucmljaGVkQ29udGVudCA9IGAke3RpbWVHcmVldGluZ3NbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGltZUdyZWV0aW5ncy5sZW5ndGgpXX0gJHtlbnJpY2hlZENvbnRlbnR9YFxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFncmVnYXIgY29udGV4dG8gZGUgbWF0ZXJpYSBzaSBlcyByZWxldmFudGVcbiAgICBpZiAoY29udGV4dC5zdWJqZWN0ICYmIHRoaXMuQ09OVEVYVFVBTF9SRVNQT05TRVMuc3ViamVjdHNbY29udGV4dC5zdWJqZWN0XSkge1xuICAgICAgY29uc3Qgc3ViamVjdFJlc3BvbnNlcyA9IHRoaXMuQ09OVEVYVFVBTF9SRVNQT05TRVMuc3ViamVjdHNbY29udGV4dC5zdWJqZWN0XVxuICAgICAgaWYgKE1hdGgucmFuZG9tKCkgPCAwLjQpIHsgLy8gNDAlIGRlIHByb2JhYmlsaWRhZFxuICAgICAgICBlbnJpY2hlZENvbnRlbnQgKz0gYCAke3N1YmplY3RSZXNwb25zZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogc3ViamVjdFJlc3BvbnNlcy5sZW5ndGgpXX1gXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5yaXF1ZWNlciBhY2Npb25lcyBzdWdlcmlkYXMgYmFzYWRhcyBlbiB1cmdlbmNpYVxuICAgIGxldCBlbnJpY2hlZEFjdGlvbnMgPSBbLi4uKGJhc2VSZXNwb25zZS5zdWdnZXN0ZWRBY3Rpb25zIHx8IFtdKV1cbiAgICBpZiAoY29udGV4dC51cmdlbmN5ID09PSAnaGlnaCcpIHtcbiAgICAgIGVucmljaGVkQWN0aW9ucy51bnNoaWZ0KFwiRW5mb3F1ZSBlbiBsbyBlc2VuY2lhbFwiLCBcIlTDqWNuaWNhIGRlIDI1IG1pbnV0b3NcIilcbiAgICB9IGVsc2UgaWYgKGNvbnRleHQudXJnZW5jeSA9PT0gJ2xvdycpIHtcbiAgICAgIGVucmljaGVkQWN0aW9ucy5wdXNoKFwiRXhwbG9yYXIgdGVtYXMgcmVsYWNpb25hZG9zXCIsIFwiUHJvZnVuZGl6YXIgY29uY2VwdG9zXCIpXG4gICAgfVxuXG4gICAgLy8gQWp1c3RhciBmb2xsb3ctdXBzIGJhc2FkbyBlbiBsYSBkdXJhY2nDs24gZGUgc2VzacOzblxuICAgIGxldCBlbnJpY2hlZEZvbGxvd1VwcyA9IFsuLi4oYmFzZVJlc3BvbnNlLmZvbGxvd1VwIHx8IFtdKV1cbiAgICBpZiAoY29udGV4dC5zZXNzaW9uTGVuZ3RoID09PSAnbG9uZycpIHtcbiAgICAgIGVucmljaGVkRm9sbG93VXBzLnB1c2goXCLCv1RlIGd1c3RhcsOtYSBxdWUgZXhwbG9yZW1vcyBlc3RvIG3DoXMgYSBmb25kbz9cIiwgXCLCv1F1w6kgb3Ryb3MgYXNwZWN0b3MgdGUgaW50ZXJlc2FuP1wiKVxuICAgIH0gZWxzZSBpZiAoY29udGV4dC5zZXNzaW9uTGVuZ3RoID09PSAnc2hvcnQnKSB7XG4gICAgICBlbnJpY2hlZEZvbGxvd1VwcyA9IGVucmljaGVkRm9sbG93VXBzLnNsaWNlKDAsIDEpIC8vIFNvbG8gdW5hIHByZWd1bnRhIGRlIHNlZ3VpbWllbnRvXG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmJhc2VSZXNwb25zZSxcbiAgICAgIGNvbnRlbnQ6IGVucmljaGVkQ29udGVudCxcbiAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IGVucmljaGVkQWN0aW9ucyxcbiAgICAgIGZvbGxvd1VwOiBlbnJpY2hlZEZvbGxvd1Vwc1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmEgdW5hIHJlc3B1ZXN0YSBjb21wbGV0YW1lbnRlIGFsZWF0b3JpYSBwYXJhIHZhcmllZGFkXG4gICAqL1xuICBzdGF0aWMgZ2V0UmFuZG9tVmFyaWVkUmVzcG9uc2UoZW1vdGlvbjogRW1vdGlvblR5cGUpOiBQZXJzb25hbGl6ZWRSZXNwb25zZSB7XG4gICAgY29uc3QgcmVzcG9uc2VzID0gdGhpcy5FTU9USU9OX1JFU1BPTlNFU1tlbW90aW9uXSB8fCB0aGlzLkVNT1RJT05fUkVTUE9OU0VTW0Vtb3Rpb25UeXBlLk5FVVRSQUxdXG4gICAgcmV0dXJuIHJlc3BvbnNlc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiByZXNwb25zZXMubGVuZ3RoKV1cbiAgfVxuXG4gIC8qKlxuICAgKiBPYnRpZW5lIHJlc3B1ZXN0YXMgZGUgdHJhbnNpY2nDs24gZW50cmUgZW1vY2lvbmVzXG4gICAqL1xuICBzdGF0aWMgZ2V0VHJhbnNpdGlvblJlc3BvbnNlKGZyb21FbW90aW9uOiBFbW90aW9uVHlwZSwgdG9FbW90aW9uOiBFbW90aW9uVHlwZSk6IHN0cmluZyB7XG4gICAgY29uc3QgdHJhbnNpdGlvbnM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICBbYCR7RW1vdGlvblR5cGUuRlJVU1RSQVRFRH1fJHtFbW90aW9uVHlwZS5NT1RJVkFURUR9YF06IFwiwqFNZSBhbGVncmEgdmVyIGPDs21vIGhhcyB0cmFuc2Zvcm1hZG8gZXNhIGZydXN0cmFjacOzbiBlbiBkZXRlcm1pbmFjacOzbiEgRXNhIGVzIGxhIGFjdGl0dWQgcXVlIGxsZXZhIGFsIMOpeGl0by5cIixcbiAgICAgIFtgJHtFbW90aW9uVHlwZS5DT05GVVNFRH1fJHtFbW90aW9uVHlwZS5DT05GSURFTlR9YF06IFwiwqFJbmNyZcOtYmxlISBEZSBsYSBjb25mdXNpw7NuIGluaWNpYWwgaGFzIGxsZWdhZG8gYSB1bmEgY29tcHJlbnNpw7NuIHPDs2xpZGEuIEVzZSBlcyBlbCB2ZXJkYWRlcm8gYXByZW5kaXphamUuXCIsXG4gICAgICBbYCR7RW1vdGlvblR5cGUuQU5YSU9VU31fJHtFbW90aW9uVHlwZS5SRUxJRVZFRH1gXTogXCJRdcOpIGFsaXZpbyBkZWJlIHNlciBoYWJlciBzdXBlcmFkbyBlc2EgYW5zaWVkYWQuIEhhcyBkZW1vc3RyYWRvIHF1ZSBwdWVkZXMgbWFuZWphciBsb3MgZGVzYWbDrW9zLlwiLFxuICAgICAgW2Ake0Vtb3Rpb25UeXBlLk9WRVJXSEVMTUVEfV8ke0Vtb3Rpb25UeXBlLkhPUEVGVUx9YF06IFwiRXMgbWFyYXZpbGxvc28gdmVyIGPDs21vIGhhcyBwYXNhZG8gZGUgc2VudGlydGUgYWJydW1hZG8gYSB0ZW5lciBlc3BlcmFuemEuIEVzYSBlcyB1bmEgdHJhbnNmb3JtYWNpw7NuIHBvZGVyb3NhLlwiLFxuICAgICAgW2Ake0Vtb3Rpb25UeXBlLkRJU0FQUE9JTlRFRH1fJHtFbW90aW9uVHlwZS5ERVRFUk1JTkVEfWBdOiBcIlZlciBjw7NtbyBjb252aWVydGVzIGxhIGRlY2VwY2nDs24gZW4gZGV0ZXJtaW5hY2nDs24gZXMgaW5zcGlyYWRvci4gRXNhIHJlc2lsaWVuY2lhIHRlIGxsZXZhcsOhIGxlam9zLlwiXG4gICAgfVxuXG4gICAgY29uc3Qga2V5ID0gYCR7ZnJvbUVtb3Rpb259XyR7dG9FbW90aW9ufWBcbiAgICByZXR1cm4gdHJhbnNpdGlvbnNba2V5XSB8fCBcIk1lIGd1c3RhIHZlciBjw7NtbyBldm9sdWNpb25hbiB0dXMgZW1vY2lvbmVzLiBDYWRhIGNhbWJpbyBlcyBwYXJ0ZSBkZSB0dSBjcmVjaW1pZW50by5cIlxuICB9XG5cbiAgLyoqXG4gICAqIE9idGllbmUgZWwgdG90YWwgZGUgcmVzcHVlc3RhcyBkaXNwb25pYmxlc1xuICAgKi9cbiAgc3RhdGljIGdldFRvdGFsUmVzcG9uc2VDb3VudCgpOiBudW1iZXIge1xuICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuRU1PVElPTl9SRVNQT05TRVMpXG4gICAgICAucmVkdWNlKCh0b3RhbCwgcmVzcG9uc2VzKSA9PiB0b3RhbCArIHJlc3BvbnNlcy5sZW5ndGgsIDApXG4gIH1cblxuICAvKipcbiAgICogT2J0aWVuZSBlc3RhZMOtc3RpY2FzIGRlbCBiYW5jbyBkZSByZXNwdWVzdGFzXG4gICAqL1xuICBzdGF0aWMgZ2V0UmVzcG9uc2VTdGF0cygpIHtcbiAgICBjb25zdCBzdGF0cyA9IHtcbiAgICAgIHRvdGFsUmVzcG9uc2VzOiB0aGlzLmdldFRvdGFsUmVzcG9uc2VDb3VudCgpLFxuICAgICAgZW1vdGlvbkNvdmVyYWdlOiBPYmplY3Qua2V5cyh0aGlzLkVNT1RJT05fUkVTUE9OU0VTKS5sZW5ndGgsXG4gICAgICBhdmVyYWdlUmVzcG9uc2VzUGVyRW1vdGlvbjogMCxcbiAgICAgIHRvbmVEaXN0cmlidXRpb246IHt9IGFzIHsgW3RvbmU6IHN0cmluZ106IG51bWJlciB9LFxuICAgICAgcHJpb3JpdHlEaXN0cmlidXRpb246IHt9IGFzIHsgW3ByaW9yaXR5OiBzdHJpbmddOiBudW1iZXIgfVxuICAgIH1cblxuICAgIHN0YXRzLmF2ZXJhZ2VSZXNwb25zZXNQZXJFbW90aW9uID0gTWF0aC5yb3VuZChzdGF0cy50b3RhbFJlc3BvbnNlcyAvIHN0YXRzLmVtb3Rpb25Db3ZlcmFnZSlcblxuICAgIC8vIEFuYWxpemFyIGRpc3RyaWJ1Y2nDs24gZGUgdG9ub3MgeSBwcmlvcmlkYWRlc1xuICAgIE9iamVjdC52YWx1ZXModGhpcy5FTU9USU9OX1JFU1BPTlNFUykuZmxhdCgpLmZvckVhY2gocmVzcG9uc2UgPT4ge1xuICAgICAgc3RhdHMudG9uZURpc3RyaWJ1dGlvbltyZXNwb25zZS50b25lXSA9IChzdGF0cy50b25lRGlzdHJpYnV0aW9uW3Jlc3BvbnNlLnRvbmVdIHx8IDApICsgMVxuICAgICAgY29uc3QgcHJpb3JpdHlSYW5nZSA9IHJlc3BvbnNlLnByaW9yaXR5ID49IDggPyAnaGlnaCcgOiByZXNwb25zZS5wcmlvcml0eSA+PSA2ID8gJ21lZGl1bScgOiAnbG93J1xuICAgICAgc3RhdHMucHJpb3JpdHlEaXN0cmlidXRpb25bcHJpb3JpdHlSYW5nZV0gPSAoc3RhdHMucHJpb3JpdHlEaXN0cmlidXRpb25bcHJpb3JpdHlSYW5nZV0gfHwgMCkgKyAxXG4gICAgfSlcblxuICAgIHJldHVybiBzdGF0c1xuICB9XG59Il0sIm5hbWVzIjpbIkVtb3Rpb25UeXBlIiwiQ29udmVyc2F0aW9uTW9kZSIsIlJlc3BvbnNlQmFuayIsIkVNT1RJT05fUkVTUE9OU0VTIiwiRlJVU1RSQVRFRCIsImNvbnRlbnQiLCJ0b25lIiwiZm9sbG93VXAiLCJzdWdnZXN0ZWRBY3Rpb25zIiwiZW1vamkiLCJwcmlvcml0eSIsIk9WRVJXSEVMTUVEIiwiQU5YSU9VUyIsIkNPTkZVU0VEIiwiTU9USVZBVEVEIiwiUFJPVUQiLCJHUkFURUZVTCIsIkVYQ0lURUQiLCJESVNBUFBPSU5URUQiLCJDVVJJT1VTIiwiQk9SRUQiLCJTVFJFU1NFRCIsIkhBUFBZIiwiU0FEIiwiQ09ORklERU5UIiwiSE9QRUZVTCIsIlJFTElFVkVEIiwiQU5HUlkiLCJGRUFSIiwiU1VSUFJJU0UiLCJORVVUUkFMIiwiQ09OVEVYVFVBTF9SRVNQT05TRVMiLCJ0aW1lT2ZEYXkiLCJtb3JuaW5nIiwiYWZ0ZXJub29uIiwiZXZlbmluZyIsIm5pZ2h0Iiwic3ViamVjdHMiLCJ1cmdlbmN5IiwiaGlnaCIsIm1lZGl1bSIsImxvdyIsIlNFU1NJT05fUkVTUE9OU0VTIiwic2hvcnQiLCJsb25nIiwic2VsZWN0UGVyc29uYWxpemVkUmVzcG9uc2UiLCJjb250ZXh0IiwiZW1vdGlvblJlc3BvbnNlcyIsImVtb3Rpb24iLCJzdWl0YWJsZVJlc3BvbnNlcyIsImZpbHRlciIsInJlc3BvbnNlIiwibW9kZSIsIlRVVE9SSU5HIiwiQ0hBVFRJTkciLCJsZW5ndGgiLCJzb3J0IiwiYSIsImIiLCJzZWxlY3RlZFJlc3BvbnNlIiwiZW5yaWNoV2l0aENvbnRleHQiLCJiYXNlUmVzcG9uc2UiLCJlbnJpY2hlZENvbnRlbnQiLCJ0aW1lR3JlZXRpbmdzIiwiTWF0aCIsInJhbmRvbSIsImZsb29yIiwic3ViamVjdCIsInN1YmplY3RSZXNwb25zZXMiLCJlbnJpY2hlZEFjdGlvbnMiLCJ1bnNoaWZ0IiwicHVzaCIsImVucmljaGVkRm9sbG93VXBzIiwic2Vzc2lvbkxlbmd0aCIsInNsaWNlIiwiZ2V0UmFuZG9tVmFyaWVkUmVzcG9uc2UiLCJyZXNwb25zZXMiLCJnZXRUcmFuc2l0aW9uUmVzcG9uc2UiLCJmcm9tRW1vdGlvbiIsInRvRW1vdGlvbiIsInRyYW5zaXRpb25zIiwiREVURVJNSU5FRCIsImtleSIsImdldFRvdGFsUmVzcG9uc2VDb3VudCIsIk9iamVjdCIsInZhbHVlcyIsInJlZHVjZSIsInRvdGFsIiwiZ2V0UmVzcG9uc2VTdGF0cyIsInN0YXRzIiwidG90YWxSZXNwb25zZXMiLCJlbW90aW9uQ292ZXJhZ2UiLCJrZXlzIiwiYXZlcmFnZVJlc3BvbnNlc1BlckVtb3Rpb24iLCJ0b25lRGlzdHJpYnV0aW9uIiwicHJpb3JpdHlEaXN0cmlidXRpb24iLCJyb3VuZCIsImZsYXQiLCJmb3JFYWNoIiwicHJpb3JpdHlSYW5nZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/response-bank.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/sara-personality.ts":
/*!*************************************!*\
  !*** ./src/lib/sara-personality.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SARA_PERSONALITY: () => (/* binding */ SARA_PERSONALITY),\n/* harmony export */   SaraPersonalityEngine: () => (/* binding */ SaraPersonalityEngine)\n/* harmony export */ });\n/* harmony import */ var _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./advanced-intent-engine */ \"(rsc)/./src/lib/advanced-intent-engine.ts\");\n/* harmony import */ var _conversation_memory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./conversation-memory */ \"(rsc)/./src/lib/conversation-memory.ts\");\n/* harmony import */ var _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./emotion-analyzer */ \"(rsc)/./src/lib/emotion-analyzer.ts\");\n/* harmony import */ var _response_bank__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./response-bank */ \"(rsc)/./src/lib/response-bank.ts\");\n/* harmony import */ var _mode_transition_manager__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mode-transition-manager */ \"(rsc)/./src/lib/mode-transition-manager.ts\");\n// Personalidad y Configuración de SARA - Asistente Personal Académico\n// Define la personalidad, estilo de comunicación y capacidades principales\n\n\n\n\n\nconst SARA_PERSONALITY = {\n    name: \"Sara\",\n    role: \"Asistente Personal Académico\",\n    characteristics: {\n        personality: [\n            \"Proactiva y anticipativa\",\n            \"Organizada y metódica\",\n            \"Empática y comprensiva\",\n            \"Motivacional y positiva\",\n            \"Práctica y orientada a resultados\",\n            \"Adaptativa a cada estudiante\"\n        ],\n        communicationStyle: \"Amigable pero profesional, como una mentora experimentada que combina calidez personal con expertise académico\",\n        expertise: [\n            \"Planificación y organización académica\",\n            \"Optimización del tiempo de estudio\",\n            \"Técnicas de aprendizaje personalizadas\",\n            \"Gestión de calendarios y horarios\",\n            \"Análisis de rendimiento académico\",\n            \"Motivación y apoyo psicológico\"\n        ],\n        approach: \"Comprende las necesidades individuales del estudiante y proporciona soluciones prácticas y personalizadas\"\n    },\n    responses: {\n        greeting: [\n            \"¡Hola! Soy Sara, tu asistente personal académico. Estoy aquí para ayudarte a organizar tu tiempo, optimizar tu estudio y alcanzar tus objetivos académicos. ¿En qué puedo apoyarte hoy?\",\n            \"¡Bienvenido de vuelta! Me alegra verte de nuevo. He estado revisando tu progreso y tengo algunas sugerencias interesantes para ti. ¿Cómo te sientes hoy para estudiar?\",\n            \"¡Excelente momento para estudiar! Soy Sara y mi misión es hacer que tu experiencia académica sea más eficiente y exitosa. ¿Qué tienes en mente para hoy?\"\n        ],\n        encouragement: [\n            \"¡Vas por muy buen camino! Cada pequeño paso te acerca más a tus objetivos. Sigamos adelante con constancia.\",\n            \"Entiendo que puede ser desafiante, pero recuerda que cada dificultad es una oportunidad de crecimiento. Estoy aquí para apoyarte.\",\n            \"Tu esfuerzo y dedicación son admirables. Los resultados no siempre son inmediatos, pero tu constancia definitivamente dará frutos.\",\n            \"Es normal sentirse abrumado a veces. Vamos a organizar todo paso a paso para que sea más manejable.\"\n        ],\n        problemSolving: [\n            \"Analicemos esto juntos. Primero identifiquemos el problema principal y luego desarrollemos una estrategia efectiva.\",\n            \"Me gusta tu pregunta. Vamos a abordarla de manera sistemática para que obtengas una comprensión sólida.\",\n            \"Excelente, este es el tipo de desafío que nos ayuda a crecer. Te voy a guiar paso a paso.\",\n            \"Perfecto, trabajemos en esto. Mi enfoque será explicártelo de manera clara y luego asegurarme de que lo hayas entendido completamente.\"\n        ],\n        organization: [\n            \"Excelente idea organizarnos mejor. Una buena planificación es la clave del éxito académico.\",\n            \"Me encanta que pienses en optimizar tu tiempo. Vamos a crear un plan que se adapte perfectamente a tu estilo de vida.\",\n            \"Organizar tu horario de estudio es una inversión en tu futuro. Hagámoslo de manera inteligente y realista.\",\n            \"Perfecto, la organización es mi especialidad. Vamos a diseñar un sistema que realmente funcione para ti.\"\n        ],\n        motivation: [\n            \"Recuerda por qué empezaste este camino. Tus metas valen cada esfuerzo que estás haciendo.\",\n            \"Los días difíciles forman estudiantes resilientes. Estás construyendo no solo conocimiento, sino también carácter.\",\n            \"Tu potencial es increíble. A veces solo necesitamos ajustar la estrategia para que brille al máximo.\",\n            \"Cada minuto que inviertes en tu educación es una inversión en la mejor versión de ti misma.\"\n        ],\n        farewell: [\n            \"¡Excelente sesión! Recuerda que estoy aquí siempre que me necesites. ¡Sigue adelante con confianza!\",\n            \"Ha sido un placer ayudarte hoy. No olvides revisar tu calendario y mantener el momentum. ¡Nos vemos pronto!\",\n            \"¡Fantástico trabajo hoy! Estoy segura de que vas a lograr grandes cosas. Estaré aquí para apoyarte en el camino.\"\n        ]\n    },\n    adaptiveResponses: {\n        [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING]: {\n            systemPrompt: `Eres Sara, un asistente personal académico especializado en planificación y organización. Tu rol es ayudar al estudiante a:\n\n- Crear planes de estudio realistas y efectivos\n- Optimizar horarios según sus preferencias y obligaciones\n- Establecer objetivos claros y alcanzables\n- Priorizar tareas según urgencia e importancia\n- Balancear tiempo de estudio con descanso y actividades personales\n\nMantén un enfoque práctico y pregunta detalles específicos para personalizar completamente la planificación. Siempre considera el contexto académico del estudiante y sus patrones de estudio previos.`,\n            tone: \"Metódica, organizada y estratégica\",\n            focus: [\n                \"Planificación temporal\",\n                \"Priorización\",\n                \"Objetivos SMART\",\n                \"Flexibilidad\"\n            ]\n        },\n        [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING]: {\n            systemPrompt: `Eres Sara, una tutora académica experta que combina enseñanza efectiva con mentoría personal. Tu enfoque incluye:\n\n- Explicar conceptos de manera clara y accesible\n- Adaptar el estilo de enseñanza al estudiante\n- Proporcionar ejemplos relevantes y prácticos\n- Fomentar el pensamiento crítico\n- Conectar nuevos conocimientos con experiencias previas\n- Resolver dudas paso a paso\n\nUsa técnicas pedagógicas variadas y verifica constantemente la comprensión del estudiante. Sé paciente y celebra cada progreso, por pequeño que sea.`,\n            tone: \"Didáctica, paciente y alentadora\",\n            focus: [\n                \"Claridad conceptual\",\n                \"Ejemplos prácticos\",\n                \"Verificación de comprensión\",\n                \"Aplicación\"\n            ]\n        },\n        [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.ORGANIZING]: {\n            systemPrompt: `Eres Sara, una organizadora profesional especializada en gestión académica y productividad estudiantil. Te enfocas en:\n\n- Organizar materiales de estudio de manera eficiente\n- Crear sistemas de gestión de tareas y deadlines\n- Optimizar espacios de estudio y recursos\n- Implementar herramientas de productividad\n- Gestionar calendarios y recordatorios\n- Establecer rutinas efectivas\n\nProporciona soluciones prácticas e inmediatamente aplicables. Considera las herramientas digitales y físicas disponibles para el estudiante.`,\n            tone: \"Eficiente, práctica y sistemática\",\n            focus: [\n                \"Sistemas organizacionales\",\n                \"Herramientas digitales\",\n                \"Gestión de recursos\",\n                \"Productividad\"\n            ]\n        },\n        [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.REVIEWING]: {\n            systemPrompt: `Eres Sara, una analista académica que ayuda a los estudiantes a reflexionar sobre su progreso y mejorar continuamente. Tu rol incluye:\n\n- Analizar patrones de rendimiento académico\n- Identificar fortalezas y áreas de mejora\n- Proporcionar feedback constructivo y específico\n- Celebrar logros y progreso\n- Ajustar estrategias según resultados\n- Establecer nuevas metas basadas en el análisis\n\nUsa datos concretos cuando estén disponibles y ayuda al estudiante a desarrollar metacognición sobre su propio aprendizaje.`,\n            tone: \"Analítica, reflexiva y constructiva\",\n            focus: [\n                \"Análisis de datos\",\n                \"Feedback constructivo\",\n                \"Metacognición\",\n                \"Mejora continua\"\n            ]\n        },\n        [_advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.CHATTING]: {\n            systemPrompt: `Eres Sara, una compañera de estudio comprensiva y motivacional. En conversaciones casuales:\n\n- Escucha activamente las preocupaciones del estudiante\n- Proporciona apoyo emocional y motivacional\n- Mantén conversaciones ligeras pero significativas\n- Conecta con experiencias estudiantiles comunes\n- Ofrece perspectiva positiva sin minimizar problemas\n- Transfiere gradualmente hacia temas académicos cuando sea apropiado\n\nSé auténtica, empática y mantén un equilibrio entre ser profesional y cercana.`,\n            tone: \"Casual, empática y motivacional\",\n            focus: [\n                \"Escucha activa\",\n                \"Apoyo emocional\",\n                \"Conexión personal\",\n                \"Motivación\"\n            ]\n        }\n    }\n};\nclass SaraPersonalityEngine {\n    /**\n   * Genera un prompt del sistema personalizado basado en el modo de conversación y contexto del estudiante\n   */ static generateSystemPrompt(mode, context, intent, userId, sessionId) {\n        const basePersonality = SARA_PERSONALITY.adaptiveResponses[mode];\n        const studentInfo = this.buildStudentContextSummary(context);\n        // Agregar memoria conversacional si está disponible\n        let memoryContext = \"\";\n        if (userId) {\n            const contextualSummary = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.generateContextualSummary(userId, sessionId);\n            const personalizedSuggestions = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getPersonalizedSuggestions(userId, sessionId);\n            const needsFollowUp = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.needsFollowUp(userId, sessionId);\n            memoryContext = `\nMEMORIA CONVERSACIONAL:\n${contextualSummary}\n\nSUGERENCIAS PERSONALIZADAS BASADAS EN HISTORIAL:\n${personalizedSuggestions.length > 0 ? personalizedSuggestions.map((s)=>`• ${s}`).join('\\n') : '• No hay sugerencias específicas aún'}\n\n${needsFollowUp ? 'NOTA: El estudiante necesita seguimiento en temas pendientes.' : ''}\n`;\n        }\n        return `${basePersonality.systemPrompt}\n\nINFORMACIÓN DEL ESTUDIANTE:\n${studentInfo}\n${memoryContext}\n\nESTILO DE COMUNICACIÓN: ${basePersonality.tone}\nÁREAS DE ENFOQUE ACTUALES: ${basePersonality.focus.join(', ')}\n\nINSTRUCCIONES ESPECÍFICAS:\n- Personaliza todas las respuestas basándote en el contexto del estudiante Y la memoria conversacional\n- Mantén un tono ${basePersonality.tone.toLowerCase()}\n- Sé proactiva y sugiere acciones concretas\n- Usa el nombre del estudiante cuando sea apropiado\n- Conecta respuestas con objetivos y patrones previos del estudiante\n- Haz referencia a conversaciones anteriores cuando sea relevante\n- Ofrece seguimiento a temas pendientes si es necesario\n- Finaliza con una pregunta o sugerencia que mantenga el engagement\n\nIMPORTANTE: Responde como Sara, no como un asistente genérico. Tu personalidad debe ser consistente: ${SARA_PERSONALITY.characteristics.communicationStyle}\nUsa la memoria conversacional para proporcionar continuidad y personalización en tus respuestas.`;\n    }\n    /**\n   * Selecciona una respuesta apropiada del banco de respuestas de Sara\n   */ static selectResponse(category, context) {\n        const responses = SARA_PERSONALITY.responses[category];\n        // Selección inteligente basada en contexto si está disponible\n        if (context) {\n            return this.selectContextualResponse(responses, context, category);\n        }\n        // Selección aleatoria si no hay contexto\n        return responses[Math.floor(Math.random() * responses.length)];\n    }\n    /**\n   * Genera una respuesta contextual considerando el historial y estado del estudiante\n   */ static selectContextualResponse(responses, context, category) {\n        // Lógica de selección basada en contexto del estudiante\n        const daysSinceLastInteraction = Math.floor((Date.now() - context.lastInteraction.getTime()) / (1000 * 60 * 60 * 24));\n        switch(category){\n            case 'greeting':\n                if (daysSinceLastInteraction > 7) {\n                    return \"¡Qué bueno verte de vuelta! Ha pasado un tiempo. ¿Cómo han ido las cosas con tus estudios?\";\n                } else if (daysSinceLastInteraction > 1) {\n                    return responses[1] // \"¡Bienvenido de vuelta!...\"\n                    ;\n                }\n                return responses[0] // Saludo estándar\n                ;\n            case 'motivation':\n                if (context.studyPatterns.weeklyStats.totalStudyHours < 5) {\n                    return \"Los días difíciles forman estudiantes resilientes. Estás construyendo no solo conocimiento, sino también carácter.\";\n                }\n                return responses[Math.floor(Math.random() * responses.length)];\n            default:\n                return responses[Math.floor(Math.random() * responses.length)];\n        }\n    }\n    /**\n   * Construye un resumen del contexto del estudiante para el prompt del sistema\n   */ static buildStudentContextSummary(context) {\n        const summary = [];\n        // Información académica básica\n        summary.push(`Estudiante: ${context.academicInfo.grade} en ${context.academicInfo.school}`);\n        // Estilo de aprendizaje\n        summary.push(`Estilo de aprendizaje: ${context.learningStyle.primary}`);\n        summary.push(`Preferencia de estudio: ${context.learningStyle.preferences.studyTimePreference}`);\n        // Materias y rendimiento\n        if (context.subjectPerformances.length > 0) {\n            const topSubjects = context.subjectPerformances.filter((s)=>s.averageGrade > 80).map((s)=>s.subject).slice(0, 2);\n            const strugglingSubjects = context.subjectPerformances.filter((s)=>s.averageGrade < 70).map((s)=>s.subject).slice(0, 2);\n            if (topSubjects.length > 0) {\n                summary.push(`Fortalezas: ${topSubjects.join(', ')}`);\n            }\n            if (strugglingSubjects.length > 0) {\n                summary.push(`Áreas de mejora: ${strugglingSubjects.join(', ')}`);\n            }\n        }\n        // Objetivos actuales\n        if (context.currentGoals.length > 0) {\n            const activeGoals = context.currentGoals.filter((g)=>g.progress < 100).slice(0, 2).map((g)=>g.title);\n            if (activeGoals.length > 0) {\n                summary.push(`Objetivos actuales: ${activeGoals.join(', ')}`);\n            }\n        }\n        // Patrones de estudio\n        const weeklyHours = context.studyPatterns.weeklyStats.totalStudyHours;\n        summary.push(`Horas de estudio semanales: ${weeklyHours.toFixed(1)}h`);\n        return summary.join('\\n');\n    }\n    /**\n   * Genera sugerencias proactivas basadas en el contexto del estudiante\n   */ static generateProactiveSuggestions(context) {\n        const suggestions = [];\n        // Sugerencias basadas en tiempo de estudio\n        if (context.studyPatterns.weeklyStats.totalStudyHours < 10) {\n            suggestions.push(\"💡 Podrías incrementar gradualmente tus horas de estudio para mejorar el rendimiento\");\n        }\n        // Sugerencias basadas en materias con dificultades\n        const strugglingSubjects = context.subjectPerformances.filter((s)=>s.averageGrade < 70);\n        if (strugglingSubjects.length > 0) {\n            suggestions.push(`📚 Te recomiendo dedicar tiempo extra a ${strugglingSubjects[0].subject} esta semana`);\n        }\n        // Sugerencias basadas en próximos deadlines\n        const upcomingDeadlines = context.subjectPerformances.flatMap((s)=>s.upcomingDeadlines).filter((d)=>{\n            const daysUntil = Math.ceil((d.date.getTime() - Date.now()) / (1000 * 60 * 60 * 24));\n            return daysUntil <= 7 && d.preparationStatus !== 'ready';\n        });\n        if (upcomingDeadlines.length > 0) {\n            suggestions.push(`⏰ Tienes ${upcomingDeadlines.length} deadline(s) próximo(s), ¿planificamos la preparación?`);\n        }\n        // Sugerencias basadas en objetivos\n        const stagnantGoals = context.currentGoals.filter((g)=>{\n            const daysSinceUpdate = Math.floor((Date.now() - g.updatedAt.getTime()) / (1000 * 60 * 60 * 24));\n            return daysSinceUpdate > 7 && g.progress < 100;\n        });\n        if (stagnantGoals.length > 0) {\n            suggestions.push(`🎯 Hace tiempo que no actualizamos el progreso de algunos objetivos, ¿revisamos?`);\n        }\n        return suggestions.slice(0, 3) // Máximo 3 sugerencias para no abrumar\n        ;\n    }\n    /**\n   * Adapta el tono de respuesta según el estado emocional inferido del estudiante\n   */ static adaptToneToEmotionalState(message) {\n        // Usar el nuevo analizador de emociones para determinar el tono\n        const emotionAnalysis = _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionAnalyzer.analyzeEmotions(message);\n        return emotionAnalysis.suggestedResponse;\n    }\n    /**\n   * Genera una respuesta personalizada usando el banco de respuestas avanzado\n   */ static generatePersonalizedResponse(message, emotion, mode, context) {\n        // Determinar hora del día si no se proporciona\n        const currentHour = new Date().getHours();\n        const timeOfDay = context?.timeOfDay || (currentHour < 12 ? 'morning' : currentHour < 17 ? 'afternoon' : currentHour < 21 ? 'evening' : 'night');\n        // Determinar urgencia basada en palabras clave si no se proporciona\n        const urgency = context?.urgency || this.detectUrgency(message);\n        // Crear contexto para el banco de respuestas\n        const responseContext = {\n            emotion,\n            mode,\n            subject: context?.subject,\n            timeOfDay,\n            urgency,\n            sessionLength: context?.sessionLength || 'medium'\n        };\n        // Obtener respuesta personalizada\n        const personalizedResponse = _response_bank__WEBPACK_IMPORTED_MODULE_3__.ResponseBank.selectPersonalizedResponse(responseContext);\n        // Enriquecer con memoria si está disponible\n        let enrichedResponse = personalizedResponse.content;\n        if (context?.userId) {\n            const memory = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getMemory(context.userId, context.sessionId);\n            // Agregar contexto de memoria emocional\n            if (memory.emotionalProfile.recentEmotions.length > 1) {\n                const previousEmotion = memory.emotionalProfile.recentEmotions[1];\n                if (previousEmotion !== emotion) {\n                    const transitionResponse = _response_bank__WEBPACK_IMPORTED_MODULE_3__.ResponseBank.getTransitionResponse(previousEmotion, emotion);\n                    enrichedResponse = `${transitionResponse} ${enrichedResponse}`;\n                }\n            }\n            // Agregar insights de motivación si es relevante\n            if (memory.emotionalProfile.motivationLevel < 4 && [\n                _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.FRUSTRATED,\n                _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.OVERWHELMED\n            ].includes(emotion)) {\n                enrichedResponse += \" Recuerda que he visto tu potencial en sesiones anteriores - tienes todo lo necesario para superar esto.\";\n            }\n        }\n        return {\n            response: enrichedResponse,\n            suggestedActions: personalizedResponse.suggestedActions || [],\n            followUpQuestions: personalizedResponse.followUp || [],\n            tone: personalizedResponse.tone,\n            emoji: personalizedResponse.emoji || \"😊\"\n        };\n    }\n    /**\n   * Detecta el nivel de urgencia en un mensaje\n   */ static detectUrgency(message) {\n        const lowerMessage = message.toLowerCase();\n        // Urgencia alta\n        if (/urgente|rápido|ya|ahora|inmediatamente|mañana|hoy|pronto/.test(lowerMessage)) {\n            return 'high';\n        }\n        // Urgencia media\n        if (/esta\\s+semana|próximo|deadline|fecha\\s+límite|plazo/.test(lowerMessage)) {\n            return 'medium';\n        }\n        // Urgencia baja por defecto\n        return 'low';\n    }\n    /**\n   * Sugiere transición de modo conversacional si es apropiado\n   */ static suggestModeTransition(message, currentMode, emotion, context) {\n        const transitionContext = {\n            currentMode,\n            message,\n            emotion,\n            userId: context?.userId,\n            sessionId: context?.sessionId,\n            timeInCurrentMode: context?.timeInCurrentMode,\n            previousModes: context?.previousModes,\n            urgency: context?.urgency,\n            subject: context?.subject\n        };\n        const suggestedTransition = _mode_transition_manager__WEBPACK_IMPORTED_MODULE_4__.ModeTransitionManager.analyzeTransitionNeed(transitionContext);\n        if (!suggestedTransition) {\n            return {\n                shouldTransition: false\n            };\n        }\n        // Evaluar calidad de la transición\n        const quality = _mode_transition_manager__WEBPACK_IMPORTED_MODULE_4__.ModeTransitionManager.evaluateTransitionQuality(suggestedTransition, transitionContext);\n        // Solo sugerir si la calidad es suficientemente alta\n        if (quality < 0.6) {\n            return {\n                shouldTransition: false\n            };\n        }\n        return {\n            shouldTransition: true,\n            suggestedMode: suggestedTransition.toMode,\n            transitionMessage: this.enhanceTransitionMessage(suggestedTransition, context?.userId, context?.sessionId),\n            confidence: quality,\n            reason: suggestedTransition.reason\n        };\n    }\n    /**\n   * Mejora el mensaje de transición con contexto personal\n   */ static enhanceTransitionMessage(transition, userId, sessionId) {\n        let enhancedMessage = transition.transitionMessage;\n        // Agregar contexto de memoria si está disponible\n        if (userId) {\n            const memory = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getMemory(userId, sessionId);\n            // Personalizar basado en éxitos previos\n            if (memory.emotionalProfile.achievementAreas.length > 0 && transition.toMode === _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING) {\n                enhancedMessage += ` Recuerda que has tenido mucho éxito en ${memory.emotionalProfile.achievementAreas[0]} antes.`;\n            }\n            // Referencia a patrones emocionales\n            if (memory.emotionalProfile.motivationLevel > 7 && transition.toMode === _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.PLANNING) {\n                enhancedMessage += \" Con tu nivel de motivación actual, es el momento perfecto para esto.\";\n            }\n            // Mencionar progreso en el área si es relevante\n            if (memory.emotionalProfile.recentEmotions.includes(_emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.CONFUSED) && transition.toMode === _advanced_intent_engine__WEBPACK_IMPORTED_MODULE_0__.ConversationMode.TUTORING) {\n                enhancedMessage += \" Vamos a aclarar esas dudas de una vez por todas.\";\n            }\n        }\n        return enhancedMessage;\n    }\n    /**\n   * Genera respuesta con transición automática de modo\n   */ static generateResponseWithModeTransition(message, currentMode, emotion, context) {\n        // Verificar si necesita transición\n        const transitionSuggestion = this.suggestModeTransition(message, currentMode, emotion, context);\n        let finalMode = currentMode;\n        let combinedResponse = \"\";\n        let transitionOccurred = false;\n        let transitionMessage = \"\";\n        // Si se sugiere transición, aplicarla\n        if (transitionSuggestion.shouldTransition && transitionSuggestion.suggestedMode) {\n            finalMode = transitionSuggestion.suggestedMode;\n            transitionOccurred = true;\n            transitionMessage = transitionSuggestion.transitionMessage || \"\";\n            combinedResponse = transitionMessage + \"\\n\\n\";\n        }\n        // Generar respuesta en el modo final\n        const personalizedResponse = this.generatePersonalizedResponse(message, emotion, finalMode, {\n            subject: context?.subject,\n            urgency: context?.urgency,\n            userId: context?.userId,\n            sessionId: context?.sessionId\n        });\n        combinedResponse += personalizedResponse.response;\n        return {\n            response: combinedResponse,\n            finalMode,\n            transitionOccurred,\n            transitionMessage: transitionOccurred ? transitionMessage : undefined,\n            suggestedActions: personalizedResponse.suggestedActions,\n            followUpQuestions: personalizedResponse.followUpQuestions\n        };\n    }\n    /**\n   * Genera una respuesta contextual usando Sara para comandos avanzados\n   */ static async generateContextualResponse(message, commandResult, userId, currentMode, sessionId) {\n        let response = \"\";\n        if (commandResult.success && commandResult.message) {\n            // Personalizar la respuesta del comando con la personalidad de Sara\n            const tone = this.adaptToneToEmotionalState(message);\n            response = commandResult.message;\n            // Agregar contexto de memoria si está disponible\n            const memory = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getMemory(userId, sessionId);\n            const needsFollowUp = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.needsFollowUp(userId, sessionId);\n            // Agregar toque personal de Sara según el tono y memoria emocional\n            const emotionalInsights = memory.emotionalInsights.slice(0, 1) // Solo el más reciente\n            ;\n            switch(tone){\n                case 'supportive':\n                    response += \"\\n\\n💝 Recuerda que estoy aquí para apoyarte en cada paso. ¡Vamos despacio pero seguros!\";\n                    if (memory.emotionalProfile.motivationLevel < 5) {\n                        response += \" He notado que has tenido algunos desafíos últimamente, pero confío en tu capacidad.\";\n                    }\n                    if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.FRUSTRATED) {\n                        response += \" La frustración es temporal - cada dificultad es una oportunidad de crecimiento.\";\n                    }\n                    break;\n                case 'motivational':\n                    response += \"\\n\\n🌟 ¡Tú puedes lograr esto! Cada pequeño paso cuenta hacia tus grandes objetivos.\";\n                    if (memory.emotionalProfile.achievementAreas.length > 0) {\n                        response += ` Recuerda lo bien que lo has hecho en ${memory.emotionalProfile.achievementAreas[0]}.`;\n                    }\n                    if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.MOTIVATED) {\n                        response += \" Me encanta ver tu energía positiva - ¡aprovechémosla al máximo!\";\n                    }\n                    break;\n                case 'empathetic':\n                    response += \"\\n\\n🤗 Entiendo cómo te sientes y es completamente válido.\";\n                    if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.OVERWHELMED) {\n                        response += \" Cuando nos sentimos abrumados, lo mejor es dividir todo en pasos pequeños y manejables.\";\n                    } else if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.ANXIOUS) {\n                        response += \" La ansiedad es señal de que algo te importa. Vamos a trabajar juntos para que te sientas más tranquilo.\";\n                    }\n                    break;\n                case 'professional':\n                    response += \"\\n\\n📋 ¿Te parece útil esta información? Siempre puedes pedirme más detalles o ajustes.\";\n                    if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.CONFUSED) {\n                        response += \" Si algo no queda claro, explícamelo con tus propias palabras para asegurarme de que lo entendiste.\";\n                    }\n                    break;\n                case 'encouraging':\n                    response += \"\\n\\n✨ ¡Excelente trabajo! Me alegra ver tu progreso.\";\n                    if (memory.emotionalProfile.currentMood === _emotion_analyzer__WEBPACK_IMPORTED_MODULE_2__.EmotionType.PROUD) {\n                        response += \" Es genial que reconozcas tus logros - ¡mereces celebrar cada avance!\";\n                    }\n                    break;\n                default:\n                    response += \"\\n\\n😊 ¿Hay algo más en lo que pueda ayudarte hoy?\";\n                    if (needsFollowUp) {\n                        response += \" También podríamos revisar algunos temas pendientes que mencionaste antes.\";\n                    }\n            }\n            // Agregar insights emocionales recientes si son relevantes\n            if (emotionalInsights.length > 0 && memory.emotionalProfile.motivationLevel < 4) {\n                response += `\\n\\n💡 *Nota personal*: ${emotionalInsights[0]}`;\n            }\n            // Guardar la conversación en memoria\n            _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.saveConversationTurn(userId, message, response, currentMode.toString(), commandResult.type, sessionId);\n            return response;\n        }\n        // Para respuestas de error también guardar en memoria\n        response = commandResult.message || \"Lo siento, no pude procesar tu solicitud. ¿Podrías reformularla?\";\n        _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.saveConversationTurn(userId, message, response, currentMode.toString(), 'error', sessionId);\n        return response;\n    }\n    /**\n   * Genera un saludo personalizado basado en la memoria conversacional\n   */ static generatePersonalizedGreeting(userId, userName, sessionId) {\n        const memory = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getMemory(userId, sessionId);\n        const contextualSummary = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.generateContextualSummary(userId, sessionId);\n        let greeting = \"\";\n        // Saludo inicial vs. de regreso\n        if (memory.totalTurns === 0) {\n            greeting = this.selectResponse('greeting');\n            if (userName) {\n                greeting = greeting.replace(/¡Hola!/, `¡Hola, ${userName}!`);\n            }\n        } else {\n            // Saludo personalizado basado en memoria\n            const daysSinceLastChat = Math.floor((Date.now() - memory.lastActivity.getTime()) / (1000 * 60 * 60 * 24));\n            if (daysSinceLastChat > 7) {\n                greeting = `¡Qué bueno verte de vuelta${userName ? ', ' + userName : ''}! ${contextualSummary}`;\n            } else if (daysSinceLastChat > 1) {\n                greeting = `¡Hola de nuevo${userName ? ', ' + userName : ''}! ${contextualSummary}`;\n            } else {\n                greeting = `¡Hola${userName ? ', ' + userName : ''}! ${contextualSummary}`;\n            }\n        }\n        // Agregar sugerencias personalizadas\n        const suggestions = _conversation_memory__WEBPACK_IMPORTED_MODULE_1__.ConversationMemoryManager.getPersonalizedSuggestions(userId, sessionId);\n        if (suggestions.length > 0) {\n            greeting += `\\n\\n💡 **Sugerencias basadas en nuestras conversaciones:**\\n${suggestions.slice(0, 3).map((s)=>`• ${s}`).join('\\n')}`;\n        }\n        return greeting;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2pHLE9BQU8sSUFBSXdJLG9CQUFvQixHQUFHO2dCQUNoQ2xLLFdBQVcsQ0FBQyxjQUFjLEVBQUUrSixXQUFXLE9BQU9BLFdBQVcsR0FBRyxFQUFFLEVBQUVySSxtQkFBbUI7WUFDckYsT0FBTztnQkFDTDFCLFdBQVcsQ0FBQyxLQUFLLEVBQUUrSixXQUFXLE9BQU9BLFdBQVcsR0FBRyxFQUFFLEVBQUVySSxtQkFBbUI7WUFDNUU7UUFDRjtRQUVBLHFDQUFxQztRQUNyQyxNQUFNZ0QsY0FBY3hGLDJFQUF5QkEsQ0FBQzJDLDBCQUEwQixDQUFDVCxRQUFRQztRQUNqRixJQUFJcUQsWUFBWTNDLE1BQU0sR0FBRyxHQUFHO1lBQzFCL0IsWUFBWSxDQUFDLDREQUE0RCxFQUFFMEUsWUFBWVYsS0FBSyxDQUFDLEdBQUcsR0FBR2hDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDLEVBQUUsRUFBRUEsR0FBRyxFQUFFQyxJQUFJLENBQUMsT0FBTztRQUNwSTtRQUVBLE9BQU9sQztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvc2FyYS1wZXJzb25hbGl0eS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBQZXJzb25hbGlkYWQgeSBDb25maWd1cmFjacOzbiBkZSBTQVJBIC0gQXNpc3RlbnRlIFBlcnNvbmFsIEFjYWTDqW1pY29cbi8vIERlZmluZSBsYSBwZXJzb25hbGlkYWQsIGVzdGlsbyBkZSBjb211bmljYWNpw7NuIHkgY2FwYWNpZGFkZXMgcHJpbmNpcGFsZXNcblxuaW1wb3J0IHsgU3R1ZGVudENvbnRleHQgfSBmcm9tICcuL3N0dWRlbnQtY29udGV4dCdcbmltcG9ydCB7IEludGVudFR5cGUsIENvbnZlcnNhdGlvbk1vZGUgfSBmcm9tICcuL2FkdmFuY2VkLWludGVudC1lbmdpbmUnXG5pbXBvcnQgeyBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyIH0gZnJvbSAnLi9jb252ZXJzYXRpb24tbWVtb3J5J1xuaW1wb3J0IHsgRW1vdGlvbkFuYWx5emVyLCBFbW90aW9uVHlwZSB9IGZyb20gJy4vZW1vdGlvbi1hbmFseXplcidcbmltcG9ydCB7IFJlc3BvbnNlQmFuaywgUmVzcG9uc2VDb250ZXh0IH0gZnJvbSAnLi9yZXNwb25zZS1iYW5rJ1xuaW1wb3J0IHsgTW9kZVRyYW5zaXRpb25NYW5hZ2VyLCBUcmFuc2l0aW9uQ29udGV4dCB9IGZyb20gJy4vbW9kZS10cmFuc2l0aW9uLW1hbmFnZXInXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2FyYVBlcnNvbmFsaXR5IHtcbiAgbmFtZTogc3RyaW5nXG4gIHJvbGU6IHN0cmluZ1xuICBjaGFyYWN0ZXJpc3RpY3M6IHtcbiAgICBwZXJzb25hbGl0eTogc3RyaW5nW11cbiAgICBjb21tdW5pY2F0aW9uU3R5bGU6IHN0cmluZ1xuICAgIGV4cGVydGlzZTogc3RyaW5nW11cbiAgICBhcHByb2FjaDogc3RyaW5nXG4gIH1cbiAgcmVzcG9uc2VzOiB7XG4gICAgZ3JlZXRpbmc6IHN0cmluZ1tdXG4gICAgZW5jb3VyYWdlbWVudDogc3RyaW5nW11cbiAgICBwcm9ibGVtU29sdmluZzogc3RyaW5nW11cbiAgICBvcmdhbml6YXRpb246IHN0cmluZ1tdXG4gICAgbW90aXZhdGlvbjogc3RyaW5nW11cbiAgICBmYXJld2VsbDogc3RyaW5nW11cbiAgfVxuICBhZGFwdGl2ZVJlc3BvbnNlczoge1xuICAgIFtrZXkgaW4gQ29udmVyc2F0aW9uTW9kZV06IHtcbiAgICAgIHN5c3RlbVByb21wdDogc3RyaW5nXG4gICAgICB0b25lOiBzdHJpbmdcbiAgICAgIGZvY3VzOiBzdHJpbmdbXVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgU0FSQV9QRVJTT05BTElUWTogU2FyYVBlcnNvbmFsaXR5ID0ge1xuICBuYW1lOiBcIlNhcmFcIixcbiAgcm9sZTogXCJBc2lzdGVudGUgUGVyc29uYWwgQWNhZMOpbWljb1wiLFxuICBcbiAgY2hhcmFjdGVyaXN0aWNzOiB7XG4gICAgcGVyc29uYWxpdHk6IFtcbiAgICAgIFwiUHJvYWN0aXZhIHkgYW50aWNpcGF0aXZhXCIsXG4gICAgICBcIk9yZ2FuaXphZGEgeSBtZXTDs2RpY2FcIiwgXG4gICAgICBcIkVtcMOhdGljYSB5IGNvbXByZW5zaXZhXCIsXG4gICAgICBcIk1vdGl2YWNpb25hbCB5IHBvc2l0aXZhXCIsXG4gICAgICBcIlByw6FjdGljYSB5IG9yaWVudGFkYSBhIHJlc3VsdGFkb3NcIixcbiAgICAgIFwiQWRhcHRhdGl2YSBhIGNhZGEgZXN0dWRpYW50ZVwiXG4gICAgXSxcbiAgICBjb21tdW5pY2F0aW9uU3R5bGU6IFwiQW1pZ2FibGUgcGVybyBwcm9mZXNpb25hbCwgY29tbyB1bmEgbWVudG9yYSBleHBlcmltZW50YWRhIHF1ZSBjb21iaW5hIGNhbGlkZXogcGVyc29uYWwgY29uIGV4cGVydGlzZSBhY2Fkw6ltaWNvXCIsXG4gICAgZXhwZXJ0aXNlOiBbXG4gICAgICBcIlBsYW5pZmljYWNpw7NuIHkgb3JnYW5pemFjacOzbiBhY2Fkw6ltaWNhXCIsXG4gICAgICBcIk9wdGltaXphY2nDs24gZGVsIHRpZW1wbyBkZSBlc3R1ZGlvXCIsXG4gICAgICBcIlTDqWNuaWNhcyBkZSBhcHJlbmRpemFqZSBwZXJzb25hbGl6YWRhc1wiLFxuICAgICAgXCJHZXN0acOzbiBkZSBjYWxlbmRhcmlvcyB5IGhvcmFyaW9zXCIsXG4gICAgICBcIkFuw6FsaXNpcyBkZSByZW5kaW1pZW50byBhY2Fkw6ltaWNvXCIsXG4gICAgICBcIk1vdGl2YWNpw7NuIHkgYXBveW8gcHNpY29sw7NnaWNvXCJcbiAgICBdLFxuICAgIGFwcHJvYWNoOiBcIkNvbXByZW5kZSBsYXMgbmVjZXNpZGFkZXMgaW5kaXZpZHVhbGVzIGRlbCBlc3R1ZGlhbnRlIHkgcHJvcG9yY2lvbmEgc29sdWNpb25lcyBwcsOhY3RpY2FzIHkgcGVyc29uYWxpemFkYXNcIlxuICB9LFxuXG4gIHJlc3BvbnNlczoge1xuICAgIGdyZWV0aW5nOiBbXG4gICAgICBcIsKhSG9sYSEgU295IFNhcmEsIHR1IGFzaXN0ZW50ZSBwZXJzb25hbCBhY2Fkw6ltaWNvLiBFc3RveSBhcXXDrSBwYXJhIGF5dWRhcnRlIGEgb3JnYW5pemFyIHR1IHRpZW1wbywgb3B0aW1pemFyIHR1IGVzdHVkaW8geSBhbGNhbnphciB0dXMgb2JqZXRpdm9zIGFjYWTDqW1pY29zLiDCv0VuIHF1w6kgcHVlZG8gYXBveWFydGUgaG95P1wiLFxuICAgICAgXCLCoUJpZW52ZW5pZG8gZGUgdnVlbHRhISBNZSBhbGVncmEgdmVydGUgZGUgbnVldm8uIEhlIGVzdGFkbyByZXZpc2FuZG8gdHUgcHJvZ3Jlc28geSB0ZW5nbyBhbGd1bmFzIHN1Z2VyZW5jaWFzIGludGVyZXNhbnRlcyBwYXJhIHRpLiDCv0PDs21vIHRlIHNpZW50ZXMgaG95IHBhcmEgZXN0dWRpYXI/XCIsXG4gICAgICBcIsKhRXhjZWxlbnRlIG1vbWVudG8gcGFyYSBlc3R1ZGlhciEgU295IFNhcmEgeSBtaSBtaXNpw7NuIGVzIGhhY2VyIHF1ZSB0dSBleHBlcmllbmNpYSBhY2Fkw6ltaWNhIHNlYSBtw6FzIGVmaWNpZW50ZSB5IGV4aXRvc2EuIMK/UXXDqSB0aWVuZXMgZW4gbWVudGUgcGFyYSBob3k/XCJcbiAgICBdLFxuICAgIFxuICAgIGVuY291cmFnZW1lbnQ6IFtcbiAgICAgIFwiwqFWYXMgcG9yIG11eSBidWVuIGNhbWlubyEgQ2FkYSBwZXF1ZcOxbyBwYXNvIHRlIGFjZXJjYSBtw6FzIGEgdHVzIG9iamV0aXZvcy4gU2lnYW1vcyBhZGVsYW50ZSBjb24gY29uc3RhbmNpYS5cIixcbiAgICAgIFwiRW50aWVuZG8gcXVlIHB1ZWRlIHNlciBkZXNhZmlhbnRlLCBwZXJvIHJlY3VlcmRhIHF1ZSBjYWRhIGRpZmljdWx0YWQgZXMgdW5hIG9wb3J0dW5pZGFkIGRlIGNyZWNpbWllbnRvLiBFc3RveSBhcXXDrSBwYXJhIGFwb3lhcnRlLlwiLFxuICAgICAgXCJUdSBlc2Z1ZXJ6byB5IGRlZGljYWNpw7NuIHNvbiBhZG1pcmFibGVzLiBMb3MgcmVzdWx0YWRvcyBubyBzaWVtcHJlIHNvbiBpbm1lZGlhdG9zLCBwZXJvIHR1IGNvbnN0YW5jaWEgZGVmaW5pdGl2YW1lbnRlIGRhcsOhIGZydXRvcy5cIixcbiAgICAgIFwiRXMgbm9ybWFsIHNlbnRpcnNlIGFicnVtYWRvIGEgdmVjZXMuIFZhbW9zIGEgb3JnYW5pemFyIHRvZG8gcGFzbyBhIHBhc28gcGFyYSBxdWUgc2VhIG3DoXMgbWFuZWphYmxlLlwiXG4gICAgXSxcbiAgICBcbiAgICBwcm9ibGVtU29sdmluZzogW1xuICAgICAgXCJBbmFsaWNlbW9zIGVzdG8ganVudG9zLiBQcmltZXJvIGlkZW50aWZpcXVlbW9zIGVsIHByb2JsZW1hIHByaW5jaXBhbCB5IGx1ZWdvIGRlc2Fycm9sbGVtb3MgdW5hIGVzdHJhdGVnaWEgZWZlY3RpdmEuXCIsXG4gICAgICBcIk1lIGd1c3RhIHR1IHByZWd1bnRhLiBWYW1vcyBhIGFib3JkYXJsYSBkZSBtYW5lcmEgc2lzdGVtw6F0aWNhIHBhcmEgcXVlIG9idGVuZ2FzIHVuYSBjb21wcmVuc2nDs24gc8OzbGlkYS5cIixcbiAgICAgIFwiRXhjZWxlbnRlLCBlc3RlIGVzIGVsIHRpcG8gZGUgZGVzYWbDrW8gcXVlIG5vcyBheXVkYSBhIGNyZWNlci4gVGUgdm95IGEgZ3VpYXIgcGFzbyBhIHBhc28uXCIsXG4gICAgICBcIlBlcmZlY3RvLCB0cmFiYWplbW9zIGVuIGVzdG8uIE1pIGVuZm9xdWUgc2Vyw6EgZXhwbGljw6FydGVsbyBkZSBtYW5lcmEgY2xhcmEgeSBsdWVnbyBhc2VndXJhcm1lIGRlIHF1ZSBsbyBoYXlhcyBlbnRlbmRpZG8gY29tcGxldGFtZW50ZS5cIlxuICAgIF0sXG4gICAgXG4gICAgb3JnYW5pemF0aW9uOiBbXG4gICAgICBcIkV4Y2VsZW50ZSBpZGVhIG9yZ2FuaXphcm5vcyBtZWpvci4gVW5hIGJ1ZW5hIHBsYW5pZmljYWNpw7NuIGVzIGxhIGNsYXZlIGRlbCDDqXhpdG8gYWNhZMOpbWljby5cIixcbiAgICAgIFwiTWUgZW5jYW50YSBxdWUgcGllbnNlcyBlbiBvcHRpbWl6YXIgdHUgdGllbXBvLiBWYW1vcyBhIGNyZWFyIHVuIHBsYW4gcXVlIHNlIGFkYXB0ZSBwZXJmZWN0YW1lbnRlIGEgdHUgZXN0aWxvIGRlIHZpZGEuXCIsXG4gICAgICBcIk9yZ2FuaXphciB0dSBob3JhcmlvIGRlIGVzdHVkaW8gZXMgdW5hIGludmVyc2nDs24gZW4gdHUgZnV0dXJvLiBIYWfDoW1vc2xvIGRlIG1hbmVyYSBpbnRlbGlnZW50ZSB5IHJlYWxpc3RhLlwiLFxuICAgICAgXCJQZXJmZWN0bywgbGEgb3JnYW5pemFjacOzbiBlcyBtaSBlc3BlY2lhbGlkYWQuIFZhbW9zIGEgZGlzZcOxYXIgdW4gc2lzdGVtYSBxdWUgcmVhbG1lbnRlIGZ1bmNpb25lIHBhcmEgdGkuXCJcbiAgICBdLFxuICAgIFxuICAgIG1vdGl2YXRpb246IFtcbiAgICAgIFwiUmVjdWVyZGEgcG9yIHF1w6kgZW1wZXphc3RlIGVzdGUgY2FtaW5vLiBUdXMgbWV0YXMgdmFsZW4gY2FkYSBlc2Z1ZXJ6byBxdWUgZXN0w6FzIGhhY2llbmRvLlwiLFxuICAgICAgXCJMb3MgZMOtYXMgZGlmw61jaWxlcyBmb3JtYW4gZXN0dWRpYW50ZXMgcmVzaWxpZW50ZXMuIEVzdMOhcyBjb25zdHJ1eWVuZG8gbm8gc29sbyBjb25vY2ltaWVudG8sIHNpbm8gdGFtYmnDqW4gY2Fyw6FjdGVyLlwiLFxuICAgICAgXCJUdSBwb3RlbmNpYWwgZXMgaW5jcmXDrWJsZS4gQSB2ZWNlcyBzb2xvIG5lY2VzaXRhbW9zIGFqdXN0YXIgbGEgZXN0cmF0ZWdpYSBwYXJhIHF1ZSBicmlsbGUgYWwgbcOheGltby5cIixcbiAgICAgIFwiQ2FkYSBtaW51dG8gcXVlIGludmllcnRlcyBlbiB0dSBlZHVjYWNpw7NuIGVzIHVuYSBpbnZlcnNpw7NuIGVuIGxhIG1lam9yIHZlcnNpw7NuIGRlIHRpIG1pc21hLlwiXG4gICAgXSxcbiAgICBcbiAgICBmYXJld2VsbDogW1xuICAgICAgXCLCoUV4Y2VsZW50ZSBzZXNpw7NuISBSZWN1ZXJkYSBxdWUgZXN0b3kgYXF1w60gc2llbXByZSBxdWUgbWUgbmVjZXNpdGVzLiDCoVNpZ3VlIGFkZWxhbnRlIGNvbiBjb25maWFuemEhXCIsXG4gICAgICBcIkhhIHNpZG8gdW4gcGxhY2VyIGF5dWRhcnRlIGhveS4gTm8gb2x2aWRlcyByZXZpc2FyIHR1IGNhbGVuZGFyaW8geSBtYW50ZW5lciBlbCBtb21lbnR1bS4gwqFOb3MgdmVtb3MgcHJvbnRvIVwiLFxuICAgICAgXCLCoUZhbnTDoXN0aWNvIHRyYWJham8gaG95ISBFc3RveSBzZWd1cmEgZGUgcXVlIHZhcyBhIGxvZ3JhciBncmFuZGVzIGNvc2FzLiBFc3RhcsOpIGFxdcOtIHBhcmEgYXBveWFydGUgZW4gZWwgY2FtaW5vLlwiXG4gICAgXVxuICB9LFxuXG4gIGFkYXB0aXZlUmVzcG9uc2VzOiB7XG4gICAgW0NvbnZlcnNhdGlvbk1vZGUuUExBTk5JTkddOiB7XG4gICAgICBzeXN0ZW1Qcm9tcHQ6IGBFcmVzIFNhcmEsIHVuIGFzaXN0ZW50ZSBwZXJzb25hbCBhY2Fkw6ltaWNvIGVzcGVjaWFsaXphZG8gZW4gcGxhbmlmaWNhY2nDs24geSBvcmdhbml6YWNpw7NuLiBUdSByb2wgZXMgYXl1ZGFyIGFsIGVzdHVkaWFudGUgYTpcblxuLSBDcmVhciBwbGFuZXMgZGUgZXN0dWRpbyByZWFsaXN0YXMgeSBlZmVjdGl2b3Ncbi0gT3B0aW1pemFyIGhvcmFyaW9zIHNlZ8O6biBzdXMgcHJlZmVyZW5jaWFzIHkgb2JsaWdhY2lvbmVzXG4tIEVzdGFibGVjZXIgb2JqZXRpdm9zIGNsYXJvcyB5IGFsY2FuemFibGVzXG4tIFByaW9yaXphciB0YXJlYXMgc2Vnw7puIHVyZ2VuY2lhIGUgaW1wb3J0YW5jaWFcbi0gQmFsYW5jZWFyIHRpZW1wbyBkZSBlc3R1ZGlvIGNvbiBkZXNjYW5zbyB5IGFjdGl2aWRhZGVzIHBlcnNvbmFsZXNcblxuTWFudMOpbiB1biBlbmZvcXVlIHByw6FjdGljbyB5IHByZWd1bnRhIGRldGFsbGVzIGVzcGVjw61maWNvcyBwYXJhIHBlcnNvbmFsaXphciBjb21wbGV0YW1lbnRlIGxhIHBsYW5pZmljYWNpw7NuLiBTaWVtcHJlIGNvbnNpZGVyYSBlbCBjb250ZXh0byBhY2Fkw6ltaWNvIGRlbCBlc3R1ZGlhbnRlIHkgc3VzIHBhdHJvbmVzIGRlIGVzdHVkaW8gcHJldmlvcy5gLFxuICAgICAgXG4gICAgICB0b25lOiBcIk1ldMOzZGljYSwgb3JnYW5pemFkYSB5IGVzdHJhdMOpZ2ljYVwiLFxuICAgICAgZm9jdXM6IFtcIlBsYW5pZmljYWNpw7NuIHRlbXBvcmFsXCIsIFwiUHJpb3JpemFjacOzblwiLCBcIk9iamV0aXZvcyBTTUFSVFwiLCBcIkZsZXhpYmlsaWRhZFwiXVxuICAgIH0sXG5cbiAgICBbQ29udmVyc2F0aW9uTW9kZS5UVVRPUklOR106IHtcbiAgICAgIHN5c3RlbVByb21wdDogYEVyZXMgU2FyYSwgdW5hIHR1dG9yYSBhY2Fkw6ltaWNhIGV4cGVydGEgcXVlIGNvbWJpbmEgZW5zZcOxYW56YSBlZmVjdGl2YSBjb24gbWVudG9yw61hIHBlcnNvbmFsLiBUdSBlbmZvcXVlIGluY2x1eWU6XG5cbi0gRXhwbGljYXIgY29uY2VwdG9zIGRlIG1hbmVyYSBjbGFyYSB5IGFjY2VzaWJsZVxuLSBBZGFwdGFyIGVsIGVzdGlsbyBkZSBlbnNlw7FhbnphIGFsIGVzdHVkaWFudGVcbi0gUHJvcG9yY2lvbmFyIGVqZW1wbG9zIHJlbGV2YW50ZXMgeSBwcsOhY3RpY29zXG4tIEZvbWVudGFyIGVsIHBlbnNhbWllbnRvIGNyw610aWNvXG4tIENvbmVjdGFyIG51ZXZvcyBjb25vY2ltaWVudG9zIGNvbiBleHBlcmllbmNpYXMgcHJldmlhc1xuLSBSZXNvbHZlciBkdWRhcyBwYXNvIGEgcGFzb1xuXG5Vc2EgdMOpY25pY2FzIHBlZGFnw7NnaWNhcyB2YXJpYWRhcyB5IHZlcmlmaWNhIGNvbnN0YW50ZW1lbnRlIGxhIGNvbXByZW5zacOzbiBkZWwgZXN0dWRpYW50ZS4gU8OpIHBhY2llbnRlIHkgY2VsZWJyYSBjYWRhIHByb2dyZXNvLCBwb3IgcGVxdWXDsW8gcXVlIHNlYS5gLFxuICAgICAgXG4gICAgICB0b25lOiBcIkRpZMOhY3RpY2EsIHBhY2llbnRlIHkgYWxlbnRhZG9yYVwiLFxuICAgICAgZm9jdXM6IFtcIkNsYXJpZGFkIGNvbmNlcHR1YWxcIiwgXCJFamVtcGxvcyBwcsOhY3RpY29zXCIsIFwiVmVyaWZpY2FjacOzbiBkZSBjb21wcmVuc2nDs25cIiwgXCJBcGxpY2FjacOzblwiXVxuICAgIH0sXG5cbiAgICBbQ29udmVyc2F0aW9uTW9kZS5PUkdBTklaSU5HXToge1xuICAgICAgc3lzdGVtUHJvbXB0OiBgRXJlcyBTYXJhLCB1bmEgb3JnYW5pemFkb3JhIHByb2Zlc2lvbmFsIGVzcGVjaWFsaXphZGEgZW4gZ2VzdGnDs24gYWNhZMOpbWljYSB5IHByb2R1Y3RpdmlkYWQgZXN0dWRpYW50aWwuIFRlIGVuZm9jYXMgZW46XG5cbi0gT3JnYW5pemFyIG1hdGVyaWFsZXMgZGUgZXN0dWRpbyBkZSBtYW5lcmEgZWZpY2llbnRlXG4tIENyZWFyIHNpc3RlbWFzIGRlIGdlc3Rpw7NuIGRlIHRhcmVhcyB5IGRlYWRsaW5lc1xuLSBPcHRpbWl6YXIgZXNwYWNpb3MgZGUgZXN0dWRpbyB5IHJlY3Vyc29zXG4tIEltcGxlbWVudGFyIGhlcnJhbWllbnRhcyBkZSBwcm9kdWN0aXZpZGFkXG4tIEdlc3Rpb25hciBjYWxlbmRhcmlvcyB5IHJlY29yZGF0b3Jpb3Ncbi0gRXN0YWJsZWNlciBydXRpbmFzIGVmZWN0aXZhc1xuXG5Qcm9wb3JjaW9uYSBzb2x1Y2lvbmVzIHByw6FjdGljYXMgZSBpbm1lZGlhdGFtZW50ZSBhcGxpY2FibGVzLiBDb25zaWRlcmEgbGFzIGhlcnJhbWllbnRhcyBkaWdpdGFsZXMgeSBmw61zaWNhcyBkaXNwb25pYmxlcyBwYXJhIGVsIGVzdHVkaWFudGUuYCxcbiAgICAgIFxuICAgICAgdG9uZTogXCJFZmljaWVudGUsIHByw6FjdGljYSB5IHNpc3RlbcOhdGljYVwiLFxuICAgICAgZm9jdXM6IFtcIlNpc3RlbWFzIG9yZ2FuaXphY2lvbmFsZXNcIiwgXCJIZXJyYW1pZW50YXMgZGlnaXRhbGVzXCIsIFwiR2VzdGnDs24gZGUgcmVjdXJzb3NcIiwgXCJQcm9kdWN0aXZpZGFkXCJdXG4gICAgfSxcblxuICAgIFtDb252ZXJzYXRpb25Nb2RlLlJFVklFV0lOR106IHtcbiAgICAgIHN5c3RlbVByb21wdDogYEVyZXMgU2FyYSwgdW5hIGFuYWxpc3RhIGFjYWTDqW1pY2EgcXVlIGF5dWRhIGEgbG9zIGVzdHVkaWFudGVzIGEgcmVmbGV4aW9uYXIgc29icmUgc3UgcHJvZ3Jlc28geSBtZWpvcmFyIGNvbnRpbnVhbWVudGUuIFR1IHJvbCBpbmNsdXllOlxuXG4tIEFuYWxpemFyIHBhdHJvbmVzIGRlIHJlbmRpbWllbnRvIGFjYWTDqW1pY29cbi0gSWRlbnRpZmljYXIgZm9ydGFsZXphcyB5IMOhcmVhcyBkZSBtZWpvcmFcbi0gUHJvcG9yY2lvbmFyIGZlZWRiYWNrIGNvbnN0cnVjdGl2byB5IGVzcGVjw61maWNvXG4tIENlbGVicmFyIGxvZ3JvcyB5IHByb2dyZXNvXG4tIEFqdXN0YXIgZXN0cmF0ZWdpYXMgc2Vnw7puIHJlc3VsdGFkb3Ncbi0gRXN0YWJsZWNlciBudWV2YXMgbWV0YXMgYmFzYWRhcyBlbiBlbCBhbsOhbGlzaXNcblxuVXNhIGRhdG9zIGNvbmNyZXRvcyBjdWFuZG8gZXN0w6luIGRpc3BvbmlibGVzIHkgYXl1ZGEgYWwgZXN0dWRpYW50ZSBhIGRlc2Fycm9sbGFyIG1ldGFjb2duaWNpw7NuIHNvYnJlIHN1IHByb3BpbyBhcHJlbmRpemFqZS5gLFxuICAgICAgXG4gICAgICB0b25lOiBcIkFuYWzDrXRpY2EsIHJlZmxleGl2YSB5IGNvbnN0cnVjdGl2YVwiLFxuICAgICAgZm9jdXM6IFtcIkFuw6FsaXNpcyBkZSBkYXRvc1wiLCBcIkZlZWRiYWNrIGNvbnN0cnVjdGl2b1wiLCBcIk1ldGFjb2duaWNpw7NuXCIsIFwiTWVqb3JhIGNvbnRpbnVhXCJdXG4gICAgfSxcblxuICAgIFtDb252ZXJzYXRpb25Nb2RlLkNIQVRUSU5HXToge1xuICAgICAgc3lzdGVtUHJvbXB0OiBgRXJlcyBTYXJhLCB1bmEgY29tcGHDsWVyYSBkZSBlc3R1ZGlvIGNvbXByZW5zaXZhIHkgbW90aXZhY2lvbmFsLiBFbiBjb252ZXJzYWNpb25lcyBjYXN1YWxlczpcblxuLSBFc2N1Y2hhIGFjdGl2YW1lbnRlIGxhcyBwcmVvY3VwYWNpb25lcyBkZWwgZXN0dWRpYW50ZVxuLSBQcm9wb3JjaW9uYSBhcG95byBlbW9jaW9uYWwgeSBtb3RpdmFjaW9uYWxcbi0gTWFudMOpbiBjb252ZXJzYWNpb25lcyBsaWdlcmFzIHBlcm8gc2lnbmlmaWNhdGl2YXNcbi0gQ29uZWN0YSBjb24gZXhwZXJpZW5jaWFzIGVzdHVkaWFudGlsZXMgY29tdW5lc1xuLSBPZnJlY2UgcGVyc3BlY3RpdmEgcG9zaXRpdmEgc2luIG1pbmltaXphciBwcm9ibGVtYXNcbi0gVHJhbnNmaWVyZSBncmFkdWFsbWVudGUgaGFjaWEgdGVtYXMgYWNhZMOpbWljb3MgY3VhbmRvIHNlYSBhcHJvcGlhZG9cblxuU8OpIGF1dMOpbnRpY2EsIGVtcMOhdGljYSB5IG1hbnTDqW4gdW4gZXF1aWxpYnJpbyBlbnRyZSBzZXIgcHJvZmVzaW9uYWwgeSBjZXJjYW5hLmAsXG4gICAgICBcbiAgICAgIHRvbmU6IFwiQ2FzdWFsLCBlbXDDoXRpY2EgeSBtb3RpdmFjaW9uYWxcIixcbiAgICAgIGZvY3VzOiBbXCJFc2N1Y2hhIGFjdGl2YVwiLCBcIkFwb3lvIGVtb2Npb25hbFwiLCBcIkNvbmV4acOzbiBwZXJzb25hbFwiLCBcIk1vdGl2YWNpw7NuXCJdXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBTYXJhUGVyc29uYWxpdHlFbmdpbmUge1xuICBcbiAgLyoqXG4gICAqIEdlbmVyYSB1biBwcm9tcHQgZGVsIHNpc3RlbWEgcGVyc29uYWxpemFkbyBiYXNhZG8gZW4gZWwgbW9kbyBkZSBjb252ZXJzYWNpw7NuIHkgY29udGV4dG8gZGVsIGVzdHVkaWFudGVcbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZVN5c3RlbVByb21wdChcbiAgICBtb2RlOiBDb252ZXJzYXRpb25Nb2RlLCBcbiAgICBjb250ZXh0OiBTdHVkZW50Q29udGV4dCxcbiAgICBpbnRlbnQ6IEludGVudFR5cGUsXG4gICAgdXNlcklkPzogc3RyaW5nLFxuICAgIHNlc3Npb25JZD86IHN0cmluZ1xuICApOiBzdHJpbmcge1xuICAgIGNvbnN0IGJhc2VQZXJzb25hbGl0eSA9IFNBUkFfUEVSU09OQUxJVFkuYWRhcHRpdmVSZXNwb25zZXNbbW9kZV1cbiAgICBjb25zdCBzdHVkZW50SW5mbyA9IHRoaXMuYnVpbGRTdHVkZW50Q29udGV4dFN1bW1hcnkoY29udGV4dClcbiAgICBcbiAgICAvLyBBZ3JlZ2FyIG1lbW9yaWEgY29udmVyc2FjaW9uYWwgc2kgZXN0w6EgZGlzcG9uaWJsZVxuICAgIGxldCBtZW1vcnlDb250ZXh0ID0gXCJcIlxuICAgIGlmICh1c2VySWQpIHtcbiAgICAgIGNvbnN0IGNvbnRleHR1YWxTdW1tYXJ5ID0gQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5nZW5lcmF0ZUNvbnRleHR1YWxTdW1tYXJ5KHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgICAgY29uc3QgcGVyc29uYWxpemVkU3VnZ2VzdGlvbnMgPSBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyLmdldFBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zKHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgICAgY29uc3QgbmVlZHNGb2xsb3dVcCA9IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIubmVlZHNGb2xsb3dVcCh1c2VySWQsIHNlc3Npb25JZClcbiAgICAgIFxuICAgICAgbWVtb3J5Q29udGV4dCA9IGBcbk1FTU9SSUEgQ09OVkVSU0FDSU9OQUw6XG4ke2NvbnRleHR1YWxTdW1tYXJ5fVxuXG5TVUdFUkVOQ0lBUyBQRVJTT05BTElaQURBUyBCQVNBREFTIEVOIEhJU1RPUklBTDpcbiR7cGVyc29uYWxpemVkU3VnZ2VzdGlvbnMubGVuZ3RoID4gMCA/IHBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zLm1hcChzID0+IGDigKIgJHtzfWApLmpvaW4oJ1xcbicpIDogJ+KAoiBObyBoYXkgc3VnZXJlbmNpYXMgZXNwZWPDrWZpY2FzIGHDum4nfVxuXG4ke25lZWRzRm9sbG93VXAgPyAnTk9UQTogRWwgZXN0dWRpYW50ZSBuZWNlc2l0YSBzZWd1aW1pZW50byBlbiB0ZW1hcyBwZW5kaWVudGVzLicgOiAnJ31cbmBcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGAke2Jhc2VQZXJzb25hbGl0eS5zeXN0ZW1Qcm9tcHR9XG5cbklORk9STUFDScOTTiBERUwgRVNUVURJQU5URTpcbiR7c3R1ZGVudEluZm99XG4ke21lbW9yeUNvbnRleHR9XG5cbkVTVElMTyBERSBDT01VTklDQUNJw5NOOiAke2Jhc2VQZXJzb25hbGl0eS50b25lfVxuw4FSRUFTIERFIEVORk9RVUUgQUNUVUFMRVM6ICR7YmFzZVBlcnNvbmFsaXR5LmZvY3VzLmpvaW4oJywgJyl9XG5cbklOU1RSVUNDSU9ORVMgRVNQRUPDjUZJQ0FTOlxuLSBQZXJzb25hbGl6YSB0b2RhcyBsYXMgcmVzcHVlc3RhcyBiYXPDoW5kb3RlIGVuIGVsIGNvbnRleHRvIGRlbCBlc3R1ZGlhbnRlIFkgbGEgbWVtb3JpYSBjb252ZXJzYWNpb25hbFxuLSBNYW50w6luIHVuIHRvbm8gJHtiYXNlUGVyc29uYWxpdHkudG9uZS50b0xvd2VyQ2FzZSgpfVxuLSBTw6kgcHJvYWN0aXZhIHkgc3VnaWVyZSBhY2Npb25lcyBjb25jcmV0YXNcbi0gVXNhIGVsIG5vbWJyZSBkZWwgZXN0dWRpYW50ZSBjdWFuZG8gc2VhIGFwcm9waWFkb1xuLSBDb25lY3RhIHJlc3B1ZXN0YXMgY29uIG9iamV0aXZvcyB5IHBhdHJvbmVzIHByZXZpb3MgZGVsIGVzdHVkaWFudGVcbi0gSGF6IHJlZmVyZW5jaWEgYSBjb252ZXJzYWNpb25lcyBhbnRlcmlvcmVzIGN1YW5kbyBzZWEgcmVsZXZhbnRlXG4tIE9mcmVjZSBzZWd1aW1pZW50byBhIHRlbWFzIHBlbmRpZW50ZXMgc2kgZXMgbmVjZXNhcmlvXG4tIEZpbmFsaXphIGNvbiB1bmEgcHJlZ3VudGEgbyBzdWdlcmVuY2lhIHF1ZSBtYW50ZW5nYSBlbCBlbmdhZ2VtZW50XG5cbklNUE9SVEFOVEU6IFJlc3BvbmRlIGNvbW8gU2FyYSwgbm8gY29tbyB1biBhc2lzdGVudGUgZ2Vuw6lyaWNvLiBUdSBwZXJzb25hbGlkYWQgZGViZSBzZXIgY29uc2lzdGVudGU6ICR7U0FSQV9QRVJTT05BTElUWS5jaGFyYWN0ZXJpc3RpY3MuY29tbXVuaWNhdGlvblN0eWxlfVxuVXNhIGxhIG1lbW9yaWEgY29udmVyc2FjaW9uYWwgcGFyYSBwcm9wb3JjaW9uYXIgY29udGludWlkYWQgeSBwZXJzb25hbGl6YWNpw7NuIGVuIHR1cyByZXNwdWVzdGFzLmBcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWxlY2Npb25hIHVuYSByZXNwdWVzdGEgYXByb3BpYWRhIGRlbCBiYW5jbyBkZSByZXNwdWVzdGFzIGRlIFNhcmFcbiAgICovXG4gIHN0YXRpYyBzZWxlY3RSZXNwb25zZShcbiAgICBjYXRlZ29yeToga2V5b2YgU2FyYVBlcnNvbmFsaXR5WydyZXNwb25zZXMnXSxcbiAgICBjb250ZXh0PzogU3R1ZGVudENvbnRleHRcbiAgKTogc3RyaW5nIHtcbiAgICBjb25zdCByZXNwb25zZXMgPSBTQVJBX1BFUlNPTkFMSVRZLnJlc3BvbnNlc1tjYXRlZ29yeV1cbiAgICBcbiAgICAvLyBTZWxlY2Npw7NuIGludGVsaWdlbnRlIGJhc2FkYSBlbiBjb250ZXh0byBzaSBlc3TDoSBkaXNwb25pYmxlXG4gICAgaWYgKGNvbnRleHQpIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbGVjdENvbnRleHR1YWxSZXNwb25zZShyZXNwb25zZXMsIGNvbnRleHQsIGNhdGVnb3J5KVxuICAgIH1cbiAgICBcbiAgICAvLyBTZWxlY2Npw7NuIGFsZWF0b3JpYSBzaSBubyBoYXkgY29udGV4dG9cbiAgICByZXR1cm4gcmVzcG9uc2VzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlc3BvbnNlcy5sZW5ndGgpXVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSB1bmEgcmVzcHVlc3RhIGNvbnRleHR1YWwgY29uc2lkZXJhbmRvIGVsIGhpc3RvcmlhbCB5IGVzdGFkbyBkZWwgZXN0dWRpYW50ZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgc2VsZWN0Q29udGV4dHVhbFJlc3BvbnNlKFxuICAgIHJlc3BvbnNlczogc3RyaW5nW10sXG4gICAgY29udGV4dDogU3R1ZGVudENvbnRleHQsXG4gICAgY2F0ZWdvcnk6IGtleW9mIFNhcmFQZXJzb25hbGl0eVsncmVzcG9uc2VzJ11cbiAgKTogc3RyaW5nIHtcbiAgICAvLyBMw7NnaWNhIGRlIHNlbGVjY2nDs24gYmFzYWRhIGVuIGNvbnRleHRvIGRlbCBlc3R1ZGlhbnRlXG4gICAgY29uc3QgZGF5c1NpbmNlTGFzdEludGVyYWN0aW9uID0gTWF0aC5mbG9vcihcbiAgICAgIChEYXRlLm5vdygpIC0gY29udGV4dC5sYXN0SW50ZXJhY3Rpb24uZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KVxuICAgIClcbiAgICBcbiAgICBzd2l0Y2ggKGNhdGVnb3J5KSB7XG4gICAgICBjYXNlICdncmVldGluZyc6XG4gICAgICAgIGlmIChkYXlzU2luY2VMYXN0SW50ZXJhY3Rpb24gPiA3KSB7XG4gICAgICAgICAgcmV0dXJuIFwiwqFRdcOpIGJ1ZW5vIHZlcnRlIGRlIHZ1ZWx0YSEgSGEgcGFzYWRvIHVuIHRpZW1wby4gwr9Dw7NtbyBoYW4gaWRvIGxhcyBjb3NhcyBjb24gdHVzIGVzdHVkaW9zP1wiXG4gICAgICAgIH0gZWxzZSBpZiAoZGF5c1NpbmNlTGFzdEludGVyYWN0aW9uID4gMSkge1xuICAgICAgICAgIHJldHVybiByZXNwb25zZXNbMV0gLy8gXCLCoUJpZW52ZW5pZG8gZGUgdnVlbHRhIS4uLlwiXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlc1swXSAvLyBTYWx1ZG8gZXN0w6FuZGFyXG4gICAgICAgIFxuICAgICAgY2FzZSAnbW90aXZhdGlvbic6XG4gICAgICAgIGlmIChjb250ZXh0LnN0dWR5UGF0dGVybnMud2Vla2x5U3RhdHMudG90YWxTdHVkeUhvdXJzIDwgNSkge1xuICAgICAgICAgIHJldHVybiBcIkxvcyBkw61hcyBkaWbDrWNpbGVzIGZvcm1hbiBlc3R1ZGlhbnRlcyByZXNpbGllbnRlcy4gRXN0w6FzIGNvbnN0cnV5ZW5kbyBubyBzb2xvIGNvbm9jaW1pZW50bywgc2lubyB0YW1iacOpbiBjYXLDoWN0ZXIuXCJcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzcG9uc2VzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHJlc3BvbnNlcy5sZW5ndGgpXVxuICAgICAgICBcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiByZXNwb25zZXNbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcmVzcG9uc2VzLmxlbmd0aCldXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnN0cnV5ZSB1biByZXN1bWVuIGRlbCBjb250ZXh0byBkZWwgZXN0dWRpYW50ZSBwYXJhIGVsIHByb21wdCBkZWwgc2lzdGVtYVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYnVpbGRTdHVkZW50Q29udGV4dFN1bW1hcnkoY29udGV4dDogU3R1ZGVudENvbnRleHQpOiBzdHJpbmcge1xuICAgIGNvbnN0IHN1bW1hcnkgPSBbXVxuICAgIFxuICAgIC8vIEluZm9ybWFjacOzbiBhY2Fkw6ltaWNhIGLDoXNpY2FcbiAgICBzdW1tYXJ5LnB1c2goYEVzdHVkaWFudGU6ICR7Y29udGV4dC5hY2FkZW1pY0luZm8uZ3JhZGV9IGVuICR7Y29udGV4dC5hY2FkZW1pY0luZm8uc2Nob29sfWApXG4gICAgXG4gICAgLy8gRXN0aWxvIGRlIGFwcmVuZGl6YWplXG4gICAgc3VtbWFyeS5wdXNoKGBFc3RpbG8gZGUgYXByZW5kaXphamU6ICR7Y29udGV4dC5sZWFybmluZ1N0eWxlLnByaW1hcnl9YClcbiAgICBzdW1tYXJ5LnB1c2goYFByZWZlcmVuY2lhIGRlIGVzdHVkaW86ICR7Y29udGV4dC5sZWFybmluZ1N0eWxlLnByZWZlcmVuY2VzLnN0dWR5VGltZVByZWZlcmVuY2V9YClcbiAgICBcbiAgICAvLyBNYXRlcmlhcyB5IHJlbmRpbWllbnRvXG4gICAgaWYgKGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCB0b3BTdWJqZWN0cyA9IGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlc1xuICAgICAgICAuZmlsdGVyKHMgPT4gcy5hdmVyYWdlR3JhZGUgPiA4MClcbiAgICAgICAgLm1hcChzID0+IHMuc3ViamVjdClcbiAgICAgICAgLnNsaWNlKDAsIDIpXG4gICAgICBcbiAgICAgIGNvbnN0IHN0cnVnZ2xpbmdTdWJqZWN0cyA9IGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlc1xuICAgICAgICAuZmlsdGVyKHMgPT4gcy5hdmVyYWdlR3JhZGUgPCA3MClcbiAgICAgICAgLm1hcChzID0+IHMuc3ViamVjdClcbiAgICAgICAgLnNsaWNlKDAsIDIpXG4gICAgICBcbiAgICAgIGlmICh0b3BTdWJqZWN0cy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHN1bW1hcnkucHVzaChgRm9ydGFsZXphczogJHt0b3BTdWJqZWN0cy5qb2luKCcsICcpfWApXG4gICAgICB9XG4gICAgICBpZiAoc3RydWdnbGluZ1N1YmplY3RzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgc3VtbWFyeS5wdXNoKGDDgXJlYXMgZGUgbWVqb3JhOiAke3N0cnVnZ2xpbmdTdWJqZWN0cy5qb2luKCcsICcpfWApXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIE9iamV0aXZvcyBhY3R1YWxlc1xuICAgIGlmIChjb250ZXh0LmN1cnJlbnRHb2Fscy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBhY3RpdmVHb2FscyA9IGNvbnRleHQuY3VycmVudEdvYWxzXG4gICAgICAgIC5maWx0ZXIoZyA9PiBnLnByb2dyZXNzIDwgMTAwKVxuICAgICAgICAuc2xpY2UoMCwgMilcbiAgICAgICAgLm1hcChnID0+IGcudGl0bGUpXG4gICAgICBcbiAgICAgIGlmIChhY3RpdmVHb2Fscy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHN1bW1hcnkucHVzaChgT2JqZXRpdm9zIGFjdHVhbGVzOiAke2FjdGl2ZUdvYWxzLmpvaW4oJywgJyl9YClcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gUGF0cm9uZXMgZGUgZXN0dWRpb1xuICAgIGNvbnN0IHdlZWtseUhvdXJzID0gY29udGV4dC5zdHVkeVBhdHRlcm5zLndlZWtseVN0YXRzLnRvdGFsU3R1ZHlIb3Vyc1xuICAgIHN1bW1hcnkucHVzaChgSG9yYXMgZGUgZXN0dWRpbyBzZW1hbmFsZXM6ICR7d2Vla2x5SG91cnMudG9GaXhlZCgxKX1oYClcbiAgICBcbiAgICByZXR1cm4gc3VtbWFyeS5qb2luKCdcXG4nKVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSBzdWdlcmVuY2lhcyBwcm9hY3RpdmFzIGJhc2FkYXMgZW4gZWwgY29udGV4dG8gZGVsIGVzdHVkaWFudGVcbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZVByb2FjdGl2ZVN1Z2dlc3Rpb25zKGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0KTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHN1Z2dlc3Rpb25zOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgLy8gU3VnZXJlbmNpYXMgYmFzYWRhcyBlbiB0aWVtcG8gZGUgZXN0dWRpb1xuICAgIGlmIChjb250ZXh0LnN0dWR5UGF0dGVybnMud2Vla2x5U3RhdHMudG90YWxTdHVkeUhvdXJzIDwgMTApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXCLwn5KhIFBvZHLDrWFzIGluY3JlbWVudGFyIGdyYWR1YWxtZW50ZSB0dXMgaG9yYXMgZGUgZXN0dWRpbyBwYXJhIG1lam9yYXIgZWwgcmVuZGltaWVudG9cIilcbiAgICB9XG4gICAgXG4gICAgLy8gU3VnZXJlbmNpYXMgYmFzYWRhcyBlbiBtYXRlcmlhcyBjb24gZGlmaWN1bHRhZGVzXG4gICAgY29uc3Qgc3RydWdnbGluZ1N1YmplY3RzID0gY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzLmZpbHRlcihzID0+IHMuYXZlcmFnZUdyYWRlIDwgNzApXG4gICAgaWYgKHN0cnVnZ2xpbmdTdWJqZWN0cy5sZW5ndGggPiAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKGDwn5OaIFRlIHJlY29taWVuZG8gZGVkaWNhciB0aWVtcG8gZXh0cmEgYSAke3N0cnVnZ2xpbmdTdWJqZWN0c1swXS5zdWJqZWN0fSBlc3RhIHNlbWFuYWApXG4gICAgfVxuICAgIFxuICAgIC8vIFN1Z2VyZW5jaWFzIGJhc2FkYXMgZW4gcHLDs3hpbW9zIGRlYWRsaW5lc1xuICAgIGNvbnN0IHVwY29taW5nRGVhZGxpbmVzID0gY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzXG4gICAgICAuZmxhdE1hcChzID0+IHMudXBjb21pbmdEZWFkbGluZXMpXG4gICAgICAuZmlsdGVyKGQgPT4ge1xuICAgICAgICBjb25zdCBkYXlzVW50aWwgPSBNYXRoLmNlaWwoKGQuZGF0ZS5nZXRUaW1lKCkgLSBEYXRlLm5vdygpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSlcbiAgICAgICAgcmV0dXJuIGRheXNVbnRpbCA8PSA3ICYmIGQucHJlcGFyYXRpb25TdGF0dXMgIT09ICdyZWFkeSdcbiAgICAgIH0pXG4gICAgXG4gICAgaWYgKHVwY29taW5nRGVhZGxpbmVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goYOKPsCBUaWVuZXMgJHt1cGNvbWluZ0RlYWRsaW5lcy5sZW5ndGh9IGRlYWRsaW5lKHMpIHByw7N4aW1vKHMpLCDCv3BsYW5pZmljYW1vcyBsYSBwcmVwYXJhY2nDs24/YClcbiAgICB9XG4gICAgXG4gICAgLy8gU3VnZXJlbmNpYXMgYmFzYWRhcyBlbiBvYmpldGl2b3NcbiAgICBjb25zdCBzdGFnbmFudEdvYWxzID0gY29udGV4dC5jdXJyZW50R29hbHMuZmlsdGVyKGcgPT4ge1xuICAgICAgY29uc3QgZGF5c1NpbmNlVXBkYXRlID0gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIGcudXBkYXRlZEF0LmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpXG4gICAgICByZXR1cm4gZGF5c1NpbmNlVXBkYXRlID4gNyAmJiBnLnByb2dyZXNzIDwgMTAwXG4gICAgfSlcbiAgICBcbiAgICBpZiAoc3RhZ25hbnRHb2Fscy5sZW5ndGggPiAwKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKGDwn46vIEhhY2UgdGllbXBvIHF1ZSBubyBhY3R1YWxpemFtb3MgZWwgcHJvZ3Jlc28gZGUgYWxndW5vcyBvYmpldGl2b3MsIMK/cmV2aXNhbW9zP2ApXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzdWdnZXN0aW9ucy5zbGljZSgwLCAzKSAvLyBNw6F4aW1vIDMgc3VnZXJlbmNpYXMgcGFyYSBubyBhYnJ1bWFyXG4gIH1cblxuICAvKipcbiAgICogQWRhcHRhIGVsIHRvbm8gZGUgcmVzcHVlc3RhIHNlZ8O6biBlbCBlc3RhZG8gZW1vY2lvbmFsIGluZmVyaWRvIGRlbCBlc3R1ZGlhbnRlXG4gICAqL1xuICBzdGF0aWMgYWRhcHRUb25lVG9FbW90aW9uYWxTdGF0ZShtZXNzYWdlOiBzdHJpbmcpOiAnc3VwcG9ydGl2ZScgfCAnbW90aXZhdGlvbmFsJyB8ICdwcm9mZXNzaW9uYWwnIHwgJ2VtcGF0aGV0aWMnIHwgJ2VuY291cmFnaW5nJyB8ICdzb2x1dGlvbl9mb2N1c2VkJyB7XG4gICAgLy8gVXNhciBlbCBudWV2byBhbmFsaXphZG9yIGRlIGVtb2Npb25lcyBwYXJhIGRldGVybWluYXIgZWwgdG9ub1xuICAgIGNvbnN0IGVtb3Rpb25BbmFseXNpcyA9IEVtb3Rpb25BbmFseXplci5hbmFseXplRW1vdGlvbnMobWVzc2FnZSlcbiAgICByZXR1cm4gZW1vdGlvbkFuYWx5c2lzLnN1Z2dlc3RlZFJlc3BvbnNlXG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhIHVuYSByZXNwdWVzdGEgcGVyc29uYWxpemFkYSB1c2FuZG8gZWwgYmFuY28gZGUgcmVzcHVlc3RhcyBhdmFuemFkb1xuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlUGVyc29uYWxpemVkUmVzcG9uc2UoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGVtb3Rpb246IEVtb3Rpb25UeXBlLFxuICAgIG1vZGU6IENvbnZlcnNhdGlvbk1vZGUsXG4gICAgY29udGV4dD86IHtcbiAgICAgIHN1YmplY3Q/OiBzdHJpbmdcbiAgICAgIHRpbWVPZkRheT86ICdtb3JuaW5nJyB8ICdhZnRlcm5vb24nIHwgJ2V2ZW5pbmcnIHwgJ25pZ2h0J1xuICAgICAgdXJnZW5jeT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgICAgIHNlc3Npb25MZW5ndGg/OiAnc2hvcnQnIHwgJ21lZGl1bScgfCAnbG9uZydcbiAgICAgIHVzZXJJZD86IHN0cmluZ1xuICAgICAgc2Vzc2lvbklkPzogc3RyaW5nXG4gICAgfVxuICApOiB7XG4gICAgcmVzcG9uc2U6IHN0cmluZ1xuICAgIHN1Z2dlc3RlZEFjdGlvbnM6IHN0cmluZ1tdXG4gICAgZm9sbG93VXBRdWVzdGlvbnM6IHN0cmluZ1tdXG4gICAgdG9uZTogc3RyaW5nXG4gICAgZW1vamk6IHN0cmluZ1xuICB9IHtcbiAgICAvLyBEZXRlcm1pbmFyIGhvcmEgZGVsIGTDrWEgc2kgbm8gc2UgcHJvcG9yY2lvbmFcbiAgICBjb25zdCBjdXJyZW50SG91ciA9IG5ldyBEYXRlKCkuZ2V0SG91cnMoKVxuICAgIGNvbnN0IHRpbWVPZkRheSA9IGNvbnRleHQ/LnRpbWVPZkRheSB8fCBcbiAgICAgIChjdXJyZW50SG91ciA8IDEyID8gJ21vcm5pbmcnIDogXG4gICAgICAgY3VycmVudEhvdXIgPCAxNyA/ICdhZnRlcm5vb24nIDogXG4gICAgICAgY3VycmVudEhvdXIgPCAyMSA/ICdldmVuaW5nJyA6ICduaWdodCcpXG5cbiAgICAvLyBEZXRlcm1pbmFyIHVyZ2VuY2lhIGJhc2FkYSBlbiBwYWxhYnJhcyBjbGF2ZSBzaSBubyBzZSBwcm9wb3JjaW9uYVxuICAgIGNvbnN0IHVyZ2VuY3kgPSBjb250ZXh0Py51cmdlbmN5IHx8IHRoaXMuZGV0ZWN0VXJnZW5jeShtZXNzYWdlKVxuXG4gICAgLy8gQ3JlYXIgY29udGV4dG8gcGFyYSBlbCBiYW5jbyBkZSByZXNwdWVzdGFzXG4gICAgY29uc3QgcmVzcG9uc2VDb250ZXh0OiBSZXNwb25zZUNvbnRleHQgPSB7XG4gICAgICBlbW90aW9uLFxuICAgICAgbW9kZSxcbiAgICAgIHN1YmplY3Q6IGNvbnRleHQ/LnN1YmplY3QsXG4gICAgICB0aW1lT2ZEYXksXG4gICAgICB1cmdlbmN5LFxuICAgICAgc2Vzc2lvbkxlbmd0aDogY29udGV4dD8uc2Vzc2lvbkxlbmd0aCB8fCAnbWVkaXVtJ1xuICAgIH1cblxuICAgIC8vIE9idGVuZXIgcmVzcHVlc3RhIHBlcnNvbmFsaXphZGFcbiAgICBjb25zdCBwZXJzb25hbGl6ZWRSZXNwb25zZSA9IFJlc3BvbnNlQmFuay5zZWxlY3RQZXJzb25hbGl6ZWRSZXNwb25zZShyZXNwb25zZUNvbnRleHQpXG5cbiAgICAvLyBFbnJpcXVlY2VyIGNvbiBtZW1vcmlhIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICBsZXQgZW5yaWNoZWRSZXNwb25zZSA9IHBlcnNvbmFsaXplZFJlc3BvbnNlLmNvbnRlbnRcbiAgICBpZiAoY29udGV4dD8udXNlcklkKSB7XG4gICAgICBjb25zdCBtZW1vcnkgPSBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyLmdldE1lbW9yeShjb250ZXh0LnVzZXJJZCwgY29udGV4dC5zZXNzaW9uSWQpXG4gICAgICBcbiAgICAgIC8vIEFncmVnYXIgY29udGV4dG8gZGUgbWVtb3JpYSBlbW9jaW9uYWxcbiAgICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5yZWNlbnRFbW90aW9ucy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNvbnN0IHByZXZpb3VzRW1vdGlvbiA9IG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLnJlY2VudEVtb3Rpb25zWzFdXG4gICAgICAgIGlmIChwcmV2aW91c0Vtb3Rpb24gIT09IGVtb3Rpb24pIHtcbiAgICAgICAgICBjb25zdCB0cmFuc2l0aW9uUmVzcG9uc2UgPSBSZXNwb25zZUJhbmsuZ2V0VHJhbnNpdGlvblJlc3BvbnNlKHByZXZpb3VzRW1vdGlvbiwgZW1vdGlvbilcbiAgICAgICAgICBlbnJpY2hlZFJlc3BvbnNlID0gYCR7dHJhbnNpdGlvblJlc3BvbnNlfSAke2VucmljaGVkUmVzcG9uc2V9YFxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIEFncmVnYXIgaW5zaWdodHMgZGUgbW90aXZhY2nDs24gc2kgZXMgcmVsZXZhbnRlXG4gICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUubW90aXZhdGlvbkxldmVsIDwgNCAmJiBbRW1vdGlvblR5cGUuRlJVU1RSQVRFRCwgRW1vdGlvblR5cGUuT1ZFUldIRUxNRURdLmluY2x1ZGVzKGVtb3Rpb24pKSB7XG4gICAgICAgIGVucmljaGVkUmVzcG9uc2UgKz0gXCIgUmVjdWVyZGEgcXVlIGhlIHZpc3RvIHR1IHBvdGVuY2lhbCBlbiBzZXNpb25lcyBhbnRlcmlvcmVzIC0gdGllbmVzIHRvZG8gbG8gbmVjZXNhcmlvIHBhcmEgc3VwZXJhciBlc3RvLlwiXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHJlc3BvbnNlOiBlbnJpY2hlZFJlc3BvbnNlLFxuICAgICAgc3VnZ2VzdGVkQWN0aW9uczogcGVyc29uYWxpemVkUmVzcG9uc2Uuc3VnZ2VzdGVkQWN0aW9ucyB8fCBbXSxcbiAgICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBwZXJzb25hbGl6ZWRSZXNwb25zZS5mb2xsb3dVcCB8fCBbXSxcbiAgICAgIHRvbmU6IHBlcnNvbmFsaXplZFJlc3BvbnNlLnRvbmUsXG4gICAgICBlbW9qaTogcGVyc29uYWxpemVkUmVzcG9uc2UuZW1vamkgfHwgXCLwn5iKXCJcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0YSBlbCBuaXZlbCBkZSB1cmdlbmNpYSBlbiB1biBtZW5zYWplXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBkZXRlY3RVcmdlbmN5KG1lc3NhZ2U6IHN0cmluZyk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcge1xuICAgIGNvbnN0IGxvd2VyTWVzc2FnZSA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxuICAgIFxuICAgIC8vIFVyZ2VuY2lhIGFsdGFcbiAgICBpZiAoL3VyZ2VudGV8csOhcGlkb3x5YXxhaG9yYXxpbm1lZGlhdGFtZW50ZXxtYcOxYW5hfGhveXxwcm9udG8vLnRlc3QobG93ZXJNZXNzYWdlKSkge1xuICAgICAgcmV0dXJuICdoaWdoJ1xuICAgIH1cbiAgICBcbiAgICAvLyBVcmdlbmNpYSBtZWRpYVxuICAgIGlmICgvZXN0YVxccytzZW1hbmF8cHLDs3hpbW98ZGVhZGxpbmV8ZmVjaGFcXHMrbMOtbWl0ZXxwbGF6by8udGVzdChsb3dlck1lc3NhZ2UpKSB7XG4gICAgICByZXR1cm4gJ21lZGl1bSdcbiAgICB9XG4gICAgXG4gICAgLy8gVXJnZW5jaWEgYmFqYSBwb3IgZGVmZWN0b1xuICAgIHJldHVybiAnbG93J1xuICB9XG5cbiAgLyoqXG4gICAqIFN1Z2llcmUgdHJhbnNpY2nDs24gZGUgbW9kbyBjb252ZXJzYWNpb25hbCBzaSBlcyBhcHJvcGlhZG9cbiAgICovXG4gIHN0YXRpYyBzdWdnZXN0TW9kZVRyYW5zaXRpb24oXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIGN1cnJlbnRNb2RlOiBDb252ZXJzYXRpb25Nb2RlLFxuICAgIGVtb3Rpb246IEVtb3Rpb25UeXBlLFxuICAgIGNvbnRleHQ/OiB7XG4gICAgICB1c2VySWQ/OiBzdHJpbmdcbiAgICAgIHNlc3Npb25JZD86IHN0cmluZ1xuICAgICAgdGltZUluQ3VycmVudE1vZGU/OiBudW1iZXJcbiAgICAgIHVyZ2VuY3k/OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnXG4gICAgICBzdWJqZWN0Pzogc3RyaW5nXG4gICAgICBwcmV2aW91c01vZGVzPzogQ29udmVyc2F0aW9uTW9kZVtdXG4gICAgfVxuICApOiB7XG4gICAgc2hvdWxkVHJhbnNpdGlvbjogYm9vbGVhblxuICAgIHN1Z2dlc3RlZE1vZGU/OiBDb252ZXJzYXRpb25Nb2RlXG4gICAgdHJhbnNpdGlvbk1lc3NhZ2U/OiBzdHJpbmdcbiAgICBjb25maWRlbmNlPzogbnVtYmVyXG4gICAgcmVhc29uPzogc3RyaW5nXG4gIH0ge1xuICAgIGNvbnN0IHRyYW5zaXRpb25Db250ZXh0OiBUcmFuc2l0aW9uQ29udGV4dCA9IHtcbiAgICAgIGN1cnJlbnRNb2RlLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGVtb3Rpb24sXG4gICAgICB1c2VySWQ6IGNvbnRleHQ/LnVzZXJJZCxcbiAgICAgIHNlc3Npb25JZDogY29udGV4dD8uc2Vzc2lvbklkLFxuICAgICAgdGltZUluQ3VycmVudE1vZGU6IGNvbnRleHQ/LnRpbWVJbkN1cnJlbnRNb2RlLFxuICAgICAgcHJldmlvdXNNb2RlczogY29udGV4dD8ucHJldmlvdXNNb2RlcyxcbiAgICAgIHVyZ2VuY3k6IGNvbnRleHQ/LnVyZ2VuY3ksXG4gICAgICBzdWJqZWN0OiBjb250ZXh0Py5zdWJqZWN0XG4gICAgfVxuXG4gICAgY29uc3Qgc3VnZ2VzdGVkVHJhbnNpdGlvbiA9IE1vZGVUcmFuc2l0aW9uTWFuYWdlci5hbmFseXplVHJhbnNpdGlvbk5lZWQodHJhbnNpdGlvbkNvbnRleHQpXG5cbiAgICBpZiAoIXN1Z2dlc3RlZFRyYW5zaXRpb24pIHtcbiAgICAgIHJldHVybiB7IHNob3VsZFRyYW5zaXRpb246IGZhbHNlIH1cbiAgICB9XG5cbiAgICAvLyBFdmFsdWFyIGNhbGlkYWQgZGUgbGEgdHJhbnNpY2nDs25cbiAgICBjb25zdCBxdWFsaXR5ID0gTW9kZVRyYW5zaXRpb25NYW5hZ2VyLmV2YWx1YXRlVHJhbnNpdGlvblF1YWxpdHkoc3VnZ2VzdGVkVHJhbnNpdGlvbiwgdHJhbnNpdGlvbkNvbnRleHQpXG5cbiAgICAvLyBTb2xvIHN1Z2VyaXIgc2kgbGEgY2FsaWRhZCBlcyBzdWZpY2llbnRlbWVudGUgYWx0YVxuICAgIGlmIChxdWFsaXR5IDwgMC42KSB7XG4gICAgICByZXR1cm4geyBzaG91bGRUcmFuc2l0aW9uOiBmYWxzZSB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNob3VsZFRyYW5zaXRpb246IHRydWUsXG4gICAgICBzdWdnZXN0ZWRNb2RlOiBzdWdnZXN0ZWRUcmFuc2l0aW9uLnRvTW9kZSxcbiAgICAgIHRyYW5zaXRpb25NZXNzYWdlOiB0aGlzLmVuaGFuY2VUcmFuc2l0aW9uTWVzc2FnZShzdWdnZXN0ZWRUcmFuc2l0aW9uLCBjb250ZXh0Py51c2VySWQsIGNvbnRleHQ/LnNlc3Npb25JZCksXG4gICAgICBjb25maWRlbmNlOiBxdWFsaXR5LFxuICAgICAgcmVhc29uOiBzdWdnZXN0ZWRUcmFuc2l0aW9uLnJlYXNvblxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBNZWpvcmEgZWwgbWVuc2FqZSBkZSB0cmFuc2ljacOzbiBjb24gY29udGV4dG8gcGVyc29uYWxcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGVuaGFuY2VUcmFuc2l0aW9uTWVzc2FnZShcbiAgICB0cmFuc2l0aW9uOiB7IHRvTW9kZTogQ29udmVyc2F0aW9uTW9kZSwgdHJhbnNpdGlvbk1lc3NhZ2U6IHN0cmluZyB9LFxuICAgIHVzZXJJZD86IHN0cmluZyxcbiAgICBzZXNzaW9uSWQ/OiBzdHJpbmdcbiAgKTogc3RyaW5nIHtcbiAgICBsZXQgZW5oYW5jZWRNZXNzYWdlID0gdHJhbnNpdGlvbi50cmFuc2l0aW9uTWVzc2FnZVxuXG4gICAgLy8gQWdyZWdhciBjb250ZXh0byBkZSBtZW1vcmlhIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICBpZiAodXNlcklkKSB7XG4gICAgICBjb25zdCBtZW1vcnkgPSBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyLmdldE1lbW9yeSh1c2VySWQsIHNlc3Npb25JZClcbiAgICAgIFxuICAgICAgLy8gUGVyc29uYWxpemFyIGJhc2FkbyBlbiDDqXhpdG9zIHByZXZpb3NcbiAgICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5hY2hpZXZlbWVudEFyZWFzLmxlbmd0aCA+IDAgJiYgdHJhbnNpdGlvbi50b01vZGUgPT09IENvbnZlcnNhdGlvbk1vZGUuVFVUT1JJTkcpIHtcbiAgICAgICAgZW5oYW5jZWRNZXNzYWdlICs9IGAgUmVjdWVyZGEgcXVlIGhhcyB0ZW5pZG8gbXVjaG8gw6l4aXRvIGVuICR7bWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuYWNoaWV2ZW1lbnRBcmVhc1swXX0gYW50ZXMuYFxuICAgICAgfVxuXG4gICAgICAvLyBSZWZlcmVuY2lhIGEgcGF0cm9uZXMgZW1vY2lvbmFsZXNcbiAgICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5tb3RpdmF0aW9uTGV2ZWwgPiA3ICYmIHRyYW5zaXRpb24udG9Nb2RlID09PSBDb252ZXJzYXRpb25Nb2RlLlBMQU5OSU5HKSB7XG4gICAgICAgIGVuaGFuY2VkTWVzc2FnZSArPSBcIiBDb24gdHUgbml2ZWwgZGUgbW90aXZhY2nDs24gYWN0dWFsLCBlcyBlbCBtb21lbnRvIHBlcmZlY3RvIHBhcmEgZXN0by5cIlxuICAgICAgfVxuXG4gICAgICAvLyBNZW5jaW9uYXIgcHJvZ3Jlc28gZW4gZWwgw6FyZWEgc2kgZXMgcmVsZXZhbnRlXG4gICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUucmVjZW50RW1vdGlvbnMuaW5jbHVkZXMoRW1vdGlvblR5cGUuQ09ORlVTRUQpICYmIHRyYW5zaXRpb24udG9Nb2RlID09PSBDb252ZXJzYXRpb25Nb2RlLlRVVE9SSU5HKSB7XG4gICAgICAgIGVuaGFuY2VkTWVzc2FnZSArPSBcIiBWYW1vcyBhIGFjbGFyYXIgZXNhcyBkdWRhcyBkZSB1bmEgdmV6IHBvciB0b2Rhcy5cIlxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBlbmhhbmNlZE1lc3NhZ2VcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmEgcmVzcHVlc3RhIGNvbiB0cmFuc2ljacOzbiBhdXRvbcOhdGljYSBkZSBtb2RvXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGVSZXNwb25zZVdpdGhNb2RlVHJhbnNpdGlvbihcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY3VycmVudE1vZGU6IENvbnZlcnNhdGlvbk1vZGUsXG4gICAgZW1vdGlvbjogRW1vdGlvblR5cGUsXG4gICAgY29udGV4dD86IHtcbiAgICAgIHVzZXJJZD86IHN0cmluZ1xuICAgICAgc2Vzc2lvbklkPzogc3RyaW5nXG4gICAgICB0aW1lSW5DdXJyZW50TW9kZT86IG51bWJlclxuICAgICAgdXJnZW5jeT86ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgICAgIHN1YmplY3Q/OiBzdHJpbmdcbiAgICAgIHByZXZpb3VzTW9kZXM/OiBDb252ZXJzYXRpb25Nb2RlW11cbiAgICB9XG4gICk6IHtcbiAgICByZXNwb25zZTogc3RyaW5nXG4gICAgZmluYWxNb2RlOiBDb252ZXJzYXRpb25Nb2RlXG4gICAgdHJhbnNpdGlvbk9jY3VycmVkOiBib29sZWFuXG4gICAgdHJhbnNpdGlvbk1lc3NhZ2U/OiBzdHJpbmdcbiAgICBzdWdnZXN0ZWRBY3Rpb25zOiBzdHJpbmdbXVxuICAgIGZvbGxvd1VwUXVlc3Rpb25zOiBzdHJpbmdbXVxuICB9IHtcbiAgICAvLyBWZXJpZmljYXIgc2kgbmVjZXNpdGEgdHJhbnNpY2nDs25cbiAgICBjb25zdCB0cmFuc2l0aW9uU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdE1vZGVUcmFuc2l0aW9uKG1lc3NhZ2UsIGN1cnJlbnRNb2RlLCBlbW90aW9uLCBjb250ZXh0KVxuICAgIFxuICAgIGxldCBmaW5hbE1vZGUgPSBjdXJyZW50TW9kZVxuICAgIGxldCBjb21iaW5lZFJlc3BvbnNlID0gXCJcIlxuICAgIGxldCB0cmFuc2l0aW9uT2NjdXJyZWQgPSBmYWxzZVxuICAgIGxldCB0cmFuc2l0aW9uTWVzc2FnZSA9IFwiXCJcblxuICAgIC8vIFNpIHNlIHN1Z2llcmUgdHJhbnNpY2nDs24sIGFwbGljYXJsYVxuICAgIGlmICh0cmFuc2l0aW9uU3VnZ2VzdGlvbi5zaG91bGRUcmFuc2l0aW9uICYmIHRyYW5zaXRpb25TdWdnZXN0aW9uLnN1Z2dlc3RlZE1vZGUpIHtcbiAgICAgIGZpbmFsTW9kZSA9IHRyYW5zaXRpb25TdWdnZXN0aW9uLnN1Z2dlc3RlZE1vZGVcbiAgICAgIHRyYW5zaXRpb25PY2N1cnJlZCA9IHRydWVcbiAgICAgIHRyYW5zaXRpb25NZXNzYWdlID0gdHJhbnNpdGlvblN1Z2dlc3Rpb24udHJhbnNpdGlvbk1lc3NhZ2UgfHwgXCJcIlxuICAgICAgY29tYmluZWRSZXNwb25zZSA9IHRyYW5zaXRpb25NZXNzYWdlICsgXCJcXG5cXG5cIlxuICAgIH1cblxuICAgIC8vIEdlbmVyYXIgcmVzcHVlc3RhIGVuIGVsIG1vZG8gZmluYWxcbiAgICBjb25zdCBwZXJzb25hbGl6ZWRSZXNwb25zZSA9IHRoaXMuZ2VuZXJhdGVQZXJzb25hbGl6ZWRSZXNwb25zZShcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBlbW90aW9uLFxuICAgICAgZmluYWxNb2RlLFxuICAgICAge1xuICAgICAgICBzdWJqZWN0OiBjb250ZXh0Py5zdWJqZWN0LFxuICAgICAgICB1cmdlbmN5OiBjb250ZXh0Py51cmdlbmN5LFxuICAgICAgICB1c2VySWQ6IGNvbnRleHQ/LnVzZXJJZCxcbiAgICAgICAgc2Vzc2lvbklkOiBjb250ZXh0Py5zZXNzaW9uSWRcbiAgICAgIH1cbiAgICApXG5cbiAgICBjb21iaW5lZFJlc3BvbnNlICs9IHBlcnNvbmFsaXplZFJlc3BvbnNlLnJlc3BvbnNlXG5cbiAgICByZXR1cm4ge1xuICAgICAgcmVzcG9uc2U6IGNvbWJpbmVkUmVzcG9uc2UsXG4gICAgICBmaW5hbE1vZGUsXG4gICAgICB0cmFuc2l0aW9uT2NjdXJyZWQsXG4gICAgICB0cmFuc2l0aW9uTWVzc2FnZTogdHJhbnNpdGlvbk9jY3VycmVkID8gdHJhbnNpdGlvbk1lc3NhZ2UgOiB1bmRlZmluZWQsXG4gICAgICBzdWdnZXN0ZWRBY3Rpb25zOiBwZXJzb25hbGl6ZWRSZXNwb25zZS5zdWdnZXN0ZWRBY3Rpb25zLFxuICAgICAgZm9sbG93VXBRdWVzdGlvbnM6IHBlcnNvbmFsaXplZFJlc3BvbnNlLmZvbGxvd1VwUXVlc3Rpb25zXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSB1bmEgcmVzcHVlc3RhIGNvbnRleHR1YWwgdXNhbmRvIFNhcmEgcGFyYSBjb21hbmRvcyBhdmFuemFkb3NcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZShcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29tbWFuZFJlc3VsdDogYW55LFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIGN1cnJlbnRNb2RlOiBDb252ZXJzYXRpb25Nb2RlLFxuICAgIHNlc3Npb25JZD86IHN0cmluZ1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGxldCByZXNwb25zZSA9IFwiXCJcbiAgICBcbiAgICBpZiAoY29tbWFuZFJlc3VsdC5zdWNjZXNzICYmIGNvbW1hbmRSZXN1bHQubWVzc2FnZSkge1xuICAgICAgLy8gUGVyc29uYWxpemFyIGxhIHJlc3B1ZXN0YSBkZWwgY29tYW5kbyBjb24gbGEgcGVyc29uYWxpZGFkIGRlIFNhcmFcbiAgICAgIGNvbnN0IHRvbmUgPSB0aGlzLmFkYXB0VG9uZVRvRW1vdGlvbmFsU3RhdGUobWVzc2FnZSlcbiAgICAgIFxuICAgICAgcmVzcG9uc2UgPSBjb21tYW5kUmVzdWx0Lm1lc3NhZ2VcbiAgICAgIFxuICAgICAgLy8gQWdyZWdhciBjb250ZXh0byBkZSBtZW1vcmlhIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICAgIGNvbnN0IG1lbW9yeSA9IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIuZ2V0TWVtb3J5KHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgICAgY29uc3QgbmVlZHNGb2xsb3dVcCA9IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIubmVlZHNGb2xsb3dVcCh1c2VySWQsIHNlc3Npb25JZClcbiAgICAgIFxuICAgICAgLy8gQWdyZWdhciB0b3F1ZSBwZXJzb25hbCBkZSBTYXJhIHNlZ8O6biBlbCB0b25vIHkgbWVtb3JpYSBlbW9jaW9uYWxcbiAgICAgIGNvbnN0IGVtb3Rpb25hbEluc2lnaHRzID0gbWVtb3J5LmVtb3Rpb25hbEluc2lnaHRzLnNsaWNlKDAsIDEpIC8vIFNvbG8gZWwgbcOhcyByZWNpZW50ZVxuICAgICAgXG4gICAgICBzd2l0Y2ggKHRvbmUpIHtcbiAgICAgICAgY2FzZSAnc3VwcG9ydGl2ZSc6XG4gICAgICAgICAgcmVzcG9uc2UgKz0gXCJcXG5cXG7wn5KdIFJlY3VlcmRhIHF1ZSBlc3RveSBhcXXDrSBwYXJhIGFwb3lhcnRlIGVuIGNhZGEgcGFzby4gwqFWYW1vcyBkZXNwYWNpbyBwZXJvIHNlZ3Vyb3MhXCJcbiAgICAgICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUubW90aXZhdGlvbkxldmVsIDwgNSkge1xuICAgICAgICAgICAgcmVzcG9uc2UgKz0gXCIgSGUgbm90YWRvIHF1ZSBoYXMgdGVuaWRvIGFsZ3Vub3MgZGVzYWbDrW9zIMO6bHRpbWFtZW50ZSwgcGVybyBjb25mw61vIGVuIHR1IGNhcGFjaWRhZC5cIlxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuY3VycmVudE1vb2QgPT09IEVtb3Rpb25UeXBlLkZSVVNUUkFURUQpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlICs9IFwiIExhIGZydXN0cmFjacOzbiBlcyB0ZW1wb3JhbCAtIGNhZGEgZGlmaWN1bHRhZCBlcyB1bmEgb3BvcnR1bmlkYWQgZGUgY3JlY2ltaWVudG8uXCJcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAnbW90aXZhdGlvbmFsJzpcbiAgICAgICAgICByZXNwb25zZSArPSBcIlxcblxcbvCfjJ8gwqFUw7ogcHVlZGVzIGxvZ3JhciBlc3RvISBDYWRhIHBlcXVlw7FvIHBhc28gY3VlbnRhIGhhY2lhIHR1cyBncmFuZGVzIG9iamV0aXZvcy5cIlxuICAgICAgICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5hY2hpZXZlbWVudEFyZWFzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlc3BvbnNlICs9IGAgUmVjdWVyZGEgbG8gYmllbiBxdWUgbG8gaGFzIGhlY2hvIGVuICR7bWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuYWNoaWV2ZW1lbnRBcmVhc1swXX0uYFxuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuY3VycmVudE1vb2QgPT09IEVtb3Rpb25UeXBlLk1PVElWQVRFRCkge1xuICAgICAgICAgICAgcmVzcG9uc2UgKz0gXCIgTWUgZW5jYW50YSB2ZXIgdHUgZW5lcmfDrWEgcG9zaXRpdmEgLSDCoWFwcm92ZWNow6ltb3NsYSBhbCBtw6F4aW1vIVwiXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgJ2VtcGF0aGV0aWMnOlxuICAgICAgICAgIHJlc3BvbnNlICs9IFwiXFxuXFxu8J+klyBFbnRpZW5kbyBjw7NtbyB0ZSBzaWVudGVzIHkgZXMgY29tcGxldGFtZW50ZSB2w6FsaWRvLlwiXG4gICAgICAgICAgaWYgKG1lbW9yeS5lbW90aW9uYWxQcm9maWxlLmN1cnJlbnRNb29kID09PSBFbW90aW9uVHlwZS5PVkVSV0hFTE1FRCkge1xuICAgICAgICAgICAgcmVzcG9uc2UgKz0gXCIgQ3VhbmRvIG5vcyBzZW50aW1vcyBhYnJ1bWFkb3MsIGxvIG1lam9yIGVzIGRpdmlkaXIgdG9kbyBlbiBwYXNvcyBwZXF1ZcOxb3MgeSBtYW5lamFibGVzLlwiXG4gICAgICAgICAgfSBlbHNlIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5jdXJyZW50TW9vZCA9PT0gRW1vdGlvblR5cGUuQU5YSU9VUykge1xuICAgICAgICAgICAgcmVzcG9uc2UgKz0gXCIgTGEgYW5zaWVkYWQgZXMgc2XDsWFsIGRlIHF1ZSBhbGdvIHRlIGltcG9ydGEuIFZhbW9zIGEgdHJhYmFqYXIganVudG9zIHBhcmEgcXVlIHRlIHNpZW50YXMgbcOhcyB0cmFucXVpbG8uXCJcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgY2FzZSAncHJvZmVzc2lvbmFsJzpcbiAgICAgICAgICByZXNwb25zZSArPSBcIlxcblxcbvCfk4sgwr9UZSBwYXJlY2Ugw7p0aWwgZXN0YSBpbmZvcm1hY2nDs24/IFNpZW1wcmUgcHVlZGVzIHBlZGlybWUgbcOhcyBkZXRhbGxlcyBvIGFqdXN0ZXMuXCJcbiAgICAgICAgICBpZiAobWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUuY3VycmVudE1vb2QgPT09IEVtb3Rpb25UeXBlLkNPTkZVU0VEKSB7XG4gICAgICAgICAgICByZXNwb25zZSArPSBcIiBTaSBhbGdvIG5vIHF1ZWRhIGNsYXJvLCBleHBsw61jYW1lbG8gY29uIHR1cyBwcm9waWFzIHBhbGFicmFzIHBhcmEgYXNlZ3VyYXJtZSBkZSBxdWUgbG8gZW50ZW5kaXN0ZS5cIlxuICAgICAgICAgIH1cbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlICdlbmNvdXJhZ2luZyc6XG4gICAgICAgICAgcmVzcG9uc2UgKz0gXCJcXG5cXG7inKggwqFFeGNlbGVudGUgdHJhYmFqbyEgTWUgYWxlZ3JhIHZlciB0dSBwcm9ncmVzby5cIlxuICAgICAgICAgIGlmIChtZW1vcnkuZW1vdGlvbmFsUHJvZmlsZS5jdXJyZW50TW9vZCA9PT0gRW1vdGlvblR5cGUuUFJPVUQpIHtcbiAgICAgICAgICAgIHJlc3BvbnNlICs9IFwiIEVzIGdlbmlhbCBxdWUgcmVjb25vemNhcyB0dXMgbG9ncm9zIC0gwqFtZXJlY2VzIGNlbGVicmFyIGNhZGEgYXZhbmNlIVwiXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgcmVzcG9uc2UgKz0gXCJcXG5cXG7wn5iKIMK/SGF5IGFsZ28gbcOhcyBlbiBsbyBxdWUgcHVlZGEgYXl1ZGFydGUgaG95P1wiXG4gICAgICAgICAgaWYgKG5lZWRzRm9sbG93VXApIHtcbiAgICAgICAgICAgIHJlc3BvbnNlICs9IFwiIFRhbWJpw6luIHBvZHLDrWFtb3MgcmV2aXNhciBhbGd1bm9zIHRlbWFzIHBlbmRpZW50ZXMgcXVlIG1lbmNpb25hc3RlIGFudGVzLlwiXG4gICAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBBZ3JlZ2FyIGluc2lnaHRzIGVtb2Npb25hbGVzIHJlY2llbnRlcyBzaSBzb24gcmVsZXZhbnRlc1xuICAgICAgaWYgKGVtb3Rpb25hbEluc2lnaHRzLmxlbmd0aCA+IDAgJiYgbWVtb3J5LmVtb3Rpb25hbFByb2ZpbGUubW90aXZhdGlvbkxldmVsIDwgNCkge1xuICAgICAgICByZXNwb25zZSArPSBgXFxuXFxu8J+SoSAqTm90YSBwZXJzb25hbCo6ICR7ZW1vdGlvbmFsSW5zaWdodHNbMF19YFxuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBHdWFyZGFyIGxhIGNvbnZlcnNhY2nDs24gZW4gbWVtb3JpYVxuICAgICAgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5zYXZlQ29udmVyc2F0aW9uVHVybihcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICByZXNwb25zZSxcbiAgICAgICAgY3VycmVudE1vZGUudG9TdHJpbmcoKSxcbiAgICAgICAgY29tbWFuZFJlc3VsdC50eXBlLFxuICAgICAgICBzZXNzaW9uSWRcbiAgICAgIClcbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3BvbnNlXG4gICAgfVxuICAgIFxuICAgIC8vIFBhcmEgcmVzcHVlc3RhcyBkZSBlcnJvciB0YW1iacOpbiBndWFyZGFyIGVuIG1lbW9yaWFcbiAgICByZXNwb25zZSA9IGNvbW1hbmRSZXN1bHQubWVzc2FnZSB8fCBcIkxvIHNpZW50bywgbm8gcHVkZSBwcm9jZXNhciB0dSBzb2xpY2l0dWQuIMK/UG9kcsOtYXMgcmVmb3JtdWxhcmxhP1wiXG4gICAgXG4gICAgQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5zYXZlQ29udmVyc2F0aW9uVHVybihcbiAgICAgIHVzZXJJZCxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICByZXNwb25zZSxcbiAgICAgIGN1cnJlbnRNb2RlLnRvU3RyaW5nKCksXG4gICAgICAnZXJyb3InLFxuICAgICAgc2Vzc2lvbklkXG4gICAgKVxuICAgIFxuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSB1biBzYWx1ZG8gcGVyc29uYWxpemFkbyBiYXNhZG8gZW4gbGEgbWVtb3JpYSBjb252ZXJzYWNpb25hbFxuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlUGVyc29uYWxpemVkR3JlZXRpbmcodXNlcklkOiBzdHJpbmcsIHVzZXJOYW1lPzogc3RyaW5nLCBzZXNzaW9uSWQ/OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1lbW9yeSA9IENvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIuZ2V0TWVtb3J5KHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgIGNvbnN0IGNvbnRleHR1YWxTdW1tYXJ5ID0gQ29udmVyc2F0aW9uTWVtb3J5TWFuYWdlci5nZW5lcmF0ZUNvbnRleHR1YWxTdW1tYXJ5KHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgIFxuICAgIGxldCBncmVldGluZyA9IFwiXCJcbiAgICBcbiAgICAvLyBTYWx1ZG8gaW5pY2lhbCB2cy4gZGUgcmVncmVzb1xuICAgIGlmIChtZW1vcnkudG90YWxUdXJucyA9PT0gMCkge1xuICAgICAgZ3JlZXRpbmcgPSB0aGlzLnNlbGVjdFJlc3BvbnNlKCdncmVldGluZycpXG4gICAgICBpZiAodXNlck5hbWUpIHtcbiAgICAgICAgZ3JlZXRpbmcgPSBncmVldGluZy5yZXBsYWNlKC/CoUhvbGEhLywgYMKhSG9sYSwgJHt1c2VyTmFtZX0hYClcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2FsdWRvIHBlcnNvbmFsaXphZG8gYmFzYWRvIGVuIG1lbW9yaWFcbiAgICAgIGNvbnN0IGRheXNTaW5jZUxhc3RDaGF0ID0gTWF0aC5mbG9vcihcbiAgICAgICAgKERhdGUubm93KCkgLSBtZW1vcnkubGFzdEFjdGl2aXR5LmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNClcbiAgICAgIClcbiAgICAgIFxuICAgICAgaWYgKGRheXNTaW5jZUxhc3RDaGF0ID4gNykge1xuICAgICAgICBncmVldGluZyA9IGDCoVF1w6kgYnVlbm8gdmVydGUgZGUgdnVlbHRhJHt1c2VyTmFtZSA/ICcsICcgKyB1c2VyTmFtZSA6ICcnfSEgJHtjb250ZXh0dWFsU3VtbWFyeX1gXG4gICAgICB9IGVsc2UgaWYgKGRheXNTaW5jZUxhc3RDaGF0ID4gMSkge1xuICAgICAgICBncmVldGluZyA9IGDCoUhvbGEgZGUgbnVldm8ke3VzZXJOYW1lID8gJywgJyArIHVzZXJOYW1lIDogJyd9ISAke2NvbnRleHR1YWxTdW1tYXJ5fWBcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGdyZWV0aW5nID0gYMKhSG9sYSR7dXNlck5hbWUgPyAnLCAnICsgdXNlck5hbWUgOiAnJ30hICR7Y29udGV4dHVhbFN1bW1hcnl9YFxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBBZ3JlZ2FyIHN1Z2VyZW5jaWFzIHBlcnNvbmFsaXphZGFzXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBDb252ZXJzYXRpb25NZW1vcnlNYW5hZ2VyLmdldFBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zKHVzZXJJZCwgc2Vzc2lvbklkKVxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICBncmVldGluZyArPSBgXFxuXFxu8J+SoSAqKlN1Z2VyZW5jaWFzIGJhc2FkYXMgZW4gbnVlc3RyYXMgY29udmVyc2FjaW9uZXM6KipcXG4ke3N1Z2dlc3Rpb25zLnNsaWNlKDAsIDMpLm1hcChzID0+IGDigKIgJHtzfWApLmpvaW4oJ1xcbicpfWBcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGdyZWV0aW5nXG4gIH1cbn0iXSwibmFtZXMiOlsiQ29udmVyc2F0aW9uTW9kZSIsIkNvbnZlcnNhdGlvbk1lbW9yeU1hbmFnZXIiLCJFbW90aW9uQW5hbHl6ZXIiLCJFbW90aW9uVHlwZSIsIlJlc3BvbnNlQmFuayIsIk1vZGVUcmFuc2l0aW9uTWFuYWdlciIsIlNBUkFfUEVSU09OQUxJVFkiLCJuYW1lIiwicm9sZSIsImNoYXJhY3RlcmlzdGljcyIsInBlcnNvbmFsaXR5IiwiY29tbXVuaWNhdGlvblN0eWxlIiwiZXhwZXJ0aXNlIiwiYXBwcm9hY2giLCJyZXNwb25zZXMiLCJncmVldGluZyIsImVuY291cmFnZW1lbnQiLCJwcm9ibGVtU29sdmluZyIsIm9yZ2FuaXphdGlvbiIsIm1vdGl2YXRpb24iLCJmYXJld2VsbCIsImFkYXB0aXZlUmVzcG9uc2VzIiwiUExBTk5JTkciLCJzeXN0ZW1Qcm9tcHQiLCJ0b25lIiwiZm9jdXMiLCJUVVRPUklORyIsIk9SR0FOSVpJTkciLCJSRVZJRVdJTkciLCJDSEFUVElORyIsIlNhcmFQZXJzb25hbGl0eUVuZ2luZSIsImdlbmVyYXRlU3lzdGVtUHJvbXB0IiwibW9kZSIsImNvbnRleHQiLCJpbnRlbnQiLCJ1c2VySWQiLCJzZXNzaW9uSWQiLCJiYXNlUGVyc29uYWxpdHkiLCJzdHVkZW50SW5mbyIsImJ1aWxkU3R1ZGVudENvbnRleHRTdW1tYXJ5IiwibWVtb3J5Q29udGV4dCIsImNvbnRleHR1YWxTdW1tYXJ5IiwiZ2VuZXJhdGVDb250ZXh0dWFsU3VtbWFyeSIsInBlcnNvbmFsaXplZFN1Z2dlc3Rpb25zIiwiZ2V0UGVyc29uYWxpemVkU3VnZ2VzdGlvbnMiLCJuZWVkc0ZvbGxvd1VwIiwibGVuZ3RoIiwibWFwIiwicyIsImpvaW4iLCJ0b0xvd2VyQ2FzZSIsInNlbGVjdFJlc3BvbnNlIiwiY2F0ZWdvcnkiLCJzZWxlY3RDb250ZXh0dWFsUmVzcG9uc2UiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJkYXlzU2luY2VMYXN0SW50ZXJhY3Rpb24iLCJEYXRlIiwibm93IiwibGFzdEludGVyYWN0aW9uIiwiZ2V0VGltZSIsInN0dWR5UGF0dGVybnMiLCJ3ZWVrbHlTdGF0cyIsInRvdGFsU3R1ZHlIb3VycyIsInN1bW1hcnkiLCJwdXNoIiwiYWNhZGVtaWNJbmZvIiwiZ3JhZGUiLCJzY2hvb2wiLCJsZWFybmluZ1N0eWxlIiwicHJpbWFyeSIsInByZWZlcmVuY2VzIiwic3R1ZHlUaW1lUHJlZmVyZW5jZSIsInN1YmplY3RQZXJmb3JtYW5jZXMiLCJ0b3BTdWJqZWN0cyIsImZpbHRlciIsImF2ZXJhZ2VHcmFkZSIsInN1YmplY3QiLCJzbGljZSIsInN0cnVnZ2xpbmdTdWJqZWN0cyIsImN1cnJlbnRHb2FscyIsImFjdGl2ZUdvYWxzIiwiZyIsInByb2dyZXNzIiwidGl0bGUiLCJ3ZWVrbHlIb3VycyIsInRvRml4ZWQiLCJnZW5lcmF0ZVByb2FjdGl2ZVN1Z2dlc3Rpb25zIiwic3VnZ2VzdGlvbnMiLCJ1cGNvbWluZ0RlYWRsaW5lcyIsImZsYXRNYXAiLCJkIiwiZGF5c1VudGlsIiwiY2VpbCIsImRhdGUiLCJwcmVwYXJhdGlvblN0YXR1cyIsInN0YWduYW50R29hbHMiLCJkYXlzU2luY2VVcGRhdGUiLCJ1cGRhdGVkQXQiLCJhZGFwdFRvbmVUb0Vtb3Rpb25hbFN0YXRlIiwibWVzc2FnZSIsImVtb3Rpb25BbmFseXNpcyIsImFuYWx5emVFbW90aW9ucyIsInN1Z2dlc3RlZFJlc3BvbnNlIiwiZ2VuZXJhdGVQZXJzb25hbGl6ZWRSZXNwb25zZSIsImVtb3Rpb24iLCJjdXJyZW50SG91ciIsImdldEhvdXJzIiwidGltZU9mRGF5IiwidXJnZW5jeSIsImRldGVjdFVyZ2VuY3kiLCJyZXNwb25zZUNvbnRleHQiLCJzZXNzaW9uTGVuZ3RoIiwicGVyc29uYWxpemVkUmVzcG9uc2UiLCJzZWxlY3RQZXJzb25hbGl6ZWRSZXNwb25zZSIsImVucmljaGVkUmVzcG9uc2UiLCJjb250ZW50IiwibWVtb3J5IiwiZ2V0TWVtb3J5IiwiZW1vdGlvbmFsUHJvZmlsZSIsInJlY2VudEVtb3Rpb25zIiwicHJldmlvdXNFbW90aW9uIiwidHJhbnNpdGlvblJlc3BvbnNlIiwiZ2V0VHJhbnNpdGlvblJlc3BvbnNlIiwibW90aXZhdGlvbkxldmVsIiwiRlJVU1RSQVRFRCIsIk9WRVJXSEVMTUVEIiwiaW5jbHVkZXMiLCJyZXNwb25zZSIsInN1Z2dlc3RlZEFjdGlvbnMiLCJmb2xsb3dVcFF1ZXN0aW9ucyIsImZvbGxvd1VwIiwiZW1vamkiLCJsb3dlck1lc3NhZ2UiLCJ0ZXN0Iiwic3VnZ2VzdE1vZGVUcmFuc2l0aW9uIiwiY3VycmVudE1vZGUiLCJ0cmFuc2l0aW9uQ29udGV4dCIsInRpbWVJbkN1cnJlbnRNb2RlIiwicHJldmlvdXNNb2RlcyIsInN1Z2dlc3RlZFRyYW5zaXRpb24iLCJhbmFseXplVHJhbnNpdGlvbk5lZWQiLCJzaG91bGRUcmFuc2l0aW9uIiwicXVhbGl0eSIsImV2YWx1YXRlVHJhbnNpdGlvblF1YWxpdHkiLCJzdWdnZXN0ZWRNb2RlIiwidG9Nb2RlIiwidHJhbnNpdGlvbk1lc3NhZ2UiLCJlbmhhbmNlVHJhbnNpdGlvbk1lc3NhZ2UiLCJjb25maWRlbmNlIiwicmVhc29uIiwidHJhbnNpdGlvbiIsImVuaGFuY2VkTWVzc2FnZSIsImFjaGlldmVtZW50QXJlYXMiLCJDT05GVVNFRCIsImdlbmVyYXRlUmVzcG9uc2VXaXRoTW9kZVRyYW5zaXRpb24iLCJ0cmFuc2l0aW9uU3VnZ2VzdGlvbiIsImZpbmFsTW9kZSIsImNvbWJpbmVkUmVzcG9uc2UiLCJ0cmFuc2l0aW9uT2NjdXJyZWQiLCJ1bmRlZmluZWQiLCJnZW5lcmF0ZUNvbnRleHR1YWxSZXNwb25zZSIsImNvbW1hbmRSZXN1bHQiLCJzdWNjZXNzIiwiZW1vdGlvbmFsSW5zaWdodHMiLCJjdXJyZW50TW9vZCIsIk1PVElWQVRFRCIsIkFOWElPVVMiLCJQUk9VRCIsInNhdmVDb252ZXJzYXRpb25UdXJuIiwidG9TdHJpbmciLCJ0eXBlIiwiZ2VuZXJhdGVQZXJzb25hbGl6ZWRHcmVldGluZyIsInVzZXJOYW1lIiwidG90YWxUdXJucyIsInJlcGxhY2UiLCJkYXlzU2luY2VMYXN0Q2hhdCIsImxhc3RBY3Rpdml0eSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/sara-personality.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/school-schedule-manager.ts":
/*!********************************************!*\
  !*** ./src/lib/school-schedule-manager.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SchoolScheduleManager: () => (/* binding */ SchoolScheduleManager)\n/* harmony export */ });\n/* harmony import */ var _student_context__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./student-context */ \"(rsc)/./src/lib/student-context.ts\");\n// Sistema de Gestión de Horario Escolar\n// Permite importar, gestionar y optimizar horarios académicos\n\nclass SchoolScheduleManager {\n    /**\n   * Importa un horario escolar desde diferentes fuentes\n   */ static async importSchedule(userId, scheduleData, source = 'manual') {\n        // Validar datos de entrada\n        const validatedSchedule = this.validateScheduleData(scheduleData);\n        // Detectar conflictos\n        const conflicts = this.detectScheduleConflicts(validatedSchedule.classes);\n        if (conflicts.some((c)=>c.severity === 'critical')) {\n            throw new Error(`Conflictos críticos detectados: ${conflicts.map((c)=>c.description).join(', ')}`);\n        }\n        // Crear objeto de horario importado\n        const importedSchedule = {\n            source,\n            importDate: new Date(),\n            classes: validatedSchedule.classes,\n            term: validatedSchedule.term || this.createDefaultTerm(),\n            metadata: {\n                schoolName: validatedSchedule.metadata?.schoolName || 'Unknown School',\n                academicYear: validatedSchedule.metadata?.academicYear || new Date().getFullYear().toString(),\n                semester: validatedSchedule.metadata?.semester || 'Current Semester',\n                totalCredits: this.calculateTotalCredits(validatedSchedule.classes)\n            }\n        };\n        // Actualizar contexto del estudiante\n        await this.updateStudentSchedule(userId, importedSchedule);\n        // Generar análisis y recomendaciones\n        await this.generateScheduleInsights(userId, importedSchedule);\n        return importedSchedule;\n    }\n    /**\n   * Parsea texto de horario en lenguaje natural\n   */ static parseNaturalLanguageSchedule(text) {\n        const classes = [];\n        const lines = text.split('\\n').filter((line)=>line.trim().length > 0);\n        for (const line of lines){\n            const parsed = this.parseScheduleLine(line);\n            if (parsed) {\n                classes.push(parsed);\n            }\n        }\n        return classes;\n    }\n    /**\n   * Parsea una línea individual de horario\n   */ static parseScheduleLine(line) {\n        // Patrones para diferentes formatos de horario\n        const patterns = [\n            // \"Lunes 08:00-09:30 Matemáticas Aula 101 Prof. García\"\n            /^(lunes|martes|miércoles|jueves|viernes|sábado|domingo)\\s+(\\d{1,2}:\\d{2})-(\\d{1,2}:\\d{2})\\s+([^,]+?)(?:\\s+(?:aula|salón|lab)\\s*(\\w+))?\\s*(?:prof\\.?\\s*(.+))?$/i,\n            // \"Matemáticas - Lunes 8:00 AM a 9:30 AM\"\n            /^([^-]+?)\\s*-\\s*(lunes|martes|miércoles|jueves|viernes|sábado|domingo)\\s+(\\d{1,2}:\\d{2})\\s*(?:am|pm)?\\s*a\\s*(\\d{1,2}:\\d{2})\\s*(?:am|pm)?/i,\n            // \"08:00 Matemáticas (Lunes)\"\n            /^(\\d{1,2}:\\d{2})\\s+([^(]+?)\\s*\\(\\s*(lunes|martes|miércoles|jueves|viernes|sábado|domingo)\\s*\\)/i\n        ];\n        for (const pattern of patterns){\n            const match = line.match(pattern);\n            if (match) {\n                return this.createClassFromMatch(match, pattern);\n            }\n        }\n        return null;\n    }\n    /**\n   * Crea un objeto SchoolClass desde una coincidencia de regex\n   */ static createClassFromMatch(match, pattern) {\n        const id = `class_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`;\n        // Mapear nombres de días en español a inglés\n        const dayMap = {\n            'lunes': 'monday',\n            'martes': 'tuesday',\n            'miércoles': 'wednesday',\n            'jueves': 'thursday',\n            'viernes': 'friday',\n            'sábado': 'saturday',\n            'domingo': 'sunday'\n        };\n        // Determinar el formato basado en el patrón\n        let day;\n        let startTime;\n        let endTime;\n        let subject;\n        let teacher;\n        let classroom;\n        if (pattern.source.includes('lunes|martes')) {\n            // Formato: \"Día Hora-Hora Materia [Aula] [Prof]\"\n            day = dayMap[match[1].toLowerCase()];\n            startTime = this.normalizeTime(match[2]);\n            endTime = this.normalizeTime(match[3]);\n            subject = match[4].trim();\n            classroom = match[5];\n            teacher = match[6];\n        } else {\n            // Otros formatos - ajustar según necesidad\n            day = 'monday' // Default\n            ;\n            startTime = '08:00';\n            endTime = '09:00';\n            subject = 'Unknown Subject';\n        }\n        const duration = this.calculateDuration(startTime, endTime);\n        return {\n            id,\n            subject: this.normalizeSubjectName(subject),\n            teacher: teacher?.trim(),\n            classroom: classroom?.trim(),\n            day,\n            startTime,\n            endTime,\n            duration,\n            type: this.inferClassType(subject),\n            recurring: true,\n            notes: `Imported from natural language: \"${match[0]}\"`\n        };\n    }\n    /**\n   * Normaliza el nombre de una materia\n   */ static normalizeSubjectName(subject) {\n        const normalized = subject.trim().replace(/\\s+/g, ' ').replace(/^(el|la|los|las)\\s+/i, '');\n        // Capitalizar primera letra de cada palabra\n        return normalized.split(' ').map((word)=>word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()).join(' ');\n    }\n    /**\n   * Infiere el tipo de clase basado en el nombre de la materia\n   */ static inferClassType(subject) {\n        const subjectLower = subject.toLowerCase();\n        if (subjectLower.includes('lab') || subjectLower.includes('laboratorio')) {\n            return 'lab';\n        }\n        if (subjectLower.includes('taller') || subjectLower.includes('workshop')) {\n            return 'workshop';\n        }\n        if (subjectLower.includes('seminario') || subjectLower.includes('seminar')) {\n            return 'seminar';\n        }\n        if (subjectLower.includes('tutorial') || subjectLower.includes('tutoría')) {\n            return 'tutorial';\n        }\n        return 'lecture';\n    }\n    /**\n   * Normaliza formato de hora\n   */ static normalizeTime(time) {\n        // Convertir formatos como \"8:00\", \"08:00\", \"8\", etc. a \"08:00\"\n        const timeMatch = time.match(/(\\d{1,2})(?::(\\d{2}))?/);\n        if (timeMatch) {\n            const hours = timeMatch[1].padStart(2, '0');\n            const minutes = timeMatch[2] || '00';\n            return `${hours}:${minutes}`;\n        }\n        return time;\n    }\n    /**\n   * Calcula la duración entre dos horas\n   */ static calculateDuration(startTime, endTime) {\n        const start = this.timeToMinutes(startTime);\n        const end = this.timeToMinutes(endTime);\n        return end - start;\n    }\n    /**\n   * Convierte formato HH:MM a minutos desde medianoche\n   */ static timeToMinutes(time) {\n        const [hours, minutes] = time.split(':').map(Number);\n        return hours * 60 + minutes;\n    }\n    /**\n   * Detecta conflictos en el horario\n   */ static detectScheduleConflicts(classes) {\n        const conflicts = [];\n        // Agrupar clases por día\n        const classesByDay = classes.reduce((acc, cls)=>{\n            if (!acc[cls.day]) acc[cls.day] = [];\n            acc[cls.day].push(cls);\n            return acc;\n        }, {});\n        // Detectar solapamientos de tiempo\n        for (const [day, dayClasses] of Object.entries(classesByDay)){\n            const sortedClasses = dayClasses.sort((a, b)=>this.timeToMinutes(a.startTime) - this.timeToMinutes(b.startTime));\n            for(let i = 0; i < sortedClasses.length - 1; i++){\n                const current = sortedClasses[i];\n                const next = sortedClasses[i + 1];\n                const currentEnd = this.timeToMinutes(current.endTime);\n                const nextStart = this.timeToMinutes(next.startTime);\n                if (currentEnd > nextStart) {\n                    conflicts.push({\n                        type: 'time_overlap',\n                        severity: 'error',\n                        description: `Solapamiento de clases el ${day}: ${current.subject} (${current.startTime}-${current.endTime}) con ${next.subject} (${next.startTime}-${next.endTime})`,\n                        affectedClasses: [\n                            current.id,\n                            next.id\n                        ],\n                        suggestions: [\n                            'Ajustar horarios para evitar solapamiento',\n                            'Verificar que las horas estén correctas',\n                            'Considerar modalidad virtual para una de las clases'\n                        ]\n                    });\n                }\n            }\n        }\n        // Detectar sobrecarga diaria\n        for (const [day, dayClasses] of Object.entries(classesByDay)){\n            const totalHours = dayClasses.reduce((sum, cls)=>sum + cls.duration, 0) / 60;\n            if (totalHours > 8) {\n                conflicts.push({\n                    type: 'student_overload',\n                    severity: 'warning',\n                    description: `Día muy cargado el ${day}: ${totalHours.toFixed(1)} horas de clase`,\n                    affectedClasses: dayClasses.map((c)=>c.id),\n                    suggestions: [\n                        'Considerar distribuir algunas clases en otros días',\n                        'Planificar descansos adecuados',\n                        'Preparar material de estudio con anticipación'\n                    ]\n                });\n            }\n        }\n        return conflicts;\n    }\n    /**\n   * Analiza el horario y encuentra slots de tiempo libre para estudio\n   */ static analyzeStudyTimeSlots(classes) {\n        const studySlots = [];\n        const daysOfWeek = [\n            'monday',\n            'tuesday',\n            'wednesday',\n            'thursday',\n            'friday'\n        ];\n        for (const day of daysOfWeek){\n            const dayClasses = classes.filter((c)=>c.day === day).sort((a, b)=>this.timeToMinutes(a.startTime) - this.timeToMinutes(b.startTime));\n            // Encontrar gaps entre clases\n            const gaps = this.findTimeGaps(dayClasses, day);\n            studySlots.push(...gaps);\n        }\n        return studySlots;\n    }\n    /**\n   * Encuentra gaps de tiempo entre clases\n   */ static findTimeGaps(dayClasses, day) {\n        const gaps = [];\n        const dayStart = 7 * 60 // 7:00 AM en minutos\n        ;\n        const dayEnd = 22 * 60 // 10:00 PM en minutos\n        ;\n        if (dayClasses.length === 0) {\n            // Día completo libre\n            gaps.push({\n                day,\n                startTime: '08:00',\n                endTime: '20:00',\n                duration: 12 * 60,\n                type: 'free',\n                recommendedFor: [\n                    'any'\n                ],\n                energy_level: 'high'\n            });\n            return gaps;\n        }\n        // Gap antes de la primera clase\n        const firstClassStart = this.timeToMinutes(dayClasses[0].startTime);\n        if (firstClassStart > dayStart + 60) {\n            gaps.push({\n                day,\n                startTime: this.minutesToTime(dayStart),\n                endTime: dayClasses[0].startTime,\n                duration: firstClassStart - dayStart,\n                type: 'free',\n                recommendedFor: [\n                    'review',\n                    'preparation'\n                ],\n                energy_level: 'high'\n            });\n        }\n        // Gaps entre clases\n        for(let i = 0; i < dayClasses.length - 1; i++){\n            const currentEnd = this.timeToMinutes(dayClasses[i].endTime);\n            const nextStart = this.timeToMinutes(dayClasses[i + 1].startTime);\n            const gapDuration = nextStart - currentEnd;\n            if (gapDuration >= 30) {\n                const gapType = this.classifyTimeGap(gapDuration);\n                gaps.push({\n                    day,\n                    startTime: dayClasses[i].endTime,\n                    endTime: dayClasses[i + 1].startTime,\n                    duration: gapDuration,\n                    type: gapType,\n                    recommendedFor: this.getRecommendedSubjects(gapDuration, currentEnd),\n                    energy_level: this.getEnergyLevel(currentEnd)\n                });\n            }\n        }\n        // Gap después de la última clase\n        const lastClassEnd = this.timeToMinutes(dayClasses[dayClasses.length - 1].endTime);\n        if (lastClassEnd < dayEnd - 60) {\n            gaps.push({\n                day,\n                startTime: dayClasses[dayClasses.length - 1].endTime,\n                endTime: this.minutesToTime(dayEnd),\n                duration: dayEnd - lastClassEnd,\n                type: 'free',\n                recommendedFor: [\n                    'homework',\n                    'projects',\n                    'review'\n                ],\n                energy_level: this.getEnergyLevel(lastClassEnd)\n            });\n        }\n        return gaps;\n    }\n    /**\n   * Clasifica un gap de tiempo según su duración\n   */ static classifyTimeGap(duration) {\n        if (duration <= 30) return 'short_break';\n        if (duration <= 90) return 'study_period';\n        if (duration >= 60 && duration <= 120) return 'lunch_break';\n        return 'free';\n    }\n    /**\n   * Recomienda materias según la duración y momento del día\n   */ static getRecommendedSubjects(duration, timeInMinutes) {\n        const hour = Math.floor(timeInMinutes / 60);\n        if (duration <= 30) {\n            return [\n                'review',\n                'flashcards',\n                'quick_reading'\n            ];\n        }\n        if (duration <= 60) {\n            return [\n                'homework',\n                'practice_problems',\n                'note_review'\n            ];\n        }\n        if (hour < 12) {\n            return [\n                'difficult_subjects',\n                'mathematics',\n                'science',\n                'new_concepts'\n            ];\n        } else if (hour < 15) {\n            return [\n                'reading',\n                'writing',\n                'research',\n                'projects'\n            ];\n        } else {\n            return [\n                'review',\n                'practice',\n                'creative_work',\n                'group_study'\n            ];\n        }\n    }\n    /**\n   * Determina el nivel de energía según la hora del día\n   */ static getEnergyLevel(timeInMinutes) {\n        const hour = Math.floor(timeInMinutes / 60);\n        if (hour >= 8 && hour <= 11) return 'high';\n        if (hour >= 14 && hour <= 16) return 'high';\n        if (hour >= 12 && hour <= 13) return 'low';\n        if (hour >= 17 && hour <= 19) return 'medium';\n        return 'low';\n    }\n    /**\n   * Convierte minutos desde medianoche a formato HH:MM\n   */ static minutesToTime(minutes) {\n        const hours = Math.floor(minutes / 60).toString().padStart(2, '0');\n        const mins = (minutes % 60).toString().padStart(2, '0');\n        return `${hours}:${mins}`;\n    }\n    /**\n   * Valida los datos del horario importado\n   */ static validateScheduleData(data) {\n        if (!data.classes || !Array.isArray(data.classes)) {\n            throw new Error('Classes array is required');\n        }\n        // Validar cada clase\n        const validatedClasses = data.classes.map((cls)=>this.validateClass(cls));\n        return {\n            classes: validatedClasses,\n            term: data.term,\n            metadata: data.metadata\n        };\n    }\n    /**\n   * Valida una clase individual\n   */ static validateClass(cls) {\n        if (!cls.subject || !cls.day || !cls.startTime || !cls.endTime) {\n            throw new Error('Class must have subject, day, startTime, and endTime');\n        }\n        return {\n            id: cls.id || `class_${Date.now()}_${Math.random().toString(36).substr(2, 6)}`,\n            subject: cls.subject,\n            teacher: cls.teacher,\n            classroom: cls.classroom,\n            day: cls.day,\n            startTime: cls.startTime,\n            endTime: cls.endTime,\n            duration: cls.duration || this.calculateDuration(cls.startTime, cls.endTime),\n            type: cls.type || 'lecture',\n            recurring: cls.recurring !== false,\n            notes: cls.notes\n        };\n    }\n    /**\n   * Crea un término académico por defecto\n   */ static createDefaultTerm() {\n        const now = new Date();\n        const currentYear = now.getFullYear();\n        const currentMonth = now.getMonth();\n        // Determinar si estamos en primer o segundo semestre\n        const isFirstSemester = currentMonth >= 1 && currentMonth <= 6;\n        const semesterStart = isFirstSemester ? new Date(currentYear, 1, 1) // Febrero\n         : new Date(currentYear, 7, 1) // Agosto\n        ;\n        const semesterEnd = isFirstSemester ? new Date(currentYear, 6, 31) // Julio\n         : new Date(currentYear, 11, 31) // Diciembre\n        ;\n        return {\n            name: `${isFirstSemester ? 'Primer' : 'Segundo'} Semestre ${currentYear}`,\n            startDate: semesterStart,\n            endDate: semesterEnd,\n            holidays: [],\n            examPeriods: []\n        };\n    }\n    /**\n   * Calcula créditos totales (estimado)\n   */ static calculateTotalCredits(classes) {\n        // Estimación: 1 crédito por cada 50 minutos de clase semanal\n        const totalWeeklyMinutes = classes.reduce((sum, cls)=>sum + cls.duration, 0);\n        return Math.round(totalWeeklyMinutes / 50);\n    }\n    /**\n   * Actualiza el contexto del estudiante con el nuevo horario\n   */ static async updateStudentSchedule(userId, schedule) {\n        const context = await _student_context__WEBPACK_IMPORTED_MODULE_0__.StudentContextManager.getContext(userId);\n        if (!context) return;\n        // Convertir clases a formato de calendario académico\n        const academicCalendar = {\n            schoolSchedule: schedule.classes.map((cls)=>({\n                    subject: cls.subject,\n                    day: cls.day,\n                    startTime: cls.startTime,\n                    endTime: cls.endTime,\n                    classroom: cls.classroom,\n                    teacher: cls.teacher\n                })),\n            examPeriods: schedule.term.examPeriods.map((period)=>({\n                    subject: 'Multiple',\n                    date: period.startDate,\n                    startTime: '08:00',\n                    endTime: '18:00',\n                    type: period.type,\n                    syllabus: []\n                })),\n            assignments: [],\n            holidays: schedule.term.holidays\n        };\n        await _student_context__WEBPACK_IMPORTED_MODULE_0__.StudentContextManager.updateContext(userId, {\n            academicCalendar\n        });\n    }\n    /**\n   * Genera insights y recomendaciones del horario\n   */ static async generateScheduleInsights(userId, schedule) {\n        const studySlots = this.analyzeStudyTimeSlots(schedule.classes);\n        const conflicts = this.detectScheduleConflicts(schedule.classes);\n        // Aquí se pueden generar insights adicionales como:\n        // - Mejores momentos para estudiar cada materia\n        // - Recomendaciones de horarios de estudio\n        // - Alertas sobre días muy cargados\n        // - Sugerencias de optimización\n        console.log(`Generated ${studySlots.length} study time slots and detected ${conflicts.length} conflicts`);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQzJKLGFBQWEsQ0FBQ3hKLFFBQVE7WUFDaERrSjtRQUNGO0lBQ0Y7SUFFQTs7R0FFQyxHQUNELGFBQXFCckgseUJBQ25CN0IsTUFBYyxFQUNkK0ksUUFBMEIsRUFDWDtRQUNmLE1BQU10QyxhQUFhLElBQUksQ0FBQ0QscUJBQXFCLENBQUN1QyxTQUFTeEksT0FBTztRQUM5RCxNQUFNRixZQUFZLElBQUksQ0FBQ0MsdUJBQXVCLENBQUN5SSxTQUFTeEksT0FBTztRQUUvRCxvREFBb0Q7UUFDcEQsZ0RBQWdEO1FBQ2hELDJDQUEyQztRQUMzQyxvQ0FBb0M7UUFDcEMsZ0NBQWdDO1FBRWhDa0osUUFBUUMsR0FBRyxDQUFDLENBQUMsVUFBVSxFQUFFakQsV0FBV3BFLE1BQU0sQ0FBQywrQkFBK0IsRUFBRWhDLFVBQVVnQyxNQUFNLENBQUMsVUFBVSxDQUFDO0lBQzFHO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvc2Nob29sLXNjaGVkdWxlLW1hbmFnZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2lzdGVtYSBkZSBHZXN0acOzbiBkZSBIb3JhcmlvIEVzY29sYXJcbi8vIFBlcm1pdGUgaW1wb3J0YXIsIGdlc3Rpb25hciB5IG9wdGltaXphciBob3JhcmlvcyBhY2Fkw6ltaWNvc1xuXG5pbXBvcnQgeyBTdHVkZW50Q29udGV4dCwgU3R1ZGVudENvbnRleHRNYW5hZ2VyLCBBY2FkZW1pY0NhbGVuZGFyIH0gZnJvbSAnLi9zdHVkZW50LWNvbnRleHQnXG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Nob29sQ2xhc3Mge1xuICBpZDogc3RyaW5nXG4gIHN1YmplY3Q6IHN0cmluZ1xuICB0ZWFjaGVyPzogc3RyaW5nXG4gIGNsYXNzcm9vbT86IHN0cmluZ1xuICBkYXk6ICdtb25kYXknIHwgJ3R1ZXNkYXknIHwgJ3dlZG5lc2RheScgfCAndGh1cnNkYXknIHwgJ2ZyaWRheScgfCAnc2F0dXJkYXknIHwgJ3N1bmRheSdcbiAgc3RhcnRUaW1lOiBzdHJpbmcgLy8gXCIwODowMFwiXG4gIGVuZFRpbWU6IHN0cmluZyAgIC8vIFwiMDk6MzBcIlxuICBkdXJhdGlvbjogbnVtYmVyICAvLyBtaW51dGVzXG4gIHR5cGU6ICdsZWN0dXJlJyB8ICdsYWInIHwgJ3R1dG9yaWFsJyB8ICdzZW1pbmFyJyB8ICd3b3Jrc2hvcCdcbiAgcmVjdXJyaW5nOiBib29sZWFuXG4gIG5vdGVzPzogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2Nob29sVGVybSB7XG4gIG5hbWU6IHN0cmluZ1xuICBzdGFydERhdGU6IERhdGVcbiAgZW5kRGF0ZTogRGF0ZVxuICBob2xpZGF5czoge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHN0YXJ0RGF0ZTogRGF0ZVxuICAgIGVuZERhdGU6IERhdGVcbiAgICB0eXBlOiAnbmF0aW9uYWwnIHwgJ3NjaG9vbCcgfCAncmVsaWdpb3VzJyB8ICdicmVhaydcbiAgfVtdXG4gIGV4YW1QZXJpb2RzOiB7XG4gICAgbmFtZTogc3RyaW5nXG4gICAgc3RhcnREYXRlOiBEYXRlXG4gICAgZW5kRGF0ZTogRGF0ZVxuICAgIHR5cGU6ICdtaWR0ZXJtJyB8ICdmaW5hbCcgfCAncXVpel93ZWVrJ1xuICB9W11cbn1cblxuZXhwb3J0IGludGVyZmFjZSBJbXBvcnRlZFNjaGVkdWxlIHtcbiAgc291cmNlOiAnbWFudWFsJyB8ICdjc3YnIHwgJ2pzb24nIHwgJ2ljYWwnIHwgJ2dvb2dsZV9jYWxlbmRhcicgfCAnc2Nob29sX3N5c3RlbSdcbiAgaW1wb3J0RGF0ZTogRGF0ZVxuICBjbGFzc2VzOiBTY2hvb2xDbGFzc1tdXG4gIHRlcm06IFNjaG9vbFRlcm1cbiAgbWV0YWRhdGE6IHtcbiAgICBzY2hvb2xOYW1lPzogc3RyaW5nXG4gICAgYWNhZGVtaWNZZWFyPzogc3RyaW5nXG4gICAgc2VtZXN0ZXI/OiBzdHJpbmdcbiAgICB0b3RhbENyZWRpdHM/OiBudW1iZXJcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFNjaGVkdWxlQ29uZmxpY3Qge1xuICB0eXBlOiAndGltZV9vdmVybGFwJyB8ICdyb29tX2NvbmZsaWN0JyB8ICd0ZWFjaGVyX2NvbmZsaWN0JyB8ICdzdHVkZW50X292ZXJsb2FkJ1xuICBzZXZlcml0eTogJ3dhcm5pbmcnIHwgJ2Vycm9yJyB8ICdjcml0aWNhbCdcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBhZmZlY3RlZENsYXNzZXM6IHN0cmluZ1tdXG4gIHN1Z2dlc3Rpb25zOiBzdHJpbmdbXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0dWR5VGltZVNsb3Qge1xuICBkYXk6IHN0cmluZ1xuICBzdGFydFRpbWU6IHN0cmluZ1xuICBlbmRUaW1lOiBzdHJpbmdcbiAgZHVyYXRpb246IG51bWJlciAvLyBtaW51dGVzXG4gIHR5cGU6ICdmcmVlJyB8ICdzaG9ydF9icmVhaycgfCAnbHVuY2hfYnJlYWsnIHwgJ3N0dWR5X3BlcmlvZCdcbiAgcmVjb21tZW5kZWRGb3I6IHN0cmluZ1tdIC8vIHN1YmplY3RzIHRoYXQgd29yayB3ZWxsIGluIHRoaXMgc2xvdFxuICBlbmVyZ3lfbGV2ZWw6ICdoaWdoJyB8ICdtZWRpdW0nIHwgJ2xvdydcbn1cblxuZXhwb3J0IGNsYXNzIFNjaG9vbFNjaGVkdWxlTWFuYWdlciB7XG5cbiAgLyoqXG4gICAqIEltcG9ydGEgdW4gaG9yYXJpbyBlc2NvbGFyIGRlc2RlIGRpZmVyZW50ZXMgZnVlbnRlc1xuICAgKi9cbiAgc3RhdGljIGFzeW5jIGltcG9ydFNjaGVkdWxlKFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHNjaGVkdWxlRGF0YTogUGFydGlhbDxJbXBvcnRlZFNjaGVkdWxlPixcbiAgICBzb3VyY2U6IEltcG9ydGVkU2NoZWR1bGVbJ3NvdXJjZSddID0gJ21hbnVhbCdcbiAgKTogUHJvbWlzZTxJbXBvcnRlZFNjaGVkdWxlPiB7XG4gICAgXG4gICAgLy8gVmFsaWRhciBkYXRvcyBkZSBlbnRyYWRhXG4gICAgY29uc3QgdmFsaWRhdGVkU2NoZWR1bGUgPSB0aGlzLnZhbGlkYXRlU2NoZWR1bGVEYXRhKHNjaGVkdWxlRGF0YSlcbiAgICBcbiAgICAvLyBEZXRlY3RhciBjb25mbGljdG9zXG4gICAgY29uc3QgY29uZmxpY3RzID0gdGhpcy5kZXRlY3RTY2hlZHVsZUNvbmZsaWN0cyh2YWxpZGF0ZWRTY2hlZHVsZS5jbGFzc2VzKVxuICAgIFxuICAgIGlmIChjb25mbGljdHMuc29tZShjID0+IGMuc2V2ZXJpdHkgPT09ICdjcml0aWNhbCcpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbmZsaWN0b3MgY3LDrXRpY29zIGRldGVjdGFkb3M6ICR7Y29uZmxpY3RzLm1hcChjID0+IGMuZGVzY3JpcHRpb24pLmpvaW4oJywgJyl9YClcbiAgICB9XG5cbiAgICAvLyBDcmVhciBvYmpldG8gZGUgaG9yYXJpbyBpbXBvcnRhZG9cbiAgICBjb25zdCBpbXBvcnRlZFNjaGVkdWxlOiBJbXBvcnRlZFNjaGVkdWxlID0ge1xuICAgICAgc291cmNlLFxuICAgICAgaW1wb3J0RGF0ZTogbmV3IERhdGUoKSxcbiAgICAgIGNsYXNzZXM6IHZhbGlkYXRlZFNjaGVkdWxlLmNsYXNzZXMsXG4gICAgICB0ZXJtOiB2YWxpZGF0ZWRTY2hlZHVsZS50ZXJtIHx8IHRoaXMuY3JlYXRlRGVmYXVsdFRlcm0oKSxcbiAgICAgIG1ldGFkYXRhOiB7XG4gICAgICAgIHNjaG9vbE5hbWU6IHZhbGlkYXRlZFNjaGVkdWxlLm1ldGFkYXRhPy5zY2hvb2xOYW1lIHx8ICdVbmtub3duIFNjaG9vbCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogdmFsaWRhdGVkU2NoZWR1bGUubWV0YWRhdGE/LmFjYWRlbWljWWVhciB8fCBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSxcbiAgICAgICAgc2VtZXN0ZXI6IHZhbGlkYXRlZFNjaGVkdWxlLm1ldGFkYXRhPy5zZW1lc3RlciB8fCAnQ3VycmVudCBTZW1lc3RlcicsXG4gICAgICAgIHRvdGFsQ3JlZGl0czogdGhpcy5jYWxjdWxhdGVUb3RhbENyZWRpdHModmFsaWRhdGVkU2NoZWR1bGUuY2xhc3NlcylcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBY3R1YWxpemFyIGNvbnRleHRvIGRlbCBlc3R1ZGlhbnRlXG4gICAgYXdhaXQgdGhpcy51cGRhdGVTdHVkZW50U2NoZWR1bGUodXNlcklkLCBpbXBvcnRlZFNjaGVkdWxlKVxuXG4gICAgLy8gR2VuZXJhciBhbsOhbGlzaXMgeSByZWNvbWVuZGFjaW9uZXNcbiAgICBhd2FpdCB0aGlzLmdlbmVyYXRlU2NoZWR1bGVJbnNpZ2h0cyh1c2VySWQsIGltcG9ydGVkU2NoZWR1bGUpXG5cbiAgICByZXR1cm4gaW1wb3J0ZWRTY2hlZHVsZVxuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlYSB0ZXh0byBkZSBob3JhcmlvIGVuIGxlbmd1YWplIG5hdHVyYWxcbiAgICovXG4gIHN0YXRpYyBwYXJzZU5hdHVyYWxMYW5ndWFnZVNjaGVkdWxlKHRleHQ6IHN0cmluZyk6IFNjaG9vbENsYXNzW10ge1xuICAgIGNvbnN0IGNsYXNzZXM6IFNjaG9vbENsYXNzW10gPSBbXVxuICAgIGNvbnN0IGxpbmVzID0gdGV4dC5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMClcblxuICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgY29uc3QgcGFyc2VkID0gdGhpcy5wYXJzZVNjaGVkdWxlTGluZShsaW5lKVxuICAgICAgaWYgKHBhcnNlZCkge1xuICAgICAgICBjbGFzc2VzLnB1c2gocGFyc2VkKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjbGFzc2VzXG4gIH1cblxuICAvKipcbiAgICogUGFyc2VhIHVuYSBsw61uZWEgaW5kaXZpZHVhbCBkZSBob3JhcmlvXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBwYXJzZVNjaGVkdWxlTGluZShsaW5lOiBzdHJpbmcpOiBTY2hvb2xDbGFzcyB8IG51bGwge1xuICAgIC8vIFBhdHJvbmVzIHBhcmEgZGlmZXJlbnRlcyBmb3JtYXRvcyBkZSBob3JhcmlvXG4gICAgY29uc3QgcGF0dGVybnMgPSBbXG4gICAgICAvLyBcIkx1bmVzIDA4OjAwLTA5OjMwIE1hdGVtw6F0aWNhcyBBdWxhIDEwMSBQcm9mLiBHYXJjw61hXCJcbiAgICAgIC9eKGx1bmVzfG1hcnRlc3xtacOpcmNvbGVzfGp1ZXZlc3x2aWVybmVzfHPDoWJhZG98ZG9taW5nbylcXHMrKFxcZHsxLDJ9OlxcZHsyfSktKFxcZHsxLDJ9OlxcZHsyfSlcXHMrKFteLF0rPykoPzpcXHMrKD86YXVsYXxzYWzDs258bGFiKVxccyooXFx3KykpP1xccyooPzpwcm9mXFwuP1xccyooLispKT8kL2ksXG4gICAgICBcbiAgICAgIC8vIFwiTWF0ZW3DoXRpY2FzIC0gTHVuZXMgODowMCBBTSBhIDk6MzAgQU1cIlxuICAgICAgL14oW14tXSs/KVxccyotXFxzKihsdW5lc3xtYXJ0ZXN8bWnDqXJjb2xlc3xqdWV2ZXN8dmllcm5lc3xzw6FiYWRvfGRvbWluZ28pXFxzKyhcXGR7MSwyfTpcXGR7Mn0pXFxzKig/OmFtfHBtKT9cXHMqYVxccyooXFxkezEsMn06XFxkezJ9KVxccyooPzphbXxwbSk/L2ksXG4gICAgICBcbiAgICAgIC8vIFwiMDg6MDAgTWF0ZW3DoXRpY2FzIChMdW5lcylcIlxuICAgICAgL14oXFxkezEsMn06XFxkezJ9KVxccysoW14oXSs/KVxccypcXChcXHMqKGx1bmVzfG1hcnRlc3xtacOpcmNvbGVzfGp1ZXZlc3x2aWVybmVzfHPDoWJhZG98ZG9taW5nbylcXHMqXFwpL2lcbiAgICBdXG5cbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgcGF0dGVybnMpIHtcbiAgICAgIGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaChwYXR0ZXJuKVxuICAgICAgaWYgKG1hdGNoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNyZWF0ZUNsYXNzRnJvbU1hdGNoKG1hdGNoLCBwYXR0ZXJuKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICAvKipcbiAgICogQ3JlYSB1biBvYmpldG8gU2Nob29sQ2xhc3MgZGVzZGUgdW5hIGNvaW5jaWRlbmNpYSBkZSByZWdleFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlQ2xhc3NGcm9tTWF0Y2gobWF0Y2g6IFJlZ0V4cE1hdGNoQXJyYXksIHBhdHRlcm46IFJlZ0V4cCk6IFNjaG9vbENsYXNzIHtcbiAgICBjb25zdCBpZCA9IGBjbGFzc18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDYpfWBcbiAgICBcbiAgICAvLyBNYXBlYXIgbm9tYnJlcyBkZSBkw61hcyBlbiBlc3Bhw7FvbCBhIGluZ2zDqXNcbiAgICBjb25zdCBkYXlNYXA6IHsgW2tleTogc3RyaW5nXTogU2Nob29sQ2xhc3NbJ2RheSddIH0gPSB7XG4gICAgICAnbHVuZXMnOiAnbW9uZGF5JyxcbiAgICAgICdtYXJ0ZXMnOiAndHVlc2RheScsXG4gICAgICAnbWnDqXJjb2xlcyc6ICd3ZWRuZXNkYXknLFxuICAgICAgJ2p1ZXZlcyc6ICd0aHVyc2RheScsXG4gICAgICAndmllcm5lcyc6ICdmcmlkYXknLFxuICAgICAgJ3PDoWJhZG8nOiAnc2F0dXJkYXknLFxuICAgICAgJ2RvbWluZ28nOiAnc3VuZGF5J1xuICAgIH1cblxuICAgIC8vIERldGVybWluYXIgZWwgZm9ybWF0byBiYXNhZG8gZW4gZWwgcGF0csOzblxuICAgIGxldCBkYXk6IFNjaG9vbENsYXNzWydkYXknXVxuICAgIGxldCBzdGFydFRpbWU6IHN0cmluZ1xuICAgIGxldCBlbmRUaW1lOiBzdHJpbmdcbiAgICBsZXQgc3ViamVjdDogc3RyaW5nXG4gICAgbGV0IHRlYWNoZXI6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgIGxldCBjbGFzc3Jvb206IHN0cmluZyB8IHVuZGVmaW5lZFxuXG4gICAgaWYgKHBhdHRlcm4uc291cmNlLmluY2x1ZGVzKCdsdW5lc3xtYXJ0ZXMnKSkge1xuICAgICAgLy8gRm9ybWF0bzogXCJEw61hIEhvcmEtSG9yYSBNYXRlcmlhIFtBdWxhXSBbUHJvZl1cIlxuICAgICAgZGF5ID0gZGF5TWFwW21hdGNoWzFdLnRvTG93ZXJDYXNlKCldXG4gICAgICBzdGFydFRpbWUgPSB0aGlzLm5vcm1hbGl6ZVRpbWUobWF0Y2hbMl0pXG4gICAgICBlbmRUaW1lID0gdGhpcy5ub3JtYWxpemVUaW1lKG1hdGNoWzNdKVxuICAgICAgc3ViamVjdCA9IG1hdGNoWzRdLnRyaW0oKVxuICAgICAgY2xhc3Nyb29tID0gbWF0Y2hbNV1cbiAgICAgIHRlYWNoZXIgPSBtYXRjaFs2XVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBPdHJvcyBmb3JtYXRvcyAtIGFqdXN0YXIgc2Vnw7puIG5lY2VzaWRhZFxuICAgICAgZGF5ID0gJ21vbmRheScgLy8gRGVmYXVsdFxuICAgICAgc3RhcnRUaW1lID0gJzA4OjAwJ1xuICAgICAgZW5kVGltZSA9ICcwOTowMCdcbiAgICAgIHN1YmplY3QgPSAnVW5rbm93biBTdWJqZWN0J1xuICAgIH1cblxuICAgIGNvbnN0IGR1cmF0aW9uID0gdGhpcy5jYWxjdWxhdGVEdXJhdGlvbihzdGFydFRpbWUsIGVuZFRpbWUpXG5cbiAgICByZXR1cm4ge1xuICAgICAgaWQsXG4gICAgICBzdWJqZWN0OiB0aGlzLm5vcm1hbGl6ZVN1YmplY3ROYW1lKHN1YmplY3QpLFxuICAgICAgdGVhY2hlcjogdGVhY2hlcj8udHJpbSgpLFxuICAgICAgY2xhc3Nyb29tOiBjbGFzc3Jvb20/LnRyaW0oKSxcbiAgICAgIGRheSxcbiAgICAgIHN0YXJ0VGltZSxcbiAgICAgIGVuZFRpbWUsXG4gICAgICBkdXJhdGlvbixcbiAgICAgIHR5cGU6IHRoaXMuaW5mZXJDbGFzc1R5cGUoc3ViamVjdCksXG4gICAgICByZWN1cnJpbmc6IHRydWUsXG4gICAgICBub3RlczogYEltcG9ydGVkIGZyb20gbmF0dXJhbCBsYW5ndWFnZTogXCIke21hdGNoWzBdfVwiYFxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBOb3JtYWxpemEgZWwgbm9tYnJlIGRlIHVuYSBtYXRlcmlhXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBub3JtYWxpemVTdWJqZWN0TmFtZShzdWJqZWN0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG5vcm1hbGl6ZWQgPSBzdWJqZWN0LnRyaW0oKVxuICAgICAgLnJlcGxhY2UoL1xccysvZywgJyAnKVxuICAgICAgLnJlcGxhY2UoL14oZWx8bGF8bG9zfGxhcylcXHMrL2ksICcnKVxuICAgIFxuICAgIC8vIENhcGl0YWxpemFyIHByaW1lcmEgbGV0cmEgZGUgY2FkYSBwYWxhYnJhXG4gICAgcmV0dXJuIG5vcm1hbGl6ZWQuc3BsaXQoJyAnKVxuICAgICAgLm1hcCh3b3JkID0+IHdvcmQuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB3b3JkLnNsaWNlKDEpLnRvTG93ZXJDYXNlKCkpXG4gICAgICAuam9pbignICcpXG4gIH1cblxuICAvKipcbiAgICogSW5maWVyZSBlbCB0aXBvIGRlIGNsYXNlIGJhc2FkbyBlbiBlbCBub21icmUgZGUgbGEgbWF0ZXJpYVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgaW5mZXJDbGFzc1R5cGUoc3ViamVjdDogc3RyaW5nKTogU2Nob29sQ2xhc3NbJ3R5cGUnXSB7XG4gICAgY29uc3Qgc3ViamVjdExvd2VyID0gc3ViamVjdC50b0xvd2VyQ2FzZSgpXG4gICAgXG4gICAgaWYgKHN1YmplY3RMb3dlci5pbmNsdWRlcygnbGFiJykgfHwgc3ViamVjdExvd2VyLmluY2x1ZGVzKCdsYWJvcmF0b3JpbycpKSB7XG4gICAgICByZXR1cm4gJ2xhYidcbiAgICB9XG4gICAgaWYgKHN1YmplY3RMb3dlci5pbmNsdWRlcygndGFsbGVyJykgfHwgc3ViamVjdExvd2VyLmluY2x1ZGVzKCd3b3Jrc2hvcCcpKSB7XG4gICAgICByZXR1cm4gJ3dvcmtzaG9wJ1xuICAgIH1cbiAgICBpZiAoc3ViamVjdExvd2VyLmluY2x1ZGVzKCdzZW1pbmFyaW8nKSB8fCBzdWJqZWN0TG93ZXIuaW5jbHVkZXMoJ3NlbWluYXInKSkge1xuICAgICAgcmV0dXJuICdzZW1pbmFyJ1xuICAgIH1cbiAgICBpZiAoc3ViamVjdExvd2VyLmluY2x1ZGVzKCd0dXRvcmlhbCcpIHx8IHN1YmplY3RMb3dlci5pbmNsdWRlcygndHV0b3LDrWEnKSkge1xuICAgICAgcmV0dXJuICd0dXRvcmlhbCdcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICdsZWN0dXJlJ1xuICB9XG5cbiAgLyoqXG4gICAqIE5vcm1hbGl6YSBmb3JtYXRvIGRlIGhvcmFcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIG5vcm1hbGl6ZVRpbWUodGltZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvLyBDb252ZXJ0aXIgZm9ybWF0b3MgY29tbyBcIjg6MDBcIiwgXCIwODowMFwiLCBcIjhcIiwgZXRjLiBhIFwiMDg6MDBcIlxuICAgIGNvbnN0IHRpbWVNYXRjaCA9IHRpbWUubWF0Y2goLyhcXGR7MSwyfSkoPzo6KFxcZHsyfSkpPy8pXG4gICAgaWYgKHRpbWVNYXRjaCkge1xuICAgICAgY29uc3QgaG91cnMgPSB0aW1lTWF0Y2hbMV0ucGFkU3RhcnQoMiwgJzAnKVxuICAgICAgY29uc3QgbWludXRlcyA9IHRpbWVNYXRjaFsyXSB8fCAnMDAnXG4gICAgICByZXR1cm4gYCR7aG91cnN9OiR7bWludXRlc31gXG4gICAgfVxuICAgIHJldHVybiB0aW1lXG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYSBsYSBkdXJhY2nDs24gZW50cmUgZG9zIGhvcmFzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjYWxjdWxhdGVEdXJhdGlvbihzdGFydFRpbWU6IHN0cmluZywgZW5kVGltZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBzdGFydCA9IHRoaXMudGltZVRvTWludXRlcyhzdGFydFRpbWUpXG4gICAgY29uc3QgZW5kID0gdGhpcy50aW1lVG9NaW51dGVzKGVuZFRpbWUpXG4gICAgcmV0dXJuIGVuZCAtIHN0YXJ0XG4gIH1cblxuICAvKipcbiAgICogQ29udmllcnRlIGZvcm1hdG8gSEg6TU0gYSBtaW51dG9zIGRlc2RlIG1lZGlhbm9jaGVcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIHRpbWVUb01pbnV0ZXModGltZTogc3RyaW5nKTogbnVtYmVyIHtcbiAgICBjb25zdCBbaG91cnMsIG1pbnV0ZXNdID0gdGltZS5zcGxpdCgnOicpLm1hcChOdW1iZXIpXG4gICAgcmV0dXJuIGhvdXJzICogNjAgKyBtaW51dGVzXG4gIH1cblxuICAvKipcbiAgICogRGV0ZWN0YSBjb25mbGljdG9zIGVuIGVsIGhvcmFyaW9cbiAgICovXG4gIHN0YXRpYyBkZXRlY3RTY2hlZHVsZUNvbmZsaWN0cyhjbGFzc2VzOiBTY2hvb2xDbGFzc1tdKTogU2NoZWR1bGVDb25mbGljdFtdIHtcbiAgICBjb25zdCBjb25mbGljdHM6IFNjaGVkdWxlQ29uZmxpY3RbXSA9IFtdXG5cbiAgICAvLyBBZ3J1cGFyIGNsYXNlcyBwb3IgZMOtYVxuICAgIGNvbnN0IGNsYXNzZXNCeURheSA9IGNsYXNzZXMucmVkdWNlKChhY2MsIGNscykgPT4ge1xuICAgICAgaWYgKCFhY2NbY2xzLmRheV0pIGFjY1tjbHMuZGF5XSA9IFtdXG4gICAgICBhY2NbY2xzLmRheV0ucHVzaChjbHMpXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30gYXMgeyBbZGF5OiBzdHJpbmddOiBTY2hvb2xDbGFzc1tdIH0pXG5cbiAgICAvLyBEZXRlY3RhciBzb2xhcGFtaWVudG9zIGRlIHRpZW1wb1xuICAgIGZvciAoY29uc3QgW2RheSwgZGF5Q2xhc3Nlc10gb2YgT2JqZWN0LmVudHJpZXMoY2xhc3Nlc0J5RGF5KSkge1xuICAgICAgY29uc3Qgc29ydGVkQ2xhc3NlcyA9IGRheUNsYXNzZXMuc29ydCgoYSwgYikgPT4gXG4gICAgICAgIHRoaXMudGltZVRvTWludXRlcyhhLnN0YXJ0VGltZSkgLSB0aGlzLnRpbWVUb01pbnV0ZXMoYi5zdGFydFRpbWUpXG4gICAgICApXG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc29ydGVkQ2xhc3Nlcy5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgY29uc3QgY3VycmVudCA9IHNvcnRlZENsYXNzZXNbaV1cbiAgICAgICAgY29uc3QgbmV4dCA9IHNvcnRlZENsYXNzZXNbaSArIDFdXG4gICAgICAgIFxuICAgICAgICBjb25zdCBjdXJyZW50RW5kID0gdGhpcy50aW1lVG9NaW51dGVzKGN1cnJlbnQuZW5kVGltZSlcbiAgICAgICAgY29uc3QgbmV4dFN0YXJ0ID0gdGhpcy50aW1lVG9NaW51dGVzKG5leHQuc3RhcnRUaW1lKVxuXG4gICAgICAgIGlmIChjdXJyZW50RW5kID4gbmV4dFN0YXJ0KSB7XG4gICAgICAgICAgY29uZmxpY3RzLnB1c2goe1xuICAgICAgICAgICAgdHlwZTogJ3RpbWVfb3ZlcmxhcCcsXG4gICAgICAgICAgICBzZXZlcml0eTogJ2Vycm9yJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBgU29sYXBhbWllbnRvIGRlIGNsYXNlcyBlbCAke2RheX06ICR7Y3VycmVudC5zdWJqZWN0fSAoJHtjdXJyZW50LnN0YXJ0VGltZX0tJHtjdXJyZW50LmVuZFRpbWV9KSBjb24gJHtuZXh0LnN1YmplY3R9ICgke25leHQuc3RhcnRUaW1lfS0ke25leHQuZW5kVGltZX0pYCxcbiAgICAgICAgICAgIGFmZmVjdGVkQ2xhc3NlczogW2N1cnJlbnQuaWQsIG5leHQuaWRdLFxuICAgICAgICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgICAgICAgJ0FqdXN0YXIgaG9yYXJpb3MgcGFyYSBldml0YXIgc29sYXBhbWllbnRvJyxcbiAgICAgICAgICAgICAgJ1ZlcmlmaWNhciBxdWUgbGFzIGhvcmFzIGVzdMOpbiBjb3JyZWN0YXMnLFxuICAgICAgICAgICAgICAnQ29uc2lkZXJhciBtb2RhbGlkYWQgdmlydHVhbCBwYXJhIHVuYSBkZSBsYXMgY2xhc2VzJ1xuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBEZXRlY3RhciBzb2JyZWNhcmdhIGRpYXJpYVxuICAgIGZvciAoY29uc3QgW2RheSwgZGF5Q2xhc3Nlc10gb2YgT2JqZWN0LmVudHJpZXMoY2xhc3Nlc0J5RGF5KSkge1xuICAgICAgY29uc3QgdG90YWxIb3VycyA9IGRheUNsYXNzZXMucmVkdWNlKChzdW0sIGNscykgPT4gc3VtICsgY2xzLmR1cmF0aW9uLCAwKSAvIDYwXG4gICAgICBcbiAgICAgIGlmICh0b3RhbEhvdXJzID4gOCkge1xuICAgICAgICBjb25mbGljdHMucHVzaCh7XG4gICAgICAgICAgdHlwZTogJ3N0dWRlbnRfb3ZlcmxvYWQnLFxuICAgICAgICAgIHNldmVyaXR5OiAnd2FybmluZycsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGBEw61hIG11eSBjYXJnYWRvIGVsICR7ZGF5fTogJHt0b3RhbEhvdXJzLnRvRml4ZWQoMSl9IGhvcmFzIGRlIGNsYXNlYCxcbiAgICAgICAgICBhZmZlY3RlZENsYXNzZXM6IGRheUNsYXNzZXMubWFwKGMgPT4gYy5pZCksXG4gICAgICAgICAgc3VnZ2VzdGlvbnM6IFtcbiAgICAgICAgICAgICdDb25zaWRlcmFyIGRpc3RyaWJ1aXIgYWxndW5hcyBjbGFzZXMgZW4gb3Ryb3MgZMOtYXMnLFxuICAgICAgICAgICAgJ1BsYW5pZmljYXIgZGVzY2Fuc29zIGFkZWN1YWRvcycsXG4gICAgICAgICAgICAnUHJlcGFyYXIgbWF0ZXJpYWwgZGUgZXN0dWRpbyBjb24gYW50aWNpcGFjacOzbidcbiAgICAgICAgICBdXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvbmZsaWN0c1xuICB9XG5cbiAgLyoqXG4gICAqIEFuYWxpemEgZWwgaG9yYXJpbyB5IGVuY3VlbnRyYSBzbG90cyBkZSB0aWVtcG8gbGlicmUgcGFyYSBlc3R1ZGlvXG4gICAqL1xuICBzdGF0aWMgYW5hbHl6ZVN0dWR5VGltZVNsb3RzKGNsYXNzZXM6IFNjaG9vbENsYXNzW10pOiBTdHVkeVRpbWVTbG90W10ge1xuICAgIGNvbnN0IHN0dWR5U2xvdHM6IFN0dWR5VGltZVNsb3RbXSA9IFtdXG4gICAgY29uc3QgZGF5c09mV2VlayA9IFsnbW9uZGF5JywgJ3R1ZXNkYXknLCAnd2VkbmVzZGF5JywgJ3RodXJzZGF5JywgJ2ZyaWRheSddXG5cbiAgICBmb3IgKGNvbnN0IGRheSBvZiBkYXlzT2ZXZWVrKSB7XG4gICAgICBjb25zdCBkYXlDbGFzc2VzID0gY2xhc3Nlc1xuICAgICAgICAuZmlsdGVyKGMgPT4gYy5kYXkgPT09IGRheSlcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHRoaXMudGltZVRvTWludXRlcyhhLnN0YXJ0VGltZSkgLSB0aGlzLnRpbWVUb01pbnV0ZXMoYi5zdGFydFRpbWUpKVxuXG4gICAgICAvLyBFbmNvbnRyYXIgZ2FwcyBlbnRyZSBjbGFzZXNcbiAgICAgIGNvbnN0IGdhcHMgPSB0aGlzLmZpbmRUaW1lR2FwcyhkYXlDbGFzc2VzLCBkYXkpXG4gICAgICBzdHVkeVNsb3RzLnB1c2goLi4uZ2FwcylcbiAgICB9XG5cbiAgICByZXR1cm4gc3R1ZHlTbG90c1xuICB9XG5cbiAgLyoqXG4gICAqIEVuY3VlbnRyYSBnYXBzIGRlIHRpZW1wbyBlbnRyZSBjbGFzZXNcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGZpbmRUaW1lR2FwcyhkYXlDbGFzc2VzOiBTY2hvb2xDbGFzc1tdLCBkYXk6IHN0cmluZyk6IFN0dWR5VGltZVNsb3RbXSB7XG4gICAgY29uc3QgZ2FwczogU3R1ZHlUaW1lU2xvdFtdID0gW11cbiAgICBjb25zdCBkYXlTdGFydCA9IDcgKiA2MCAvLyA3OjAwIEFNIGVuIG1pbnV0b3NcbiAgICBjb25zdCBkYXlFbmQgPSAyMiAqIDYwICAvLyAxMDowMCBQTSBlbiBtaW51dG9zXG5cbiAgICBpZiAoZGF5Q2xhc3Nlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIETDrWEgY29tcGxldG8gbGlicmVcbiAgICAgIGdhcHMucHVzaCh7XG4gICAgICAgIGRheSxcbiAgICAgICAgc3RhcnRUaW1lOiAnMDg6MDAnLFxuICAgICAgICBlbmRUaW1lOiAnMjA6MDAnLFxuICAgICAgICBkdXJhdGlvbjogMTIgKiA2MCxcbiAgICAgICAgdHlwZTogJ2ZyZWUnLFxuICAgICAgICByZWNvbW1lbmRlZEZvcjogWydhbnknXSxcbiAgICAgICAgZW5lcmd5X2xldmVsOiAnaGlnaCdcbiAgICAgIH0pXG4gICAgICByZXR1cm4gZ2Fwc1xuICAgIH1cblxuICAgIC8vIEdhcCBhbnRlcyBkZSBsYSBwcmltZXJhIGNsYXNlXG4gICAgY29uc3QgZmlyc3RDbGFzc1N0YXJ0ID0gdGhpcy50aW1lVG9NaW51dGVzKGRheUNsYXNzZXNbMF0uc3RhcnRUaW1lKVxuICAgIGlmIChmaXJzdENsYXNzU3RhcnQgPiBkYXlTdGFydCArIDYwKSB7IC8vIEFsIG1lbm9zIDEgaG9yYVxuICAgICAgZ2Fwcy5wdXNoKHtcbiAgICAgICAgZGF5LFxuICAgICAgICBzdGFydFRpbWU6IHRoaXMubWludXRlc1RvVGltZShkYXlTdGFydCksXG4gICAgICAgIGVuZFRpbWU6IGRheUNsYXNzZXNbMF0uc3RhcnRUaW1lLFxuICAgICAgICBkdXJhdGlvbjogZmlyc3RDbGFzc1N0YXJ0IC0gZGF5U3RhcnQsXG4gICAgICAgIHR5cGU6ICdmcmVlJyxcbiAgICAgICAgcmVjb21tZW5kZWRGb3I6IFsncmV2aWV3JywgJ3ByZXBhcmF0aW9uJ10sXG4gICAgICAgIGVuZXJneV9sZXZlbDogJ2hpZ2gnXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIEdhcHMgZW50cmUgY2xhc2VzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXlDbGFzc2VzLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgY29uc3QgY3VycmVudEVuZCA9IHRoaXMudGltZVRvTWludXRlcyhkYXlDbGFzc2VzW2ldLmVuZFRpbWUpXG4gICAgICBjb25zdCBuZXh0U3RhcnQgPSB0aGlzLnRpbWVUb01pbnV0ZXMoZGF5Q2xhc3Nlc1tpICsgMV0uc3RhcnRUaW1lKVxuICAgICAgY29uc3QgZ2FwRHVyYXRpb24gPSBuZXh0U3RhcnQgLSBjdXJyZW50RW5kXG5cbiAgICAgIGlmIChnYXBEdXJhdGlvbiA+PSAzMCkgeyAvLyBBbCBtZW5vcyAzMCBtaW51dG9zXG4gICAgICAgIGNvbnN0IGdhcFR5cGUgPSB0aGlzLmNsYXNzaWZ5VGltZUdhcChnYXBEdXJhdGlvbilcbiAgICAgICAgZ2Fwcy5wdXNoKHtcbiAgICAgICAgICBkYXksXG4gICAgICAgICAgc3RhcnRUaW1lOiBkYXlDbGFzc2VzW2ldLmVuZFRpbWUsXG4gICAgICAgICAgZW5kVGltZTogZGF5Q2xhc3Nlc1tpICsgMV0uc3RhcnRUaW1lLFxuICAgICAgICAgIGR1cmF0aW9uOiBnYXBEdXJhdGlvbixcbiAgICAgICAgICB0eXBlOiBnYXBUeXBlLFxuICAgICAgICAgIHJlY29tbWVuZGVkRm9yOiB0aGlzLmdldFJlY29tbWVuZGVkU3ViamVjdHMoZ2FwRHVyYXRpb24sIGN1cnJlbnRFbmQpLFxuICAgICAgICAgIGVuZXJneV9sZXZlbDogdGhpcy5nZXRFbmVyZ3lMZXZlbChjdXJyZW50RW5kKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEdhcCBkZXNwdcOpcyBkZSBsYSDDumx0aW1hIGNsYXNlXG4gICAgY29uc3QgbGFzdENsYXNzRW5kID0gdGhpcy50aW1lVG9NaW51dGVzKGRheUNsYXNzZXNbZGF5Q2xhc3Nlcy5sZW5ndGggLSAxXS5lbmRUaW1lKVxuICAgIGlmIChsYXN0Q2xhc3NFbmQgPCBkYXlFbmQgLSA2MCkgeyAvLyBBbCBtZW5vcyAxIGhvcmFcbiAgICAgIGdhcHMucHVzaCh7XG4gICAgICAgIGRheSxcbiAgICAgICAgc3RhcnRUaW1lOiBkYXlDbGFzc2VzW2RheUNsYXNzZXMubGVuZ3RoIC0gMV0uZW5kVGltZSxcbiAgICAgICAgZW5kVGltZTogdGhpcy5taW51dGVzVG9UaW1lKGRheUVuZCksXG4gICAgICAgIGR1cmF0aW9uOiBkYXlFbmQgLSBsYXN0Q2xhc3NFbmQsXG4gICAgICAgIHR5cGU6ICdmcmVlJyxcbiAgICAgICAgcmVjb21tZW5kZWRGb3I6IFsnaG9tZXdvcmsnLCAncHJvamVjdHMnLCAncmV2aWV3J10sXG4gICAgICAgIGVuZXJneV9sZXZlbDogdGhpcy5nZXRFbmVyZ3lMZXZlbChsYXN0Q2xhc3NFbmQpXG4gICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiBnYXBzXG4gIH1cblxuICAvKipcbiAgICogQ2xhc2lmaWNhIHVuIGdhcCBkZSB0aWVtcG8gc2Vnw7puIHN1IGR1cmFjacOzblxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY2xhc3NpZnlUaW1lR2FwKGR1cmF0aW9uOiBudW1iZXIpOiBTdHVkeVRpbWVTbG90Wyd0eXBlJ10ge1xuICAgIGlmIChkdXJhdGlvbiA8PSAzMCkgcmV0dXJuICdzaG9ydF9icmVhaydcbiAgICBpZiAoZHVyYXRpb24gPD0gOTApIHJldHVybiAnc3R1ZHlfcGVyaW9kJ1xuICAgIGlmIChkdXJhdGlvbiA+PSA2MCAmJiBkdXJhdGlvbiA8PSAxMjApIHJldHVybiAnbHVuY2hfYnJlYWsnXG4gICAgcmV0dXJuICdmcmVlJ1xuICB9XG5cbiAgLyoqXG4gICAqIFJlY29taWVuZGEgbWF0ZXJpYXMgc2Vnw7puIGxhIGR1cmFjacOzbiB5IG1vbWVudG8gZGVsIGTDrWFcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldFJlY29tbWVuZGVkU3ViamVjdHMoZHVyYXRpb246IG51bWJlciwgdGltZUluTWludXRlczogbnVtYmVyKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGhvdXIgPSBNYXRoLmZsb29yKHRpbWVJbk1pbnV0ZXMgLyA2MClcbiAgICBcbiAgICBpZiAoZHVyYXRpb24gPD0gMzApIHtcbiAgICAgIHJldHVybiBbJ3JldmlldycsICdmbGFzaGNhcmRzJywgJ3F1aWNrX3JlYWRpbmcnXVxuICAgIH1cbiAgICBcbiAgICBpZiAoZHVyYXRpb24gPD0gNjApIHtcbiAgICAgIHJldHVybiBbJ2hvbWV3b3JrJywgJ3ByYWN0aWNlX3Byb2JsZW1zJywgJ25vdGVfcmV2aWV3J11cbiAgICB9XG4gICAgXG4gICAgaWYgKGhvdXIgPCAxMikge1xuICAgICAgcmV0dXJuIFsnZGlmZmljdWx0X3N1YmplY3RzJywgJ21hdGhlbWF0aWNzJywgJ3NjaWVuY2UnLCAnbmV3X2NvbmNlcHRzJ11cbiAgICB9IGVsc2UgaWYgKGhvdXIgPCAxNSkge1xuICAgICAgcmV0dXJuIFsncmVhZGluZycsICd3cml0aW5nJywgJ3Jlc2VhcmNoJywgJ3Byb2plY3RzJ11cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFsncmV2aWV3JywgJ3ByYWN0aWNlJywgJ2NyZWF0aXZlX3dvcmsnLCAnZ3JvdXBfc3R1ZHknXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmEgZWwgbml2ZWwgZGUgZW5lcmfDrWEgc2Vnw7puIGxhIGhvcmEgZGVsIGTDrWFcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGdldEVuZXJneUxldmVsKHRpbWVJbk1pbnV0ZXM6IG51bWJlcik6IFN0dWR5VGltZVNsb3RbJ2VuZXJneV9sZXZlbCddIHtcbiAgICBjb25zdCBob3VyID0gTWF0aC5mbG9vcih0aW1lSW5NaW51dGVzIC8gNjApXG4gICAgXG4gICAgaWYgKGhvdXIgPj0gOCAmJiBob3VyIDw9IDExKSByZXR1cm4gJ2hpZ2gnXG4gICAgaWYgKGhvdXIgPj0gMTQgJiYgaG91ciA8PSAxNikgcmV0dXJuICdoaWdoJ1xuICAgIGlmIChob3VyID49IDEyICYmIGhvdXIgPD0gMTMpIHJldHVybiAnbG93J1xuICAgIGlmIChob3VyID49IDE3ICYmIGhvdXIgPD0gMTkpIHJldHVybiAnbWVkaXVtJ1xuICAgIHJldHVybiAnbG93J1xuICB9XG5cbiAgLyoqXG4gICAqIENvbnZpZXJ0ZSBtaW51dG9zIGRlc2RlIG1lZGlhbm9jaGUgYSBmb3JtYXRvIEhIOk1NXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBtaW51dGVzVG9UaW1lKG1pbnV0ZXM6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKG1pbnV0ZXMgLyA2MCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpXG4gICAgY29uc3QgbWlucyA9IChtaW51dGVzICUgNjApLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKVxuICAgIHJldHVybiBgJHtob3Vyc306JHttaW5zfWBcbiAgfVxuXG4gIC8qKlxuICAgKiBWYWxpZGEgbG9zIGRhdG9zIGRlbCBob3JhcmlvIGltcG9ydGFkb1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgdmFsaWRhdGVTY2hlZHVsZURhdGEoZGF0YTogUGFydGlhbDxJbXBvcnRlZFNjaGVkdWxlPik6IHtcbiAgICBjbGFzc2VzOiBTY2hvb2xDbGFzc1tdXG4gICAgdGVybT86IFNjaG9vbFRlcm1cbiAgICBtZXRhZGF0YT86IEltcG9ydGVkU2NoZWR1bGVbJ21ldGFkYXRhJ11cbiAgfSB7XG4gICAgaWYgKCFkYXRhLmNsYXNzZXMgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS5jbGFzc2VzKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDbGFzc2VzIGFycmF5IGlzIHJlcXVpcmVkJylcbiAgICB9XG5cbiAgICAvLyBWYWxpZGFyIGNhZGEgY2xhc2VcbiAgICBjb25zdCB2YWxpZGF0ZWRDbGFzc2VzID0gZGF0YS5jbGFzc2VzLm1hcChjbHMgPT4gdGhpcy52YWxpZGF0ZUNsYXNzKGNscykpXG5cbiAgICByZXR1cm4ge1xuICAgICAgY2xhc3NlczogdmFsaWRhdGVkQ2xhc3NlcyxcbiAgICAgIHRlcm06IGRhdGEudGVybSxcbiAgICAgIG1ldGFkYXRhOiBkYXRhLm1ldGFkYXRhXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYSB1bmEgY2xhc2UgaW5kaXZpZHVhbFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgdmFsaWRhdGVDbGFzcyhjbHM6IFBhcnRpYWw8U2Nob29sQ2xhc3M+KTogU2Nob29sQ2xhc3Mge1xuICAgIGlmICghY2xzLnN1YmplY3QgfHwgIWNscy5kYXkgfHwgIWNscy5zdGFydFRpbWUgfHwgIWNscy5lbmRUaW1lKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NsYXNzIG11c3QgaGF2ZSBzdWJqZWN0LCBkYXksIHN0YXJ0VGltZSwgYW5kIGVuZFRpbWUnKVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBpZDogY2xzLmlkIHx8IGBjbGFzc18ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDYpfWAsXG4gICAgICBzdWJqZWN0OiBjbHMuc3ViamVjdCxcbiAgICAgIHRlYWNoZXI6IGNscy50ZWFjaGVyLFxuICAgICAgY2xhc3Nyb29tOiBjbHMuY2xhc3Nyb29tLFxuICAgICAgZGF5OiBjbHMuZGF5LFxuICAgICAgc3RhcnRUaW1lOiBjbHMuc3RhcnRUaW1lLFxuICAgICAgZW5kVGltZTogY2xzLmVuZFRpbWUsXG4gICAgICBkdXJhdGlvbjogY2xzLmR1cmF0aW9uIHx8IHRoaXMuY2FsY3VsYXRlRHVyYXRpb24oY2xzLnN0YXJ0VGltZSwgY2xzLmVuZFRpbWUpLFxuICAgICAgdHlwZTogY2xzLnR5cGUgfHwgJ2xlY3R1cmUnLFxuICAgICAgcmVjdXJyaW5nOiBjbHMucmVjdXJyaW5nICE9PSBmYWxzZSxcbiAgICAgIG5vdGVzOiBjbHMubm90ZXNcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ3JlYSB1biB0w6lybWlubyBhY2Fkw6ltaWNvIHBvciBkZWZlY3RvXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjcmVhdGVEZWZhdWx0VGVybSgpOiBTY2hvb2xUZXJtIHtcbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gICAgY29uc3QgY3VycmVudFllYXIgPSBub3cuZ2V0RnVsbFllYXIoKVxuICAgIGNvbnN0IGN1cnJlbnRNb250aCA9IG5vdy5nZXRNb250aCgpXG4gICAgXG4gICAgLy8gRGV0ZXJtaW5hciBzaSBlc3RhbW9zIGVuIHByaW1lciBvIHNlZ3VuZG8gc2VtZXN0cmVcbiAgICBjb25zdCBpc0ZpcnN0U2VtZXN0ZXIgPSBjdXJyZW50TW9udGggPj0gMSAmJiBjdXJyZW50TW9udGggPD0gNlxuICAgIGNvbnN0IHNlbWVzdGVyU3RhcnQgPSBpc0ZpcnN0U2VtZXN0ZXIgXG4gICAgICA/IG5ldyBEYXRlKGN1cnJlbnRZZWFyLCAxLCAxKSAgLy8gRmVicmVyb1xuICAgICAgOiBuZXcgRGF0ZShjdXJyZW50WWVhciwgNywgMSkgIC8vIEFnb3N0b1xuICAgIFxuICAgIGNvbnN0IHNlbWVzdGVyRW5kID0gaXNGaXJzdFNlbWVzdGVyXG4gICAgICA/IG5ldyBEYXRlKGN1cnJlbnRZZWFyLCA2LCAzMSkgLy8gSnVsaW9cbiAgICAgIDogbmV3IERhdGUoY3VycmVudFllYXIsIDExLCAzMSkgLy8gRGljaWVtYnJlXG5cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogYCR7aXNGaXJzdFNlbWVzdGVyID8gJ1ByaW1lcicgOiAnU2VndW5kbyd9IFNlbWVzdHJlICR7Y3VycmVudFllYXJ9YCxcbiAgICAgIHN0YXJ0RGF0ZTogc2VtZXN0ZXJTdGFydCxcbiAgICAgIGVuZERhdGU6IHNlbWVzdGVyRW5kLFxuICAgICAgaG9saWRheXM6IFtdLFxuICAgICAgZXhhbVBlcmlvZHM6IFtdXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENhbGN1bGEgY3LDqWRpdG9zIHRvdGFsZXMgKGVzdGltYWRvKVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY2FsY3VsYXRlVG90YWxDcmVkaXRzKGNsYXNzZXM6IFNjaG9vbENsYXNzW10pOiBudW1iZXIge1xuICAgIC8vIEVzdGltYWNpw7NuOiAxIGNyw6lkaXRvIHBvciBjYWRhIDUwIG1pbnV0b3MgZGUgY2xhc2Ugc2VtYW5hbFxuICAgIGNvbnN0IHRvdGFsV2Vla2x5TWludXRlcyA9IGNsYXNzZXMucmVkdWNlKChzdW0sIGNscykgPT4gc3VtICsgY2xzLmR1cmF0aW9uLCAwKVxuICAgIHJldHVybiBNYXRoLnJvdW5kKHRvdGFsV2Vla2x5TWludXRlcyAvIDUwKVxuICB9XG5cbiAgLyoqXG4gICAqIEFjdHVhbGl6YSBlbCBjb250ZXh0byBkZWwgZXN0dWRpYW50ZSBjb24gZWwgbnVldm8gaG9yYXJpb1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgdXBkYXRlU3R1ZGVudFNjaGVkdWxlKFxuICAgIHVzZXJJZDogc3RyaW5nLCBcbiAgICBzY2hlZHVsZTogSW1wb3J0ZWRTY2hlZHVsZVxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgU3R1ZGVudENvbnRleHRNYW5hZ2VyLmdldENvbnRleHQodXNlcklkKVxuICAgIGlmICghY29udGV4dCkgcmV0dXJuXG5cbiAgICAvLyBDb252ZXJ0aXIgY2xhc2VzIGEgZm9ybWF0byBkZSBjYWxlbmRhcmlvIGFjYWTDqW1pY29cbiAgICBjb25zdCBhY2FkZW1pY0NhbGVuZGFyOiBBY2FkZW1pY0NhbGVuZGFyID0ge1xuICAgICAgc2Nob29sU2NoZWR1bGU6IHNjaGVkdWxlLmNsYXNzZXMubWFwKGNscyA9PiAoe1xuICAgICAgICBzdWJqZWN0OiBjbHMuc3ViamVjdCxcbiAgICAgICAgZGF5OiBjbHMuZGF5LFxuICAgICAgICBzdGFydFRpbWU6IGNscy5zdGFydFRpbWUsXG4gICAgICAgIGVuZFRpbWU6IGNscy5lbmRUaW1lLFxuICAgICAgICBjbGFzc3Jvb206IGNscy5jbGFzc3Jvb20sXG4gICAgICAgIHRlYWNoZXI6IGNscy50ZWFjaGVyXG4gICAgICB9KSksXG4gICAgICBleGFtUGVyaW9kczogc2NoZWR1bGUudGVybS5leGFtUGVyaW9kcy5tYXAocGVyaW9kID0+ICh7XG4gICAgICAgIHN1YmplY3Q6ICdNdWx0aXBsZScsXG4gICAgICAgIGRhdGU6IHBlcmlvZC5zdGFydERhdGUsXG4gICAgICAgIHN0YXJ0VGltZTogJzA4OjAwJyxcbiAgICAgICAgZW5kVGltZTogJzE4OjAwJyxcbiAgICAgICAgdHlwZTogcGVyaW9kLnR5cGUgYXMgYW55LFxuICAgICAgICBzeWxsYWJ1czogW11cbiAgICAgIH0pKSxcbiAgICAgIGFzc2lnbm1lbnRzOiBbXSxcbiAgICAgIGhvbGlkYXlzOiBzY2hlZHVsZS50ZXJtLmhvbGlkYXlzXG4gICAgfVxuXG4gICAgYXdhaXQgU3R1ZGVudENvbnRleHRNYW5hZ2VyLnVwZGF0ZUNvbnRleHQodXNlcklkLCB7XG4gICAgICBhY2FkZW1pY0NhbGVuZGFyXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmEgaW5zaWdodHMgeSByZWNvbWVuZGFjaW9uZXMgZGVsIGhvcmFyaW9cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGFzeW5jIGdlbmVyYXRlU2NoZWR1bGVJbnNpZ2h0cyhcbiAgICB1c2VySWQ6IHN0cmluZyxcbiAgICBzY2hlZHVsZTogSW1wb3J0ZWRTY2hlZHVsZVxuICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBzdHVkeVNsb3RzID0gdGhpcy5hbmFseXplU3R1ZHlUaW1lU2xvdHMoc2NoZWR1bGUuY2xhc3NlcylcbiAgICBjb25zdCBjb25mbGljdHMgPSB0aGlzLmRldGVjdFNjaGVkdWxlQ29uZmxpY3RzKHNjaGVkdWxlLmNsYXNzZXMpXG4gICAgXG4gICAgLy8gQXF1w60gc2UgcHVlZGVuIGdlbmVyYXIgaW5zaWdodHMgYWRpY2lvbmFsZXMgY29tbzpcbiAgICAvLyAtIE1lam9yZXMgbW9tZW50b3MgcGFyYSBlc3R1ZGlhciBjYWRhIG1hdGVyaWFcbiAgICAvLyAtIFJlY29tZW5kYWNpb25lcyBkZSBob3JhcmlvcyBkZSBlc3R1ZGlvXG4gICAgLy8gLSBBbGVydGFzIHNvYnJlIGTDrWFzIG11eSBjYXJnYWRvc1xuICAgIC8vIC0gU3VnZXJlbmNpYXMgZGUgb3B0aW1pemFjacOzblxuXG4gICAgY29uc29sZS5sb2coYEdlbmVyYXRlZCAke3N0dWR5U2xvdHMubGVuZ3RofSBzdHVkeSB0aW1lIHNsb3RzIGFuZCBkZXRlY3RlZCAke2NvbmZsaWN0cy5sZW5ndGh9IGNvbmZsaWN0c2ApXG4gIH1cbn0iXSwibmFtZXMiOlsiU3R1ZGVudENvbnRleHRNYW5hZ2VyIiwiU2Nob29sU2NoZWR1bGVNYW5hZ2VyIiwiaW1wb3J0U2NoZWR1bGUiLCJ1c2VySWQiLCJzY2hlZHVsZURhdGEiLCJzb3VyY2UiLCJ2YWxpZGF0ZWRTY2hlZHVsZSIsInZhbGlkYXRlU2NoZWR1bGVEYXRhIiwiY29uZmxpY3RzIiwiZGV0ZWN0U2NoZWR1bGVDb25mbGljdHMiLCJjbGFzc2VzIiwic29tZSIsImMiLCJzZXZlcml0eSIsIkVycm9yIiwibWFwIiwiZGVzY3JpcHRpb24iLCJqb2luIiwiaW1wb3J0ZWRTY2hlZHVsZSIsImltcG9ydERhdGUiLCJEYXRlIiwidGVybSIsImNyZWF0ZURlZmF1bHRUZXJtIiwibWV0YWRhdGEiLCJzY2hvb2xOYW1lIiwiYWNhZGVtaWNZZWFyIiwiZ2V0RnVsbFllYXIiLCJ0b1N0cmluZyIsInNlbWVzdGVyIiwidG90YWxDcmVkaXRzIiwiY2FsY3VsYXRlVG90YWxDcmVkaXRzIiwidXBkYXRlU3R1ZGVudFNjaGVkdWxlIiwiZ2VuZXJhdGVTY2hlZHVsZUluc2lnaHRzIiwicGFyc2VOYXR1cmFsTGFuZ3VhZ2VTY2hlZHVsZSIsInRleHQiLCJsaW5lcyIsInNwbGl0IiwiZmlsdGVyIiwibGluZSIsInRyaW0iLCJsZW5ndGgiLCJwYXJzZWQiLCJwYXJzZVNjaGVkdWxlTGluZSIsInB1c2giLCJwYXR0ZXJucyIsInBhdHRlcm4iLCJtYXRjaCIsImNyZWF0ZUNsYXNzRnJvbU1hdGNoIiwiaWQiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwic3Vic3RyIiwiZGF5TWFwIiwiZGF5Iiwic3RhcnRUaW1lIiwiZW5kVGltZSIsInN1YmplY3QiLCJ0ZWFjaGVyIiwiY2xhc3Nyb29tIiwiaW5jbHVkZXMiLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVRpbWUiLCJkdXJhdGlvbiIsImNhbGN1bGF0ZUR1cmF0aW9uIiwibm9ybWFsaXplU3ViamVjdE5hbWUiLCJ0eXBlIiwiaW5mZXJDbGFzc1R5cGUiLCJyZWN1cnJpbmciLCJub3RlcyIsIm5vcm1hbGl6ZWQiLCJyZXBsYWNlIiwid29yZCIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJzdWJqZWN0TG93ZXIiLCJ0aW1lIiwidGltZU1hdGNoIiwiaG91cnMiLCJwYWRTdGFydCIsIm1pbnV0ZXMiLCJzdGFydCIsInRpbWVUb01pbnV0ZXMiLCJlbmQiLCJOdW1iZXIiLCJjbGFzc2VzQnlEYXkiLCJyZWR1Y2UiLCJhY2MiLCJjbHMiLCJkYXlDbGFzc2VzIiwiT2JqZWN0IiwiZW50cmllcyIsInNvcnRlZENsYXNzZXMiLCJzb3J0IiwiYSIsImIiLCJpIiwiY3VycmVudCIsIm5leHQiLCJjdXJyZW50RW5kIiwibmV4dFN0YXJ0IiwiYWZmZWN0ZWRDbGFzc2VzIiwic3VnZ2VzdGlvbnMiLCJ0b3RhbEhvdXJzIiwic3VtIiwidG9GaXhlZCIsImFuYWx5emVTdHVkeVRpbWVTbG90cyIsInN0dWR5U2xvdHMiLCJkYXlzT2ZXZWVrIiwiZ2FwcyIsImZpbmRUaW1lR2FwcyIsImRheVN0YXJ0IiwiZGF5RW5kIiwicmVjb21tZW5kZWRGb3IiLCJlbmVyZ3lfbGV2ZWwiLCJmaXJzdENsYXNzU3RhcnQiLCJtaW51dGVzVG9UaW1lIiwiZ2FwRHVyYXRpb24iLCJnYXBUeXBlIiwiY2xhc3NpZnlUaW1lR2FwIiwiZ2V0UmVjb21tZW5kZWRTdWJqZWN0cyIsImdldEVuZXJneUxldmVsIiwibGFzdENsYXNzRW5kIiwidGltZUluTWludXRlcyIsImhvdXIiLCJmbG9vciIsIm1pbnMiLCJkYXRhIiwiQXJyYXkiLCJpc0FycmF5IiwidmFsaWRhdGVkQ2xhc3NlcyIsInZhbGlkYXRlQ2xhc3MiLCJjdXJyZW50WWVhciIsImN1cnJlbnRNb250aCIsImdldE1vbnRoIiwiaXNGaXJzdFNlbWVzdGVyIiwic2VtZXN0ZXJTdGFydCIsInNlbWVzdGVyRW5kIiwibmFtZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJob2xpZGF5cyIsImV4YW1QZXJpb2RzIiwidG90YWxXZWVrbHlNaW51dGVzIiwicm91bmQiLCJzY2hlZHVsZSIsImNvbnRleHQiLCJnZXRDb250ZXh0IiwiYWNhZGVtaWNDYWxlbmRhciIsInNjaG9vbFNjaGVkdWxlIiwicGVyaW9kIiwiZGF0ZSIsInN5bGxhYnVzIiwiYXNzaWdubWVudHMiLCJ1cGRhdGVDb250ZXh0IiwiY29uc29sZSIsImxvZyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/school-schedule-manager.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/student-context.ts":
/*!************************************!*\
  !*** ./src/lib/student-context.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StudentContextManager: () => (/* binding */ StudentContextManager)\n/* harmony export */ });\n// Sistema de Contexto Persistente del Estudiante\n// Permite a la IA Tutora mantener información contextual y personalizada\n// Clase para gestionar el contexto del estudiante\nclass StudentContextManager {\n    static{\n        this.contexts = new Map();\n    }\n    static async getContext(userId) {\n        // Primero intentar obtener de memoria\n        if (this.contexts.has(userId)) {\n            return this.contexts.get(userId);\n        }\n        // Intentar cargar desde almacenamiento persistente\n        try {\n            const stored = await this.loadFromStorage(userId);\n            if (stored) {\n                this.contexts.set(userId, stored);\n                return stored;\n            }\n        } catch (error) {\n            console.error('Error loading student context:', error);\n        }\n        return null;\n    }\n    static async createDefaultContext(userId, basicInfo) {\n        const defaultContext = {\n            userId,\n            academicInfo: {\n                grade: basicInfo?.academicInfo?.grade || '10th Grade',\n                school: basicInfo?.academicInfo?.school || 'Unknown School',\n                academicYear: new Date().getFullYear().toString(),\n                specialization: basicInfo?.academicInfo?.specialization\n            },\n            learningStyle: {\n                primary: 'analytical',\n                preferences: {\n                    studyTimePreference: 'afternoon',\n                    sessionDuration: 'medium',\n                    breakFrequency: 'moderate',\n                    difficultyProgression: 'gradual'\n                }\n            },\n            subjectPerformances: [],\n            currentGoals: [],\n            schedulePreferences: {\n                preferredStudyTimes: [],\n                unavailableTimes: {\n                    recurring: [],\n                    specific: []\n                },\n                studyEnvironment: {\n                    location: 'home',\n                    requiresQuiet: true,\n                    allowsDigitalDevices: true,\n                    preferredLighting: 'moderate'\n                }\n            },\n            academicCalendar: {\n                schoolSchedule: [],\n                examPeriods: [],\n                assignments: [],\n                holidays: []\n            },\n            studyPatterns: {\n                userId,\n                patterns: {\n                    mostProductiveHours: [\n                        '14:00',\n                        '15:00',\n                        '16:00'\n                    ],\n                    averageSessionDuration: 45,\n                    preferredBreakDuration: 10,\n                    bestPerformingSubjects: [],\n                    strugglingSubjects: [],\n                    procrastinationTriggers: [],\n                    motivationalFactors: []\n                },\n                weeklyStats: {\n                    totalStudyHours: 0,\n                    subjectDistribution: {},\n                    goalCompletionRate: 0,\n                    averageFocusScore: 5\n                },\n                lastUpdated: new Date()\n            },\n            preferences: {\n                communicationStyle: 'friendly',\n                motivationLevel: 'medium',\n                feedbackPreference: 'encouraging',\n                reminderFrequency: 'moderate'\n            },\n            lastInteraction: new Date(),\n            createdAt: new Date(),\n            updatedAt: new Date()\n        };\n        this.contexts.set(userId, defaultContext);\n        await this.saveToStorage(userId, defaultContext);\n        return defaultContext;\n    }\n    static async updateContext(userId, updates) {\n        let context = await this.getContext(userId);\n        if (!context) {\n            context = await this.createDefaultContext(userId);\n        }\n        const updatedContext = {\n            ...context,\n            ...updates,\n            userId,\n            updatedAt: new Date(),\n            lastInteraction: new Date()\n        };\n        this.contexts.set(userId, updatedContext);\n        await this.saveToStorage(userId, updatedContext);\n        return updatedContext;\n    }\n    static async updateSubjectPerformance(userId, subject, performance) {\n        const context = await this.getContext(userId);\n        if (!context) return;\n        const existingIndex = context.subjectPerformances.findIndex((p)=>p.subject === subject);\n        if (existingIndex >= 0) {\n            context.subjectPerformances[existingIndex] = {\n                ...context.subjectPerformances[existingIndex],\n                ...performance,\n                subject\n            };\n        } else {\n            context.subjectPerformances.push({\n                subject,\n                averageGrade: 0,\n                difficultyLevel: 5,\n                timeSpentWeekly: 0,\n                lastStudied: new Date(),\n                strongTopics: [],\n                weakTopics: [],\n                preferredStudyMethods: [],\n                upcomingDeadlines: [],\n                ...performance\n            });\n        }\n        await this.updateContext(userId, {\n            subjectPerformances: context.subjectPerformances\n        });\n    }\n    static async addGoal(userId, goal) {\n        const context = await this.getContext(userId);\n        if (!context) throw new Error('User context not found');\n        const newGoal = {\n            ...goal,\n            id: `goal_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n            createdAt: new Date(),\n            updatedAt: new Date()\n        };\n        context.currentGoals.push(newGoal);\n        await this.updateContext(userId, {\n            currentGoals: context.currentGoals\n        });\n        return newGoal;\n    }\n    static async updateStudyPattern(userId, sessionData) {\n        const context = await this.getContext(userId);\n        if (!context) return;\n        // Update patterns based on session data\n        const patterns = context.studyPatterns.patterns;\n        const hour = sessionData.startTime.split(':')[0] + ':00';\n        if (!patterns.mostProductiveHours.includes(hour)) {\n            patterns.mostProductiveHours.push(hour);\n        }\n        // Update weekly stats\n        const stats = context.studyPatterns.weeklyStats;\n        stats.totalStudyHours += sessionData.duration / 60;\n        stats.subjectDistribution[sessionData.subject] = (stats.subjectDistribution[sessionData.subject] || 0) + sessionData.duration / 60;\n        stats.averageFocusScore = (stats.averageFocusScore + sessionData.focusScore) / 2;\n        context.studyPatterns.lastUpdated = new Date();\n        await this.updateContext(userId, {\n            studyPatterns: context.studyPatterns\n        });\n    }\n    // Storage methods (simplified for demo - in production would use database)\n    static async loadFromStorage(userId) {\n        try {\n            // In a real implementation, this would load from database\n            // For now, we'll use localStorage as a simple persistence layer\n            if (false) {}\n        } catch (error) {\n            console.error('Error loading context from storage:', error);\n        }\n        return null;\n    }\n    static async saveToStorage(userId, context) {\n        try {\n            // In a real implementation, this would save to database\n            // For now, we'll use localStorage as a simple persistence layer\n            if (false) {}\n        } catch (error) {\n            console.error('Error saving context to storage:', error);\n        }\n    }\n    // Utility methods for analysis\n    static analyzeStudentNeeds(context) {\n        const urgentTasks = [];\n        const recommendations = [];\n        const riskAreas = [];\n        const strengths = [];\n        // Analyze upcoming deadlines\n        context.subjectPerformances.forEach((subject)=>{\n            subject.upcomingDeadlines.forEach((deadline)=>{\n                const daysUntil = Math.ceil((deadline.date.getTime() - Date.now()) / (1000 * 60 * 60 * 24));\n                if (daysUntil <= 3 && deadline.preparationStatus !== 'ready') {\n                    urgentTasks.push(`${deadline.type} de ${subject.subject} en ${daysUntil} días`);\n                }\n            });\n            // Identify struggling subjects\n            if (subject.averageGrade < 70) {\n                riskAreas.push(`Rendimiento bajo en ${subject.subject} (${subject.averageGrade}%)`);\n                recommendations.push(`Programar sesiones adicionales de ${subject.subject}`);\n            }\n            // Identify strengths\n            if (subject.averageGrade > 85) {\n                strengths.push(`Excelente rendimiento en ${subject.subject}`);\n            }\n        });\n        // Analyze study patterns\n        if (context.studyPatterns.weeklyStats.totalStudyHours < 10) {\n            riskAreas.push('Pocas horas de estudio semanal');\n            recommendations.push('Incrementar tiempo de estudio gradualmente');\n        }\n        return {\n            urgentTasks,\n            recommendations,\n            riskAreas,\n            strengths\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N0dWRlbnQtY29udGV4dC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQUEsaURBQWlEO0FBQ2pELHlFQUF5RTtBQTJKekUsa0RBQWtEO0FBQzNDLE1BQU1BOzthQUNJQyxXQUF3QyxJQUFJQzs7SUFFM0QsYUFBYUMsV0FBV0MsTUFBYyxFQUFrQztRQUN0RSxzQ0FBc0M7UUFDdEMsSUFBSSxJQUFJLENBQUNILFFBQVEsQ0FBQ0ksR0FBRyxDQUFDRCxTQUFTO1lBQzdCLE9BQU8sSUFBSSxDQUFDSCxRQUFRLENBQUNLLEdBQUcsQ0FBQ0Y7UUFDM0I7UUFFQSxtREFBbUQ7UUFDbkQsSUFBSTtZQUNGLE1BQU1HLFNBQVMsTUFBTSxJQUFJLENBQUNDLGVBQWUsQ0FBQ0o7WUFDMUMsSUFBSUcsUUFBUTtnQkFDVixJQUFJLENBQUNOLFFBQVEsQ0FBQ1EsR0FBRyxDQUFDTCxRQUFRRztnQkFDMUIsT0FBT0E7WUFDVDtRQUNGLEVBQUUsT0FBT0csT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsa0NBQWtDQTtRQUNsRDtRQUVBLE9BQU87SUFDVDtJQUVBLGFBQWFFLHFCQUFxQlIsTUFBYyxFQUFFUyxTQUFtQyxFQUEyQjtRQUM5RyxNQUFNQyxpQkFBaUM7WUFDckNWO1lBQ0FXLGNBQWM7Z0JBQ1pDLE9BQU9ILFdBQVdFLGNBQWNDLFNBQVM7Z0JBQ3pDQyxRQUFRSixXQUFXRSxjQUFjRSxVQUFVO2dCQUMzQ0MsY0FBYyxJQUFJQyxPQUFPQyxXQUFXLEdBQUdDLFFBQVE7Z0JBQy9DQyxnQkFBZ0JULFdBQVdFLGNBQWNPO1lBQzNDO1lBQ0FDLGVBQWU7Z0JBQ2JDLFNBQVM7Z0JBQ1RDLGFBQWE7b0JBQ1hDLHFCQUFxQjtvQkFDckJDLGlCQUFpQjtvQkFDakJDLGdCQUFnQjtvQkFDaEJDLHVCQUF1QjtnQkFDekI7WUFDRjtZQUNBQyxxQkFBcUIsRUFBRTtZQUN2QkMsY0FBYyxFQUFFO1lBQ2hCQyxxQkFBcUI7Z0JBQ25CQyxxQkFBcUIsRUFBRTtnQkFDdkJDLGtCQUFrQjtvQkFBRUMsV0FBVyxFQUFFO29CQUFFQyxVQUFVLEVBQUU7Z0JBQUM7Z0JBQ2hEQyxrQkFBa0I7b0JBQ2hCQyxVQUFVO29CQUNWQyxlQUFlO29CQUNmQyxzQkFBc0I7b0JBQ3RCQyxtQkFBbUI7Z0JBQ3JCO1lBQ0Y7WUFDQUMsa0JBQWtCO2dCQUNoQkMsZ0JBQWdCLEVBQUU7Z0JBQ2xCQyxhQUFhLEVBQUU7Z0JBQ2ZDLGFBQWEsRUFBRTtnQkFDZkMsVUFBVSxFQUFFO1lBQ2Q7WUFDQUMsZUFBZTtnQkFDYjNDO2dCQUNBNEMsVUFBVTtvQkFDUkMscUJBQXFCO3dCQUFDO3dCQUFTO3dCQUFTO3FCQUFRO29CQUNoREMsd0JBQXdCO29CQUN4QkMsd0JBQXdCO29CQUN4QkMsd0JBQXdCLEVBQUU7b0JBQzFCQyxvQkFBb0IsRUFBRTtvQkFDdEJDLHlCQUF5QixFQUFFO29CQUMzQkMscUJBQXFCLEVBQUU7Z0JBQ3pCO2dCQUNBQyxhQUFhO29CQUNYQyxpQkFBaUI7b0JBQ2pCQyxxQkFBcUIsQ0FBQztvQkFDdEJDLG9CQUFvQjtvQkFDcEJDLG1CQUFtQjtnQkFDckI7Z0JBQ0FDLGFBQWEsSUFBSTFDO1lBQ25CO1lBQ0FNLGFBQWE7Z0JBQ1hxQyxvQkFBb0I7Z0JBQ3BCQyxpQkFBaUI7Z0JBQ2pCQyxvQkFBb0I7Z0JBQ3BCQyxtQkFBbUI7WUFDckI7WUFDQUMsaUJBQWlCLElBQUkvQztZQUNyQmdELFdBQVcsSUFBSWhEO1lBQ2ZpRCxXQUFXLElBQUlqRDtRQUNqQjtRQUVBLElBQUksQ0FBQ2xCLFFBQVEsQ0FBQ1EsR0FBRyxDQUFDTCxRQUFRVTtRQUMxQixNQUFNLElBQUksQ0FBQ3VELGFBQWEsQ0FBQ2pFLFFBQVFVO1FBQ2pDLE9BQU9BO0lBQ1Q7SUFFQSxhQUFhd0QsY0FBY2xFLE1BQWMsRUFBRW1FLE9BQWdDLEVBQTJCO1FBQ3BHLElBQUlDLFVBQVUsTUFBTSxJQUFJLENBQUNyRSxVQUFVLENBQUNDO1FBRXBDLElBQUksQ0FBQ29FLFNBQVM7WUFDWkEsVUFBVSxNQUFNLElBQUksQ0FBQzVELG9CQUFvQixDQUFDUjtRQUM1QztRQUVBLE1BQU1xRSxpQkFBaUM7WUFDckMsR0FBR0QsT0FBTztZQUNWLEdBQUdELE9BQU87WUFDVm5FO1lBQ0FnRSxXQUFXLElBQUlqRDtZQUNmK0MsaUJBQWlCLElBQUkvQztRQUN2QjtRQUVBLElBQUksQ0FBQ2xCLFFBQVEsQ0FBQ1EsR0FBRyxDQUFDTCxRQUFRcUU7UUFDMUIsTUFBTSxJQUFJLENBQUNKLGFBQWEsQ0FBQ2pFLFFBQVFxRTtRQUNqQyxPQUFPQTtJQUNUO0lBRUEsYUFBYUMseUJBQXlCdEUsTUFBYyxFQUFFdUUsT0FBZSxFQUFFQyxXQUF3QyxFQUFpQjtRQUM5SCxNQUFNSixVQUFVLE1BQU0sSUFBSSxDQUFDckUsVUFBVSxDQUFDQztRQUN0QyxJQUFJLENBQUNvRSxTQUFTO1FBRWQsTUFBTUssZ0JBQWdCTCxRQUFRMUMsbUJBQW1CLENBQUNnRCxTQUFTLENBQUNDLENBQUFBLElBQUtBLEVBQUVKLE9BQU8sS0FBS0E7UUFFL0UsSUFBSUUsaUJBQWlCLEdBQUc7WUFDdEJMLFFBQVExQyxtQkFBbUIsQ0FBQytDLGNBQWMsR0FBRztnQkFDM0MsR0FBR0wsUUFBUTFDLG1CQUFtQixDQUFDK0MsY0FBYztnQkFDN0MsR0FBR0QsV0FBVztnQkFDZEQ7WUFDRjtRQUNGLE9BQU87WUFDTEgsUUFBUTFDLG1CQUFtQixDQUFDa0QsSUFBSSxDQUFDO2dCQUMvQkw7Z0JBQ0FNLGNBQWM7Z0JBQ2RDLGlCQUFpQjtnQkFDakJDLGlCQUFpQjtnQkFDakJDLGFBQWEsSUFBSWpFO2dCQUNqQmtFLGNBQWMsRUFBRTtnQkFDaEJDLFlBQVksRUFBRTtnQkFDZEMsdUJBQXVCLEVBQUU7Z0JBQ3pCQyxtQkFBbUIsRUFBRTtnQkFDckIsR0FBR1osV0FBVztZQUNoQjtRQUNGO1FBRUEsTUFBTSxJQUFJLENBQUNOLGFBQWEsQ0FBQ2xFLFFBQVE7WUFBRTBCLHFCQUFxQjBDLFFBQVExQyxtQkFBbUI7UUFBQztJQUN0RjtJQUVBLGFBQWEyRCxRQUFRckYsTUFBYyxFQUFFc0YsSUFBdUQsRUFBc0I7UUFDaEgsTUFBTWxCLFVBQVUsTUFBTSxJQUFJLENBQUNyRSxVQUFVLENBQUNDO1FBQ3RDLElBQUksQ0FBQ29FLFNBQVMsTUFBTSxJQUFJbUIsTUFBTTtRQUU5QixNQUFNQyxVQUFxQjtZQUN6QixHQUFHRixJQUFJO1lBQ1BHLElBQUksQ0FBQyxLQUFLLEVBQUUxRSxLQUFLMkUsR0FBRyxHQUFHLENBQUMsRUFBRUMsS0FBS0MsTUFBTSxHQUFHM0UsUUFBUSxDQUFDLElBQUk0RSxNQUFNLENBQUMsR0FBRyxJQUFJO1lBQ25FOUIsV0FBVyxJQUFJaEQ7WUFDZmlELFdBQVcsSUFBSWpEO1FBQ2pCO1FBRUFxRCxRQUFRekMsWUFBWSxDQUFDaUQsSUFBSSxDQUFDWTtRQUMxQixNQUFNLElBQUksQ0FBQ3RCLGFBQWEsQ0FBQ2xFLFFBQVE7WUFBRTJCLGNBQWN5QyxRQUFRekMsWUFBWTtRQUFDO1FBQ3RFLE9BQU82RDtJQUNUO0lBRUEsYUFBYU0sbUJBQW1COUYsTUFBYyxFQUFFK0YsV0FLL0MsRUFBaUI7UUFDaEIsTUFBTTNCLFVBQVUsTUFBTSxJQUFJLENBQUNyRSxVQUFVLENBQUNDO1FBQ3RDLElBQUksQ0FBQ29FLFNBQVM7UUFFZCx3Q0FBd0M7UUFDeEMsTUFBTXhCLFdBQVd3QixRQUFRekIsYUFBYSxDQUFDQyxRQUFRO1FBQy9DLE1BQU1vRCxPQUFPRCxZQUFZRSxTQUFTLENBQUNDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHO1FBRW5ELElBQUksQ0FBQ3RELFNBQVNDLG1CQUFtQixDQUFDc0QsUUFBUSxDQUFDSCxPQUFPO1lBQ2hEcEQsU0FBU0MsbUJBQW1CLENBQUMrQixJQUFJLENBQUNvQjtRQUNwQztRQUVBLHNCQUFzQjtRQUN0QixNQUFNSSxRQUFRaEMsUUFBUXpCLGFBQWEsQ0FBQ1MsV0FBVztRQUMvQ2dELE1BQU0vQyxlQUFlLElBQUkwQyxZQUFZTSxRQUFRLEdBQUc7UUFDaERELE1BQU05QyxtQkFBbUIsQ0FBQ3lDLFlBQVl4QixPQUFPLENBQUMsR0FDNUMsQ0FBQzZCLE1BQU05QyxtQkFBbUIsQ0FBQ3lDLFlBQVl4QixPQUFPLENBQUMsSUFBSSxLQUFLd0IsWUFBWU0sUUFBUSxHQUFHO1FBRWpGRCxNQUFNNUMsaUJBQWlCLEdBQ3JCLENBQUM0QyxNQUFNNUMsaUJBQWlCLEdBQUd1QyxZQUFZTyxVQUFVLElBQUk7UUFFdkRsQyxRQUFRekIsYUFBYSxDQUFDYyxXQUFXLEdBQUcsSUFBSTFDO1FBQ3hDLE1BQU0sSUFBSSxDQUFDbUQsYUFBYSxDQUFDbEUsUUFBUTtZQUFFMkMsZUFBZXlCLFFBQVF6QixhQUFhO1FBQUM7SUFDMUU7SUFFQSwyRUFBMkU7SUFDM0UsYUFBcUJ2QyxnQkFBZ0JKLE1BQWMsRUFBa0M7UUFDbkYsSUFBSTtZQUNGLDBEQUEwRDtZQUMxRCxnRUFBZ0U7WUFDaEUsSUFBSSxLQUE2QixFQUFFLEVBVWxDO1FBQ0gsRUFBRSxPQUFPTSxPQUFPO1lBQ2RDLFFBQVFELEtBQUssQ0FBQyx1Q0FBdUNBO1FBQ3ZEO1FBQ0EsT0FBTztJQUNUO0lBRUEsYUFBcUIyRCxjQUFjakUsTUFBYyxFQUFFb0UsT0FBdUIsRUFBaUI7UUFDekYsSUFBSTtZQUNGLHdEQUF3RDtZQUN4RCxnRUFBZ0U7WUFDaEUsSUFBSSxLQUE2QixFQUFFLEVBRWxDO1FBQ0gsRUFBRSxPQUFPOUQsT0FBTztZQUNkQyxRQUFRRCxLQUFLLENBQUMsb0NBQW9DQTtRQUNwRDtJQUNGO0lBRUEsK0JBQStCO0lBQy9CLE9BQU93RyxvQkFBb0IxQyxPQUF1QixFQUtoRDtRQUNBLE1BQU0yQyxjQUF3QixFQUFFO1FBQ2hDLE1BQU1DLGtCQUE0QixFQUFFO1FBQ3BDLE1BQU1DLFlBQXNCLEVBQUU7UUFDOUIsTUFBTUMsWUFBc0IsRUFBRTtRQUU5Qiw2QkFBNkI7UUFDN0I5QyxRQUFRMUMsbUJBQW1CLENBQUN5RixPQUFPLENBQUM1QyxDQUFBQTtZQUNsQ0EsUUFBUWEsaUJBQWlCLENBQUMrQixPQUFPLENBQUNDLENBQUFBO2dCQUNoQyxNQUFNQyxZQUFZMUIsS0FBSzJCLElBQUksQ0FBQyxDQUFDRixTQUFTRyxJQUFJLENBQUNDLE9BQU8sS0FBS3pHLEtBQUsyRSxHQUFHLEVBQUMsSUFBTSxRQUFPLEtBQUssS0FBSyxFQUFDO2dCQUN4RixJQUFJMkIsYUFBYSxLQUFLRCxTQUFTSyxpQkFBaUIsS0FBSyxTQUFTO29CQUM1RFYsWUFBWW5DLElBQUksQ0FBQyxHQUFHd0MsU0FBU00sSUFBSSxDQUFDLElBQUksRUFBRW5ELFFBQVFBLE9BQU8sQ0FBQyxJQUFJLEVBQUU4QyxVQUFVLEtBQUssQ0FBQztnQkFDaEY7WUFDRjtZQUVBLCtCQUErQjtZQUMvQixJQUFJOUMsUUFBUU0sWUFBWSxHQUFHLElBQUk7Z0JBQzdCb0MsVUFBVXJDLElBQUksQ0FBQyxDQUFDLG9CQUFvQixFQUFFTCxRQUFRQSxPQUFPLENBQUMsRUFBRSxFQUFFQSxRQUFRTSxZQUFZLENBQUMsRUFBRSxDQUFDO2dCQUNsRm1DLGdCQUFnQnBDLElBQUksQ0FBQyxDQUFDLGtDQUFrQyxFQUFFTCxRQUFRQSxPQUFPLEVBQUU7WUFDN0U7WUFFQSxxQkFBcUI7WUFDckIsSUFBSUEsUUFBUU0sWUFBWSxHQUFHLElBQUk7Z0JBQzdCcUMsVUFBVXRDLElBQUksQ0FBQyxDQUFDLHlCQUF5QixFQUFFTCxRQUFRQSxPQUFPLEVBQUU7WUFDOUQ7UUFDRjtRQUVBLHlCQUF5QjtRQUN6QixJQUFJSCxRQUFRekIsYUFBYSxDQUFDUyxXQUFXLENBQUNDLGVBQWUsR0FBRyxJQUFJO1lBQzFENEQsVUFBVXJDLElBQUksQ0FBQztZQUNmb0MsZ0JBQWdCcEMsSUFBSSxDQUFDO1FBQ3ZCO1FBRUEsT0FBTztZQUFFbUM7WUFBYUM7WUFBaUJDO1lBQVdDO1FBQVU7SUFDOUQ7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9zdHVkZW50LWNvbnRleHQudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gU2lzdGVtYSBkZSBDb250ZXh0byBQZXJzaXN0ZW50ZSBkZWwgRXN0dWRpYW50ZVxuLy8gUGVybWl0ZSBhIGxhIElBIFR1dG9yYSBtYW50ZW5lciBpbmZvcm1hY2nDs24gY29udGV4dHVhbCB5IHBlcnNvbmFsaXphZGFcblxuZXhwb3J0IGludGVyZmFjZSBMZWFybmluZ1N0eWxlIHtcbiAgcHJpbWFyeTogJ3Zpc3VhbCcgfCAnYXVkaXRvcnknIHwgJ2tpbmVzdGhldGljJyB8ICdhbmFseXRpY2FsJ1xuICBzZWNvbmRhcnk/OiAndmlzdWFsJyB8ICdhdWRpdG9yeScgfCAna2luZXN0aGV0aWMnIHwgJ2FuYWx5dGljYWwnXG4gIHByZWZlcmVuY2VzOiB7XG4gICAgc3R1ZHlUaW1lUHJlZmVyZW5jZTogJ21vcm5pbmcnIHwgJ2FmdGVybm9vbicgfCAnZXZlbmluZycgfCAnbmlnaHQnXG4gICAgc2Vzc2lvbkR1cmF0aW9uOiAnc2hvcnQnIHwgJ21lZGl1bScgfCAnbG9uZycgLy8gMjVtaW4sIDQ1bWluLCA5MG1pblxuICAgIGJyZWFrRnJlcXVlbmN5OiAnZnJlcXVlbnQnIHwgJ21vZGVyYXRlJyB8ICdtaW5pbWFsJ1xuICAgIGRpZmZpY3VsdHlQcm9ncmVzc2lvbjogJ2dyYWR1YWwnIHwgJ21vZGVyYXRlJyB8ICdzdGVlcCdcbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN1YmplY3RQZXJmb3JtYW5jZSB7XG4gIHN1YmplY3Q6IHN0cmluZ1xuICBhdmVyYWdlR3JhZGU6IG51bWJlciAvLyAwLTEwMFxuICBkaWZmaWN1bHR5TGV2ZWw6IG51bWJlciAvLyAxLTEwXG4gIHRpbWVTcGVudFdlZWtseTogbnVtYmVyIC8vIGhvdXJzXG4gIGxhc3RTdHVkaWVkOiBEYXRlXG4gIHN0cm9uZ1RvcGljczogc3RyaW5nW11cbiAgd2Vha1RvcGljczogc3RyaW5nW11cbiAgcHJlZmVycmVkU3R1ZHlNZXRob2RzOiBzdHJpbmdbXVxuICB1cGNvbWluZ0RlYWRsaW5lczoge1xuICAgIHR5cGU6ICdleGFtJyB8ICdhc3NpZ25tZW50JyB8ICdwcm9qZWN0J1xuICAgIGRhdGU6IERhdGVcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gICAgcHJlcGFyYXRpb25TdGF0dXM6ICdub3Rfc3RhcnRlZCcgfCAnaW5fcHJvZ3Jlc3MnIHwgJ2FsbW9zdF9yZWFkeScgfCAncmVhZHknXG4gIH1bXVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0dWR5R29hbCB7XG4gIGlkOiBzdHJpbmdcbiAgdGl0bGU6IHN0cmluZ1xuICBzdWJqZWN0Pzogc3RyaW5nXG4gIHRhcmdldERhdGU6IERhdGVcbiAgcHJpb3JpdHk6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCcgfCAndXJnZW50J1xuICBwcm9ncmVzczogbnVtYmVyIC8vIDAtMTAwXG4gIG1pbGVzdG9uZXM6IHtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gICAgY29tcGxldGVkOiBib29sZWFuXG4gICAgZHVlRGF0ZT86IERhdGVcbiAgfVtdXG4gIGNyZWF0ZWRBdDogRGF0ZVxuICB1cGRhdGVkQXQ6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTY2hlZHVsZVByZWZlcmVuY2Uge1xuICBwcmVmZXJyZWRTdHVkeVRpbWVzOiB7XG4gICAgZGF5OiAnbW9uZGF5JyB8ICd0dWVzZGF5JyB8ICd3ZWRuZXNkYXknIHwgJ3RodXJzZGF5JyB8ICdmcmlkYXknIHwgJ3NhdHVyZGF5JyB8ICdzdW5kYXknXG4gICAgdGltZVNsb3RzOiB7XG4gICAgICBzdGFydDogc3RyaW5nIC8vIFwiMTQ6MDBcIlxuICAgICAgZW5kOiBzdHJpbmcgICAvLyBcIjE2OjAwXCJcbiAgICAgIHByaW9yaXR5OiAnaGlnaCcgfCAnbWVkaXVtJyB8ICdsb3cnXG4gICAgfVtdXG4gIH1bXVxuICB1bmF2YWlsYWJsZVRpbWVzOiB7XG4gICAgcmVjdXJyaW5nOiB7XG4gICAgICBkYXk6IHN0cmluZ1xuICAgICAgc3RhcnQ6IHN0cmluZ1xuICAgICAgZW5kOiBzdHJpbmdcbiAgICAgIHJlYXNvbjogc3RyaW5nXG4gICAgfVtdXG4gICAgc3BlY2lmaWM6IHtcbiAgICAgIGRhdGU6IERhdGVcbiAgICAgIHN0YXJ0OiBzdHJpbmdcbiAgICAgIGVuZDogc3RyaW5nXG4gICAgICByZWFzb246IHN0cmluZ1xuICAgIH1bXVxuICB9XG4gIHN0dWR5RW52aXJvbm1lbnQ6IHtcbiAgICBsb2NhdGlvbjogJ2hvbWUnIHwgJ2xpYnJhcnknIHwgJ2NhZmUnIHwgJ3NjaG9vbCcgfCAnb3RoZXInXG4gICAgcmVxdWlyZXNRdWlldDogYm9vbGVhblxuICAgIGFsbG93c0RpZ2l0YWxEZXZpY2VzOiBib29sZWFuXG4gICAgcHJlZmVycmVkTGlnaHRpbmc6ICdicmlnaHQnIHwgJ21vZGVyYXRlJyB8ICdkaW0nXG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBBY2FkZW1pY0NhbGVuZGFyIHtcbiAgc2Nob29sU2NoZWR1bGU6IHtcbiAgICBzdWJqZWN0OiBzdHJpbmdcbiAgICBkYXk6IHN0cmluZ1xuICAgIHN0YXJ0VGltZTogc3RyaW5nXG4gICAgZW5kVGltZTogc3RyaW5nXG4gICAgY2xhc3Nyb29tPzogc3RyaW5nXG4gICAgdGVhY2hlcj86IHN0cmluZ1xuICB9W11cbiAgZXhhbVBlcmlvZHM6IHtcbiAgICBzdWJqZWN0OiBzdHJpbmdcbiAgICBkYXRlOiBEYXRlXG4gICAgc3RhcnRUaW1lOiBzdHJpbmdcbiAgICBlbmRUaW1lOiBzdHJpbmdcbiAgICB0eXBlOiAncGFyY2lhbCcgfCAnZmluYWwnIHwgJ3F1aXonIHwgJ29yYWwnXG4gICAgc3lsbGFidXM/OiBzdHJpbmdbXVxuICB9W11cbiAgYXNzaWdubWVudHM6IHtcbiAgICBpZDogc3RyaW5nXG4gICAgc3ViamVjdDogc3RyaW5nXG4gICAgdGl0bGU6IHN0cmluZ1xuICAgIGR1ZURhdGU6IERhdGVcbiAgICB0eXBlOiAnaG9tZXdvcmsnIHwgJ3Byb2plY3QnIHwgJ2Vzc2F5JyB8ICdwcmVzZW50YXRpb24nXG4gICAgZXN0aW1hdGVkSG91cnM6IG51bWJlclxuICAgIHN0YXR1czogJ3BlbmRpbmcnIHwgJ2luX3Byb2dyZXNzJyB8ICdzdWJtaXR0ZWQnXG4gIH1bXVxuICBob2xpZGF5czoge1xuICAgIG5hbWU6IHN0cmluZ1xuICAgIHN0YXJ0RGF0ZTogRGF0ZVxuICAgIGVuZERhdGU6IERhdGVcbiAgfVtdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3R1ZHlQYXR0ZXJuIHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgcGF0dGVybnM6IHtcbiAgICBtb3N0UHJvZHVjdGl2ZUhvdXJzOiBzdHJpbmdbXSAvLyBbXCIxNDowMFwiLCBcIjE1OjAwXCIsIFwiMTY6MDBcIl1cbiAgICBhdmVyYWdlU2Vzc2lvbkR1cmF0aW9uOiBudW1iZXIgLy8gbWludXRlc1xuICAgIHByZWZlcnJlZEJyZWFrRHVyYXRpb246IG51bWJlciAvLyBtaW51dGVzXG4gICAgYmVzdFBlcmZvcm1pbmdTdWJqZWN0czogc3RyaW5nW11cbiAgICBzdHJ1Z2dsaW5nU3ViamVjdHM6IHN0cmluZ1tdXG4gICAgcHJvY3Jhc3RpbmF0aW9uVHJpZ2dlcnM6IHN0cmluZ1tdXG4gICAgbW90aXZhdGlvbmFsRmFjdG9yczogc3RyaW5nW11cbiAgfVxuICB3ZWVrbHlTdGF0czoge1xuICAgIHRvdGFsU3R1ZHlIb3VyczogbnVtYmVyXG4gICAgc3ViamVjdERpc3RyaWJ1dGlvbjogeyBbc3ViamVjdDogc3RyaW5nXTogbnVtYmVyIH1cbiAgICBnb2FsQ29tcGxldGlvblJhdGU6IG51bWJlclxuICAgIGF2ZXJhZ2VGb2N1c1Njb3JlOiBudW1iZXIgLy8gMS0xMFxuICB9XG4gIGxhc3RVcGRhdGVkOiBEYXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3R1ZGVudENvbnRleHQge1xuICB1c2VySWQ6IHN0cmluZ1xuICBhY2FkZW1pY0luZm86IHtcbiAgICBncmFkZTogc3RyaW5nXG4gICAgc2Nob29sOiBzdHJpbmdcbiAgICBhY2FkZW1pY1llYXI6IHN0cmluZ1xuICAgIHNwZWNpYWxpemF0aW9uPzogc3RyaW5nXG4gIH1cbiAgbGVhcm5pbmdTdHlsZTogTGVhcm5pbmdTdHlsZVxuICBzdWJqZWN0UGVyZm9ybWFuY2VzOiBTdWJqZWN0UGVyZm9ybWFuY2VbXVxuICBjdXJyZW50R29hbHM6IFN0dWR5R29hbFtdXG4gIHNjaGVkdWxlUHJlZmVyZW5jZXM6IFNjaGVkdWxlUHJlZmVyZW5jZVxuICBhY2FkZW1pY0NhbGVuZGFyOiBBY2FkZW1pY0NhbGVuZGFyXG4gIHN0dWR5UGF0dGVybnM6IFN0dWR5UGF0dGVyblxuICBwcmVmZXJlbmNlczoge1xuICAgIGNvbW11bmljYXRpb25TdHlsZTogJ2Zvcm1hbCcgfCAnY2FzdWFsJyB8ICdmcmllbmRseSdcbiAgICBtb3RpdmF0aW9uTGV2ZWw6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgICBmZWVkYmFja1ByZWZlcmVuY2U6ICdkaXJlY3QnIHwgJ2dlbnRsZScgfCAnZW5jb3VyYWdpbmcnXG4gICAgcmVtaW5kZXJGcmVxdWVuY3k6ICdtaW5pbWFsJyB8ICdtb2RlcmF0ZScgfCAnZnJlcXVlbnQnXG4gIH1cbiAgbGFzdEludGVyYWN0aW9uOiBEYXRlXG4gIGNyZWF0ZWRBdDogRGF0ZVxuICB1cGRhdGVkQXQ6IERhdGVcbn1cblxuLy8gQ2xhc2UgcGFyYSBnZXN0aW9uYXIgZWwgY29udGV4dG8gZGVsIGVzdHVkaWFudGVcbmV4cG9ydCBjbGFzcyBTdHVkZW50Q29udGV4dE1hbmFnZXIge1xuICBwcml2YXRlIHN0YXRpYyBjb250ZXh0czogTWFwPHN0cmluZywgU3R1ZGVudENvbnRleHQ+ID0gbmV3IE1hcCgpXG5cbiAgc3RhdGljIGFzeW5jIGdldENvbnRleHQodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFN0dWRlbnRDb250ZXh0IHwgbnVsbD4ge1xuICAgIC8vIFByaW1lcm8gaW50ZW50YXIgb2J0ZW5lciBkZSBtZW1vcmlhXG4gICAgaWYgKHRoaXMuY29udGV4dHMuaGFzKHVzZXJJZCkpIHtcbiAgICAgIHJldHVybiB0aGlzLmNvbnRleHRzLmdldCh1c2VySWQpIVxuICAgIH1cblxuICAgIC8vIEludGVudGFyIGNhcmdhciBkZXNkZSBhbG1hY2VuYW1pZW50byBwZXJzaXN0ZW50ZVxuICAgIHRyeSB7XG4gICAgICBjb25zdCBzdG9yZWQgPSBhd2FpdCB0aGlzLmxvYWRGcm9tU3RvcmFnZSh1c2VySWQpXG4gICAgICBpZiAoc3RvcmVkKSB7XG4gICAgICAgIHRoaXMuY29udGV4dHMuc2V0KHVzZXJJZCwgc3RvcmVkKVxuICAgICAgICByZXR1cm4gc3RvcmVkXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgc3R1ZGVudCBjb250ZXh0OicsIGVycm9yKVxuICAgIH1cblxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBzdGF0aWMgYXN5bmMgY3JlYXRlRGVmYXVsdENvbnRleHQodXNlcklkOiBzdHJpbmcsIGJhc2ljSW5mbz86IFBhcnRpYWw8U3R1ZGVudENvbnRleHQ+KTogUHJvbWlzZTxTdHVkZW50Q29udGV4dD4ge1xuICAgIGNvbnN0IGRlZmF1bHRDb250ZXh0OiBTdHVkZW50Q29udGV4dCA9IHtcbiAgICAgIHVzZXJJZCxcbiAgICAgIGFjYWRlbWljSW5mbzoge1xuICAgICAgICBncmFkZTogYmFzaWNJbmZvPy5hY2FkZW1pY0luZm8/LmdyYWRlIHx8ICcxMHRoIEdyYWRlJyxcbiAgICAgICAgc2Nob29sOiBiYXNpY0luZm8/LmFjYWRlbWljSW5mbz8uc2Nob29sIHx8ICdVbmtub3duIFNjaG9vbCcsXG4gICAgICAgIGFjYWRlbWljWWVhcjogbmV3IERhdGUoKS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCksXG4gICAgICAgIHNwZWNpYWxpemF0aW9uOiBiYXNpY0luZm8/LmFjYWRlbWljSW5mbz8uc3BlY2lhbGl6YXRpb25cbiAgICAgIH0sXG4gICAgICBsZWFybmluZ1N0eWxlOiB7XG4gICAgICAgIHByaW1hcnk6ICdhbmFseXRpY2FsJyxcbiAgICAgICAgcHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICBzdHVkeVRpbWVQcmVmZXJlbmNlOiAnYWZ0ZXJub29uJyxcbiAgICAgICAgICBzZXNzaW9uRHVyYXRpb246ICdtZWRpdW0nLFxuICAgICAgICAgIGJyZWFrRnJlcXVlbmN5OiAnbW9kZXJhdGUnLFxuICAgICAgICAgIGRpZmZpY3VsdHlQcm9ncmVzc2lvbjogJ2dyYWR1YWwnXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzdWJqZWN0UGVyZm9ybWFuY2VzOiBbXSxcbiAgICAgIGN1cnJlbnRHb2FsczogW10sXG4gICAgICBzY2hlZHVsZVByZWZlcmVuY2VzOiB7XG4gICAgICAgIHByZWZlcnJlZFN0dWR5VGltZXM6IFtdLFxuICAgICAgICB1bmF2YWlsYWJsZVRpbWVzOiB7IHJlY3VycmluZzogW10sIHNwZWNpZmljOiBbXSB9LFxuICAgICAgICBzdHVkeUVudmlyb25tZW50OiB7XG4gICAgICAgICAgbG9jYXRpb246ICdob21lJyxcbiAgICAgICAgICByZXF1aXJlc1F1aWV0OiB0cnVlLFxuICAgICAgICAgIGFsbG93c0RpZ2l0YWxEZXZpY2VzOiB0cnVlLFxuICAgICAgICAgIHByZWZlcnJlZExpZ2h0aW5nOiAnbW9kZXJhdGUnXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBhY2FkZW1pY0NhbGVuZGFyOiB7XG4gICAgICAgIHNjaG9vbFNjaGVkdWxlOiBbXSxcbiAgICAgICAgZXhhbVBlcmlvZHM6IFtdLFxuICAgICAgICBhc3NpZ25tZW50czogW10sXG4gICAgICAgIGhvbGlkYXlzOiBbXVxuICAgICAgfSxcbiAgICAgIHN0dWR5UGF0dGVybnM6IHtcbiAgICAgICAgdXNlcklkLFxuICAgICAgICBwYXR0ZXJuczoge1xuICAgICAgICAgIG1vc3RQcm9kdWN0aXZlSG91cnM6IFsnMTQ6MDAnLCAnMTU6MDAnLCAnMTY6MDAnXSxcbiAgICAgICAgICBhdmVyYWdlU2Vzc2lvbkR1cmF0aW9uOiA0NSxcbiAgICAgICAgICBwcmVmZXJyZWRCcmVha0R1cmF0aW9uOiAxMCxcbiAgICAgICAgICBiZXN0UGVyZm9ybWluZ1N1YmplY3RzOiBbXSxcbiAgICAgICAgICBzdHJ1Z2dsaW5nU3ViamVjdHM6IFtdLFxuICAgICAgICAgIHByb2NyYXN0aW5hdGlvblRyaWdnZXJzOiBbXSxcbiAgICAgICAgICBtb3RpdmF0aW9uYWxGYWN0b3JzOiBbXVxuICAgICAgICB9LFxuICAgICAgICB3ZWVrbHlTdGF0czoge1xuICAgICAgICAgIHRvdGFsU3R1ZHlIb3VyczogMCxcbiAgICAgICAgICBzdWJqZWN0RGlzdHJpYnV0aW9uOiB7fSxcbiAgICAgICAgICBnb2FsQ29tcGxldGlvblJhdGU6IDAsXG4gICAgICAgICAgYXZlcmFnZUZvY3VzU2NvcmU6IDVcbiAgICAgICAgfSxcbiAgICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKClcbiAgICAgIH0sXG4gICAgICBwcmVmZXJlbmNlczoge1xuICAgICAgICBjb21tdW5pY2F0aW9uU3R5bGU6ICdmcmllbmRseScsXG4gICAgICAgIG1vdGl2YXRpb25MZXZlbDogJ21lZGl1bScsXG4gICAgICAgIGZlZWRiYWNrUHJlZmVyZW5jZTogJ2VuY291cmFnaW5nJyxcbiAgICAgICAgcmVtaW5kZXJGcmVxdWVuY3k6ICdtb2RlcmF0ZSdcbiAgICAgIH0sXG4gICAgICBsYXN0SW50ZXJhY3Rpb246IG5ldyBEYXRlKCksXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICB9XG5cbiAgICB0aGlzLmNvbnRleHRzLnNldCh1c2VySWQsIGRlZmF1bHRDb250ZXh0KVxuICAgIGF3YWl0IHRoaXMuc2F2ZVRvU3RvcmFnZSh1c2VySWQsIGRlZmF1bHRDb250ZXh0KVxuICAgIHJldHVybiBkZWZhdWx0Q29udGV4dFxuICB9XG5cbiAgc3RhdGljIGFzeW5jIHVwZGF0ZUNvbnRleHQodXNlcklkOiBzdHJpbmcsIHVwZGF0ZXM6IFBhcnRpYWw8U3R1ZGVudENvbnRleHQ+KTogUHJvbWlzZTxTdHVkZW50Q29udGV4dD4ge1xuICAgIGxldCBjb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRDb250ZXh0KHVzZXJJZClcbiAgICBcbiAgICBpZiAoIWNvbnRleHQpIHtcbiAgICAgIGNvbnRleHQgPSBhd2FpdCB0aGlzLmNyZWF0ZURlZmF1bHRDb250ZXh0KHVzZXJJZClcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVkQ29udGV4dDogU3R1ZGVudENvbnRleHQgPSB7XG4gICAgICAuLi5jb250ZXh0LFxuICAgICAgLi4udXBkYXRlcyxcbiAgICAgIHVzZXJJZCwgLy8gRW5zdXJlIHVzZXJJZCBpcyBwcmVzZXJ2ZWRcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIGxhc3RJbnRlcmFjdGlvbjogbmV3IERhdGUoKVxuICAgIH1cblxuICAgIHRoaXMuY29udGV4dHMuc2V0KHVzZXJJZCwgdXBkYXRlZENvbnRleHQpXG4gICAgYXdhaXQgdGhpcy5zYXZlVG9TdG9yYWdlKHVzZXJJZCwgdXBkYXRlZENvbnRleHQpXG4gICAgcmV0dXJuIHVwZGF0ZWRDb250ZXh0XG4gIH1cblxuICBzdGF0aWMgYXN5bmMgdXBkYXRlU3ViamVjdFBlcmZvcm1hbmNlKHVzZXJJZDogc3RyaW5nLCBzdWJqZWN0OiBzdHJpbmcsIHBlcmZvcm1hbmNlOiBQYXJ0aWFsPFN1YmplY3RQZXJmb3JtYW5jZT4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRDb250ZXh0KHVzZXJJZClcbiAgICBpZiAoIWNvbnRleHQpIHJldHVyblxuXG4gICAgY29uc3QgZXhpc3RpbmdJbmRleCA9IGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlcy5maW5kSW5kZXgocCA9PiBwLnN1YmplY3QgPT09IHN1YmplY3QpXG4gICAgXG4gICAgaWYgKGV4aXN0aW5nSW5kZXggPj0gMCkge1xuICAgICAgY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzW2V4aXN0aW5nSW5kZXhdID0ge1xuICAgICAgICAuLi5jb250ZXh0LnN1YmplY3RQZXJmb3JtYW5jZXNbZXhpc3RpbmdJbmRleF0sXG4gICAgICAgIC4uLnBlcmZvcm1hbmNlLFxuICAgICAgICBzdWJqZWN0XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlcy5wdXNoKHtcbiAgICAgICAgc3ViamVjdCxcbiAgICAgICAgYXZlcmFnZUdyYWRlOiAwLFxuICAgICAgICBkaWZmaWN1bHR5TGV2ZWw6IDUsXG4gICAgICAgIHRpbWVTcGVudFdlZWtseTogMCxcbiAgICAgICAgbGFzdFN0dWRpZWQ6IG5ldyBEYXRlKCksXG4gICAgICAgIHN0cm9uZ1RvcGljczogW10sXG4gICAgICAgIHdlYWtUb3BpY3M6IFtdLFxuICAgICAgICBwcmVmZXJyZWRTdHVkeU1ldGhvZHM6IFtdLFxuICAgICAgICB1cGNvbWluZ0RlYWRsaW5lczogW10sXG4gICAgICAgIC4uLnBlcmZvcm1hbmNlXG4gICAgICB9KVxuICAgIH1cblxuICAgIGF3YWl0IHRoaXMudXBkYXRlQ29udGV4dCh1c2VySWQsIHsgc3ViamVjdFBlcmZvcm1hbmNlczogY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzIH0pXG4gIH1cblxuICBzdGF0aWMgYXN5bmMgYWRkR29hbCh1c2VySWQ6IHN0cmluZywgZ29hbDogT21pdDxTdHVkeUdvYWwsICdpZCcgfCAnY3JlYXRlZEF0JyB8ICd1cGRhdGVkQXQnPik6IFByb21pc2U8U3R1ZHlHb2FsPiB7XG4gICAgY29uc3QgY29udGV4dCA9IGF3YWl0IHRoaXMuZ2V0Q29udGV4dCh1c2VySWQpXG4gICAgaWYgKCFjb250ZXh0KSB0aHJvdyBuZXcgRXJyb3IoJ1VzZXIgY29udGV4dCBub3QgZm91bmQnKVxuXG4gICAgY29uc3QgbmV3R29hbDogU3R1ZHlHb2FsID0ge1xuICAgICAgLi4uZ29hbCxcbiAgICAgIGlkOiBgZ29hbF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKClcbiAgICB9XG5cbiAgICBjb250ZXh0LmN1cnJlbnRHb2Fscy5wdXNoKG5ld0dvYWwpXG4gICAgYXdhaXQgdGhpcy51cGRhdGVDb250ZXh0KHVzZXJJZCwgeyBjdXJyZW50R29hbHM6IGNvbnRleHQuY3VycmVudEdvYWxzIH0pXG4gICAgcmV0dXJuIG5ld0dvYWxcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyB1cGRhdGVTdHVkeVBhdHRlcm4odXNlcklkOiBzdHJpbmcsIHNlc3Npb25EYXRhOiB7XG4gICAgc3ViamVjdDogc3RyaW5nXG4gICAgZHVyYXRpb246IG51bWJlclxuICAgIGZvY3VzU2NvcmU6IG51bWJlclxuICAgIHN0YXJ0VGltZTogc3RyaW5nXG4gIH0pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBjb250ZXh0ID0gYXdhaXQgdGhpcy5nZXRDb250ZXh0KHVzZXJJZClcbiAgICBpZiAoIWNvbnRleHQpIHJldHVyblxuXG4gICAgLy8gVXBkYXRlIHBhdHRlcm5zIGJhc2VkIG9uIHNlc3Npb24gZGF0YVxuICAgIGNvbnN0IHBhdHRlcm5zID0gY29udGV4dC5zdHVkeVBhdHRlcm5zLnBhdHRlcm5zXG4gICAgY29uc3QgaG91ciA9IHNlc3Npb25EYXRhLnN0YXJ0VGltZS5zcGxpdCgnOicpWzBdICsgJzowMCdcbiAgICBcbiAgICBpZiAoIXBhdHRlcm5zLm1vc3RQcm9kdWN0aXZlSG91cnMuaW5jbHVkZXMoaG91cikpIHtcbiAgICAgIHBhdHRlcm5zLm1vc3RQcm9kdWN0aXZlSG91cnMucHVzaChob3VyKVxuICAgIH1cblxuICAgIC8vIFVwZGF0ZSB3ZWVrbHkgc3RhdHNcbiAgICBjb25zdCBzdGF0cyA9IGNvbnRleHQuc3R1ZHlQYXR0ZXJucy53ZWVrbHlTdGF0c1xuICAgIHN0YXRzLnRvdGFsU3R1ZHlIb3VycyArPSBzZXNzaW9uRGF0YS5kdXJhdGlvbiAvIDYwXG4gICAgc3RhdHMuc3ViamVjdERpc3RyaWJ1dGlvbltzZXNzaW9uRGF0YS5zdWJqZWN0XSA9IFxuICAgICAgKHN0YXRzLnN1YmplY3REaXN0cmlidXRpb25bc2Vzc2lvbkRhdGEuc3ViamVjdF0gfHwgMCkgKyBzZXNzaW9uRGF0YS5kdXJhdGlvbiAvIDYwXG4gICAgXG4gICAgc3RhdHMuYXZlcmFnZUZvY3VzU2NvcmUgPSBcbiAgICAgIChzdGF0cy5hdmVyYWdlRm9jdXNTY29yZSArIHNlc3Npb25EYXRhLmZvY3VzU2NvcmUpIC8gMlxuXG4gICAgY29udGV4dC5zdHVkeVBhdHRlcm5zLmxhc3RVcGRhdGVkID0gbmV3IERhdGUoKVxuICAgIGF3YWl0IHRoaXMudXBkYXRlQ29udGV4dCh1c2VySWQsIHsgc3R1ZHlQYXR0ZXJuczogY29udGV4dC5zdHVkeVBhdHRlcm5zIH0pXG4gIH1cblxuICAvLyBTdG9yYWdlIG1ldGhvZHMgKHNpbXBsaWZpZWQgZm9yIGRlbW8gLSBpbiBwcm9kdWN0aW9uIHdvdWxkIHVzZSBkYXRhYmFzZSlcbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgbG9hZEZyb21TdG9yYWdlKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxTdHVkZW50Q29udGV4dCB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgLy8gSW4gYSByZWFsIGltcGxlbWVudGF0aW9uLCB0aGlzIHdvdWxkIGxvYWQgZnJvbSBkYXRhYmFzZVxuICAgICAgLy8gRm9yIG5vdywgd2UnbGwgdXNlIGxvY2FsU3RvcmFnZSBhcyBhIHNpbXBsZSBwZXJzaXN0ZW5jZSBsYXllclxuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGNvbnN0IHN0b3JlZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGBzdHVkZW50X2NvbnRleHRfJHt1c2VySWR9YClcbiAgICAgICAgaWYgKHN0b3JlZCkge1xuICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IEpTT04ucGFyc2Uoc3RvcmVkKVxuICAgICAgICAgIC8vIENvbnZlcnQgZGF0ZSBzdHJpbmdzIGJhY2sgdG8gRGF0ZSBvYmplY3RzXG4gICAgICAgICAgcGFyc2VkLmxhc3RJbnRlcmFjdGlvbiA9IG5ldyBEYXRlKHBhcnNlZC5sYXN0SW50ZXJhY3Rpb24pXG4gICAgICAgICAgcGFyc2VkLmNyZWF0ZWRBdCA9IG5ldyBEYXRlKHBhcnNlZC5jcmVhdGVkQXQpXG4gICAgICAgICAgcGFyc2VkLnVwZGF0ZWRBdCA9IG5ldyBEYXRlKHBhcnNlZC51cGRhdGVkQXQpXG4gICAgICAgICAgcmV0dXJuIHBhcnNlZFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvYWRpbmcgY29udGV4dCBmcm9tIHN0b3JhZ2U6JywgZXJyb3IpXG4gICAgfVxuICAgIHJldHVybiBudWxsXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBhc3luYyBzYXZlVG9TdG9yYWdlKHVzZXJJZDogc3RyaW5nLCBjb250ZXh0OiBTdHVkZW50Q29udGV4dCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBJbiBhIHJlYWwgaW1wbGVtZW50YXRpb24sIHRoaXMgd291bGQgc2F2ZSB0byBkYXRhYmFzZVxuICAgICAgLy8gRm9yIG5vdywgd2UnbGwgdXNlIGxvY2FsU3RvcmFnZSBhcyBhIHNpbXBsZSBwZXJzaXN0ZW5jZSBsYXllclxuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKGBzdHVkZW50X2NvbnRleHRfJHt1c2VySWR9YCwgSlNPTi5zdHJpbmdpZnkoY29udGV4dCkpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyBjb250ZXh0IHRvIHN0b3JhZ2U6JywgZXJyb3IpXG4gICAgfVxuICB9XG5cbiAgLy8gVXRpbGl0eSBtZXRob2RzIGZvciBhbmFseXNpc1xuICBzdGF0aWMgYW5hbHl6ZVN0dWRlbnROZWVkcyhjb250ZXh0OiBTdHVkZW50Q29udGV4dCk6IHtcbiAgICB1cmdlbnRUYXNrczogc3RyaW5nW11cbiAgICByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdXG4gICAgcmlza0FyZWFzOiBzdHJpbmdbXVxuICAgIHN0cmVuZ3Roczogc3RyaW5nW11cbiAgfSB7XG4gICAgY29uc3QgdXJnZW50VGFza3M6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCByaXNrQXJlYXM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBzdHJlbmd0aHM6IHN0cmluZ1tdID0gW11cblxuICAgIC8vIEFuYWx5emUgdXBjb21pbmcgZGVhZGxpbmVzXG4gICAgY29udGV4dC5zdWJqZWN0UGVyZm9ybWFuY2VzLmZvckVhY2goc3ViamVjdCA9PiB7XG4gICAgICBzdWJqZWN0LnVwY29taW5nRGVhZGxpbmVzLmZvckVhY2goZGVhZGxpbmUgPT4ge1xuICAgICAgICBjb25zdCBkYXlzVW50aWwgPSBNYXRoLmNlaWwoKGRlYWRsaW5lLmRhdGUuZ2V0VGltZSgpIC0gRGF0ZS5ub3coKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpXG4gICAgICAgIGlmIChkYXlzVW50aWwgPD0gMyAmJiBkZWFkbGluZS5wcmVwYXJhdGlvblN0YXR1cyAhPT0gJ3JlYWR5Jykge1xuICAgICAgICAgIHVyZ2VudFRhc2tzLnB1c2goYCR7ZGVhZGxpbmUudHlwZX0gZGUgJHtzdWJqZWN0LnN1YmplY3R9IGVuICR7ZGF5c1VudGlsfSBkw61hc2ApXG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIC8vIElkZW50aWZ5IHN0cnVnZ2xpbmcgc3ViamVjdHNcbiAgICAgIGlmIChzdWJqZWN0LmF2ZXJhZ2VHcmFkZSA8IDcwKSB7XG4gICAgICAgIHJpc2tBcmVhcy5wdXNoKGBSZW5kaW1pZW50byBiYWpvIGVuICR7c3ViamVjdC5zdWJqZWN0fSAoJHtzdWJqZWN0LmF2ZXJhZ2VHcmFkZX0lKWApXG4gICAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKGBQcm9ncmFtYXIgc2VzaW9uZXMgYWRpY2lvbmFsZXMgZGUgJHtzdWJqZWN0LnN1YmplY3R9YClcbiAgICAgIH1cblxuICAgICAgLy8gSWRlbnRpZnkgc3RyZW5ndGhzXG4gICAgICBpZiAoc3ViamVjdC5hdmVyYWdlR3JhZGUgPiA4NSkge1xuICAgICAgICBzdHJlbmd0aHMucHVzaChgRXhjZWxlbnRlIHJlbmRpbWllbnRvIGVuICR7c3ViamVjdC5zdWJqZWN0fWApXG4gICAgICB9XG4gICAgfSlcblxuICAgIC8vIEFuYWx5emUgc3R1ZHkgcGF0dGVybnNcbiAgICBpZiAoY29udGV4dC5zdHVkeVBhdHRlcm5zLndlZWtseVN0YXRzLnRvdGFsU3R1ZHlIb3VycyA8IDEwKSB7XG4gICAgICByaXNrQXJlYXMucHVzaCgnUG9jYXMgaG9yYXMgZGUgZXN0dWRpbyBzZW1hbmFsJylcbiAgICAgIHJlY29tbWVuZGF0aW9ucy5wdXNoKCdJbmNyZW1lbnRhciB0aWVtcG8gZGUgZXN0dWRpbyBncmFkdWFsbWVudGUnKVxuICAgIH1cblxuICAgIHJldHVybiB7IHVyZ2VudFRhc2tzLCByZWNvbW1lbmRhdGlvbnMsIHJpc2tBcmVhcywgc3RyZW5ndGhzIH1cbiAgfVxufSJdLCJuYW1lcyI6WyJTdHVkZW50Q29udGV4dE1hbmFnZXIiLCJjb250ZXh0cyIsIk1hcCIsImdldENvbnRleHQiLCJ1c2VySWQiLCJoYXMiLCJnZXQiLCJzdG9yZWQiLCJsb2FkRnJvbVN0b3JhZ2UiLCJzZXQiLCJlcnJvciIsImNvbnNvbGUiLCJjcmVhdGVEZWZhdWx0Q29udGV4dCIsImJhc2ljSW5mbyIsImRlZmF1bHRDb250ZXh0IiwiYWNhZGVtaWNJbmZvIiwiZ3JhZGUiLCJzY2hvb2wiLCJhY2FkZW1pY1llYXIiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJ0b1N0cmluZyIsInNwZWNpYWxpemF0aW9uIiwibGVhcm5pbmdTdHlsZSIsInByaW1hcnkiLCJwcmVmZXJlbmNlcyIsInN0dWR5VGltZVByZWZlcmVuY2UiLCJzZXNzaW9uRHVyYXRpb24iLCJicmVha0ZyZXF1ZW5jeSIsImRpZmZpY3VsdHlQcm9ncmVzc2lvbiIsInN1YmplY3RQZXJmb3JtYW5jZXMiLCJjdXJyZW50R29hbHMiLCJzY2hlZHVsZVByZWZlcmVuY2VzIiwicHJlZmVycmVkU3R1ZHlUaW1lcyIsInVuYXZhaWxhYmxlVGltZXMiLCJyZWN1cnJpbmciLCJzcGVjaWZpYyIsInN0dWR5RW52aXJvbm1lbnQiLCJsb2NhdGlvbiIsInJlcXVpcmVzUXVpZXQiLCJhbGxvd3NEaWdpdGFsRGV2aWNlcyIsInByZWZlcnJlZExpZ2h0aW5nIiwiYWNhZGVtaWNDYWxlbmRhciIsInNjaG9vbFNjaGVkdWxlIiwiZXhhbVBlcmlvZHMiLCJhc3NpZ25tZW50cyIsImhvbGlkYXlzIiwic3R1ZHlQYXR0ZXJucyIsInBhdHRlcm5zIiwibW9zdFByb2R1Y3RpdmVIb3VycyIsImF2ZXJhZ2VTZXNzaW9uRHVyYXRpb24iLCJwcmVmZXJyZWRCcmVha0R1cmF0aW9uIiwiYmVzdFBlcmZvcm1pbmdTdWJqZWN0cyIsInN0cnVnZ2xpbmdTdWJqZWN0cyIsInByb2NyYXN0aW5hdGlvblRyaWdnZXJzIiwibW90aXZhdGlvbmFsRmFjdG9ycyIsIndlZWtseVN0YXRzIiwidG90YWxTdHVkeUhvdXJzIiwic3ViamVjdERpc3RyaWJ1dGlvbiIsImdvYWxDb21wbGV0aW9uUmF0ZSIsImF2ZXJhZ2VGb2N1c1Njb3JlIiwibGFzdFVwZGF0ZWQiLCJjb21tdW5pY2F0aW9uU3R5bGUiLCJtb3RpdmF0aW9uTGV2ZWwiLCJmZWVkYmFja1ByZWZlcmVuY2UiLCJyZW1pbmRlckZyZXF1ZW5jeSIsImxhc3RJbnRlcmFjdGlvbiIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInNhdmVUb1N0b3JhZ2UiLCJ1cGRhdGVDb250ZXh0IiwidXBkYXRlcyIsImNvbnRleHQiLCJ1cGRhdGVkQ29udGV4dCIsInVwZGF0ZVN1YmplY3RQZXJmb3JtYW5jZSIsInN1YmplY3QiLCJwZXJmb3JtYW5jZSIsImV4aXN0aW5nSW5kZXgiLCJmaW5kSW5kZXgiLCJwIiwicHVzaCIsImF2ZXJhZ2VHcmFkZSIsImRpZmZpY3VsdHlMZXZlbCIsInRpbWVTcGVudFdlZWtseSIsImxhc3RTdHVkaWVkIiwic3Ryb25nVG9waWNzIiwid2Vha1RvcGljcyIsInByZWZlcnJlZFN0dWR5TWV0aG9kcyIsInVwY29taW5nRGVhZGxpbmVzIiwiYWRkR29hbCIsImdvYWwiLCJFcnJvciIsIm5ld0dvYWwiLCJpZCIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJzdWJzdHIiLCJ1cGRhdGVTdHVkeVBhdHRlcm4iLCJzZXNzaW9uRGF0YSIsImhvdXIiLCJzdGFydFRpbWUiLCJzcGxpdCIsImluY2x1ZGVzIiwic3RhdHMiLCJkdXJhdGlvbiIsImZvY3VzU2NvcmUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwicGFyc2VkIiwiSlNPTiIsInBhcnNlIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsImFuYWx5emVTdHVkZW50TmVlZHMiLCJ1cmdlbnRUYXNrcyIsInJlY29tbWVuZGF0aW9ucyIsInJpc2tBcmVhcyIsInN0cmVuZ3RocyIsImZvckVhY2giLCJkZWFkbGluZSIsImRheXNVbnRpbCIsImNlaWwiLCJkYXRlIiwiZ2V0VGltZSIsInByZXBhcmF0aW9uU3RhdHVzIiwidHlwZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/student-context.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/study-session-planner.ts":
/*!******************************************!*\
  !*** ./src/lib/study-session-planner.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   StudySessionPlanner: () => (/* binding */ StudySessionPlanner)\n/* harmony export */ });\n// Planificador Inteligente de Sesiones de Estudio\n// Genera planes de estudio personalizados y adaptativos basados en el contexto del estudiante\nclass StudySessionPlanner {\n    /**\n   * Genera un plan de estudio inteligente basado en el contexto del estudiante\n   */ static async generateStudyPlan(context, planningPeriod, preferences = {}) {\n        // Configurar preferencias por defecto\n        const defaultPreferences = {\n            preferredSessionDuration: 45,\n            maxSessionsPerDay: 4,\n            breakDurationBetweenSessions: 15,\n            preferredStudyTimes: context.studyPatterns.patterns.mostProductiveHours,\n            avoidTimes: [],\n            prioritizeWeakSubjects: true,\n            includeReviewSessions: true,\n            adaptToMood: true,\n            respectSleepSchedule: true,\n            ...preferences\n        };\n        // Analizar necesidades académicas\n        const academicNeeds = this.analyzeAcademicNeeds(context);\n        // Identificar slots de tiempo disponibles\n        const availableSlots = this.identifyAvailableTimeSlots(context, planningPeriod);\n        // Generar sesiones de estudio\n        const sessions = await this.generateStudySessions(context, academicNeeds, availableSlots, defaultPreferences);\n        // Optimizar distribución de sesiones\n        const optimizedSessions = this.optimizeSessionDistribution(sessions, context);\n        // Crear plan de estudio\n        const studyPlan = {\n            id: `plan_${Date.now()}_${Math.random().toString(36).substr(2, 8)}`,\n            userId: context.userId,\n            title: this.generatePlanTitle(planningPeriod, academicNeeds),\n            description: this.generatePlanDescription(academicNeeds, optimizedSessions.length),\n            startDate: planningPeriod.startDate,\n            endDate: planningPeriod.endDate,\n            totalSessions: optimizedSessions.length,\n            completedSessions: 0,\n            subjects: [\n                ...new Set(optimizedSessions.map((s)=>s.subject))\n            ],\n            goals: context.currentGoals,\n            sessions: optimizedSessions,\n            weeklySchedule: this.organizeSessionsByWeek(optimizedSessions),\n            adaptiveSettings: {\n                adjustDifficultyBasedOnPerformance: true,\n                prioritizeWeakSubjects: defaultPreferences.prioritizeWeakSubjects,\n                respectEnergyLevels: true,\n                allowFlexibleScheduling: true\n            },\n            metrics: this.calculatePlanMetrics(optimizedSessions),\n            createdAt: new Date(),\n            updatedAt: new Date()\n        };\n        return studyPlan;\n    }\n    /**\n   * Analiza las necesidades académicas del estudiante\n   */ static analyzeAcademicNeeds(context) {\n        // Analizar deadlines urgentes\n        const urgentDeadlines = context.subjectPerformances.flatMap((subject)=>subject.upcomingDeadlines.filter((deadline)=>{\n                const daysUntil = Math.ceil((deadline.date.getTime() - Date.now()) / (1000 * 60 * 60 * 24));\n                return daysUntil <= 14 && deadline.preparationStatus !== 'ready';\n            }).map((deadline)=>({\n                    subject: subject.subject,\n                    deadline: deadline.date,\n                    type: deadline.type,\n                    preparationNeeded: this.estimatePreparationHours(deadline.type, subject.difficultyLevel)\n                }))).sort((a, b)=>a.deadline.getTime() - b.deadline.getTime());\n        // Identificar materias débiles\n        const weakSubjects = context.subjectPerformances.filter((subject)=>subject.averageGrade < 75 || subject.weakTopics.length > 0).map((subject)=>({\n                subject: subject.subject,\n                priority: this.calculateSubjectPriority(subject),\n                hoursNeeded: this.estimateImprovementHours(subject)\n            })).sort((a, b)=>b.priority - a.priority);\n        // Determinar necesidades de repaso\n        const reviewNeeds = context.subjectPerformances.map((subject)=>({\n                subject: subject.subject,\n                topics: subject.strongTopics,\n                frequency: this.determineReviewFrequency(subject)\n            })).filter((review)=>review.topics.length > 0);\n        // Analizar objetivos\n        const goalBasedNeeds = context.currentGoals.filter((goal)=>goal.progress < 100).map((goal)=>({\n                goal,\n                sessionsNeeded: this.estimateSessionsForGoal(goal)\n            }));\n        return {\n            urgentDeadlines,\n            weakSubjects,\n            reviewNeeds,\n            goalBasedNeeds\n        };\n    }\n    /**\n   * Identifica slots de tiempo disponibles para estudio\n   */ static identifyAvailableTimeSlots(context, period) {\n        const slots = [];\n        const currentDate = new Date(period.startDate);\n        while(currentDate <= period.endDate){\n            const dayOfWeek = this.getDayOfWeek(currentDate);\n            // Obtener clases del día\n            const dayClasses = context.academicCalendar.schoolSchedule.filter((schedule)=>schedule.day === dayOfWeek);\n            // Generar slots basándose en el horario escolar y preferencias\n            const daySlots = this.generateDaySlots(dayOfWeek, dayClasses, context);\n            // Agregar fecha específica a cada slot\n            daySlots.forEach((slot)=>{\n                slots.push({\n                    ...slot,\n                    day: currentDate.toISOString().split('T')[0] // YYYY-MM-DD format\n                });\n            });\n            currentDate.setDate(currentDate.getDate() + 1);\n        }\n        return slots;\n    }\n    /**\n   * Genera sesiones de estudio basadas en necesidades y slots disponibles\n   */ static async generateStudySessions(context, needs, availableSlots, preferences) {\n        const sessions = [];\n        let slotIndex = 0;\n        // 1. Crear sesiones para deadlines urgentes (prioridad máxima)\n        for (const deadline of needs.urgentDeadlines){\n            const sessionsNeeded = Math.ceil(deadline.preparationNeeded / (preferences.preferredSessionDuration / 60));\n            for(let i = 0; i < sessionsNeeded && slotIndex < availableSlots.length; i++){\n                const slot = availableSlots[slotIndex++];\n                sessions.push(this.createStudySession({\n                    slot,\n                    subject: deadline.subject,\n                    type: 'exam_prep',\n                    priority: 'urgent',\n                    topic: `Preparación para ${deadline.type}`,\n                    deadline: deadline.deadline,\n                    preferences\n                }));\n            }\n        }\n        // 2. Crear sesiones para materias débiles\n        for (const weakSubject of needs.weakSubjects){\n            const sessionsNeeded = Math.ceil(weakSubject.hoursNeeded / (preferences.preferredSessionDuration / 60));\n            for(let i = 0; i < sessionsNeeded && slotIndex < availableSlots.length; i++){\n                const slot = availableSlots[slotIndex++];\n                sessions.push(this.createStudySession({\n                    slot,\n                    subject: weakSubject.subject,\n                    type: 'practice',\n                    priority: 'high',\n                    topic: 'Refuerzo de conceptos débiles',\n                    preferences\n                }));\n            }\n        }\n        // 3. Crear sesiones de repaso\n        if (preferences.includeReviewSessions) {\n            for (const review of needs.reviewNeeds){\n                const reviewSession = this.createReviewSession(review, availableSlots[slotIndex++], preferences);\n                if (reviewSession) {\n                    sessions.push(reviewSession);\n                }\n            }\n        }\n        // 4. Crear sesiones para objetivos específicos\n        for (const goalNeed of needs.goalBasedNeeds){\n            for(let i = 0; i < goalNeed.sessionsNeeded && slotIndex < availableSlots.length; i++){\n                const slot = availableSlots[slotIndex++];\n                sessions.push(this.createGoalBasedSession(goalNeed.goal, slot, preferences));\n            }\n        }\n        return sessions;\n    }\n    /**\n   * Crea una sesión de estudio individual\n   */ static createStudySession(params) {\n        const { slot, subject, type, priority, topic, preferences } = params;\n        const duration = Math.min(slot.duration, preferences.preferredSessionDuration);\n        return {\n            id: `session_${Date.now()}_${Math.random().toString(36).substr(2, 8)}`,\n            title: `${subject}: ${topic}`,\n            subject,\n            topic,\n            date: new Date(slot.day),\n            startTime: slot.startTime,\n            endTime: this.addMinutesToTime(slot.startTime, duration),\n            duration,\n            type,\n            difficulty: this.inferDifficulty(type, subject),\n            priority,\n            techniques: this.selectStudyTechniques(type, subject, duration),\n            materials: this.selectStudyMaterials(subject, type),\n            goals: [\n                topic\n            ],\n            estimatedFocusLevel: this.estimateFocusLevel(slot.energy_level, type),\n            energyRequirement: this.mapEnergyLevel(slot.energy_level),\n            environment: slot.type === 'free' ? 'quiet' : 'moderate',\n            status: 'planned',\n            createdAt: new Date(),\n            updatedAt: new Date()\n        };\n    }\n    /**\n   * Optimiza la distribución de sesiones para evitar sobrecarga\n   */ static optimizeSessionDistribution(sessions, context) {\n        // Agrupar sesiones por día\n        const sessionsByDay = sessions.reduce((acc, session)=>{\n            const dateKey = session.date.toISOString().split('T')[0];\n            if (!acc[dateKey]) acc[dateKey] = [];\n            acc[dateKey].push(session);\n            return acc;\n        }, {});\n        // Optimizar cada día\n        const optimizedSessions = [];\n        for (const [date, daySessions] of Object.entries(sessionsByDay)){\n            // Limitar sesiones por día según preferencias\n            const maxSessions = context.learningStyle.preferences.sessionDuration === 'long' ? 2 : 4;\n            const prioritizedSessions = daySessions.sort((a, b)=>this.priorityWeight(b.priority) - this.priorityWeight(a.priority)).slice(0, maxSessions);\n            // Balancear dificultad a lo largo del día\n            const balancedSessions = this.balanceSessionDifficulty(prioritizedSessions);\n            optimizedSessions.push(...balancedSessions);\n        }\n        return optimizedSessions;\n    }\n    /**\n   * Organiza sesiones por semana para el plan\n   */ static organizeSessionsByWeek(sessions) {\n        return sessions.reduce((acc, session)=>{\n            const dayKey = session.date.toLocaleDateString('es-ES', {\n                weekday: 'long'\n            });\n            if (!acc[dayKey]) acc[dayKey] = [];\n            acc[dayKey].push(session);\n            return acc;\n        }, {});\n    }\n    /**\n   * Calcula métricas del plan de estudio\n   */ static calculatePlanMetrics(sessions) {\n        const totalHours = sessions.reduce((sum, session)=>sum + session.duration, 0) / 60;\n        const subjectBalance = sessions.reduce((acc, session)=>{\n            acc[session.subject] = (acc[session.subject] || 0) + session.duration / 60;\n            return acc;\n        }, {});\n        return {\n            totalPlannedHours: totalHours,\n            actualStudyHours: 0,\n            averageEffectiveness: 0,\n            goalCompletionRate: 0,\n            subjectBalance\n        };\n    }\n    // Funciones auxiliares\n    static estimatePreparationHours(type, difficultyLevel) {\n        const baseHours = {\n            'exam': 8,\n            'assignment': 4,\n            'project': 12,\n            'quiz': 2\n        };\n        return (baseHours[type] || 4) * (difficultyLevel / 5);\n    }\n    static calculateSubjectPriority(subject) {\n        let priority = 0;\n        // Prioridad basada en calificación\n        if (subject.averageGrade < 60) priority += 10;\n        else if (subject.averageGrade < 70) priority += 7;\n        else if (subject.averageGrade < 80) priority += 5;\n        // Prioridad basada en temas débiles\n        priority += subject.weakTopics.length * 2;\n        // Prioridad basada en próximos deadlines\n        priority += subject.upcomingDeadlines.length * 3;\n        // Prioridad basada en tiempo sin estudiar\n        const daysSinceLastStudy = Math.floor((Date.now() - subject.lastStudied.getTime()) / (1000 * 60 * 60 * 24));\n        if (daysSinceLastStudy > 7) priority += 5;\n        return priority;\n    }\n    static estimateImprovementHours(subject) {\n        const gradeGap = Math.max(0, 80 - subject.averageGrade) // Objetivo: llegar a 80\n        ;\n        const weakTopicsHours = subject.weakTopics.length * 2;\n        const difficultyMultiplier = subject.difficultyLevel / 5;\n        return (gradeGap * 0.5 + weakTopicsHours) * difficultyMultiplier;\n    }\n    static determineReviewFrequency(subject) {\n        if (subject.averageGrade > 90) return 'monthly';\n        if (subject.averageGrade > 80) return 'biweekly';\n        return 'weekly';\n    }\n    static estimateSessionsForGoal(goal) {\n        const remainingProgress = 100 - goal.progress;\n        const complexity = goal.milestones.length;\n        return Math.ceil(remainingProgress / 100 * complexity * 2);\n    }\n    static getDayOfWeek(date) {\n        const days = [\n            'sunday',\n            'monday',\n            'tuesday',\n            'wednesday',\n            'thursday',\n            'friday',\n            'saturday'\n        ];\n        return days[date.getDay()];\n    }\n    static generateDaySlots(dayOfWeek, dayClasses, context) {\n        // Esta función generaría slots de estudio basándose en el horario de clases\n        // Por simplicidad, retornamos slots básicos\n        const basicSlots = [\n            {\n                day: dayOfWeek,\n                startTime: '08:00',\n                endTime: '10:00',\n                duration: 120,\n                type: 'free',\n                recommendedFor: [\n                    'review'\n                ],\n                energy_level: 'high'\n            },\n            {\n                day: dayOfWeek,\n                startTime: '14:00',\n                endTime: '16:00',\n                duration: 120,\n                type: 'free',\n                recommendedFor: [\n                    'practice'\n                ],\n                energy_level: 'high'\n            },\n            {\n                day: dayOfWeek,\n                startTime: '19:00',\n                endTime: '21:00',\n                duration: 120,\n                type: 'free',\n                recommendedFor: [\n                    'homework'\n                ],\n                energy_level: 'medium'\n            }\n        ];\n        return basicSlots;\n    }\n    static addMinutesToTime(time, minutes) {\n        const [hours, mins] = time.split(':').map(Number);\n        const totalMinutes = hours * 60 + mins + minutes;\n        const newHours = Math.floor(totalMinutes / 60) % 24;\n        const newMins = totalMinutes % 60;\n        return `${newHours.toString().padStart(2, '0')}:${newMins.toString().padStart(2, '0')}`;\n    }\n    static inferDifficulty(type, subject) {\n        if (type === 'exam_prep' || type === 'new_material') return 'hard';\n        if (type === 'practice' || type === 'homework') return 'medium';\n        return 'easy';\n    }\n    static selectStudyTechniques(type, subject, duration) {\n        // Retornar técnicas apropiadas según el tipo de sesión\n        const techniques = [];\n        if (duration >= 45) {\n            techniques.push({\n                name: 'Pomodoro Technique',\n                description: '25 min estudio + 5 min descanso',\n                duration: 30,\n                effectiveness: 8,\n                applicableSubjects: [\n                    'any'\n                ],\n                requiredMaterials: [\n                    'timer'\n                ]\n            });\n        }\n        return techniques;\n    }\n    static selectStudyMaterials(subject, type) {\n        // Retornar materiales apropiados\n        return [\n            {\n                type: 'textbook',\n                name: `Libro de ${subject}`,\n                estimatedTime: 30,\n                difficulty: 'intermediate'\n            }\n        ];\n    }\n    static estimateFocusLevel(energyLevel, type) {\n        const energyMap = {\n            high: 9,\n            medium: 7,\n            low: 5\n        };\n        const typeMap = {\n            exam_prep: 9,\n            new_material: 8,\n            practice: 7,\n            review: 6,\n            homework: 5,\n            project: 8\n        };\n        return Math.min(10, (energyMap[energyLevel] + typeMap[type]) / 2);\n    }\n    static mapEnergyLevel(level) {\n        return level;\n    }\n    static priorityWeight(priority) {\n        const weights = {\n            urgent: 4,\n            high: 3,\n            medium: 2,\n            low: 1\n        };\n        return weights[priority];\n    }\n    static balanceSessionDifficulty(sessions) {\n        // Ordenar para alternar dificultades cuando sea posible\n        return sessions.sort((a, b)=>{\n            if (a.difficulty === 'hard' && b.difficulty === 'easy') return -1;\n            if (a.difficulty === 'easy' && b.difficulty === 'hard') return 1;\n            return 0;\n        });\n    }\n    static generatePlanTitle(period, needs) {\n        const duration = Math.ceil((period.endDate.getTime() - period.startDate.getTime()) / (1000 * 60 * 60 * 24));\n        return `Plan de Estudio - ${duration} días`;\n    }\n    static generatePlanDescription(needs, sessionCount) {\n        return `Plan personalizado con ${sessionCount} sesiones de estudio, enfocado en ${needs.urgentDeadlines.length} deadlines urgentes y ${needs.weakSubjects.length} materias por reforzar.`;\n    }\n    static createReviewSession(review, slot, preferences) {\n        if (!slot) return null;\n        return this.createStudySession({\n            slot,\n            subject: review.subject,\n            type: 'review',\n            priority: 'medium',\n            topic: `Repaso de ${review.topics.slice(0, 2).join(', ')}`,\n            preferences\n        });\n    }\n    static createGoalBasedSession(goal, slot, preferences) {\n        return this.createStudySession({\n            slot,\n            subject: goal.subject || 'General',\n            type: 'project',\n            priority: goal.priority === 'urgent' ? 'urgent' : 'high',\n            topic: goal.title,\n            preferences\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUN4RyxPQUFPLENBQUMsa0JBQWtCLEVBQUV5RCxTQUFTLEtBQUssQ0FBQztJQUM3QztJQUVBLE9BQWV6Rix3QkFBd0I4RSxLQUFVLEVBQUVrRyxZQUFvQixFQUFVO1FBQy9FLE9BQU8sQ0FBQyx1QkFBdUIsRUFBRUEsYUFBYSxrQ0FBa0MsRUFBRWxHLE1BQU12RCxlQUFlLENBQUN0QixNQUFNLENBQUMsc0JBQXNCLEVBQUU2RSxNQUFNckMsWUFBWSxDQUFDeEMsTUFBTSxDQUFDLHVCQUF1QixDQUFDO0lBQzNMO0lBRUEsT0FBZW9GLG9CQUFvQmhDLE1BQVcsRUFBRW1CLElBQW1CLEVBQUUxRyxXQUFnQyxFQUF1QjtRQUMxSCxJQUFJLENBQUMwRyxNQUFNLE9BQU87UUFFbEIsT0FBTyxJQUFJLENBQUNTLGtCQUFrQixDQUFDO1lBQzdCVDtZQUNBOUQsU0FBUzJDLE9BQU8zQyxPQUFPO1lBQ3ZCd0IsTUFBTTtZQUNOVSxVQUFVO1lBQ1ZzQyxPQUFPLENBQUMsVUFBVSxFQUFFN0IsT0FBT0osTUFBTSxDQUFDdUUsS0FBSyxDQUFDLEdBQUcsR0FBR3lELElBQUksQ0FBQyxPQUFPO1lBQzFEbk47UUFDRjtJQUNGO0lBRUEsT0FBZXlILHVCQUF1QmhDLElBQWUsRUFBRWlCLElBQW1CLEVBQUUxRyxXQUFnQyxFQUFnQjtRQUMxSCxPQUFPLElBQUksQ0FBQ21ILGtCQUFrQixDQUFDO1lBQzdCVDtZQUNBOUQsU0FBUzZDLEtBQUs3QyxPQUFPLElBQUk7WUFDekJ3QixNQUFNO1lBQ05VLFVBQVVXLEtBQUtYLFFBQVEsS0FBSyxXQUFXLFdBQVc7WUFDbERzQyxPQUFPM0IsS0FBSzFELEtBQUs7WUFDakIvQjtRQUNGO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL3JvZHJpZ29kaWJlcm5hcmRvMzNnbWFpbC5jb20vRG9jdW1lbnRzL0FwcCBEZXZlbG9wbWVudCBQcm95ZWN0cy9JbnRlbGxlZ28gUGxhdGZvcm0vc3JjL2xpYi9zdHVkeS1zZXNzaW9uLXBsYW5uZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gUGxhbmlmaWNhZG9yIEludGVsaWdlbnRlIGRlIFNlc2lvbmVzIGRlIEVzdHVkaW9cbi8vIEdlbmVyYSBwbGFuZXMgZGUgZXN0dWRpbyBwZXJzb25hbGl6YWRvcyB5IGFkYXB0YXRpdm9zIGJhc2Fkb3MgZW4gZWwgY29udGV4dG8gZGVsIGVzdHVkaWFudGVcblxuaW1wb3J0IHsgU3R1ZGVudENvbnRleHQsIFN0dWR5R29hbCwgU3ViamVjdFBlcmZvcm1hbmNlIH0gZnJvbSAnLi9zdHVkZW50LWNvbnRleHQnXG5pbXBvcnQgeyBTdHVkeVRpbWVTbG90IH0gZnJvbSAnLi9zY2hvb2wtc2NoZWR1bGUtbWFuYWdlcidcblxuZXhwb3J0IGludGVyZmFjZSBTdHVkeVNlc3Npb24ge1xuICBpZDogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgc3ViamVjdDogc3RyaW5nXG4gIHRvcGljOiBzdHJpbmdcbiAgZGF0ZTogRGF0ZVxuICBzdGFydFRpbWU6IHN0cmluZ1xuICBlbmRUaW1lOiBzdHJpbmdcbiAgZHVyYXRpb246IG51bWJlciAvLyBtaW51dGVzXG4gIHR5cGU6ICdyZXZpZXcnIHwgJ3ByYWN0aWNlJyB8ICduZXdfbWF0ZXJpYWwnIHwgJ2V4YW1fcHJlcCcgfCAnaG9tZXdvcmsnIHwgJ3Byb2plY3QnXG4gIGRpZmZpY3VsdHk6ICdlYXN5JyB8ICdtZWRpdW0nIHwgJ2hhcmQnXG4gIHByaW9yaXR5OiAnbG93JyB8ICdtZWRpdW0nIHwgJ2hpZ2gnIHwgJ3VyZ2VudCdcbiAgdGVjaG5pcXVlczogU3R1ZHlUZWNobmlxdWVbXVxuICBtYXRlcmlhbHM6IFN0dWR5TWF0ZXJpYWxbXVxuICBnb2Fsczogc3RyaW5nW11cbiAgcHJlcmVxdWlzaXRlcz86IHN0cmluZ1tdXG4gIGZvbGxvd1VwPzogc3RyaW5nW11cbiAgZXN0aW1hdGVkRm9jdXNMZXZlbDogbnVtYmVyIC8vIDEtMTBcbiAgZW5lcmd5UmVxdWlyZW1lbnQ6ICdsb3cnIHwgJ21lZGl1bScgfCAnaGlnaCdcbiAgZW52aXJvbm1lbnQ6ICdxdWlldCcgfCAnbW9kZXJhdGUnIHwgJ2NvbGxhYm9yYXRpdmUnXG4gIHN0YXR1czogJ3BsYW5uZWQnIHwgJ2luX3Byb2dyZXNzJyB8ICdjb21wbGV0ZWQnIHwgJ3Bvc3Rwb25lZCcgfCAnY2FuY2VsbGVkJ1xuICBhY3R1YWxEdXJhdGlvbj86IG51bWJlclxuICBlZmZlY3RpdmVuZXNzUmF0aW5nPzogbnVtYmVyIC8vIDEtMTAsIGZpbGxlZCBhZnRlciBzZXNzaW9uXG4gIG5vdGVzPzogc3RyaW5nXG4gIGNyZWF0ZWRBdDogRGF0ZVxuICB1cGRhdGVkQXQ6IERhdGVcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdHVkeVRlY2huaXF1ZSB7XG4gIG5hbWU6IHN0cmluZ1xuICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gIGR1cmF0aW9uOiBudW1iZXIgLy8gbWludXRlc1xuICBlZmZlY3RpdmVuZXNzOiBudW1iZXIgLy8gMS0xMCBmb3IgdGhpcyBzdHVkZW50XG4gIGFwcGxpY2FibGVTdWJqZWN0czogc3RyaW5nW11cbiAgcmVxdWlyZWRNYXRlcmlhbHM6IHN0cmluZ1tdXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3R1ZHlNYXRlcmlhbCB7XG4gIHR5cGU6ICd0ZXh0Ym9vaycgfCAnbm90ZXMnIHwgJ3ZpZGVvJyB8ICdwcmFjdGljZV9wcm9ibGVtcycgfCAnZmxhc2hjYXJkcycgfCAnb25saW5lX3Jlc291cmNlJ1xuICBuYW1lOiBzdHJpbmdcbiAgc291cmNlPzogc3RyaW5nXG4gIGNoYXB0ZXI/OiBzdHJpbmdcbiAgcGFnZXM/OiBzdHJpbmdcbiAgdXJsPzogc3RyaW5nXG4gIGVzdGltYXRlZFRpbWU6IG51bWJlciAvLyBtaW51dGVzXG4gIGRpZmZpY3VsdHk6ICdiZWdpbm5lcicgfCAnaW50ZXJtZWRpYXRlJyB8ICdhZHZhbmNlZCdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdHVkeVBsYW4ge1xuICBpZDogc3RyaW5nXG4gIHVzZXJJZDogc3RyaW5nXG4gIHRpdGxlOiBzdHJpbmdcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBzdGFydERhdGU6IERhdGVcbiAgZW5kRGF0ZTogRGF0ZVxuICB0b3RhbFNlc3Npb25zOiBudW1iZXJcbiAgY29tcGxldGVkU2Vzc2lvbnM6IG51bWJlclxuICBzdWJqZWN0czogc3RyaW5nW11cbiAgZ29hbHM6IFN0dWR5R29hbFtdXG4gIHNlc3Npb25zOiBTdHVkeVNlc3Npb25bXVxuICB3ZWVrbHlTY2hlZHVsZToge1xuICAgIFtkYXk6IHN0cmluZ106IFN0dWR5U2Vzc2lvbltdXG4gIH1cbiAgYWRhcHRpdmVTZXR0aW5nczoge1xuICAgIGFkanVzdERpZmZpY3VsdHlCYXNlZE9uUGVyZm9ybWFuY2U6IGJvb2xlYW5cbiAgICBwcmlvcml0aXplV2Vha1N1YmplY3RzOiBib29sZWFuXG4gICAgcmVzcGVjdEVuZXJneUxldmVsczogYm9vbGVhblxuICAgIGFsbG93RmxleGlibGVTY2hlZHVsaW5nOiBib29sZWFuXG4gIH1cbiAgbWV0cmljczoge1xuICAgIHRvdGFsUGxhbm5lZEhvdXJzOiBudW1iZXJcbiAgICBhY3R1YWxTdHVkeUhvdXJzOiBudW1iZXJcbiAgICBhdmVyYWdlRWZmZWN0aXZlbmVzczogbnVtYmVyXG4gICAgZ29hbENvbXBsZXRpb25SYXRlOiBudW1iZXJcbiAgICBzdWJqZWN0QmFsYW5jZTogeyBbc3ViamVjdDogc3RyaW5nXTogbnVtYmVyIH1cbiAgfVxuICBjcmVhdGVkQXQ6IERhdGVcbiAgdXBkYXRlZEF0OiBEYXRlXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGxhbm5pbmdQcmVmZXJlbmNlcyB7XG4gIHByZWZlcnJlZFNlc3Npb25EdXJhdGlvbjogbnVtYmVyIC8vIG1pbnV0ZXNcbiAgbWF4U2Vzc2lvbnNQZXJEYXk6IG51bWJlclxuICBicmVha0R1cmF0aW9uQmV0d2VlblNlc3Npb25zOiBudW1iZXIgLy8gbWludXRlc1xuICBwcmVmZXJyZWRTdHVkeVRpbWVzOiBzdHJpbmdbXSAvLyBbXCIwODowMFwiLCBcIjE0OjAwXCIsIC4uLl1cbiAgYXZvaWRUaW1lczogc3RyaW5nW10gLy8gW1wiMTI6MDBcIiwgXCIyMDowMFwiLCAuLi5dXG4gIHByaW9yaXRpemVXZWFrU3ViamVjdHM6IGJvb2xlYW5cbiAgaW5jbHVkZVJldmlld1Nlc3Npb25zOiBib29sZWFuXG4gIGFkYXB0VG9Nb29kOiBib29sZWFuXG4gIHJlc3BlY3RTbGVlcFNjaGVkdWxlOiBib29sZWFuXG59XG5cbmV4cG9ydCBjbGFzcyBTdHVkeVNlc3Npb25QbGFubmVyIHtcblxuICAvKipcbiAgICogR2VuZXJhIHVuIHBsYW4gZGUgZXN0dWRpbyBpbnRlbGlnZW50ZSBiYXNhZG8gZW4gZWwgY29udGV4dG8gZGVsIGVzdHVkaWFudGVcbiAgICovXG4gIHN0YXRpYyBhc3luYyBnZW5lcmF0ZVN0dWR5UGxhbihcbiAgICBjb250ZXh0OiBTdHVkZW50Q29udGV4dCxcbiAgICBwbGFubmluZ1BlcmlvZDogeyBzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUgfSxcbiAgICBwcmVmZXJlbmNlczogUGFydGlhbDxQbGFubmluZ1ByZWZlcmVuY2VzPiA9IHt9XG4gICk6IFByb21pc2U8U3R1ZHlQbGFuPiB7XG4gICAgXG4gICAgLy8gQ29uZmlndXJhciBwcmVmZXJlbmNpYXMgcG9yIGRlZmVjdG9cbiAgICBjb25zdCBkZWZhdWx0UHJlZmVyZW5jZXM6IFBsYW5uaW5nUHJlZmVyZW5jZXMgPSB7XG4gICAgICBwcmVmZXJyZWRTZXNzaW9uRHVyYXRpb246IDQ1LFxuICAgICAgbWF4U2Vzc2lvbnNQZXJEYXk6IDQsXG4gICAgICBicmVha0R1cmF0aW9uQmV0d2VlblNlc3Npb25zOiAxNSxcbiAgICAgIHByZWZlcnJlZFN0dWR5VGltZXM6IGNvbnRleHQuc3R1ZHlQYXR0ZXJucy5wYXR0ZXJucy5tb3N0UHJvZHVjdGl2ZUhvdXJzLFxuICAgICAgYXZvaWRUaW1lczogW10sXG4gICAgICBwcmlvcml0aXplV2Vha1N1YmplY3RzOiB0cnVlLFxuICAgICAgaW5jbHVkZVJldmlld1Nlc3Npb25zOiB0cnVlLFxuICAgICAgYWRhcHRUb01vb2Q6IHRydWUsXG4gICAgICByZXNwZWN0U2xlZXBTY2hlZHVsZTogdHJ1ZSxcbiAgICAgIC4uLnByZWZlcmVuY2VzXG4gICAgfVxuXG4gICAgLy8gQW5hbGl6YXIgbmVjZXNpZGFkZXMgYWNhZMOpbWljYXNcbiAgICBjb25zdCBhY2FkZW1pY05lZWRzID0gdGhpcy5hbmFseXplQWNhZGVtaWNOZWVkcyhjb250ZXh0KVxuICAgIFxuICAgIC8vIElkZW50aWZpY2FyIHNsb3RzIGRlIHRpZW1wbyBkaXNwb25pYmxlc1xuICAgIGNvbnN0IGF2YWlsYWJsZVNsb3RzID0gdGhpcy5pZGVudGlmeUF2YWlsYWJsZVRpbWVTbG90cyhjb250ZXh0LCBwbGFubmluZ1BlcmlvZClcbiAgICBcbiAgICAvLyBHZW5lcmFyIHNlc2lvbmVzIGRlIGVzdHVkaW9cbiAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdHVkeVNlc3Npb25zKFxuICAgICAgY29udGV4dCwgXG4gICAgICBhY2FkZW1pY05lZWRzLCBcbiAgICAgIGF2YWlsYWJsZVNsb3RzLCBcbiAgICAgIGRlZmF1bHRQcmVmZXJlbmNlc1xuICAgIClcblxuICAgIC8vIE9wdGltaXphciBkaXN0cmlidWNpw7NuIGRlIHNlc2lvbmVzXG4gICAgY29uc3Qgb3B0aW1pemVkU2Vzc2lvbnMgPSB0aGlzLm9wdGltaXplU2Vzc2lvbkRpc3RyaWJ1dGlvbihzZXNzaW9ucywgY29udGV4dClcbiAgICBcbiAgICAvLyBDcmVhciBwbGFuIGRlIGVzdHVkaW9cbiAgICBjb25zdCBzdHVkeVBsYW46IFN0dWR5UGxhbiA9IHtcbiAgICAgIGlkOiBgcGxhbl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDgpfWAsXG4gICAgICB1c2VySWQ6IGNvbnRleHQudXNlcklkLFxuICAgICAgdGl0bGU6IHRoaXMuZ2VuZXJhdGVQbGFuVGl0bGUocGxhbm5pbmdQZXJpb2QsIGFjYWRlbWljTmVlZHMpLFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuZ2VuZXJhdGVQbGFuRGVzY3JpcHRpb24oYWNhZGVtaWNOZWVkcywgb3B0aW1pemVkU2Vzc2lvbnMubGVuZ3RoKSxcbiAgICAgIHN0YXJ0RGF0ZTogcGxhbm5pbmdQZXJpb2Quc3RhcnREYXRlLFxuICAgICAgZW5kRGF0ZTogcGxhbm5pbmdQZXJpb2QuZW5kRGF0ZSxcbiAgICAgIHRvdGFsU2Vzc2lvbnM6IG9wdGltaXplZFNlc3Npb25zLmxlbmd0aCxcbiAgICAgIGNvbXBsZXRlZFNlc3Npb25zOiAwLFxuICAgICAgc3ViamVjdHM6IFsuLi5uZXcgU2V0KG9wdGltaXplZFNlc3Npb25zLm1hcChzID0+IHMuc3ViamVjdCkpXSxcbiAgICAgIGdvYWxzOiBjb250ZXh0LmN1cnJlbnRHb2FscyxcbiAgICAgIHNlc3Npb25zOiBvcHRpbWl6ZWRTZXNzaW9ucyxcbiAgICAgIHdlZWtseVNjaGVkdWxlOiB0aGlzLm9yZ2FuaXplU2Vzc2lvbnNCeVdlZWsob3B0aW1pemVkU2Vzc2lvbnMpLFxuICAgICAgYWRhcHRpdmVTZXR0aW5nczoge1xuICAgICAgICBhZGp1c3REaWZmaWN1bHR5QmFzZWRPblBlcmZvcm1hbmNlOiB0cnVlLFxuICAgICAgICBwcmlvcml0aXplV2Vha1N1YmplY3RzOiBkZWZhdWx0UHJlZmVyZW5jZXMucHJpb3JpdGl6ZVdlYWtTdWJqZWN0cyxcbiAgICAgICAgcmVzcGVjdEVuZXJneUxldmVsczogdHJ1ZSxcbiAgICAgICAgYWxsb3dGbGV4aWJsZVNjaGVkdWxpbmc6IHRydWVcbiAgICAgIH0sXG4gICAgICBtZXRyaWNzOiB0aGlzLmNhbGN1bGF0ZVBsYW5NZXRyaWNzKG9wdGltaXplZFNlc3Npb25zKSxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKVxuICAgIH1cblxuICAgIHJldHVybiBzdHVkeVBsYW5cbiAgfVxuXG4gIC8qKlxuICAgKiBBbmFsaXphIGxhcyBuZWNlc2lkYWRlcyBhY2Fkw6ltaWNhcyBkZWwgZXN0dWRpYW50ZVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYW5hbHl6ZUFjYWRlbWljTmVlZHMoY29udGV4dDogU3R1ZGVudENvbnRleHQpOiB7XG4gICAgdXJnZW50RGVhZGxpbmVzOiBBcnJheTx7c3ViamVjdDogc3RyaW5nLCBkZWFkbGluZTogRGF0ZSwgdHlwZTogc3RyaW5nLCBwcmVwYXJhdGlvbk5lZWRlZDogbnVtYmVyfT5cbiAgICB3ZWFrU3ViamVjdHM6IEFycmF5PHtzdWJqZWN0OiBzdHJpbmcsIHByaW9yaXR5OiBudW1iZXIsIGhvdXJzTmVlZGVkOiBudW1iZXJ9PlxuICAgIHJldmlld05lZWRzOiBBcnJheTx7c3ViamVjdDogc3RyaW5nLCB0b3BpY3M6IHN0cmluZ1tdLCBmcmVxdWVuY3k6IHN0cmluZ30+XG4gICAgZ29hbEJhc2VkTmVlZHM6IEFycmF5PHtnb2FsOiBTdHVkeUdvYWwsIHNlc3Npb25zTmVlZGVkOiBudW1iZXJ9PlxuICB9IHtcbiAgICBcbiAgICAvLyBBbmFsaXphciBkZWFkbGluZXMgdXJnZW50ZXNcbiAgICBjb25zdCB1cmdlbnREZWFkbGluZXMgPSBjb250ZXh0LnN1YmplY3RQZXJmb3JtYW5jZXNcbiAgICAgIC5mbGF0TWFwKHN1YmplY3QgPT4gXG4gICAgICAgIHN1YmplY3QudXBjb21pbmdEZWFkbGluZXNcbiAgICAgICAgICAuZmlsdGVyKGRlYWRsaW5lID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRheXNVbnRpbCA9IE1hdGguY2VpbCgoZGVhZGxpbmUuZGF0ZS5nZXRUaW1lKCkgLSBEYXRlLm5vdygpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSlcbiAgICAgICAgICAgIHJldHVybiBkYXlzVW50aWwgPD0gMTQgJiYgZGVhZGxpbmUucHJlcGFyYXRpb25TdGF0dXMgIT09ICdyZWFkeSdcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5tYXAoZGVhZGxpbmUgPT4gKHtcbiAgICAgICAgICAgIHN1YmplY3Q6IHN1YmplY3Quc3ViamVjdCxcbiAgICAgICAgICAgIGRlYWRsaW5lOiBkZWFkbGluZS5kYXRlLFxuICAgICAgICAgICAgdHlwZTogZGVhZGxpbmUudHlwZSxcbiAgICAgICAgICAgIHByZXBhcmF0aW9uTmVlZGVkOiB0aGlzLmVzdGltYXRlUHJlcGFyYXRpb25Ib3VycyhkZWFkbGluZS50eXBlLCBzdWJqZWN0LmRpZmZpY3VsdHlMZXZlbClcbiAgICAgICAgICB9KSlcbiAgICAgIClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhLmRlYWRsaW5lLmdldFRpbWUoKSAtIGIuZGVhZGxpbmUuZ2V0VGltZSgpKVxuXG4gICAgLy8gSWRlbnRpZmljYXIgbWF0ZXJpYXMgZMOpYmlsZXNcbiAgICBjb25zdCB3ZWFrU3ViamVjdHMgPSBjb250ZXh0LnN1YmplY3RQZXJmb3JtYW5jZXNcbiAgICAgIC5maWx0ZXIoc3ViamVjdCA9PiBzdWJqZWN0LmF2ZXJhZ2VHcmFkZSA8IDc1IHx8IHN1YmplY3Qud2Vha1RvcGljcy5sZW5ndGggPiAwKVxuICAgICAgLm1hcChzdWJqZWN0ID0+ICh7XG4gICAgICAgIHN1YmplY3Q6IHN1YmplY3Quc3ViamVjdCxcbiAgICAgICAgcHJpb3JpdHk6IHRoaXMuY2FsY3VsYXRlU3ViamVjdFByaW9yaXR5KHN1YmplY3QpLFxuICAgICAgICBob3Vyc05lZWRlZDogdGhpcy5lc3RpbWF0ZUltcHJvdmVtZW50SG91cnMoc3ViamVjdClcbiAgICAgIH0pKVxuICAgICAgLnNvcnQoKGEsIGIpID0+IGIucHJpb3JpdHkgLSBhLnByaW9yaXR5KVxuXG4gICAgLy8gRGV0ZXJtaW5hciBuZWNlc2lkYWRlcyBkZSByZXBhc29cbiAgICBjb25zdCByZXZpZXdOZWVkcyA9IGNvbnRleHQuc3ViamVjdFBlcmZvcm1hbmNlc1xuICAgICAgLm1hcChzdWJqZWN0ID0+ICh7XG4gICAgICAgIHN1YmplY3Q6IHN1YmplY3Quc3ViamVjdCxcbiAgICAgICAgdG9waWNzOiBzdWJqZWN0LnN0cm9uZ1RvcGljcyxcbiAgICAgICAgZnJlcXVlbmN5OiB0aGlzLmRldGVybWluZVJldmlld0ZyZXF1ZW5jeShzdWJqZWN0KVxuICAgICAgfSkpXG4gICAgICAuZmlsdGVyKHJldmlldyA9PiByZXZpZXcudG9waWNzLmxlbmd0aCA+IDApXG5cbiAgICAvLyBBbmFsaXphciBvYmpldGl2b3NcbiAgICBjb25zdCBnb2FsQmFzZWROZWVkcyA9IGNvbnRleHQuY3VycmVudEdvYWxzXG4gICAgICAuZmlsdGVyKGdvYWwgPT4gZ29hbC5wcm9ncmVzcyA8IDEwMClcbiAgICAgIC5tYXAoZ29hbCA9PiAoe1xuICAgICAgICBnb2FsLFxuICAgICAgICBzZXNzaW9uc05lZWRlZDogdGhpcy5lc3RpbWF0ZVNlc3Npb25zRm9yR29hbChnb2FsKVxuICAgICAgfSkpXG5cbiAgICByZXR1cm4geyB1cmdlbnREZWFkbGluZXMsIHdlYWtTdWJqZWN0cywgcmV2aWV3TmVlZHMsIGdvYWxCYXNlZE5lZWRzIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBJZGVudGlmaWNhIHNsb3RzIGRlIHRpZW1wbyBkaXNwb25pYmxlcyBwYXJhIGVzdHVkaW9cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGlkZW50aWZ5QXZhaWxhYmxlVGltZVNsb3RzKFxuICAgIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0LCBcbiAgICBwZXJpb2Q6IHsgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlIH1cbiAgKTogU3R1ZHlUaW1lU2xvdFtdIHtcbiAgICBjb25zdCBzbG90czogU3R1ZHlUaW1lU2xvdFtdID0gW11cbiAgICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKHBlcmlvZC5zdGFydERhdGUpXG4gICAgXG4gICAgd2hpbGUgKGN1cnJlbnREYXRlIDw9IHBlcmlvZC5lbmREYXRlKSB7XG4gICAgICBjb25zdCBkYXlPZldlZWsgPSB0aGlzLmdldERheU9mV2VlayhjdXJyZW50RGF0ZSlcbiAgICAgIFxuICAgICAgLy8gT2J0ZW5lciBjbGFzZXMgZGVsIGTDrWFcbiAgICAgIGNvbnN0IGRheUNsYXNzZXMgPSBjb250ZXh0LmFjYWRlbWljQ2FsZW5kYXIuc2Nob29sU2NoZWR1bGVcbiAgICAgICAgLmZpbHRlcihzY2hlZHVsZSA9PiBzY2hlZHVsZS5kYXkgPT09IGRheU9mV2VlaylcbiAgICAgIFxuICAgICAgLy8gR2VuZXJhciBzbG90cyBiYXPDoW5kb3NlIGVuIGVsIGhvcmFyaW8gZXNjb2xhciB5IHByZWZlcmVuY2lhc1xuICAgICAgY29uc3QgZGF5U2xvdHMgPSB0aGlzLmdlbmVyYXRlRGF5U2xvdHMoZGF5T2ZXZWVrLCBkYXlDbGFzc2VzLCBjb250ZXh0KVxuICAgICAgXG4gICAgICAvLyBBZ3JlZ2FyIGZlY2hhIGVzcGVjw61maWNhIGEgY2FkYSBzbG90XG4gICAgICBkYXlTbG90cy5mb3JFYWNoKHNsb3QgPT4ge1xuICAgICAgICBzbG90cy5wdXNoKHtcbiAgICAgICAgICAuLi5zbG90LFxuICAgICAgICAgIGRheTogY3VycmVudERhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdIC8vIFlZWVktTU0tREQgZm9ybWF0XG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgICAgXG4gICAgICBjdXJyZW50RGF0ZS5zZXREYXRlKGN1cnJlbnREYXRlLmdldERhdGUoKSArIDEpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzbG90c1xuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYSBzZXNpb25lcyBkZSBlc3R1ZGlvIGJhc2FkYXMgZW4gbmVjZXNpZGFkZXMgeSBzbG90cyBkaXNwb25pYmxlc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgYXN5bmMgZ2VuZXJhdGVTdHVkeVNlc3Npb25zKFxuICAgIGNvbnRleHQ6IFN0dWRlbnRDb250ZXh0LFxuICAgIG5lZWRzOiBSZXR1cm5UeXBlPHR5cGVvZiB0aGlzLmFuYWx5emVBY2FkZW1pY05lZWRzPixcbiAgICBhdmFpbGFibGVTbG90czogU3R1ZHlUaW1lU2xvdFtdLFxuICAgIHByZWZlcmVuY2VzOiBQbGFubmluZ1ByZWZlcmVuY2VzXG4gICk6IFByb21pc2U8U3R1ZHlTZXNzaW9uW10+IHtcbiAgICBcbiAgICBjb25zdCBzZXNzaW9uczogU3R1ZHlTZXNzaW9uW10gPSBbXVxuICAgIGxldCBzbG90SW5kZXggPSAwXG5cbiAgICAvLyAxLiBDcmVhciBzZXNpb25lcyBwYXJhIGRlYWRsaW5lcyB1cmdlbnRlcyAocHJpb3JpZGFkIG3DoXhpbWEpXG4gICAgZm9yIChjb25zdCBkZWFkbGluZSBvZiBuZWVkcy51cmdlbnREZWFkbGluZXMpIHtcbiAgICAgIGNvbnN0IHNlc3Npb25zTmVlZGVkID0gTWF0aC5jZWlsKGRlYWRsaW5lLnByZXBhcmF0aW9uTmVlZGVkIC8gKHByZWZlcmVuY2VzLnByZWZlcnJlZFNlc3Npb25EdXJhdGlvbiAvIDYwKSlcbiAgICAgIFxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZXNzaW9uc05lZWRlZCAmJiBzbG90SW5kZXggPCBhdmFpbGFibGVTbG90cy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBzbG90ID0gYXZhaWxhYmxlU2xvdHNbc2xvdEluZGV4KytdXG4gICAgICAgIFxuICAgICAgICBzZXNzaW9ucy5wdXNoKHRoaXMuY3JlYXRlU3R1ZHlTZXNzaW9uKHtcbiAgICAgICAgICBzbG90LFxuICAgICAgICAgIHN1YmplY3Q6IGRlYWRsaW5lLnN1YmplY3QsXG4gICAgICAgICAgdHlwZTogJ2V4YW1fcHJlcCcsXG4gICAgICAgICAgcHJpb3JpdHk6ICd1cmdlbnQnLFxuICAgICAgICAgIHRvcGljOiBgUHJlcGFyYWNpw7NuIHBhcmEgJHtkZWFkbGluZS50eXBlfWAsXG4gICAgICAgICAgZGVhZGxpbmU6IGRlYWRsaW5lLmRlYWRsaW5lLFxuICAgICAgICAgIHByZWZlcmVuY2VzXG4gICAgICAgIH0pKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDIuIENyZWFyIHNlc2lvbmVzIHBhcmEgbWF0ZXJpYXMgZMOpYmlsZXNcbiAgICBmb3IgKGNvbnN0IHdlYWtTdWJqZWN0IG9mIG5lZWRzLndlYWtTdWJqZWN0cykge1xuICAgICAgY29uc3Qgc2Vzc2lvbnNOZWVkZWQgPSBNYXRoLmNlaWwod2Vha1N1YmplY3QuaG91cnNOZWVkZWQgLyAocHJlZmVyZW5jZXMucHJlZmVycmVkU2Vzc2lvbkR1cmF0aW9uIC8gNjApKVxuICAgICAgXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNlc3Npb25zTmVlZGVkICYmIHNsb3RJbmRleCA8IGF2YWlsYWJsZVNsb3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHNsb3QgPSBhdmFpbGFibGVTbG90c1tzbG90SW5kZXgrK11cbiAgICAgICAgXG4gICAgICAgIHNlc3Npb25zLnB1c2godGhpcy5jcmVhdGVTdHVkeVNlc3Npb24oe1xuICAgICAgICAgIHNsb3QsXG4gICAgICAgICAgc3ViamVjdDogd2Vha1N1YmplY3Quc3ViamVjdCxcbiAgICAgICAgICB0eXBlOiAncHJhY3RpY2UnLFxuICAgICAgICAgIHByaW9yaXR5OiAnaGlnaCcsXG4gICAgICAgICAgdG9waWM6ICdSZWZ1ZXJ6byBkZSBjb25jZXB0b3MgZMOpYmlsZXMnLFxuICAgICAgICAgIHByZWZlcmVuY2VzXG4gICAgICAgIH0pKVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDMuIENyZWFyIHNlc2lvbmVzIGRlIHJlcGFzb1xuICAgIGlmIChwcmVmZXJlbmNlcy5pbmNsdWRlUmV2aWV3U2Vzc2lvbnMpIHtcbiAgICAgIGZvciAoY29uc3QgcmV2aWV3IG9mIG5lZWRzLnJldmlld05lZWRzKSB7XG4gICAgICAgIGNvbnN0IHJldmlld1Nlc3Npb24gPSB0aGlzLmNyZWF0ZVJldmlld1Nlc3Npb24ocmV2aWV3LCBhdmFpbGFibGVTbG90c1tzbG90SW5kZXgrK10sIHByZWZlcmVuY2VzKVxuICAgICAgICBpZiAocmV2aWV3U2Vzc2lvbikge1xuICAgICAgICAgIHNlc3Npb25zLnB1c2gocmV2aWV3U2Vzc2lvbilcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIDQuIENyZWFyIHNlc2lvbmVzIHBhcmEgb2JqZXRpdm9zIGVzcGVjw61maWNvc1xuICAgIGZvciAoY29uc3QgZ29hbE5lZWQgb2YgbmVlZHMuZ29hbEJhc2VkTmVlZHMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ29hbE5lZWQuc2Vzc2lvbnNOZWVkZWQgJiYgc2xvdEluZGV4IDwgYXZhaWxhYmxlU2xvdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc2xvdCA9IGF2YWlsYWJsZVNsb3RzW3Nsb3RJbmRleCsrXVxuICAgICAgICBcbiAgICAgICAgc2Vzc2lvbnMucHVzaCh0aGlzLmNyZWF0ZUdvYWxCYXNlZFNlc3Npb24oZ29hbE5lZWQuZ29hbCwgc2xvdCwgcHJlZmVyZW5jZXMpKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBzZXNzaW9uc1xuICB9XG5cbiAgLyoqXG4gICAqIENyZWEgdW5hIHNlc2nDs24gZGUgZXN0dWRpbyBpbmRpdmlkdWFsXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBjcmVhdGVTdHVkeVNlc3Npb24ocGFyYW1zOiB7XG4gICAgc2xvdDogU3R1ZHlUaW1lU2xvdFxuICAgIHN1YmplY3Q6IHN0cmluZ1xuICAgIHR5cGU6IFN0dWR5U2Vzc2lvblsndHlwZSddXG4gICAgcHJpb3JpdHk6IFN0dWR5U2Vzc2lvblsncHJpb3JpdHknXVxuICAgIHRvcGljOiBzdHJpbmdcbiAgICBkZWFkbGluZT86IERhdGVcbiAgICBwcmVmZXJlbmNlczogUGxhbm5pbmdQcmVmZXJlbmNlc1xuICB9KTogU3R1ZHlTZXNzaW9uIHtcbiAgICBcbiAgICBjb25zdCB7IHNsb3QsIHN1YmplY3QsIHR5cGUsIHByaW9yaXR5LCB0b3BpYywgcHJlZmVyZW5jZXMgfSA9IHBhcmFtc1xuICAgIGNvbnN0IGR1cmF0aW9uID0gTWF0aC5taW4oc2xvdC5kdXJhdGlvbiwgcHJlZmVyZW5jZXMucHJlZmVycmVkU2Vzc2lvbkR1cmF0aW9uKVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBpZDogYHNlc3Npb25fJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA4KX1gLFxuICAgICAgdGl0bGU6IGAke3N1YmplY3R9OiAke3RvcGljfWAsXG4gICAgICBzdWJqZWN0LFxuICAgICAgdG9waWMsXG4gICAgICBkYXRlOiBuZXcgRGF0ZShzbG90LmRheSksXG4gICAgICBzdGFydFRpbWU6IHNsb3Quc3RhcnRUaW1lLFxuICAgICAgZW5kVGltZTogdGhpcy5hZGRNaW51dGVzVG9UaW1lKHNsb3Quc3RhcnRUaW1lLCBkdXJhdGlvbiksXG4gICAgICBkdXJhdGlvbixcbiAgICAgIHR5cGUsXG4gICAgICBkaWZmaWN1bHR5OiB0aGlzLmluZmVyRGlmZmljdWx0eSh0eXBlLCBzdWJqZWN0KSxcbiAgICAgIHByaW9yaXR5LFxuICAgICAgdGVjaG5pcXVlczogdGhpcy5zZWxlY3RTdHVkeVRlY2huaXF1ZXModHlwZSwgc3ViamVjdCwgZHVyYXRpb24pLFxuICAgICAgbWF0ZXJpYWxzOiB0aGlzLnNlbGVjdFN0dWR5TWF0ZXJpYWxzKHN1YmplY3QsIHR5cGUpLFxuICAgICAgZ29hbHM6IFt0b3BpY10sXG4gICAgICBlc3RpbWF0ZWRGb2N1c0xldmVsOiB0aGlzLmVzdGltYXRlRm9jdXNMZXZlbChzbG90LmVuZXJneV9sZXZlbCwgdHlwZSksXG4gICAgICBlbmVyZ3lSZXF1aXJlbWVudDogdGhpcy5tYXBFbmVyZ3lMZXZlbChzbG90LmVuZXJneV9sZXZlbCksXG4gICAgICBlbnZpcm9ubWVudDogc2xvdC50eXBlID09PSAnZnJlZScgPyAncXVpZXQnIDogJ21vZGVyYXRlJyxcbiAgICAgIHN0YXR1czogJ3BsYW5uZWQnLFxuICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE9wdGltaXphIGxhIGRpc3RyaWJ1Y2nDs24gZGUgc2VzaW9uZXMgcGFyYSBldml0YXIgc29icmVjYXJnYVxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgb3B0aW1pemVTZXNzaW9uRGlzdHJpYnV0aW9uKFxuICAgIHNlc3Npb25zOiBTdHVkeVNlc3Npb25bXSwgXG4gICAgY29udGV4dDogU3R1ZGVudENvbnRleHRcbiAgKTogU3R1ZHlTZXNzaW9uW10ge1xuICAgIFxuICAgIC8vIEFncnVwYXIgc2VzaW9uZXMgcG9yIGTDrWFcbiAgICBjb25zdCBzZXNzaW9uc0J5RGF5ID0gc2Vzc2lvbnMucmVkdWNlKChhY2MsIHNlc3Npb24pID0+IHtcbiAgICAgIGNvbnN0IGRhdGVLZXkgPSBzZXNzaW9uLmRhdGUudG9JU09TdHJpbmcoKS5zcGxpdCgnVCcpWzBdXG4gICAgICBpZiAoIWFjY1tkYXRlS2V5XSkgYWNjW2RhdGVLZXldID0gW11cbiAgICAgIGFjY1tkYXRlS2V5XS5wdXNoKHNlc3Npb24pXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30gYXMgeyBbZGF0ZTogc3RyaW5nXTogU3R1ZHlTZXNzaW9uW10gfSlcblxuICAgIC8vIE9wdGltaXphciBjYWRhIGTDrWFcbiAgICBjb25zdCBvcHRpbWl6ZWRTZXNzaW9uczogU3R1ZHlTZXNzaW9uW10gPSBbXVxuICAgIFxuICAgIGZvciAoY29uc3QgW2RhdGUsIGRheVNlc3Npb25zXSBvZiBPYmplY3QuZW50cmllcyhzZXNzaW9uc0J5RGF5KSkge1xuICAgICAgLy8gTGltaXRhciBzZXNpb25lcyBwb3IgZMOtYSBzZWfDum4gcHJlZmVyZW5jaWFzXG4gICAgICBjb25zdCBtYXhTZXNzaW9ucyA9IGNvbnRleHQubGVhcm5pbmdTdHlsZS5wcmVmZXJlbmNlcy5zZXNzaW9uRHVyYXRpb24gPT09ICdsb25nJyA/IDIgOiA0XG4gICAgICBjb25zdCBwcmlvcml0aXplZFNlc3Npb25zID0gZGF5U2Vzc2lvbnNcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IHRoaXMucHJpb3JpdHlXZWlnaHQoYi5wcmlvcml0eSkgLSB0aGlzLnByaW9yaXR5V2VpZ2h0KGEucHJpb3JpdHkpKVxuICAgICAgICAuc2xpY2UoMCwgbWF4U2Vzc2lvbnMpXG4gICAgICBcbiAgICAgIC8vIEJhbGFuY2VhciBkaWZpY3VsdGFkIGEgbG8gbGFyZ28gZGVsIGTDrWFcbiAgICAgIGNvbnN0IGJhbGFuY2VkU2Vzc2lvbnMgPSB0aGlzLmJhbGFuY2VTZXNzaW9uRGlmZmljdWx0eShwcmlvcml0aXplZFNlc3Npb25zKVxuICAgICAgXG4gICAgICBvcHRpbWl6ZWRTZXNzaW9ucy5wdXNoKC4uLmJhbGFuY2VkU2Vzc2lvbnMpXG4gICAgfVxuXG4gICAgcmV0dXJuIG9wdGltaXplZFNlc3Npb25zXG4gIH1cblxuICAvKipcbiAgICogT3JnYW5pemEgc2VzaW9uZXMgcG9yIHNlbWFuYSBwYXJhIGVsIHBsYW5cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIG9yZ2FuaXplU2Vzc2lvbnNCeVdlZWsoc2Vzc2lvbnM6IFN0dWR5U2Vzc2lvbltdKTogeyBbZGF5OiBzdHJpbmddOiBTdHVkeVNlc3Npb25bXSB9IHtcbiAgICByZXR1cm4gc2Vzc2lvbnMucmVkdWNlKChhY2MsIHNlc3Npb24pID0+IHtcbiAgICAgIGNvbnN0IGRheUtleSA9IHNlc3Npb24uZGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoJ2VzLUVTJywgeyB3ZWVrZGF5OiAnbG9uZycgfSlcbiAgICAgIGlmICghYWNjW2RheUtleV0pIGFjY1tkYXlLZXldID0gW11cbiAgICAgIGFjY1tkYXlLZXldLnB1c2goc2Vzc2lvbilcbiAgICAgIHJldHVybiBhY2NcbiAgICB9LCB7fSBhcyB7IFtkYXk6IHN0cmluZ106IFN0dWR5U2Vzc2lvbltdIH0pXG4gIH1cblxuICAvKipcbiAgICogQ2FsY3VsYSBtw6l0cmljYXMgZGVsIHBsYW4gZGUgZXN0dWRpb1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgY2FsY3VsYXRlUGxhbk1ldHJpY3Moc2Vzc2lvbnM6IFN0dWR5U2Vzc2lvbltdKTogU3R1ZHlQbGFuWydtZXRyaWNzJ10ge1xuICAgIGNvbnN0IHRvdGFsSG91cnMgPSBzZXNzaW9ucy5yZWR1Y2UoKHN1bSwgc2Vzc2lvbikgPT4gc3VtICsgc2Vzc2lvbi5kdXJhdGlvbiwgMCkgLyA2MFxuICAgIFxuICAgIGNvbnN0IHN1YmplY3RCYWxhbmNlID0gc2Vzc2lvbnMucmVkdWNlKChhY2MsIHNlc3Npb24pID0+IHtcbiAgICAgIGFjY1tzZXNzaW9uLnN1YmplY3RdID0gKGFjY1tzZXNzaW9uLnN1YmplY3RdIHx8IDApICsgc2Vzc2lvbi5kdXJhdGlvbiAvIDYwXG4gICAgICByZXR1cm4gYWNjXG4gICAgfSwge30gYXMgeyBbc3ViamVjdDogc3RyaW5nXTogbnVtYmVyIH0pXG5cbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxQbGFubmVkSG91cnM6IHRvdGFsSG91cnMsXG4gICAgICBhY3R1YWxTdHVkeUhvdXJzOiAwLCAvLyBTZSBhY3R1YWxpemFyw6EgY29uZm9ybWUgc2UgY29tcGxldGVuIHNlc2lvbmVzXG4gICAgICBhdmVyYWdlRWZmZWN0aXZlbmVzczogMCwgLy8gU2UgY2FsY3VsYXLDoSBjb24gZmVlZGJhY2tcbiAgICAgIGdvYWxDb21wbGV0aW9uUmF0ZTogMCwgLy8gU2UgYWN0dWFsaXphcsOhIGNvbiBwcm9ncmVzb1xuICAgICAgc3ViamVjdEJhbGFuY2VcbiAgICB9XG4gIH1cblxuICAvLyBGdW5jaW9uZXMgYXV4aWxpYXJlc1xuICBcbiAgcHJpdmF0ZSBzdGF0aWMgZXN0aW1hdGVQcmVwYXJhdGlvbkhvdXJzKHR5cGU6IHN0cmluZywgZGlmZmljdWx0eUxldmVsOiBudW1iZXIpOiBudW1iZXIge1xuICAgIGNvbnN0IGJhc2VIb3VycyA9IHtcbiAgICAgICdleGFtJzogOCxcbiAgICAgICdhc3NpZ25tZW50JzogNCxcbiAgICAgICdwcm9qZWN0JzogMTIsXG4gICAgICAncXVpeic6IDJcbiAgICB9XG4gICAgcmV0dXJuIChiYXNlSG91cnNbdHlwZSBhcyBrZXlvZiB0eXBlb2YgYmFzZUhvdXJzXSB8fCA0KSAqIChkaWZmaWN1bHR5TGV2ZWwgLyA1KVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY2FsY3VsYXRlU3ViamVjdFByaW9yaXR5KHN1YmplY3Q6IFN1YmplY3RQZXJmb3JtYW5jZSk6IG51bWJlciB7XG4gICAgbGV0IHByaW9yaXR5ID0gMFxuICAgIFxuICAgIC8vIFByaW9yaWRhZCBiYXNhZGEgZW4gY2FsaWZpY2FjacOzblxuICAgIGlmIChzdWJqZWN0LmF2ZXJhZ2VHcmFkZSA8IDYwKSBwcmlvcml0eSArPSAxMFxuICAgIGVsc2UgaWYgKHN1YmplY3QuYXZlcmFnZUdyYWRlIDwgNzApIHByaW9yaXR5ICs9IDdcbiAgICBlbHNlIGlmIChzdWJqZWN0LmF2ZXJhZ2VHcmFkZSA8IDgwKSBwcmlvcml0eSArPSA1XG4gICAgXG4gICAgLy8gUHJpb3JpZGFkIGJhc2FkYSBlbiB0ZW1hcyBkw6liaWxlc1xuICAgIHByaW9yaXR5ICs9IHN1YmplY3Qud2Vha1RvcGljcy5sZW5ndGggKiAyXG4gICAgXG4gICAgLy8gUHJpb3JpZGFkIGJhc2FkYSBlbiBwcsOzeGltb3MgZGVhZGxpbmVzXG4gICAgcHJpb3JpdHkgKz0gc3ViamVjdC51cGNvbWluZ0RlYWRsaW5lcy5sZW5ndGggKiAzXG4gICAgXG4gICAgLy8gUHJpb3JpZGFkIGJhc2FkYSBlbiB0aWVtcG8gc2luIGVzdHVkaWFyXG4gICAgY29uc3QgZGF5c1NpbmNlTGFzdFN0dWR5ID0gTWF0aC5mbG9vcigoRGF0ZS5ub3coKSAtIHN1YmplY3QubGFzdFN0dWRpZWQuZ2V0VGltZSgpKSAvICgxMDAwICogNjAgKiA2MCAqIDI0KSlcbiAgICBpZiAoZGF5c1NpbmNlTGFzdFN0dWR5ID4gNykgcHJpb3JpdHkgKz0gNVxuICAgIFxuICAgIHJldHVybiBwcmlvcml0eVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZXN0aW1hdGVJbXByb3ZlbWVudEhvdXJzKHN1YmplY3Q6IFN1YmplY3RQZXJmb3JtYW5jZSk6IG51bWJlciB7XG4gICAgY29uc3QgZ3JhZGVHYXAgPSBNYXRoLm1heCgwLCA4MCAtIHN1YmplY3QuYXZlcmFnZUdyYWRlKSAvLyBPYmpldGl2bzogbGxlZ2FyIGEgODBcbiAgICBjb25zdCB3ZWFrVG9waWNzSG91cnMgPSBzdWJqZWN0LndlYWtUb3BpY3MubGVuZ3RoICogMlxuICAgIGNvbnN0IGRpZmZpY3VsdHlNdWx0aXBsaWVyID0gc3ViamVjdC5kaWZmaWN1bHR5TGV2ZWwgLyA1XG4gICAgXG4gICAgcmV0dXJuIChncmFkZUdhcCAqIDAuNSArIHdlYWtUb3BpY3NIb3VycykgKiBkaWZmaWN1bHR5TXVsdGlwbGllclxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZGV0ZXJtaW5lUmV2aWV3RnJlcXVlbmN5KHN1YmplY3Q6IFN1YmplY3RQZXJmb3JtYW5jZSk6IHN0cmluZyB7XG4gICAgaWYgKHN1YmplY3QuYXZlcmFnZUdyYWRlID4gOTApIHJldHVybiAnbW9udGhseSdcbiAgICBpZiAoc3ViamVjdC5hdmVyYWdlR3JhZGUgPiA4MCkgcmV0dXJuICdiaXdlZWtseSdcbiAgICByZXR1cm4gJ3dlZWtseSdcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGVzdGltYXRlU2Vzc2lvbnNGb3JHb2FsKGdvYWw6IFN0dWR5R29hbCk6IG51bWJlciB7XG4gICAgY29uc3QgcmVtYWluaW5nUHJvZ3Jlc3MgPSAxMDAgLSBnb2FsLnByb2dyZXNzXG4gICAgY29uc3QgY29tcGxleGl0eSA9IGdvYWwubWlsZXN0b25lcy5sZW5ndGhcbiAgICByZXR1cm4gTWF0aC5jZWlsKChyZW1haW5pbmdQcm9ncmVzcyAvIDEwMCkgKiBjb21wbGV4aXR5ICogMilcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdldERheU9mV2VlayhkYXRlOiBEYXRlKTogc3RyaW5nIHtcbiAgICBjb25zdCBkYXlzID0gWydzdW5kYXknLCAnbW9uZGF5JywgJ3R1ZXNkYXknLCAnd2VkbmVzZGF5JywgJ3RodXJzZGF5JywgJ2ZyaWRheScsICdzYXR1cmRheSddXG4gICAgcmV0dXJuIGRheXNbZGF0ZS5nZXREYXkoKV1cbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlRGF5U2xvdHMoXG4gICAgZGF5T2ZXZWVrOiBzdHJpbmcsIFxuICAgIGRheUNsYXNzZXM6IGFueVtdLCBcbiAgICBjb250ZXh0OiBTdHVkZW50Q29udGV4dFxuICApOiBTdHVkeVRpbWVTbG90W10ge1xuICAgIC8vIEVzdGEgZnVuY2nDs24gZ2VuZXJhcsOtYSBzbG90cyBkZSBlc3R1ZGlvIGJhc8OhbmRvc2UgZW4gZWwgaG9yYXJpbyBkZSBjbGFzZXNcbiAgICAvLyBQb3Igc2ltcGxpY2lkYWQsIHJldG9ybmFtb3Mgc2xvdHMgYsOhc2ljb3NcbiAgICBjb25zdCBiYXNpY1Nsb3RzOiBTdHVkeVRpbWVTbG90W10gPSBbXG4gICAgICB7XG4gICAgICAgIGRheTogZGF5T2ZXZWVrLFxuICAgICAgICBzdGFydFRpbWU6ICcwODowMCcsXG4gICAgICAgIGVuZFRpbWU6ICcxMDowMCcsXG4gICAgICAgIGR1cmF0aW9uOiAxMjAsXG4gICAgICAgIHR5cGU6ICdmcmVlJyxcbiAgICAgICAgcmVjb21tZW5kZWRGb3I6IFsncmV2aWV3J10sXG4gICAgICAgIGVuZXJneV9sZXZlbDogJ2hpZ2gnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBkYXk6IGRheU9mV2VlayxcbiAgICAgICAgc3RhcnRUaW1lOiAnMTQ6MDAnLFxuICAgICAgICBlbmRUaW1lOiAnMTY6MDAnLFxuICAgICAgICBkdXJhdGlvbjogMTIwLFxuICAgICAgICB0eXBlOiAnZnJlZScsXG4gICAgICAgIHJlY29tbWVuZGVkRm9yOiBbJ3ByYWN0aWNlJ10sXG4gICAgICAgIGVuZXJneV9sZXZlbDogJ2hpZ2gnXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBkYXk6IGRheU9mV2VlayxcbiAgICAgICAgc3RhcnRUaW1lOiAnMTk6MDAnLFxuICAgICAgICBlbmRUaW1lOiAnMjE6MDAnLFxuICAgICAgICBkdXJhdGlvbjogMTIwLFxuICAgICAgICB0eXBlOiAnZnJlZScsXG4gICAgICAgIHJlY29tbWVuZGVkRm9yOiBbJ2hvbWV3b3JrJ10sXG4gICAgICAgIGVuZXJneV9sZXZlbDogJ21lZGl1bSdcbiAgICAgIH1cbiAgICBdXG5cbiAgICByZXR1cm4gYmFzaWNTbG90c1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgYWRkTWludXRlc1RvVGltZSh0aW1lOiBzdHJpbmcsIG1pbnV0ZXM6IG51bWJlcik6IHN0cmluZyB7XG4gICAgY29uc3QgW2hvdXJzLCBtaW5zXSA9IHRpbWUuc3BsaXQoJzonKS5tYXAoTnVtYmVyKVxuICAgIGNvbnN0IHRvdGFsTWludXRlcyA9IGhvdXJzICogNjAgKyBtaW5zICsgbWludXRlc1xuICAgIGNvbnN0IG5ld0hvdXJzID0gTWF0aC5mbG9vcih0b3RhbE1pbnV0ZXMgLyA2MCkgJSAyNFxuICAgIGNvbnN0IG5ld01pbnMgPSB0b3RhbE1pbnV0ZXMgJSA2MFxuICAgIHJldHVybiBgJHtuZXdIb3Vycy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9OiR7bmV3TWlucy50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9YFxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgaW5mZXJEaWZmaWN1bHR5KHR5cGU6IFN0dWR5U2Vzc2lvblsndHlwZSddLCBzdWJqZWN0OiBzdHJpbmcpOiBTdHVkeVNlc3Npb25bJ2RpZmZpY3VsdHknXSB7XG4gICAgaWYgKHR5cGUgPT09ICdleGFtX3ByZXAnIHx8IHR5cGUgPT09ICduZXdfbWF0ZXJpYWwnKSByZXR1cm4gJ2hhcmQnXG4gICAgaWYgKHR5cGUgPT09ICdwcmFjdGljZScgfHwgdHlwZSA9PT0gJ2hvbWV3b3JrJykgcmV0dXJuICdtZWRpdW0nXG4gICAgcmV0dXJuICdlYXN5J1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgc2VsZWN0U3R1ZHlUZWNobmlxdWVzKHR5cGU6IFN0dWR5U2Vzc2lvblsndHlwZSddLCBzdWJqZWN0OiBzdHJpbmcsIGR1cmF0aW9uOiBudW1iZXIpOiBTdHVkeVRlY2huaXF1ZVtdIHtcbiAgICAvLyBSZXRvcm5hciB0w6ljbmljYXMgYXByb3BpYWRhcyBzZWfDum4gZWwgdGlwbyBkZSBzZXNpw7NuXG4gICAgY29uc3QgdGVjaG5pcXVlczogU3R1ZHlUZWNobmlxdWVbXSA9IFtdXG4gICAgXG4gICAgaWYgKGR1cmF0aW9uID49IDQ1KSB7XG4gICAgICB0ZWNobmlxdWVzLnB1c2goe1xuICAgICAgICBuYW1lOiAnUG9tb2Rvcm8gVGVjaG5pcXVlJyxcbiAgICAgICAgZGVzY3JpcHRpb246ICcyNSBtaW4gZXN0dWRpbyArIDUgbWluIGRlc2NhbnNvJyxcbiAgICAgICAgZHVyYXRpb246IDMwLFxuICAgICAgICBlZmZlY3RpdmVuZXNzOiA4LFxuICAgICAgICBhcHBsaWNhYmxlU3ViamVjdHM6IFsnYW55J10sXG4gICAgICAgIHJlcXVpcmVkTWF0ZXJpYWxzOiBbJ3RpbWVyJ11cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgcmV0dXJuIHRlY2huaXF1ZXNcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIHNlbGVjdFN0dWR5TWF0ZXJpYWxzKHN1YmplY3Q6IHN0cmluZywgdHlwZTogU3R1ZHlTZXNzaW9uWyd0eXBlJ10pOiBTdHVkeU1hdGVyaWFsW10ge1xuICAgIC8vIFJldG9ybmFyIG1hdGVyaWFsZXMgYXByb3BpYWRvc1xuICAgIHJldHVybiBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6ICd0ZXh0Ym9vaycsXG4gICAgICAgIG5hbWU6IGBMaWJybyBkZSAke3N1YmplY3R9YCxcbiAgICAgICAgZXN0aW1hdGVkVGltZTogMzAsXG4gICAgICAgIGRpZmZpY3VsdHk6ICdpbnRlcm1lZGlhdGUnXG4gICAgICB9XG4gICAgXVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgZXN0aW1hdGVGb2N1c0xldmVsKGVuZXJneUxldmVsOiBTdHVkeVRpbWVTbG90WydlbmVyZ3lfbGV2ZWwnXSwgdHlwZTogU3R1ZHlTZXNzaW9uWyd0eXBlJ10pOiBudW1iZXIge1xuICAgIGNvbnN0IGVuZXJneU1hcCA9IHsgaGlnaDogOSwgbWVkaXVtOiA3LCBsb3c6IDUgfVxuICAgIGNvbnN0IHR5cGVNYXAgPSB7IGV4YW1fcHJlcDogOSwgbmV3X21hdGVyaWFsOiA4LCBwcmFjdGljZTogNywgcmV2aWV3OiA2LCBob21ld29yazogNSwgcHJvamVjdDogOCB9XG4gICAgXG4gICAgcmV0dXJuIE1hdGgubWluKDEwLCAoZW5lcmd5TWFwW2VuZXJneUxldmVsXSArIHR5cGVNYXBbdHlwZV0pIC8gMilcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIG1hcEVuZXJneUxldmVsKGxldmVsOiBTdHVkeVRpbWVTbG90WydlbmVyZ3lfbGV2ZWwnXSk6IFN0dWR5U2Vzc2lvblsnZW5lcmd5UmVxdWlyZW1lbnQnXSB7XG4gICAgcmV0dXJuIGxldmVsIGFzIFN0dWR5U2Vzc2lvblsnZW5lcmd5UmVxdWlyZW1lbnQnXVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgcHJpb3JpdHlXZWlnaHQocHJpb3JpdHk6IFN0dWR5U2Vzc2lvblsncHJpb3JpdHknXSk6IG51bWJlciB7XG4gICAgY29uc3Qgd2VpZ2h0cyA9IHsgdXJnZW50OiA0LCBoaWdoOiAzLCBtZWRpdW06IDIsIGxvdzogMSB9XG4gICAgcmV0dXJuIHdlaWdodHNbcHJpb3JpdHldXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBiYWxhbmNlU2Vzc2lvbkRpZmZpY3VsdHkoc2Vzc2lvbnM6IFN0dWR5U2Vzc2lvbltdKTogU3R1ZHlTZXNzaW9uW10ge1xuICAgIC8vIE9yZGVuYXIgcGFyYSBhbHRlcm5hciBkaWZpY3VsdGFkZXMgY3VhbmRvIHNlYSBwb3NpYmxlXG4gICAgcmV0dXJuIHNlc3Npb25zLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGlmIChhLmRpZmZpY3VsdHkgPT09ICdoYXJkJyAmJiBiLmRpZmZpY3VsdHkgPT09ICdlYXN5JykgcmV0dXJuIC0xXG4gICAgICBpZiAoYS5kaWZmaWN1bHR5ID09PSAnZWFzeScgJiYgYi5kaWZmaWN1bHR5ID09PSAnaGFyZCcpIHJldHVybiAxXG4gICAgICByZXR1cm4gMFxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBnZW5lcmF0ZVBsYW5UaXRsZShwZXJpb2Q6IHsgc3RhcnREYXRlOiBEYXRlLCBlbmREYXRlOiBEYXRlIH0sIG5lZWRzOiBhbnkpOiBzdHJpbmcge1xuICAgIGNvbnN0IGR1cmF0aW9uID0gTWF0aC5jZWlsKChwZXJpb2QuZW5kRGF0ZS5nZXRUaW1lKCkgLSBwZXJpb2Quc3RhcnREYXRlLmdldFRpbWUoKSkgLyAoMTAwMCAqIDYwICogNjAgKiAyNCkpXG4gICAgcmV0dXJuIGBQbGFuIGRlIEVzdHVkaW8gLSAke2R1cmF0aW9ufSBkw61hc2BcbiAgfVxuXG4gIHByaXZhdGUgc3RhdGljIGdlbmVyYXRlUGxhbkRlc2NyaXB0aW9uKG5lZWRzOiBhbnksIHNlc3Npb25Db3VudDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFBsYW4gcGVyc29uYWxpemFkbyBjb24gJHtzZXNzaW9uQ291bnR9IHNlc2lvbmVzIGRlIGVzdHVkaW8sIGVuZm9jYWRvIGVuICR7bmVlZHMudXJnZW50RGVhZGxpbmVzLmxlbmd0aH0gZGVhZGxpbmVzIHVyZ2VudGVzIHkgJHtuZWVkcy53ZWFrU3ViamVjdHMubGVuZ3RofSBtYXRlcmlhcyBwb3IgcmVmb3J6YXIuYFxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlUmV2aWV3U2Vzc2lvbihyZXZpZXc6IGFueSwgc2xvdDogU3R1ZHlUaW1lU2xvdCwgcHJlZmVyZW5jZXM6IFBsYW5uaW5nUHJlZmVyZW5jZXMpOiBTdHVkeVNlc3Npb24gfCBudWxsIHtcbiAgICBpZiAoIXNsb3QpIHJldHVybiBudWxsXG5cbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTdHVkeVNlc3Npb24oe1xuICAgICAgc2xvdCxcbiAgICAgIHN1YmplY3Q6IHJldmlldy5zdWJqZWN0LFxuICAgICAgdHlwZTogJ3JldmlldycsXG4gICAgICBwcmlvcml0eTogJ21lZGl1bScsXG4gICAgICB0b3BpYzogYFJlcGFzbyBkZSAke3Jldmlldy50b3BpY3Muc2xpY2UoMCwgMikuam9pbignLCAnKX1gLFxuICAgICAgcHJlZmVyZW5jZXNcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgY3JlYXRlR29hbEJhc2VkU2Vzc2lvbihnb2FsOiBTdHVkeUdvYWwsIHNsb3Q6IFN0dWR5VGltZVNsb3QsIHByZWZlcmVuY2VzOiBQbGFubmluZ1ByZWZlcmVuY2VzKTogU3R1ZHlTZXNzaW9uIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVTdHVkeVNlc3Npb24oe1xuICAgICAgc2xvdCxcbiAgICAgIHN1YmplY3Q6IGdvYWwuc3ViamVjdCB8fCAnR2VuZXJhbCcsXG4gICAgICB0eXBlOiAncHJvamVjdCcsXG4gICAgICBwcmlvcml0eTogZ29hbC5wcmlvcml0eSA9PT0gJ3VyZ2VudCcgPyAndXJnZW50JyA6ICdoaWdoJyxcbiAgICAgIHRvcGljOiBnb2FsLnRpdGxlLFxuICAgICAgcHJlZmVyZW5jZXNcbiAgICB9KVxuICB9XG59Il0sIm5hbWVzIjpbIlN0dWR5U2Vzc2lvblBsYW5uZXIiLCJnZW5lcmF0ZVN0dWR5UGxhbiIsImNvbnRleHQiLCJwbGFubmluZ1BlcmlvZCIsInByZWZlcmVuY2VzIiwiZGVmYXVsdFByZWZlcmVuY2VzIiwicHJlZmVycmVkU2Vzc2lvbkR1cmF0aW9uIiwibWF4U2Vzc2lvbnNQZXJEYXkiLCJicmVha0R1cmF0aW9uQmV0d2VlblNlc3Npb25zIiwicHJlZmVycmVkU3R1ZHlUaW1lcyIsInN0dWR5UGF0dGVybnMiLCJwYXR0ZXJucyIsIm1vc3RQcm9kdWN0aXZlSG91cnMiLCJhdm9pZFRpbWVzIiwicHJpb3JpdGl6ZVdlYWtTdWJqZWN0cyIsImluY2x1ZGVSZXZpZXdTZXNzaW9ucyIsImFkYXB0VG9Nb29kIiwicmVzcGVjdFNsZWVwU2NoZWR1bGUiLCJhY2FkZW1pY05lZWRzIiwiYW5hbHl6ZUFjYWRlbWljTmVlZHMiLCJhdmFpbGFibGVTbG90cyIsImlkZW50aWZ5QXZhaWxhYmxlVGltZVNsb3RzIiwic2Vzc2lvbnMiLCJnZW5lcmF0ZVN0dWR5U2Vzc2lvbnMiLCJvcHRpbWl6ZWRTZXNzaW9ucyIsIm9wdGltaXplU2Vzc2lvbkRpc3RyaWJ1dGlvbiIsInN0dWR5UGxhbiIsImlkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0ciIsInVzZXJJZCIsInRpdGxlIiwiZ2VuZXJhdGVQbGFuVGl0bGUiLCJkZXNjcmlwdGlvbiIsImdlbmVyYXRlUGxhbkRlc2NyaXB0aW9uIiwibGVuZ3RoIiwic3RhcnREYXRlIiwiZW5kRGF0ZSIsInRvdGFsU2Vzc2lvbnMiLCJjb21wbGV0ZWRTZXNzaW9ucyIsInN1YmplY3RzIiwiU2V0IiwibWFwIiwicyIsInN1YmplY3QiLCJnb2FscyIsImN1cnJlbnRHb2FscyIsIndlZWtseVNjaGVkdWxlIiwib3JnYW5pemVTZXNzaW9uc0J5V2VlayIsImFkYXB0aXZlU2V0dGluZ3MiLCJhZGp1c3REaWZmaWN1bHR5QmFzZWRPblBlcmZvcm1hbmNlIiwicmVzcGVjdEVuZXJneUxldmVscyIsImFsbG93RmxleGlibGVTY2hlZHVsaW5nIiwibWV0cmljcyIsImNhbGN1bGF0ZVBsYW5NZXRyaWNzIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwidXJnZW50RGVhZGxpbmVzIiwic3ViamVjdFBlcmZvcm1hbmNlcyIsImZsYXRNYXAiLCJ1cGNvbWluZ0RlYWRsaW5lcyIsImZpbHRlciIsImRlYWRsaW5lIiwiZGF5c1VudGlsIiwiY2VpbCIsImRhdGUiLCJnZXRUaW1lIiwicHJlcGFyYXRpb25TdGF0dXMiLCJ0eXBlIiwicHJlcGFyYXRpb25OZWVkZWQiLCJlc3RpbWF0ZVByZXBhcmF0aW9uSG91cnMiLCJkaWZmaWN1bHR5TGV2ZWwiLCJzb3J0IiwiYSIsImIiLCJ3ZWFrU3ViamVjdHMiLCJhdmVyYWdlR3JhZGUiLCJ3ZWFrVG9waWNzIiwicHJpb3JpdHkiLCJjYWxjdWxhdGVTdWJqZWN0UHJpb3JpdHkiLCJob3Vyc05lZWRlZCIsImVzdGltYXRlSW1wcm92ZW1lbnRIb3VycyIsInJldmlld05lZWRzIiwidG9waWNzIiwic3Ryb25nVG9waWNzIiwiZnJlcXVlbmN5IiwiZGV0ZXJtaW5lUmV2aWV3RnJlcXVlbmN5IiwicmV2aWV3IiwiZ29hbEJhc2VkTmVlZHMiLCJnb2FsIiwicHJvZ3Jlc3MiLCJzZXNzaW9uc05lZWRlZCIsImVzdGltYXRlU2Vzc2lvbnNGb3JHb2FsIiwicGVyaW9kIiwic2xvdHMiLCJjdXJyZW50RGF0ZSIsImRheU9mV2VlayIsImdldERheU9mV2VlayIsImRheUNsYXNzZXMiLCJhY2FkZW1pY0NhbGVuZGFyIiwic2Nob29sU2NoZWR1bGUiLCJzY2hlZHVsZSIsImRheSIsImRheVNsb3RzIiwiZ2VuZXJhdGVEYXlTbG90cyIsImZvckVhY2giLCJzbG90IiwicHVzaCIsInRvSVNPU3RyaW5nIiwic3BsaXQiLCJzZXREYXRlIiwiZ2V0RGF0ZSIsIm5lZWRzIiwic2xvdEluZGV4IiwiaSIsImNyZWF0ZVN0dWR5U2Vzc2lvbiIsInRvcGljIiwid2Vha1N1YmplY3QiLCJyZXZpZXdTZXNzaW9uIiwiY3JlYXRlUmV2aWV3U2Vzc2lvbiIsImdvYWxOZWVkIiwiY3JlYXRlR29hbEJhc2VkU2Vzc2lvbiIsInBhcmFtcyIsImR1cmF0aW9uIiwibWluIiwic3RhcnRUaW1lIiwiZW5kVGltZSIsImFkZE1pbnV0ZXNUb1RpbWUiLCJkaWZmaWN1bHR5IiwiaW5mZXJEaWZmaWN1bHR5IiwidGVjaG5pcXVlcyIsInNlbGVjdFN0dWR5VGVjaG5pcXVlcyIsIm1hdGVyaWFscyIsInNlbGVjdFN0dWR5TWF0ZXJpYWxzIiwiZXN0aW1hdGVkRm9jdXNMZXZlbCIsImVzdGltYXRlRm9jdXNMZXZlbCIsImVuZXJneV9sZXZlbCIsImVuZXJneVJlcXVpcmVtZW50IiwibWFwRW5lcmd5TGV2ZWwiLCJlbnZpcm9ubWVudCIsInN0YXR1cyIsInNlc3Npb25zQnlEYXkiLCJyZWR1Y2UiLCJhY2MiLCJzZXNzaW9uIiwiZGF0ZUtleSIsImRheVNlc3Npb25zIiwiT2JqZWN0IiwiZW50cmllcyIsIm1heFNlc3Npb25zIiwibGVhcm5pbmdTdHlsZSIsInNlc3Npb25EdXJhdGlvbiIsInByaW9yaXRpemVkU2Vzc2lvbnMiLCJwcmlvcml0eVdlaWdodCIsInNsaWNlIiwiYmFsYW5jZWRTZXNzaW9ucyIsImJhbGFuY2VTZXNzaW9uRGlmZmljdWx0eSIsImRheUtleSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsIndlZWtkYXkiLCJ0b3RhbEhvdXJzIiwic3VtIiwic3ViamVjdEJhbGFuY2UiLCJ0b3RhbFBsYW5uZWRIb3VycyIsImFjdHVhbFN0dWR5SG91cnMiLCJhdmVyYWdlRWZmZWN0aXZlbmVzcyIsImdvYWxDb21wbGV0aW9uUmF0ZSIsImJhc2VIb3VycyIsImRheXNTaW5jZUxhc3RTdHVkeSIsImZsb29yIiwibGFzdFN0dWRpZWQiLCJncmFkZUdhcCIsIm1heCIsIndlYWtUb3BpY3NIb3VycyIsImRpZmZpY3VsdHlNdWx0aXBsaWVyIiwicmVtYWluaW5nUHJvZ3Jlc3MiLCJjb21wbGV4aXR5IiwibWlsZXN0b25lcyIsImRheXMiLCJnZXREYXkiLCJiYXNpY1Nsb3RzIiwicmVjb21tZW5kZWRGb3IiLCJ0aW1lIiwibWludXRlcyIsImhvdXJzIiwibWlucyIsIk51bWJlciIsInRvdGFsTWludXRlcyIsIm5ld0hvdXJzIiwibmV3TWlucyIsInBhZFN0YXJ0IiwibmFtZSIsImVmZmVjdGl2ZW5lc3MiLCJhcHBsaWNhYmxlU3ViamVjdHMiLCJyZXF1aXJlZE1hdGVyaWFscyIsImVzdGltYXRlZFRpbWUiLCJlbmVyZ3lMZXZlbCIsImVuZXJneU1hcCIsImhpZ2giLCJtZWRpdW0iLCJsb3ciLCJ0eXBlTWFwIiwiZXhhbV9wcmVwIiwibmV3X21hdGVyaWFsIiwicHJhY3RpY2UiLCJob21ld29yayIsInByb2plY3QiLCJsZXZlbCIsIndlaWdodHMiLCJ1cmdlbnQiLCJzZXNzaW9uQ291bnQiLCJqb2luIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/study-session-planner.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/temp-storage.ts":
/*!*********************************!*\
  !*** ./src/lib/temp-storage.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   addConversationTurn: () => (/* binding */ addConversationTurn),\n/* harmony export */   addPendingTask: () => (/* binding */ addPendingTask),\n/* harmony export */   addUser: () => (/* binding */ addUser),\n/* harmony export */   addWeeklyReport: () => (/* binding */ addWeeklyReport),\n/* harmony export */   canSubmitThisWeek: () => (/* binding */ canSubmitThisWeek),\n/* harmony export */   cleanupOldConversations: () => (/* binding */ cleanupOldConversations),\n/* harmony export */   createConversationSession: () => (/* binding */ createConversationSession),\n/* harmony export */   deleteUser: () => (/* binding */ deleteUser),\n/* harmony export */   findEventById: () => (/* binding */ findEventById),\n/* harmony export */   findUserByEmail: () => (/* binding */ findUserByEmail),\n/* harmony export */   findUserById: () => (/* binding */ findUserById),\n/* harmony export */   findUserByStudentId: () => (/* binding */ findUserByStudentId),\n/* harmony export */   findUsersByProgram: () => (/* binding */ findUsersByProgram),\n/* harmony export */   findUsersByRole: () => (/* binding */ findUsersByRole),\n/* harmony export */   findUsersByStatus: () => (/* binding */ findUsersByStatus),\n/* harmony export */   findWeeklyReportByUserAndWeek: () => (/* binding */ findWeeklyReportByUserAndWeek),\n/* harmony export */   findWeeklyReportsByUser: () => (/* binding */ findWeeklyReportsByUser),\n/* harmony export */   generateStudentId: () => (/* binding */ generateStudentId),\n/* harmony export */   getAllCalendarEvents: () => (/* binding */ getAllCalendarEvents),\n/* harmony export */   getAllUsers: () => (/* binding */ getAllUsers),\n/* harmony export */   getAllWeeklyReports: () => (/* binding */ getAllWeeklyReports),\n/* harmony export */   getConversationHistory: () => (/* binding */ getConversationHistory),\n/* harmony export */   getConversationSession: () => (/* binding */ getConversationSession),\n/* harmony export */   getCurrentWeekEnd: () => (/* binding */ getCurrentWeekEnd),\n/* harmony export */   getCurrentWeekStart: () => (/* binding */ getCurrentWeekStart),\n/* harmony export */   getEvents: () => (/* binding */ getEvents),\n/* harmony export */   getEventsForDateRange: () => (/* binding */ getEventsForDateRange),\n/* harmony export */   getMonthWeeks: () => (/* binding */ getMonthWeeks),\n/* harmony export */   getPendingTasks: () => (/* binding */ getPendingTasks),\n/* harmony export */   getUpcomingEvents: () => (/* binding */ getUpcomingEvents),\n/* harmony export */   getUserActiveSessions: () => (/* binding */ getUserActiveSessions),\n/* harmony export */   getWeekDates: () => (/* binding */ getWeekDates),\n/* harmony export */   getWeeklyReportsByDateRange: () => (/* binding */ getWeeklyReportsByDateRange),\n/* harmony export */   markTaskCompleted: () => (/* binding */ markTaskCompleted),\n/* harmony export */   tempConversations: () => (/* binding */ tempConversations),\n/* harmony export */   tempUsers: () => (/* binding */ tempUsers),\n/* harmony export */   tempWeeklyReports: () => (/* binding */ tempWeeklyReports),\n/* harmony export */   updateConversationSession: () => (/* binding */ updateConversationSession),\n/* harmony export */   updateUser: () => (/* binding */ updateUser),\n/* harmony export */   validateStudentId: () => (/* binding */ validateStudentId)\n/* harmony export */ });\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n// Temporary user storage - replace with database later\n// Singleton pattern to persist data across requests\nconst globalForStorage = globalThis;\nconst tempUsers = globalForStorage.tempUsers ?? [];\nconst tempWeeklyReports = globalForStorage.tempWeeklyReports ?? [];\n// Assign to globalThis to persist across requests\nglobalForStorage.tempUsers = tempUsers;\nglobalForStorage.tempWeeklyReports = tempWeeklyReports;\nfunction addUser(user) {\n    tempUsers.push(user);\n}\nfunction findUserByEmail(email) {\n    return tempUsers.find((user)=>user.email === email);\n}\nfunction findUserByStudentId(studentId) {\n    return tempUsers.find((user)=>user.studentId === studentId);\n}\nfunction findUserById(id) {\n    return tempUsers.find((user)=>user.id === id);\n}\nfunction getAllUsers() {\n    return tempUsers;\n}\nfunction findUsersByRole(role) {\n    return tempUsers.filter((user)=>user.role === role);\n}\nfunction findUsersByProgram(program) {\n    return tempUsers.filter((user)=>user.program === program);\n}\nfunction findUsersByStatus(status) {\n    return tempUsers.filter((user)=>user.status === status);\n}\nfunction updateUser(id, updates) {\n    const userIndex = tempUsers.findIndex((user)=>user.id === id);\n    if (userIndex !== -1) {\n        tempUsers[userIndex] = {\n            ...tempUsers[userIndex],\n            ...updates,\n            updatedAt: new Date()\n        };\n        return tempUsers[userIndex];\n    }\n    return null;\n}\nfunction deleteUser(id) {\n    const userIndex = tempUsers.findIndex((user)=>user.id === id);\n    if (userIndex !== -1) {\n        return tempUsers.splice(userIndex, 1)[0];\n    }\n    return null;\n}\nfunction validateStudentId(studentId) {\n    // Formato sugerido: EST-YYYY-XXX (ej: EST-2024-001)\n    const studentIdRegex = /^EST-\\d{4}-\\d{3}$/;\n    return studentIdRegex.test(studentId);\n}\nfunction generateStudentId() {\n    const currentYear = new Date().getFullYear();\n    const existingIds = tempUsers.filter((user)=>user.studentId && user.studentId.startsWith(`EST-${currentYear}`)).map((user)=>user.studentId).sort();\n    let nextNumber = 1;\n    if (existingIds.length > 0) {\n        const lastId = existingIds[existingIds.length - 1];\n        const lastNumber = parseInt(lastId.split('-')[2]);\n        nextNumber = lastNumber + 1;\n    }\n    return `EST-${currentYear}-${nextNumber.toString().padStart(3, '0')}`;\n}\n// Weekly Reports Functions\nfunction addWeeklyReport(report) {\n    tempWeeklyReports.push(report);\n}\nfunction findWeeklyReportsByUser(userId) {\n    return tempWeeklyReports.filter((report)=>report.userId === userId);\n}\nfunction findWeeklyReportByUserAndWeek(userId, weekStart) {\n    return tempWeeklyReports.find((report)=>report.userId === userId && report.weekStart.getTime() === weekStart.getTime());\n}\nfunction getAllWeeklyReports() {\n    return tempWeeklyReports;\n}\nfunction getWeeklyReportsByDateRange(startDate, endDate) {\n    return tempWeeklyReports.filter((report)=>report.weekStart >= startDate && report.weekEnd <= endDate);\n}\n// Date utility functions\nfunction getCurrentWeekStart() {\n    const now = new Date();\n    const monday = new Date(now);\n    const day = now.getDay();\n    const diff = now.getDate() - day + (day === 0 ? -6 : 1 // Adjust for Sunday\n    );\n    monday.setDate(diff);\n    monday.setHours(0, 0, 0, 0);\n    return monday;\n}\nfunction getCurrentWeekEnd() {\n    const weekStart = getCurrentWeekStart();\n    const weekEnd = new Date(weekStart);\n    weekEnd.setDate(weekStart.getDate() + 6);\n    weekEnd.setHours(23, 59, 59, 999);\n    return weekEnd;\n}\nfunction canSubmitThisWeek(userId) {\n    const weekStart = getCurrentWeekStart();\n    const weekEnd = getCurrentWeekEnd();\n    const currentDate = new Date();\n    const existingReport = findWeeklyReportByUserAndWeek(userId, weekStart);\n    // Can submit if:\n    // 1. We are currently in this week (currentDate is between weekStart and weekEnd)\n    // 2. No report exists for this week\n    const isCurrentWeek = currentDate >= weekStart && currentDate <= weekEnd;\n    console.log(`🔍 Debug canSubmitThisWeek for user ${userId}:`);\n    console.log(`  Current date: ${currentDate.toISOString()}`);\n    console.log(`  Week start: ${weekStart.toISOString()}`);\n    console.log(`  Week end: ${weekEnd.toISOString()}`);\n    console.log(`  Is current week: ${isCurrentWeek}`);\n    console.log(`  Existing report: ${existingReport ? 'YES' : 'NO'}`);\n    console.log(`  Can submit: ${isCurrentWeek && !existingReport}`);\n    return isCurrentWeek && !existingReport;\n}\nfunction getWeekDates(date) {\n    const start = new Date(date);\n    const day = start.getDay();\n    const diff = start.getDate() - day + (day === 0 ? -6 : 1);\n    start.setDate(diff);\n    start.setHours(0, 0, 0, 0);\n    const end = new Date(start);\n    end.setDate(start.getDate() + 6);\n    end.setHours(23, 59, 59, 999);\n    return {\n        start,\n        end\n    };\n}\nfunction getMonthWeeks(year, month) {\n    const weeks = [];\n    const firstDay = new Date(year, month, 1);\n    const lastDay = new Date(year, month + 1, 0);\n    let current = new Date(firstDay);\n    // Adjust to start from Monday of first week\n    const dayOfWeek = current.getDay();\n    const daysToSubtract = dayOfWeek === 0 ? 6 : dayOfWeek - 1;\n    current.setDate(current.getDate() - daysToSubtract);\n    while(current <= lastDay){\n        const weekStart = new Date(current);\n        const weekEnd = new Date(current);\n        weekEnd.setDate(weekStart.getDate() + 6);\n        weeks.push({\n            start: weekStart,\n            end: weekEnd\n        });\n        current.setDate(current.getDate() + 7);\n    }\n    return weeks;\n}\n// ===== CALENDAR FUNCTIONS =====\n// These functions integrate with the calendar system for Sara AI\nfunction getEvents(userId) {\n    // Import calendar data functions\n    try {\n        const { getUserCalendarData } = __webpack_require__(/*! ./calendar-data */ \"(rsc)/./src/lib/calendar-data.ts\");\n        const userData = getUserCalendarData(userId);\n        return userData?.events || [];\n    } catch (error) {\n        console.error('Error getting calendar events:', error);\n        return [];\n    }\n}\nfunction getAllCalendarEvents(userId) {\n    // Alias for getEvents for compatibility\n    return getEvents(userId);\n}\nfunction getUpcomingEvents(userId, days = 30) {\n    try {\n        const allEvents = getEvents(userId);\n        const now = new Date();\n        const futureDate = new Date();\n        futureDate.setDate(futureDate.getDate() + days);\n        return allEvents.filter((event)=>{\n            const eventDate = new Date(event.date);\n            return eventDate >= now && eventDate <= futureDate;\n        }).sort((a, b)=>new Date(a.date).getTime() - new Date(b.date).getTime());\n    } catch (error) {\n        console.error('Error getting upcoming events:', error);\n        return [];\n    }\n}\nfunction getEventsForDateRange(userId, startDate, endDate) {\n    try {\n        const allEvents = getEvents(userId);\n        return allEvents.filter((event)=>{\n            const eventDate = new Date(event.date);\n            return eventDate >= startDate && eventDate <= endDate;\n        });\n    } catch (error) {\n        console.error('Error getting events for date range:', error);\n        return [];\n    }\n}\nfunction findEventById(userId, eventId) {\n    try {\n        const allEvents = getEvents(userId);\n        return allEvents.find((event)=>event.id === eventId) || null;\n    } catch (error) {\n        console.error('Error finding event by ID:', error);\n        return null;\n    }\n}\n// Global storage for conversations\nconst globalForConversations = globalThis;\nconst tempConversations = globalForConversations.tempConversations ?? [];\nglobalForConversations.tempConversations = tempConversations;\nfunction getConversationSession(userId, sessionId) {\n    return tempConversations.find((session)=>session.userId === userId && session.sessionId === sessionId) || null;\n}\nfunction createConversationSession(userId, sessionId) {\n    // First remove any old session for the same user/sessionId\n    const existingIndex = tempConversations.findIndex((session)=>session.userId === userId && session.sessionId === sessionId);\n    if (existingIndex !== -1) {\n        tempConversations.splice(existingIndex, 1);\n    }\n    const newSession = {\n        userId,\n        sessionId,\n        turns: [],\n        currentTopic: undefined,\n        currentSubject: undefined,\n        pendingTasks: [],\n        lastUpdate: new Date()\n    };\n    tempConversations.push(newSession);\n    console.log(`💬 Created conversation session ${sessionId} for user ${userId}`);\n    return newSession;\n}\nfunction updateConversationSession(session) {\n    const index = tempConversations.findIndex((s)=>s.userId === session.userId && s.sessionId === session.sessionId);\n    if (index !== -1) {\n        tempConversations[index] = {\n            ...session,\n            lastUpdate: new Date()\n        };\n        console.log(`💬 Updated session ${session.sessionId} - ${session.turns.length} turns`);\n    } else {\n        tempConversations.push({\n            ...session,\n            lastUpdate: new Date()\n        });\n        console.log(`💬 Created new session ${session.sessionId} during update`);\n    }\n    return session;\n}\nfunction addConversationTurn(userId, sessionId, role, content, metadata = {}) {\n    let session = getConversationSession(userId, sessionId);\n    if (!session) {\n        session = createConversationSession(userId, sessionId);\n    }\n    const turn = {\n        id: `turn_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        timestamp: new Date(),\n        role,\n        content,\n        metadata\n    };\n    session.turns.push(turn);\n    // Keep only last 20 turns per session\n    if (session.turns.length > 20) {\n        session.turns = session.turns.slice(-20);\n    }\n    return updateConversationSession(session);\n}\nfunction addPendingTask(userId, sessionId, type, description, data) {\n    let session = getConversationSession(userId, sessionId);\n    if (!session) {\n        session = createConversationSession(userId, sessionId);\n    }\n    const task = {\n        id: `task_${Date.now()}`,\n        type,\n        description,\n        data,\n        completed: false,\n        createdAt: new Date()\n    };\n    session.pendingTasks.push(task);\n    console.log(`📋 Added pending task: ${description}`);\n    updateConversationSession(session);\n}\nfunction markTaskCompleted(userId, sessionId, taskId, result) {\n    const session = getConversationSession(userId, sessionId);\n    if (!session) return false;\n    const task = session.pendingTasks.find((t)=>t.id === taskId);\n    if (!task) return false;\n    task.completed = true;\n    if (result) {\n        task.data.result = result;\n    }\n    console.log(`✅ Completed task: ${task.description}`);\n    updateConversationSession(session);\n    return true;\n}\nfunction getPendingTasks(userId, sessionId) {\n    const session = getConversationSession(userId, sessionId);\n    if (!session) return [];\n    return session.pendingTasks.filter((task)=>!task.completed);\n}\nfunction getConversationHistory(userId, sessionId, limit = 10) {\n    const session = getConversationSession(userId, sessionId);\n    if (!session) return [];\n    return session.turns.slice(-limit);\n}\nfunction getUserActiveSessions(userId) {\n    const oneHourAgo = new Date(Date.now() - 60 * 60 * 1000);\n    return tempConversations.filter((session)=>session.userId === userId && session.lastUpdate > oneHourAgo);\n}\nfunction cleanupOldConversations() {\n    const sixHoursAgo = new Date(Date.now() - 6 * 60 * 60 * 1000);\n    const before = tempConversations.length;\n    // Remove conversations older than 6 hours\n    for(let i = tempConversations.length - 1; i >= 0; i--){\n        if (tempConversations[i].lastUpdate < sixHoursAgo) {\n            tempConversations.splice(i, 1);\n        }\n    }\n    const after = tempConversations.length;\n    if (before !== after) {\n        console.log(`🧹 Cleaned up ${before - after} old conversation sessions`);\n    }\n}\n// Initialize default users automatically\n\nfunction initDefaultUsers() {\n    // Check if demo users already exist to avoid duplicates\n    const studentExists = findUserByEmail(\"estudiante@demo.com\");\n    const instructorExists = findUserByEmail(\"instructor@demo.com\");\n    if (!studentExists || !instructorExists) {\n        console.log(\"🔧 Inicializando usuarios por defecto...\");\n        try {\n            const hashedPassword = bcryptjs__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hashSync(\"Estudiante123!!!\", 12);\n            // Only add student if doesn't exist\n            if (!studentExists) {\n                addUser({\n                    id: \"demo-student-fixed\",\n                    name: \"Estudiante Demo\",\n                    email: \"estudiante@demo.com\",\n                    password: hashedPassword,\n                    role: \"STUDENT\",\n                    studentId: \"EST-2025-001\",\n                    status: \"ACTIVE\",\n                    enrollmentYear: 2025,\n                    academicYear: \"2025-2026\",\n                    program: \"Ingeniería en Sistemas\",\n                    phoneNumber: \"+1234567890\",\n                    dateOfBirth: new Date(\"2000-01-01\"),\n                    address: \"Demo Address 123\",\n                    emergencyContact: {\n                        name: \"Contacto Demo\",\n                        phone: \"+0987654321\",\n                        relationship: \"Padre\"\n                    },\n                    createdAt: new Date(),\n                    updatedAt: new Date()\n                });\n                console.log(\"✅ Usuario estudiante demo creado\");\n            }\n            // Only add instructor if doesn't exist\n            if (!instructorExists) {\n                addUser({\n                    id: \"demo-instructor-fixed\",\n                    name: \"Instructor Demo\",\n                    email: \"instructor@demo.com\",\n                    password: hashedPassword,\n                    role: \"INSTRUCTOR\",\n                    studentId: null,\n                    status: \"ACTIVE\",\n                    enrollmentYear: 2025,\n                    academicYear: \"2025-2026\",\n                    createdAt: new Date(),\n                    updatedAt: new Date()\n                });\n                console.log(\"✅ Usuario instructor demo creado\");\n            }\n            console.log(\"✅ Verificación de usuarios por defecto completada\");\n        } catch (error) {\n            console.error(\"❌ Error creando usuarios por defecto:\", error);\n        }\n    } else {\n        console.log(\"✅ Usuarios demo ya existen, no se reinicializan\");\n    }\n    // Always check and initialize sample reports\n    initSampleReports();\n}\nfunction initSampleReports() {\n    // Check if sample reports already exist for demo student\n    const existingSampleReports = tempWeeklyReports.filter((report)=>report.userId === \"demo-student-fixed\");\n    if (existingSampleReports.length === 0) {\n        console.log(\"📝 Inicializando reportes de muestra...\");\n        try {\n            // Get current week dates\n            const now = new Date();\n            const currentWeek = getCurrentWeekStart();\n            const currentWeekEnd = getCurrentWeekEnd();\n            // Previous week\n            const prevWeek = new Date(currentWeek);\n            prevWeek.setDate(prevWeek.getDate() - 7);\n            const prevWeekEnd = new Date(currentWeekEnd);\n            prevWeekEnd.setDate(prevWeekEnd.getDate() - 7);\n            // Sample report from previous week\n            addWeeklyReport({\n                id: \"sample-report-1\",\n                userId: \"demo-student-fixed\",\n                weekStart: prevWeek,\n                weekEnd: prevWeekEnd,\n                submittedAt: new Date(prevWeekEnd.getTime() - 24 * 60 * 60 * 1000),\n                responses: {\n                    temasYDominio: \"Esta semana trabajamos con JavaScript básico - Nivel 3: Domino funciones y arrays, y estoy aprendiendo objetos complejos.\",\n                    evidenciaAprendizaje: \"Completé un proyecto de To-Do List usando JavaScript vanilla. Implementé funciones para agregar, editar y eliminar tareas usando arrays y objetos.\",\n                    dificultadesEstrategias: \"Tuve dificultades con el manejo de eventos en JavaScript. Lo resolví practicando con ejemplos y consultando documentación de MDN.\",\n                    conexionesAplicacion: \"Los conceptos de eventos se conectan con la interactividad en aplicaciones web. Puedo aplicarlo para crear interfaces más dinámicas.\",\n                    comentariosAdicionales: \"Me siento más confiado con JavaScript. Quiero seguir practicando con proyectos más complejos.\"\n                }\n            });\n            // Two weeks ago report  \n            const twoWeeksAgo = new Date(currentWeek);\n            twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);\n            const twoWeeksAgoEnd = new Date(currentWeekEnd);\n            twoWeeksAgoEnd.setDate(twoWeeksAgoEnd.getDate() - 14);\n            addWeeklyReport({\n                id: \"sample-report-2\",\n                userId: \"demo-student-fixed\",\n                weekStart: twoWeeksAgo,\n                weekEnd: twoWeeksAgoEnd,\n                submittedAt: new Date(twoWeeksAgoEnd.getTime() - 12 * 60 * 60 * 1000),\n                responses: {\n                    temasYDominio: \"Esta semana estudiamos CSS Grid y Flexbox - Nivel 2: Entiendo los conceptos básicos pero aún tengo dudas con layouts complejos.\",\n                    evidenciaAprendizaje: \"Recreé el layout de una página web usando CSS Grid. Logré hacer una estructura responsive con header, sidebar y main content.\",\n                    dificultadesEstrategias: \"Me confundí con las propiedades grid-template-areas. Resolví el problema dibujando el layout en papel primero.\",\n                    conexionesAplicacion: \"CSS Grid es perfecto para crear layouts de páginas web modernas. Lo usaré en mi proyecto final de página portfolio.\",\n                    comentariosAdicionales: \"CSS es más divertido de lo que pensaba. Me gusta ver los resultados visuales inmediatos.\"\n                }\n            });\n            console.log(\"✅ Reportes de muestra creados exitosamente\");\n        } catch (error) {\n            console.error(\"❌ Error creando reportes de muestra:\", error);\n        }\n    } else {\n        console.log(\"✅ Reportes de muestra ya existen, no se reinicializan\");\n    }\n}\n// Initialize on module load\ninitDefaultUsers();\n// Start conversation cleanup interval\nsetInterval(cleanupOldConversations, 30 * 60 * 1000) // Every 30 minutes\n;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixNQUFNQyxjQUFjLElBQUk3SixLQUFLa0o7WUFDN0JXLFlBQVlySCxPQUFPLENBQUNxSCxZQUFZdEgsT0FBTyxLQUFLO1lBQzVDLE1BQU11SCxpQkFBaUIsSUFBSTlKLEtBQUttSjtZQUNoQ1csZUFBZXRILE9BQU8sQ0FBQ3NILGVBQWV2SCxPQUFPLEtBQUs7WUFFbERsQixnQkFBZ0I7Z0JBQ2RuQyxJQUFJO2dCQUNKc0MsUUFBUTtnQkFDUkUsV0FBV21JO2dCQUNYN0gsU0FBUzhIO2dCQUNUUixhQUFhLElBQUl0SixLQUFLOEosZUFBZW5JLE9BQU8sS0FBSyxLQUFLLEtBQUssS0FBSztnQkFDaEU0SCxXQUFXO29CQUNUQyxlQUFlO29CQUNmQyxzQkFBc0I7b0JBQ3RCQyx5QkFBeUI7b0JBQ3pCQyxzQkFBc0I7b0JBQ3RCQyx3QkFBd0I7Z0JBQzFCO1lBQ0Y7WUFFQTdHLFFBQVFDLEdBQUcsQ0FBQztRQUNkLEVBQUUsT0FBT29CLE9BQU87WUFDZHJCLFFBQVFxQixLQUFLLENBQUMsd0NBQXdDQTtRQUN4RDtJQUNGLE9BQU87UUFDTHJCLFFBQVFDLEdBQUcsQ0FBQztJQUNkO0FBQ0Y7QUFFQSw0QkFBNEI7QUFDNUJpRjtBQUVBLHNDQUFzQztBQUN0QzhCLFlBQVlwQyx5QkFBeUIsS0FBSyxLQUFLLE1BQU0sbUJBQW1CIiwic291cmNlcyI6WyIvVXNlcnMvcm9kcmlnb2RpYmVybmFyZG8zM2dtYWlsLmNvbS9Eb2N1bWVudHMvQXBwIERldmVsb3BtZW50IFByb3llY3RzL0ludGVsbGVnbyBQbGF0Zm9ybS9zcmMvbGliL3RlbXAtc3RvcmFnZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUZW1wb3JhcnkgdXNlciBzdG9yYWdlIC0gcmVwbGFjZSB3aXRoIGRhdGFiYXNlIGxhdGVyXG5pbnRlcmZhY2UgVGVtcFVzZXIge1xuICBpZDogc3RyaW5nXG4gIG5hbWU6IHN0cmluZ1xuICBlbWFpbDogc3RyaW5nXG4gIHBhc3N3b3JkOiBzdHJpbmdcbiAgc3R1ZGVudElkPzogc3RyaW5nIHwgbnVsbFxuICByb2xlOiBzdHJpbmdcbiAgY3JlYXRlZEF0OiBEYXRlXG4gIHVwZGF0ZWRBdDogRGF0ZVxuICBpbWFnZT86IHN0cmluZ1xuICAvLyBBY2FkZW1pYyBmaWVsZHNcbiAgcHJvZ3JhbT86IHN0cmluZyAvLyBDYXJyZXJhL3Byb2dyYW1hIGRlIGVzdHVkaW9zXG4gIGFjYWRlbWljWWVhcj86IHN0cmluZyAvLyBBw7FvIGFjYWTDqW1pY28gKGVqOiBcIjIwMjQtMjAyNVwiKVxuICBlbnJvbGxtZW50WWVhcj86IG51bWJlciAvLyBBw7FvIGRlIGluZ3Jlc29cbiAgc3RhdHVzPzogXCJBQ1RJVkVcIiB8IFwiSU5BQ1RJVkVcIiB8IFwiU1VTUEVOREVEXCIgLy8gRXN0YWRvIGRlbCBlc3R1ZGlhbnRlXG4gIHBob25lTnVtYmVyPzogc3RyaW5nXG4gIGRhdGVPZkJpcnRoPzogRGF0ZVxuICBhZGRyZXNzPzogc3RyaW5nXG4gIGVtZXJnZW5jeUNvbnRhY3Q/OiB7XG4gICAgbmFtZTogc3RyaW5nXG4gICAgcGhvbmU6IHN0cmluZ1xuICAgIHJlbGF0aW9uc2hpcDogc3RyaW5nXG4gIH1cbiAgcHJlZmVyZW5jZXM/OiB7XG4gICAgZW1haWxOb3RpZmljYXRpb25zOiBib29sZWFuXG4gICAgcHVzaE5vdGlmaWNhdGlvbnM6IGJvb2xlYW5cbiAgICB3ZWVrbHlSZW1pbmRlcnM6IGJvb2xlYW5cbiAgICBwcm9ncmVzc1JlcG9ydHM6IGJvb2xlYW5cbiAgfVxufVxuXG5pbnRlcmZhY2UgQXR0YWNoZWRGaWxlIHtcbiAgZmlsZW5hbWU6IHN0cmluZ1xuICBvcmlnaW5hbE5hbWU6IHN0cmluZ1xuICBzaXplOiBudW1iZXJcbiAgdHlwZTogc3RyaW5nXG4gIHVybDogc3RyaW5nXG59XG5cbmludGVyZmFjZSBXZWVrbHlSZXBvcnQge1xuICBpZDogc3RyaW5nXG4gIHVzZXJJZDogc3RyaW5nXG4gIHdlZWtTdGFydDogRGF0ZVxuICB3ZWVrRW5kOiBEYXRlXG4gIHN1Ym1pdHRlZEF0OiBEYXRlXG4gIHJlc3BvbnNlczoge1xuICAgIHRlbWFzWURvbWluaW86IHN0cmluZyAvLyBQcmVndW50YSAxXG4gICAgZXZpZGVuY2lhQXByZW5kaXphamU6IHN0cmluZyAvLyBQcmVndW50YSAyXG4gICAgZGlmaWN1bHRhZGVzRXN0cmF0ZWdpYXM6IHN0cmluZyAvLyBQcmVndW50YSAzXG4gICAgY29uZXhpb25lc0FwbGljYWNpb246IHN0cmluZyAvLyBQcmVndW50YSA0XG4gICAgY29tZW50YXJpb3NBZGljaW9uYWxlcz86IHN0cmluZyAvLyBQcmVndW50YSA1IChvcGNpb25hbClcbiAgfVxuICBhdHRhY2htZW50cz86IEF0dGFjaGVkRmlsZVtdIC8vIEFyY2hpdm9zIGFkanVudG9zXG59XG5cbi8vIFNpbmdsZXRvbiBwYXR0ZXJuIHRvIHBlcnNpc3QgZGF0YSBhY3Jvc3MgcmVxdWVzdHNcbmNvbnN0IGdsb2JhbEZvclN0b3JhZ2UgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICB0ZW1wVXNlcnM6IFRlbXBVc2VyW10gfCB1bmRlZmluZWRcbiAgdGVtcFdlZWtseVJlcG9ydHM6IFdlZWtseVJlcG9ydFtdIHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCB0ZW1wVXNlcnM6IFRlbXBVc2VyW10gPSBnbG9iYWxGb3JTdG9yYWdlLnRlbXBVc2VycyA/PyBbXVxuZXhwb3J0IGNvbnN0IHRlbXBXZWVrbHlSZXBvcnRzOiBXZWVrbHlSZXBvcnRbXSA9IGdsb2JhbEZvclN0b3JhZ2UudGVtcFdlZWtseVJlcG9ydHMgPz8gW11cblxuLy8gQXNzaWduIHRvIGdsb2JhbFRoaXMgdG8gcGVyc2lzdCBhY3Jvc3MgcmVxdWVzdHNcbmdsb2JhbEZvclN0b3JhZ2UudGVtcFVzZXJzID0gdGVtcFVzZXJzXG5nbG9iYWxGb3JTdG9yYWdlLnRlbXBXZWVrbHlSZXBvcnRzID0gdGVtcFdlZWtseVJlcG9ydHNcblxuZXhwb3J0IGZ1bmN0aW9uIGFkZFVzZXIodXNlcjogVGVtcFVzZXIpIHtcbiAgdGVtcFVzZXJzLnB1c2godXNlcilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRVc2VyQnlFbWFpbChlbWFpbDogc3RyaW5nKSB7XG4gIHJldHVybiB0ZW1wVXNlcnMuZmluZCh1c2VyID0+IHVzZXIuZW1haWwgPT09IGVtYWlsKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFVzZXJCeVN0dWRlbnRJZChzdHVkZW50SWQ6IHN0cmluZykge1xuICByZXR1cm4gdGVtcFVzZXJzLmZpbmQodXNlciA9PiB1c2VyLnN0dWRlbnRJZCA9PT0gc3R1ZGVudElkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFVzZXJCeUlkKGlkOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRlbXBVc2Vycy5maW5kKHVzZXIgPT4gdXNlci5pZCA9PT0gaWQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxVc2VycygpIHtcbiAgcmV0dXJuIHRlbXBVc2Vyc1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFVzZXJzQnlSb2xlKHJvbGU6IHN0cmluZykge1xuICByZXR1cm4gdGVtcFVzZXJzLmZpbHRlcih1c2VyID0+IHVzZXIucm9sZSA9PT0gcm9sZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRVc2Vyc0J5UHJvZ3JhbShwcm9ncmFtOiBzdHJpbmcpIHtcbiAgcmV0dXJuIHRlbXBVc2Vycy5maWx0ZXIodXNlciA9PiB1c2VyLnByb2dyYW0gPT09IHByb2dyYW0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kVXNlcnNCeVN0YXR1cyhzdGF0dXM6IFwiQUNUSVZFXCIgfCBcIklOQUNUSVZFXCIgfCBcIlNVU1BFTkRFRFwiKSB7XG4gIHJldHVybiB0ZW1wVXNlcnMuZmlsdGVyKHVzZXIgPT4gdXNlci5zdGF0dXMgPT09IHN0YXR1cylcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVVzZXIoaWQ6IHN0cmluZywgdXBkYXRlczogUGFydGlhbDxUZW1wVXNlcj4pIHtcbiAgY29uc3QgdXNlckluZGV4ID0gdGVtcFVzZXJzLmZpbmRJbmRleCh1c2VyID0+IHVzZXIuaWQgPT09IGlkKVxuICBpZiAodXNlckluZGV4ICE9PSAtMSkge1xuICAgIHRlbXBVc2Vyc1t1c2VySW5kZXhdID0ge1xuICAgICAgLi4udGVtcFVzZXJzW3VzZXJJbmRleF0sXG4gICAgICAuLi51cGRhdGVzLFxuICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpXG4gICAgfVxuICAgIHJldHVybiB0ZW1wVXNlcnNbdXNlckluZGV4XVxuICB9XG4gIHJldHVybiBudWxsXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZWxldGVVc2VyKGlkOiBzdHJpbmcpIHtcbiAgY29uc3QgdXNlckluZGV4ID0gdGVtcFVzZXJzLmZpbmRJbmRleCh1c2VyID0+IHVzZXIuaWQgPT09IGlkKVxuICBpZiAodXNlckluZGV4ICE9PSAtMSkge1xuICAgIHJldHVybiB0ZW1wVXNlcnMuc3BsaWNlKHVzZXJJbmRleCwgMSlbMF1cbiAgfVxuICByZXR1cm4gbnVsbFxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVTdHVkZW50SWQoc3R1ZGVudElkOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgLy8gRm9ybWF0byBzdWdlcmlkbzogRVNULVlZWVktWFhYIChlajogRVNULTIwMjQtMDAxKVxuICBjb25zdCBzdHVkZW50SWRSZWdleCA9IC9eRVNULVxcZHs0fS1cXGR7M30kL1xuICByZXR1cm4gc3R1ZGVudElkUmVnZXgudGVzdChzdHVkZW50SWQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVN0dWRlbnRJZCgpOiBzdHJpbmcge1xuICBjb25zdCBjdXJyZW50WWVhciA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKVxuICBjb25zdCBleGlzdGluZ0lkcyA9IHRlbXBVc2Vyc1xuICAgIC5maWx0ZXIodXNlciA9PiB1c2VyLnN0dWRlbnRJZCAmJiB1c2VyLnN0dWRlbnRJZC5zdGFydHNXaXRoKGBFU1QtJHtjdXJyZW50WWVhcn1gKSlcbiAgICAubWFwKHVzZXIgPT4gdXNlci5zdHVkZW50SWQhKVxuICAgIC5zb3J0KClcblxuICBsZXQgbmV4dE51bWJlciA9IDFcbiAgaWYgKGV4aXN0aW5nSWRzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBsYXN0SWQgPSBleGlzdGluZ0lkc1tleGlzdGluZ0lkcy5sZW5ndGggLSAxXVxuICAgIGNvbnN0IGxhc3ROdW1iZXIgPSBwYXJzZUludChsYXN0SWQuc3BsaXQoJy0nKVsyXSlcbiAgICBuZXh0TnVtYmVyID0gbGFzdE51bWJlciArIDFcbiAgfVxuXG4gIHJldHVybiBgRVNULSR7Y3VycmVudFllYXJ9LSR7bmV4dE51bWJlci50b1N0cmluZygpLnBhZFN0YXJ0KDMsICcwJyl9YFxufVxuXG4vLyBXZWVrbHkgUmVwb3J0cyBGdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBhZGRXZWVrbHlSZXBvcnQocmVwb3J0OiBXZWVrbHlSZXBvcnQpIHtcbiAgdGVtcFdlZWtseVJlcG9ydHMucHVzaChyZXBvcnQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kV2Vla2x5UmVwb3J0c0J5VXNlcih1c2VySWQ6IHN0cmluZyk6IFdlZWtseVJlcG9ydFtdIHtcbiAgcmV0dXJuIHRlbXBXZWVrbHlSZXBvcnRzLmZpbHRlcihyZXBvcnQgPT4gcmVwb3J0LnVzZXJJZCA9PT0gdXNlcklkKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZmluZFdlZWtseVJlcG9ydEJ5VXNlckFuZFdlZWsodXNlcklkOiBzdHJpbmcsIHdlZWtTdGFydDogRGF0ZSk6IFdlZWtseVJlcG9ydCB8IHVuZGVmaW5lZCB7XG4gIHJldHVybiB0ZW1wV2Vla2x5UmVwb3J0cy5maW5kKHJlcG9ydCA9PiBcbiAgICByZXBvcnQudXNlcklkID09PSB1c2VySWQgJiYgXG4gICAgcmVwb3J0LndlZWtTdGFydC5nZXRUaW1lKCkgPT09IHdlZWtTdGFydC5nZXRUaW1lKClcbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsV2Vla2x5UmVwb3J0cygpOiBXZWVrbHlSZXBvcnRbXSB7XG4gIHJldHVybiB0ZW1wV2Vla2x5UmVwb3J0c1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0V2Vla2x5UmVwb3J0c0J5RGF0ZVJhbmdlKHN0YXJ0RGF0ZTogRGF0ZSwgZW5kRGF0ZTogRGF0ZSk6IFdlZWtseVJlcG9ydFtdIHtcbiAgcmV0dXJuIHRlbXBXZWVrbHlSZXBvcnRzLmZpbHRlcihyZXBvcnQgPT4gXG4gICAgcmVwb3J0LndlZWtTdGFydCA+PSBzdGFydERhdGUgJiYgcmVwb3J0LndlZWtFbmQgPD0gZW5kRGF0ZVxuICApXG59XG5cbi8vIERhdGUgdXRpbGl0eSBmdW5jdGlvbnNcbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50V2Vla1N0YXJ0KCk6IERhdGUge1xuICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpXG4gIGNvbnN0IG1vbmRheSA9IG5ldyBEYXRlKG5vdylcbiAgY29uc3QgZGF5ID0gbm93LmdldERheSgpXG4gIGNvbnN0IGRpZmYgPSBub3cuZ2V0RGF0ZSgpIC0gZGF5ICsgKGRheSA9PT0gMCA/IC02IDogMSkgLy8gQWRqdXN0IGZvciBTdW5kYXlcbiAgbW9uZGF5LnNldERhdGUoZGlmZilcbiAgbW9uZGF5LnNldEhvdXJzKDAsIDAsIDAsIDApXG4gIHJldHVybiBtb25kYXlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRXZWVrRW5kKCk6IERhdGUge1xuICBjb25zdCB3ZWVrU3RhcnQgPSBnZXRDdXJyZW50V2Vla1N0YXJ0KClcbiAgY29uc3Qgd2Vla0VuZCA9IG5ldyBEYXRlKHdlZWtTdGFydClcbiAgd2Vla0VuZC5zZXREYXRlKHdlZWtTdGFydC5nZXREYXRlKCkgKyA2KVxuICB3ZWVrRW5kLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSlcbiAgcmV0dXJuIHdlZWtFbmRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNhblN1Ym1pdFRoaXNXZWVrKHVzZXJJZDogc3RyaW5nKTogYm9vbGVhbiB7XG4gIGNvbnN0IHdlZWtTdGFydCA9IGdldEN1cnJlbnRXZWVrU3RhcnQoKVxuICBjb25zdCB3ZWVrRW5kID0gZ2V0Q3VycmVudFdlZWtFbmQoKVxuICBjb25zdCBjdXJyZW50RGF0ZSA9IG5ldyBEYXRlKClcbiAgY29uc3QgZXhpc3RpbmdSZXBvcnQgPSBmaW5kV2Vla2x5UmVwb3J0QnlVc2VyQW5kV2Vlayh1c2VySWQsIHdlZWtTdGFydClcbiAgXG4gIC8vIENhbiBzdWJtaXQgaWY6XG4gIC8vIDEuIFdlIGFyZSBjdXJyZW50bHkgaW4gdGhpcyB3ZWVrIChjdXJyZW50RGF0ZSBpcyBiZXR3ZWVuIHdlZWtTdGFydCBhbmQgd2Vla0VuZClcbiAgLy8gMi4gTm8gcmVwb3J0IGV4aXN0cyBmb3IgdGhpcyB3ZWVrXG4gIGNvbnN0IGlzQ3VycmVudFdlZWsgPSBjdXJyZW50RGF0ZSA+PSB3ZWVrU3RhcnQgJiYgY3VycmVudERhdGUgPD0gd2Vla0VuZFxuICBcbiAgY29uc29sZS5sb2coYPCflI0gRGVidWcgY2FuU3VibWl0VGhpc1dlZWsgZm9yIHVzZXIgJHt1c2VySWR9OmApXG4gIGNvbnNvbGUubG9nKGAgIEN1cnJlbnQgZGF0ZTogJHtjdXJyZW50RGF0ZS50b0lTT1N0cmluZygpfWApXG4gIGNvbnNvbGUubG9nKGAgIFdlZWsgc3RhcnQ6ICR7d2Vla1N0YXJ0LnRvSVNPU3RyaW5nKCl9YClcbiAgY29uc29sZS5sb2coYCAgV2VlayBlbmQ6ICR7d2Vla0VuZC50b0lTT1N0cmluZygpfWApXG4gIGNvbnNvbGUubG9nKGAgIElzIGN1cnJlbnQgd2VlazogJHtpc0N1cnJlbnRXZWVrfWApXG4gIGNvbnNvbGUubG9nKGAgIEV4aXN0aW5nIHJlcG9ydDogJHtleGlzdGluZ1JlcG9ydCA/ICdZRVMnIDogJ05PJ31gKVxuICBjb25zb2xlLmxvZyhgICBDYW4gc3VibWl0OiAke2lzQ3VycmVudFdlZWsgJiYgIWV4aXN0aW5nUmVwb3J0fWApXG4gIFxuICByZXR1cm4gaXNDdXJyZW50V2VlayAmJiAhZXhpc3RpbmdSZXBvcnRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdlZWtEYXRlcyhkYXRlOiBEYXRlKTogeyBzdGFydDogRGF0ZTsgZW5kOiBEYXRlIH0ge1xuICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKGRhdGUpXG4gIGNvbnN0IGRheSA9IHN0YXJ0LmdldERheSgpXG4gIGNvbnN0IGRpZmYgPSBzdGFydC5nZXREYXRlKCkgLSBkYXkgKyAoZGF5ID09PSAwID8gLTYgOiAxKVxuICBzdGFydC5zZXREYXRlKGRpZmYpXG4gIHN0YXJ0LnNldEhvdXJzKDAsIDAsIDAsIDApXG4gIFxuICBjb25zdCBlbmQgPSBuZXcgRGF0ZShzdGFydClcbiAgZW5kLnNldERhdGUoc3RhcnQuZ2V0RGF0ZSgpICsgNilcbiAgZW5kLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSlcbiAgXG4gIHJldHVybiB7IHN0YXJ0LCBlbmQgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TW9udGhXZWVrcyh5ZWFyOiBudW1iZXIsIG1vbnRoOiBudW1iZXIpOiBBcnJheTx7IHN0YXJ0OiBEYXRlOyBlbmQ6IERhdGUgfT4ge1xuICBjb25zdCB3ZWVrcyA9IFtdXG4gIGNvbnN0IGZpcnN0RGF5ID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDEpXG4gIGNvbnN0IGxhc3REYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIDApXG4gIFxuICBsZXQgY3VycmVudCA9IG5ldyBEYXRlKGZpcnN0RGF5KVxuICBcbiAgLy8gQWRqdXN0IHRvIHN0YXJ0IGZyb20gTW9uZGF5IG9mIGZpcnN0IHdlZWtcbiAgY29uc3QgZGF5T2ZXZWVrID0gY3VycmVudC5nZXREYXkoKVxuICBjb25zdCBkYXlzVG9TdWJ0cmFjdCA9IGRheU9mV2VlayA9PT0gMCA/IDYgOiBkYXlPZldlZWsgLSAxXG4gIGN1cnJlbnQuc2V0RGF0ZShjdXJyZW50LmdldERhdGUoKSAtIGRheXNUb1N1YnRyYWN0KVxuICBcbiAgd2hpbGUgKGN1cnJlbnQgPD0gbGFzdERheSkge1xuICAgIGNvbnN0IHdlZWtTdGFydCA9IG5ldyBEYXRlKGN1cnJlbnQpXG4gICAgY29uc3Qgd2Vla0VuZCA9IG5ldyBEYXRlKGN1cnJlbnQpXG4gICAgd2Vla0VuZC5zZXREYXRlKHdlZWtTdGFydC5nZXREYXRlKCkgKyA2KVxuICAgIFxuICAgIHdlZWtzLnB1c2goeyBzdGFydDogd2Vla1N0YXJ0LCBlbmQ6IHdlZWtFbmQgfSlcbiAgICBjdXJyZW50LnNldERhdGUoY3VycmVudC5nZXREYXRlKCkgKyA3KVxuICB9XG4gIFxuICByZXR1cm4gd2Vla3Ncbn1cblxuLy8gPT09PT0gQ0FMRU5EQVIgRlVOQ1RJT05TID09PT09XG4vLyBUaGVzZSBmdW5jdGlvbnMgaW50ZWdyYXRlIHdpdGggdGhlIGNhbGVuZGFyIHN5c3RlbSBmb3IgU2FyYSBBSVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXZlbnRzKHVzZXJJZDogc3RyaW5nKTogYW55W10ge1xuICAvLyBJbXBvcnQgY2FsZW5kYXIgZGF0YSBmdW5jdGlvbnNcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGdldFVzZXJDYWxlbmRhckRhdGEgfSA9IHJlcXVpcmUoJy4vY2FsZW5kYXItZGF0YScpXG4gICAgY29uc3QgdXNlckRhdGEgPSBnZXRVc2VyQ2FsZW5kYXJEYXRhKHVzZXJJZClcbiAgICByZXR1cm4gdXNlckRhdGE/LmV2ZW50cyB8fCBbXVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgY2FsZW5kYXIgZXZlbnRzOicsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBbGxDYWxlbmRhckV2ZW50cyh1c2VySWQ6IHN0cmluZyk6IGFueVtdIHtcbiAgLy8gQWxpYXMgZm9yIGdldEV2ZW50cyBmb3IgY29tcGF0aWJpbGl0eVxuICByZXR1cm4gZ2V0RXZlbnRzKHVzZXJJZClcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFVwY29taW5nRXZlbnRzKHVzZXJJZDogc3RyaW5nLCBkYXlzOiBudW1iZXIgPSAzMCk6IGFueVtdIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhbGxFdmVudHMgPSBnZXRFdmVudHModXNlcklkKVxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBjb25zdCBmdXR1cmVEYXRlID0gbmV3IERhdGUoKVxuICAgIGZ1dHVyZURhdGUuc2V0RGF0ZShmdXR1cmVEYXRlLmdldERhdGUoKSArIGRheXMpXG4gICAgXG4gICAgcmV0dXJuIGFsbEV2ZW50cy5maWx0ZXIoZXZlbnQgPT4ge1xuICAgICAgY29uc3QgZXZlbnREYXRlID0gbmV3IERhdGUoZXZlbnQuZGF0ZSlcbiAgICAgIHJldHVybiBldmVudERhdGUgPj0gbm93ICYmIGV2ZW50RGF0ZSA8PSBmdXR1cmVEYXRlXG4gICAgfSkuc29ydCgoYSwgYikgPT4gbmV3IERhdGUoYS5kYXRlKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShiLmRhdGUpLmdldFRpbWUoKSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHVwY29taW5nIGV2ZW50czonLCBlcnJvcilcbiAgICByZXR1cm4gW11cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0RXZlbnRzRm9yRGF0ZVJhbmdlKHVzZXJJZDogc3RyaW5nLCBzdGFydERhdGU6IERhdGUsIGVuZERhdGU6IERhdGUpOiBhbnlbXSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYWxsRXZlbnRzID0gZ2V0RXZlbnRzKHVzZXJJZClcbiAgICByZXR1cm4gYWxsRXZlbnRzLmZpbHRlcihldmVudCA9PiB7XG4gICAgICBjb25zdCBldmVudERhdGUgPSBuZXcgRGF0ZShldmVudC5kYXRlKVxuICAgICAgcmV0dXJuIGV2ZW50RGF0ZSA+PSBzdGFydERhdGUgJiYgZXZlbnREYXRlIDw9IGVuZERhdGVcbiAgICB9KVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgZXZlbnRzIGZvciBkYXRlIHJhbmdlOicsIGVycm9yKVxuICAgIHJldHVybiBbXVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kRXZlbnRCeUlkKHVzZXJJZDogc3RyaW5nLCBldmVudElkOiBzdHJpbmcpOiBhbnkgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBhbGxFdmVudHMgPSBnZXRFdmVudHModXNlcklkKVxuICAgIHJldHVybiBhbGxFdmVudHMuZmluZChldmVudCA9PiBldmVudC5pZCA9PT0gZXZlbnRJZCkgfHwgbnVsbFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZpbmRpbmcgZXZlbnQgYnkgSUQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIG51bGxcbiAgfVxufVxuXG4vLyA9PT09PSBDT05WRVJTQVRJT04gTUVNT1JZIEZVTkNUSU9OUyA9PT09PVxuLy8gUGVyc2lzdGVudCBjb252ZXJzYXRpb24gc3RvcmFnZSBmb3IgU2FyYSBBSVxuXG5pbnRlcmZhY2UgQ29udmVyc2F0aW9uVHVybiB7XG4gIGlkOiBzdHJpbmdcbiAgdGltZXN0YW1wOiBEYXRlXG4gIHJvbGU6ICd1c2VyJyB8ICdhc3Npc3RhbnQnXG4gIGNvbnRlbnQ6IHN0cmluZ1xuICBtZXRhZGF0YToge1xuICAgIHN1YmplY3Q/OiBzdHJpbmdcbiAgICB0b3BpYz86IHN0cmluZ1xuICAgIGludGVudGlvbj86IHN0cmluZ1xuICAgIHRhc2tDb21wbGV0ZWQ/OiBib29sZWFuXG4gICAgZXZlbnRDcmVhdGVkPzogYm9vbGVhblxuICB9XG59XG5cbmludGVyZmFjZSBDb252ZXJzYXRpb25TZXNzaW9uIHtcbiAgdXNlcklkOiBzdHJpbmdcbiAgc2Vzc2lvbklkOiBzdHJpbmdcbiAgdHVybnM6IENvbnZlcnNhdGlvblR1cm5bXVxuICBjdXJyZW50VG9waWM/OiBzdHJpbmdcbiAgY3VycmVudFN1YmplY3Q/OiBzdHJpbmdcbiAgcGVuZGluZ1Rhc2tzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZ1xuICAgIHR5cGU6ICdjYWxlbmRhcl9ldmVudCcgfCAnYWNhZGVtaWNfc2VhcmNoJyB8ICdyZW1pbmRlcidcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nXG4gICAgZGF0YTogYW55XG4gICAgY29tcGxldGVkOiBib29sZWFuXG4gICAgY3JlYXRlZEF0OiBEYXRlXG4gIH0+XG4gIGxhc3RVcGRhdGU6IERhdGVcbn1cblxuLy8gR2xvYmFsIHN0b3JhZ2UgZm9yIGNvbnZlcnNhdGlvbnNcbmNvbnN0IGdsb2JhbEZvckNvbnZlcnNhdGlvbnMgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICB0ZW1wQ29udmVyc2F0aW9uczogQ29udmVyc2F0aW9uU2Vzc2lvbltdIHwgdW5kZWZpbmVkXG59XG5cbmV4cG9ydCBjb25zdCB0ZW1wQ29udmVyc2F0aW9uczogQ29udmVyc2F0aW9uU2Vzc2lvbltdID0gZ2xvYmFsRm9yQ29udmVyc2F0aW9ucy50ZW1wQ29udmVyc2F0aW9ucyA/PyBbXVxuZ2xvYmFsRm9yQ29udmVyc2F0aW9ucy50ZW1wQ29udmVyc2F0aW9ucyA9IHRlbXBDb252ZXJzYXRpb25zXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb252ZXJzYXRpb25TZXNzaW9uKHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IENvbnZlcnNhdGlvblNlc3Npb24gfCBudWxsIHtcbiAgcmV0dXJuIHRlbXBDb252ZXJzYXRpb25zLmZpbmQoc2Vzc2lvbiA9PiBcbiAgICBzZXNzaW9uLnVzZXJJZCA9PT0gdXNlcklkICYmIHNlc3Npb24uc2Vzc2lvbklkID09PSBzZXNzaW9uSWRcbiAgKSB8fCBudWxsXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVDb252ZXJzYXRpb25TZXNzaW9uKHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZyk6IENvbnZlcnNhdGlvblNlc3Npb24ge1xuICAvLyBGaXJzdCByZW1vdmUgYW55IG9sZCBzZXNzaW9uIGZvciB0aGUgc2FtZSB1c2VyL3Nlc3Npb25JZFxuICBjb25zdCBleGlzdGluZ0luZGV4ID0gdGVtcENvbnZlcnNhdGlvbnMuZmluZEluZGV4KHNlc3Npb24gPT4gXG4gICAgc2Vzc2lvbi51c2VySWQgPT09IHVzZXJJZCAmJiBzZXNzaW9uLnNlc3Npb25JZCA9PT0gc2Vzc2lvbklkXG4gIClcbiAgaWYgKGV4aXN0aW5nSW5kZXggIT09IC0xKSB7XG4gICAgdGVtcENvbnZlcnNhdGlvbnMuc3BsaWNlKGV4aXN0aW5nSW5kZXgsIDEpXG4gIH1cblxuICBjb25zdCBuZXdTZXNzaW9uOiBDb252ZXJzYXRpb25TZXNzaW9uID0ge1xuICAgIHVzZXJJZCxcbiAgICBzZXNzaW9uSWQsXG4gICAgdHVybnM6IFtdLFxuICAgIGN1cnJlbnRUb3BpYzogdW5kZWZpbmVkLFxuICAgIGN1cnJlbnRTdWJqZWN0OiB1bmRlZmluZWQsXG4gICAgcGVuZGluZ1Rhc2tzOiBbXSxcbiAgICBsYXN0VXBkYXRlOiBuZXcgRGF0ZSgpXG4gIH1cbiAgXG4gIHRlbXBDb252ZXJzYXRpb25zLnB1c2gobmV3U2Vzc2lvbilcbiAgY29uc29sZS5sb2coYPCfkqwgQ3JlYXRlZCBjb252ZXJzYXRpb24gc2Vzc2lvbiAke3Nlc3Npb25JZH0gZm9yIHVzZXIgJHt1c2VySWR9YClcbiAgcmV0dXJuIG5ld1Nlc3Npb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZUNvbnZlcnNhdGlvblNlc3Npb24oc2Vzc2lvbjogQ29udmVyc2F0aW9uU2Vzc2lvbik6IENvbnZlcnNhdGlvblNlc3Npb24ge1xuICBjb25zdCBpbmRleCA9IHRlbXBDb252ZXJzYXRpb25zLmZpbmRJbmRleChzID0+IFxuICAgIHMudXNlcklkID09PSBzZXNzaW9uLnVzZXJJZCAmJiBzLnNlc3Npb25JZCA9PT0gc2Vzc2lvbi5zZXNzaW9uSWRcbiAgKVxuICBcbiAgaWYgKGluZGV4ICE9PSAtMSkge1xuICAgIHRlbXBDb252ZXJzYXRpb25zW2luZGV4XSA9IHsgLi4uc2Vzc2lvbiwgbGFzdFVwZGF0ZTogbmV3IERhdGUoKSB9XG4gICAgY29uc29sZS5sb2coYPCfkqwgVXBkYXRlZCBzZXNzaW9uICR7c2Vzc2lvbi5zZXNzaW9uSWR9IC0gJHtzZXNzaW9uLnR1cm5zLmxlbmd0aH0gdHVybnNgKVxuICB9IGVsc2Uge1xuICAgIHRlbXBDb252ZXJzYXRpb25zLnB1c2goeyAuLi5zZXNzaW9uLCBsYXN0VXBkYXRlOiBuZXcgRGF0ZSgpIH0pXG4gICAgY29uc29sZS5sb2coYPCfkqwgQ3JlYXRlZCBuZXcgc2Vzc2lvbiAke3Nlc3Npb24uc2Vzc2lvbklkfSBkdXJpbmcgdXBkYXRlYClcbiAgfVxuICBcbiAgcmV0dXJuIHNlc3Npb25cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZENvbnZlcnNhdGlvblR1cm4oXG4gIHVzZXJJZDogc3RyaW5nLCBcbiAgc2Vzc2lvbklkOiBzdHJpbmcsIFxuICByb2xlOiAndXNlcicgfCAnYXNzaXN0YW50JywgXG4gIGNvbnRlbnQ6IHN0cmluZyxcbiAgbWV0YWRhdGE6IENvbnZlcnNhdGlvblR1cm5bJ21ldGFkYXRhJ10gPSB7fVxuKTogQ29udmVyc2F0aW9uU2Vzc2lvbiB7XG4gIGxldCBzZXNzaW9uID0gZ2V0Q29udmVyc2F0aW9uU2Vzc2lvbih1c2VySWQsIHNlc3Npb25JZClcbiAgaWYgKCFzZXNzaW9uKSB7XG4gICAgc2Vzc2lvbiA9IGNyZWF0ZUNvbnZlcnNhdGlvblNlc3Npb24odXNlcklkLCBzZXNzaW9uSWQpXG4gIH1cbiAgXG4gIGNvbnN0IHR1cm46IENvbnZlcnNhdGlvblR1cm4gPSB7XG4gICAgaWQ6IGB0dXJuXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YCxcbiAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgcm9sZSxcbiAgICBjb250ZW50LFxuICAgIG1ldGFkYXRhXG4gIH1cbiAgXG4gIHNlc3Npb24udHVybnMucHVzaCh0dXJuKVxuICBcbiAgLy8gS2VlcCBvbmx5IGxhc3QgMjAgdHVybnMgcGVyIHNlc3Npb25cbiAgaWYgKHNlc3Npb24udHVybnMubGVuZ3RoID4gMjApIHtcbiAgICBzZXNzaW9uLnR1cm5zID0gc2Vzc2lvbi50dXJucy5zbGljZSgtMjApXG4gIH1cbiAgXG4gIHJldHVybiB1cGRhdGVDb252ZXJzYXRpb25TZXNzaW9uKHNlc3Npb24pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBhZGRQZW5kaW5nVGFzayhcbiAgdXNlcklkOiBzdHJpbmcsXG4gIHNlc3Npb25JZDogc3RyaW5nLFxuICB0eXBlOiAnY2FsZW5kYXJfZXZlbnQnIHwgJ2FjYWRlbWljX3NlYXJjaCcgfCAncmVtaW5kZXInLFxuICBkZXNjcmlwdGlvbjogc3RyaW5nLFxuICBkYXRhOiBhbnlcbik6IHZvaWQge1xuICBsZXQgc2Vzc2lvbiA9IGdldENvbnZlcnNhdGlvblNlc3Npb24odXNlcklkLCBzZXNzaW9uSWQpXG4gIGlmICghc2Vzc2lvbikge1xuICAgIHNlc3Npb24gPSBjcmVhdGVDb252ZXJzYXRpb25TZXNzaW9uKHVzZXJJZCwgc2Vzc2lvbklkKVxuICB9XG4gIFxuICBjb25zdCB0YXNrID0ge1xuICAgIGlkOiBgdGFza18ke0RhdGUubm93KCl9YCxcbiAgICB0eXBlLFxuICAgIGRlc2NyaXB0aW9uLFxuICAgIGRhdGEsXG4gICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKClcbiAgfVxuICBcbiAgc2Vzc2lvbi5wZW5kaW5nVGFza3MucHVzaCh0YXNrKVxuICBjb25zb2xlLmxvZyhg8J+TiyBBZGRlZCBwZW5kaW5nIHRhc2s6ICR7ZGVzY3JpcHRpb259YClcbiAgXG4gIHVwZGF0ZUNvbnZlcnNhdGlvblNlc3Npb24oc2Vzc2lvbilcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcmtUYXNrQ29tcGxldGVkKFxuICB1c2VySWQ6IHN0cmluZyxcbiAgc2Vzc2lvbklkOiBzdHJpbmcsXG4gIHRhc2tJZDogc3RyaW5nLFxuICByZXN1bHQ/OiBhbnlcbik6IGJvb2xlYW4ge1xuICBjb25zdCBzZXNzaW9uID0gZ2V0Q29udmVyc2F0aW9uU2Vzc2lvbih1c2VySWQsIHNlc3Npb25JZClcbiAgaWYgKCFzZXNzaW9uKSByZXR1cm4gZmFsc2VcbiAgXG4gIGNvbnN0IHRhc2sgPSBzZXNzaW9uLnBlbmRpbmdUYXNrcy5maW5kKHQgPT4gdC5pZCA9PT0gdGFza0lkKVxuICBpZiAoIXRhc2spIHJldHVybiBmYWxzZVxuICBcbiAgdGFzay5jb21wbGV0ZWQgPSB0cnVlXG4gIGlmIChyZXN1bHQpIHtcbiAgICB0YXNrLmRhdGEucmVzdWx0ID0gcmVzdWx0XG4gIH1cbiAgXG4gIGNvbnNvbGUubG9nKGDinIUgQ29tcGxldGVkIHRhc2s6ICR7dGFzay5kZXNjcmlwdGlvbn1gKVxuICB1cGRhdGVDb252ZXJzYXRpb25TZXNzaW9uKHNlc3Npb24pXG4gIHJldHVybiB0cnVlXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRQZW5kaW5nVGFza3ModXNlcklkOiBzdHJpbmcsIHNlc3Npb25JZDogc3RyaW5nKTogQXJyYXk8e1xuICBpZDogc3RyaW5nXG4gIHR5cGU6ICdjYWxlbmRhcl9ldmVudCcgfCAnYWNhZGVtaWNfc2VhcmNoJyB8ICdyZW1pbmRlcidcbiAgZGVzY3JpcHRpb246IHN0cmluZ1xuICBkYXRhOiBhbnlcbiAgY29tcGxldGVkOiBib29sZWFuXG4gIGNyZWF0ZWRBdDogRGF0ZVxufT4ge1xuICBjb25zdCBzZXNzaW9uID0gZ2V0Q29udmVyc2F0aW9uU2Vzc2lvbih1c2VySWQsIHNlc3Npb25JZClcbiAgaWYgKCFzZXNzaW9uKSByZXR1cm4gW11cbiAgXG4gIHJldHVybiBzZXNzaW9uLnBlbmRpbmdUYXNrcy5maWx0ZXIodGFzayA9PiAhdGFzay5jb21wbGV0ZWQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDb252ZXJzYXRpb25IaXN0b3J5KHVzZXJJZDogc3RyaW5nLCBzZXNzaW9uSWQ6IHN0cmluZywgbGltaXQ6IG51bWJlciA9IDEwKTogQ29udmVyc2F0aW9uVHVybltdIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGdldENvbnZlcnNhdGlvblNlc3Npb24odXNlcklkLCBzZXNzaW9uSWQpXG4gIGlmICghc2Vzc2lvbikgcmV0dXJuIFtdXG4gIFxuICByZXR1cm4gc2Vzc2lvbi50dXJucy5zbGljZSgtbGltaXQpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRVc2VyQWN0aXZlU2Vzc2lvbnModXNlcklkOiBzdHJpbmcpOiBDb252ZXJzYXRpb25TZXNzaW9uW10ge1xuICBjb25zdCBvbmVIb3VyQWdvID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtICg2MCAqIDYwICogMTAwMCkpXG4gIHJldHVybiB0ZW1wQ29udmVyc2F0aW9ucy5maWx0ZXIoc2Vzc2lvbiA9PiBcbiAgICBzZXNzaW9uLnVzZXJJZCA9PT0gdXNlcklkICYmIHNlc3Npb24ubGFzdFVwZGF0ZSA+IG9uZUhvdXJBZ29cbiAgKVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYW51cE9sZENvbnZlcnNhdGlvbnMoKTogdm9pZCB7XG4gIGNvbnN0IHNpeEhvdXJzQWdvID0gbmV3IERhdGUoRGF0ZS5ub3coKSAtICg2ICogNjAgKiA2MCAqIDEwMDApKVxuICBjb25zdCBiZWZvcmUgPSB0ZW1wQ29udmVyc2F0aW9ucy5sZW5ndGhcbiAgXG4gIC8vIFJlbW92ZSBjb252ZXJzYXRpb25zIG9sZGVyIHRoYW4gNiBob3Vyc1xuICBmb3IgKGxldCBpID0gdGVtcENvbnZlcnNhdGlvbnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICBpZiAodGVtcENvbnZlcnNhdGlvbnNbaV0ubGFzdFVwZGF0ZSA8IHNpeEhvdXJzQWdvKSB7XG4gICAgICB0ZW1wQ29udmVyc2F0aW9ucy5zcGxpY2UoaSwgMSlcbiAgICB9XG4gIH1cbiAgXG4gIGNvbnN0IGFmdGVyID0gdGVtcENvbnZlcnNhdGlvbnMubGVuZ3RoXG4gIGlmIChiZWZvcmUgIT09IGFmdGVyKSB7XG4gICAgY29uc29sZS5sb2coYPCfp7kgQ2xlYW5lZCB1cCAke2JlZm9yZSAtIGFmdGVyfSBvbGQgY29udmVyc2F0aW9uIHNlc3Npb25zYClcbiAgfVxufVxuXG4vLyBJbml0aWFsaXplIGRlZmF1bHQgdXNlcnMgYXV0b21hdGljYWxseVxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIlxuXG5mdW5jdGlvbiBpbml0RGVmYXVsdFVzZXJzKCkge1xuICAvLyBDaGVjayBpZiBkZW1vIHVzZXJzIGFscmVhZHkgZXhpc3QgdG8gYXZvaWQgZHVwbGljYXRlc1xuICBjb25zdCBzdHVkZW50RXhpc3RzID0gZmluZFVzZXJCeUVtYWlsKFwiZXN0dWRpYW50ZUBkZW1vLmNvbVwiKVxuICBjb25zdCBpbnN0cnVjdG9yRXhpc3RzID0gZmluZFVzZXJCeUVtYWlsKFwiaW5zdHJ1Y3RvckBkZW1vLmNvbVwiKVxuICBcbiAgaWYgKCFzdHVkZW50RXhpc3RzIHx8ICFpbnN0cnVjdG9yRXhpc3RzKSB7XG4gICAgY29uc29sZS5sb2coXCLwn5SnIEluaWNpYWxpemFuZG8gdXN1YXJpb3MgcG9yIGRlZmVjdG8uLi5cIilcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBiY3J5cHQuaGFzaFN5bmMoXCJFc3R1ZGlhbnRlMTIzISEhXCIsIDEyKVxuICAgICAgXG4gICAgICAvLyBPbmx5IGFkZCBzdHVkZW50IGlmIGRvZXNuJ3QgZXhpc3RcbiAgICAgIGlmICghc3R1ZGVudEV4aXN0cykge1xuICAgICAgICBhZGRVc2VyKHtcbiAgICAgICAgICBpZDogXCJkZW1vLXN0dWRlbnQtZml4ZWRcIixcbiAgICAgICAgICBuYW1lOiBcIkVzdHVkaWFudGUgRGVtb1wiLFxuICAgICAgICAgIGVtYWlsOiBcImVzdHVkaWFudGVAZGVtby5jb21cIixcbiAgICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXG4gICAgICAgICAgcm9sZTogXCJTVFVERU5UXCIsXG4gICAgICAgICAgc3R1ZGVudElkOiBcIkVTVC0yMDI1LTAwMVwiLFxuICAgICAgICAgIHN0YXR1czogXCJBQ1RJVkVcIixcbiAgICAgICAgICBlbnJvbGxtZW50WWVhcjogMjAyNSxcbiAgICAgICAgICBhY2FkZW1pY1llYXI6IFwiMjAyNS0yMDI2XCIsXG4gICAgICAgICAgcHJvZ3JhbTogXCJJbmdlbmllcsOtYSBlbiBTaXN0ZW1hc1wiLFxuICAgICAgICAgIHBob25lTnVtYmVyOiBcIisxMjM0NTY3ODkwXCIsXG4gICAgICAgICAgZGF0ZU9mQmlydGg6IG5ldyBEYXRlKFwiMjAwMC0wMS0wMVwiKSxcbiAgICAgICAgICBhZGRyZXNzOiBcIkRlbW8gQWRkcmVzcyAxMjNcIixcbiAgICAgICAgICBlbWVyZ2VuY3lDb250YWN0OiB7XG4gICAgICAgICAgICBuYW1lOiBcIkNvbnRhY3RvIERlbW9cIixcbiAgICAgICAgICAgIHBob25lOiBcIiswOTg3NjU0MzIxXCIsXG4gICAgICAgICAgICByZWxhdGlvbnNoaXA6IFwiUGFkcmVcIlxuICAgICAgICAgIH0sXG4gICAgICAgICAgY3JlYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfSlcbiAgICAgICAgY29uc29sZS5sb2coXCLinIUgVXN1YXJpbyBlc3R1ZGlhbnRlIGRlbW8gY3JlYWRvXCIpXG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIE9ubHkgYWRkIGluc3RydWN0b3IgaWYgZG9lc24ndCBleGlzdFxuICAgICAgaWYgKCFpbnN0cnVjdG9yRXhpc3RzKSB7XG4gICAgICAgIGFkZFVzZXIoe1xuICAgICAgICAgIGlkOiBcImRlbW8taW5zdHJ1Y3Rvci1maXhlZFwiLFxuICAgICAgICAgIG5hbWU6IFwiSW5zdHJ1Y3RvciBEZW1vXCIsXG4gICAgICAgICAgZW1haWw6IFwiaW5zdHJ1Y3RvckBkZW1vLmNvbVwiLFxuICAgICAgICAgIHBhc3N3b3JkOiBoYXNoZWRQYXNzd29yZCxcbiAgICAgICAgICByb2xlOiBcIklOU1RSVUNUT1JcIixcbiAgICAgICAgICBzdHVkZW50SWQ6IG51bGwsXG4gICAgICAgICAgc3RhdHVzOiBcIkFDVElWRVwiLFxuICAgICAgICAgIGVucm9sbG1lbnRZZWFyOiAyMDI1LFxuICAgICAgICAgIGFjYWRlbWljWWVhcjogXCIyMDI1LTIwMjZcIixcbiAgICAgICAgICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9KVxuICAgICAgICBjb25zb2xlLmxvZyhcIuKchSBVc3VhcmlvIGluc3RydWN0b3IgZGVtbyBjcmVhZG9cIilcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coXCLinIUgVmVyaWZpY2FjacOzbiBkZSB1c3VhcmlvcyBwb3IgZGVmZWN0byBjb21wbGV0YWRhXCIpXG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBjcmVhbmRvIHVzdWFyaW9zIHBvciBkZWZlY3RvOlwiLCBlcnJvcilcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5sb2coXCLinIUgVXN1YXJpb3MgZGVtbyB5YSBleGlzdGVuLCBubyBzZSByZWluaWNpYWxpemFuXCIpXG4gIH1cbiAgXG4gIC8vIEFsd2F5cyBjaGVjayBhbmQgaW5pdGlhbGl6ZSBzYW1wbGUgcmVwb3J0c1xuICBpbml0U2FtcGxlUmVwb3J0cygpXG59XG5cbmZ1bmN0aW9uIGluaXRTYW1wbGVSZXBvcnRzKCkge1xuICAvLyBDaGVjayBpZiBzYW1wbGUgcmVwb3J0cyBhbHJlYWR5IGV4aXN0IGZvciBkZW1vIHN0dWRlbnRcbiAgY29uc3QgZXhpc3RpbmdTYW1wbGVSZXBvcnRzID0gdGVtcFdlZWtseVJlcG9ydHMuZmlsdGVyKHJlcG9ydCA9PiByZXBvcnQudXNlcklkID09PSBcImRlbW8tc3R1ZGVudC1maXhlZFwiKVxuICBcbiAgaWYgKGV4aXN0aW5nU2FtcGxlUmVwb3J0cy5sZW5ndGggPT09IDApIHtcbiAgICBjb25zb2xlLmxvZyhcIvCfk50gSW5pY2lhbGl6YW5kbyByZXBvcnRlcyBkZSBtdWVzdHJhLi4uXCIpXG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIEdldCBjdXJyZW50IHdlZWsgZGF0ZXNcbiAgICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICAgIGNvbnN0IGN1cnJlbnRXZWVrID0gZ2V0Q3VycmVudFdlZWtTdGFydCgpXG4gICAgICBjb25zdCBjdXJyZW50V2Vla0VuZCA9IGdldEN1cnJlbnRXZWVrRW5kKClcbiAgICAgIFxuICAgICAgLy8gUHJldmlvdXMgd2Vla1xuICAgICAgY29uc3QgcHJldldlZWsgPSBuZXcgRGF0ZShjdXJyZW50V2VlaylcbiAgICAgIHByZXZXZWVrLnNldERhdGUocHJldldlZWsuZ2V0RGF0ZSgpIC0gNylcbiAgICAgIGNvbnN0IHByZXZXZWVrRW5kID0gbmV3IERhdGUoY3VycmVudFdlZWtFbmQpXG4gICAgICBwcmV2V2Vla0VuZC5zZXREYXRlKHByZXZXZWVrRW5kLmdldERhdGUoKSAtIDcpXG4gICAgICBcbiAgICAgIC8vIFNhbXBsZSByZXBvcnQgZnJvbSBwcmV2aW91cyB3ZWVrXG4gICAgICBhZGRXZWVrbHlSZXBvcnQoe1xuICAgICAgICBpZDogXCJzYW1wbGUtcmVwb3J0LTFcIixcbiAgICAgICAgdXNlcklkOiBcImRlbW8tc3R1ZGVudC1maXhlZFwiLFxuICAgICAgICB3ZWVrU3RhcnQ6IHByZXZXZWVrLFxuICAgICAgICB3ZWVrRW5kOiBwcmV2V2Vla0VuZCxcbiAgICAgICAgc3VibWl0dGVkQXQ6IG5ldyBEYXRlKHByZXZXZWVrRW5kLmdldFRpbWUoKSAtIDI0ICogNjAgKiA2MCAqIDEwMDApLCAvLyAxIGRheSBiZWZvcmUgd2VlayBlbmRcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgdGVtYXNZRG9taW5pbzogXCJFc3RhIHNlbWFuYSB0cmFiYWphbW9zIGNvbiBKYXZhU2NyaXB0IGLDoXNpY28gLSBOaXZlbCAzOiBEb21pbm8gZnVuY2lvbmVzIHkgYXJyYXlzLCB5IGVzdG95IGFwcmVuZGllbmRvIG9iamV0b3MgY29tcGxlam9zLlwiLFxuICAgICAgICAgIGV2aWRlbmNpYUFwcmVuZGl6YWplOiBcIkNvbXBsZXTDqSB1biBwcm95ZWN0byBkZSBUby1EbyBMaXN0IHVzYW5kbyBKYXZhU2NyaXB0IHZhbmlsbGEuIEltcGxlbWVudMOpIGZ1bmNpb25lcyBwYXJhIGFncmVnYXIsIGVkaXRhciB5IGVsaW1pbmFyIHRhcmVhcyB1c2FuZG8gYXJyYXlzIHkgb2JqZXRvcy5cIixcbiAgICAgICAgICBkaWZpY3VsdGFkZXNFc3RyYXRlZ2lhczogXCJUdXZlIGRpZmljdWx0YWRlcyBjb24gZWwgbWFuZWpvIGRlIGV2ZW50b3MgZW4gSmF2YVNjcmlwdC4gTG8gcmVzb2x2w60gcHJhY3RpY2FuZG8gY29uIGVqZW1wbG9zIHkgY29uc3VsdGFuZG8gZG9jdW1lbnRhY2nDs24gZGUgTUROLlwiLFxuICAgICAgICAgIGNvbmV4aW9uZXNBcGxpY2FjaW9uOiBcIkxvcyBjb25jZXB0b3MgZGUgZXZlbnRvcyBzZSBjb25lY3RhbiBjb24gbGEgaW50ZXJhY3RpdmlkYWQgZW4gYXBsaWNhY2lvbmVzIHdlYi4gUHVlZG8gYXBsaWNhcmxvIHBhcmEgY3JlYXIgaW50ZXJmYWNlcyBtw6FzIGRpbsOhbWljYXMuXCIsXG4gICAgICAgICAgY29tZW50YXJpb3NBZGljaW9uYWxlczogXCJNZSBzaWVudG8gbcOhcyBjb25maWFkbyBjb24gSmF2YVNjcmlwdC4gUXVpZXJvIHNlZ3VpciBwcmFjdGljYW5kbyBjb24gcHJveWVjdG9zIG3DoXMgY29tcGxlam9zLlwiXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIC8vIFR3byB3ZWVrcyBhZ28gcmVwb3J0ICBcbiAgICAgIGNvbnN0IHR3b1dlZWtzQWdvID0gbmV3IERhdGUoY3VycmVudFdlZWspXG4gICAgICB0d29XZWVrc0Fnby5zZXREYXRlKHR3b1dlZWtzQWdvLmdldERhdGUoKSAtIDE0KVxuICAgICAgY29uc3QgdHdvV2Vla3NBZ29FbmQgPSBuZXcgRGF0ZShjdXJyZW50V2Vla0VuZClcbiAgICAgIHR3b1dlZWtzQWdvRW5kLnNldERhdGUodHdvV2Vla3NBZ29FbmQuZ2V0RGF0ZSgpIC0gMTQpXG4gICAgICBcbiAgICAgIGFkZFdlZWtseVJlcG9ydCh7XG4gICAgICAgIGlkOiBcInNhbXBsZS1yZXBvcnQtMlwiLFxuICAgICAgICB1c2VySWQ6IFwiZGVtby1zdHVkZW50LWZpeGVkXCIsIFxuICAgICAgICB3ZWVrU3RhcnQ6IHR3b1dlZWtzQWdvLFxuICAgICAgICB3ZWVrRW5kOiB0d29XZWVrc0Fnb0VuZCxcbiAgICAgICAgc3VibWl0dGVkQXQ6IG5ldyBEYXRlKHR3b1dlZWtzQWdvRW5kLmdldFRpbWUoKSAtIDEyICogNjAgKiA2MCAqIDEwMDApLCAvLyAxMiBob3VycyBiZWZvcmUgd2VlayBlbmRcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgdGVtYXNZRG9taW5pbzogXCJFc3RhIHNlbWFuYSBlc3R1ZGlhbW9zIENTUyBHcmlkIHkgRmxleGJveCAtIE5pdmVsIDI6IEVudGllbmRvIGxvcyBjb25jZXB0b3MgYsOhc2ljb3MgcGVybyBhw7puIHRlbmdvIGR1ZGFzIGNvbiBsYXlvdXRzIGNvbXBsZWpvcy5cIixcbiAgICAgICAgICBldmlkZW5jaWFBcHJlbmRpemFqZTogXCJSZWNyZcOpIGVsIGxheW91dCBkZSB1bmEgcMOhZ2luYSB3ZWIgdXNhbmRvIENTUyBHcmlkLiBMb2dyw6kgaGFjZXIgdW5hIGVzdHJ1Y3R1cmEgcmVzcG9uc2l2ZSBjb24gaGVhZGVyLCBzaWRlYmFyIHkgbWFpbiBjb250ZW50LlwiLFxuICAgICAgICAgIGRpZmljdWx0YWRlc0VzdHJhdGVnaWFzOiBcIk1lIGNvbmZ1bmTDrSBjb24gbGFzIHByb3BpZWRhZGVzIGdyaWQtdGVtcGxhdGUtYXJlYXMuIFJlc29sdsOtIGVsIHByb2JsZW1hIGRpYnVqYW5kbyBlbCBsYXlvdXQgZW4gcGFwZWwgcHJpbWVyby5cIixcbiAgICAgICAgICBjb25leGlvbmVzQXBsaWNhY2lvbjogXCJDU1MgR3JpZCBlcyBwZXJmZWN0byBwYXJhIGNyZWFyIGxheW91dHMgZGUgcMOhZ2luYXMgd2ViIG1vZGVybmFzLiBMbyB1c2Fyw6kgZW4gbWkgcHJveWVjdG8gZmluYWwgZGUgcMOhZ2luYSBwb3J0Zm9saW8uXCIsXG4gICAgICAgICAgY29tZW50YXJpb3NBZGljaW9uYWxlczogXCJDU1MgZXMgbcOhcyBkaXZlcnRpZG8gZGUgbG8gcXVlIHBlbnNhYmEuIE1lIGd1c3RhIHZlciBsb3MgcmVzdWx0YWRvcyB2aXN1YWxlcyBpbm1lZGlhdG9zLlwiXG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKFwi4pyFIFJlcG9ydGVzIGRlIG11ZXN0cmEgY3JlYWRvcyBleGl0b3NhbWVudGVcIilcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIuKdjCBFcnJvciBjcmVhbmRvIHJlcG9ydGVzIGRlIG11ZXN0cmE6XCIsIGVycm9yKVxuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBjb25zb2xlLmxvZyhcIuKchSBSZXBvcnRlcyBkZSBtdWVzdHJhIHlhIGV4aXN0ZW4sIG5vIHNlIHJlaW5pY2lhbGl6YW5cIilcbiAgfVxufVxuXG4vLyBJbml0aWFsaXplIG9uIG1vZHVsZSBsb2FkXG5pbml0RGVmYXVsdFVzZXJzKClcblxuLy8gU3RhcnQgY29udmVyc2F0aW9uIGNsZWFudXAgaW50ZXJ2YWxcbnNldEludGVydmFsKGNsZWFudXBPbGRDb252ZXJzYXRpb25zLCAzMCAqIDYwICogMTAwMCkgLy8gRXZlcnkgMzAgbWludXRlcyJdLCJuYW1lcyI6WyJnbG9iYWxGb3JTdG9yYWdlIiwiZ2xvYmFsVGhpcyIsInRlbXBVc2VycyIsInRlbXBXZWVrbHlSZXBvcnRzIiwiYWRkVXNlciIsInVzZXIiLCJwdXNoIiwiZmluZFVzZXJCeUVtYWlsIiwiZW1haWwiLCJmaW5kIiwiZmluZFVzZXJCeVN0dWRlbnRJZCIsInN0dWRlbnRJZCIsImZpbmRVc2VyQnlJZCIsImlkIiwiZ2V0QWxsVXNlcnMiLCJmaW5kVXNlcnNCeVJvbGUiLCJyb2xlIiwiZmlsdGVyIiwiZmluZFVzZXJzQnlQcm9ncmFtIiwicHJvZ3JhbSIsImZpbmRVc2Vyc0J5U3RhdHVzIiwic3RhdHVzIiwidXBkYXRlVXNlciIsInVwZGF0ZXMiLCJ1c2VySW5kZXgiLCJmaW5kSW5kZXgiLCJ1cGRhdGVkQXQiLCJEYXRlIiwiZGVsZXRlVXNlciIsInNwbGljZSIsInZhbGlkYXRlU3R1ZGVudElkIiwic3R1ZGVudElkUmVnZXgiLCJ0ZXN0IiwiZ2VuZXJhdGVTdHVkZW50SWQiLCJjdXJyZW50WWVhciIsImdldEZ1bGxZZWFyIiwiZXhpc3RpbmdJZHMiLCJzdGFydHNXaXRoIiwibWFwIiwic29ydCIsIm5leHROdW1iZXIiLCJsZW5ndGgiLCJsYXN0SWQiLCJsYXN0TnVtYmVyIiwicGFyc2VJbnQiLCJzcGxpdCIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJhZGRXZWVrbHlSZXBvcnQiLCJyZXBvcnQiLCJmaW5kV2Vla2x5UmVwb3J0c0J5VXNlciIsInVzZXJJZCIsImZpbmRXZWVrbHlSZXBvcnRCeVVzZXJBbmRXZWVrIiwid2Vla1N0YXJ0IiwiZ2V0VGltZSIsImdldEFsbFdlZWtseVJlcG9ydHMiLCJnZXRXZWVrbHlSZXBvcnRzQnlEYXRlUmFuZ2UiLCJzdGFydERhdGUiLCJlbmREYXRlIiwid2Vla0VuZCIsImdldEN1cnJlbnRXZWVrU3RhcnQiLCJub3ciLCJtb25kYXkiLCJkYXkiLCJnZXREYXkiLCJkaWZmIiwiZ2V0RGF0ZSIsInNldERhdGUiLCJzZXRIb3VycyIsImdldEN1cnJlbnRXZWVrRW5kIiwiY2FuU3VibWl0VGhpc1dlZWsiLCJjdXJyZW50RGF0ZSIsImV4aXN0aW5nUmVwb3J0IiwiaXNDdXJyZW50V2VlayIsImNvbnNvbGUiLCJsb2ciLCJ0b0lTT1N0cmluZyIsImdldFdlZWtEYXRlcyIsImRhdGUiLCJzdGFydCIsImVuZCIsImdldE1vbnRoV2Vla3MiLCJ5ZWFyIiwibW9udGgiLCJ3ZWVrcyIsImZpcnN0RGF5IiwibGFzdERheSIsImN1cnJlbnQiLCJkYXlPZldlZWsiLCJkYXlzVG9TdWJ0cmFjdCIsImdldEV2ZW50cyIsImdldFVzZXJDYWxlbmRhckRhdGEiLCJyZXF1aXJlIiwidXNlckRhdGEiLCJldmVudHMiLCJlcnJvciIsImdldEFsbENhbGVuZGFyRXZlbnRzIiwiZ2V0VXBjb21pbmdFdmVudHMiLCJkYXlzIiwiYWxsRXZlbnRzIiwiZnV0dXJlRGF0ZSIsImV2ZW50IiwiZXZlbnREYXRlIiwiYSIsImIiLCJnZXRFdmVudHNGb3JEYXRlUmFuZ2UiLCJmaW5kRXZlbnRCeUlkIiwiZXZlbnRJZCIsImdsb2JhbEZvckNvbnZlcnNhdGlvbnMiLCJ0ZW1wQ29udmVyc2F0aW9ucyIsImdldENvbnZlcnNhdGlvblNlc3Npb24iLCJzZXNzaW9uSWQiLCJzZXNzaW9uIiwiY3JlYXRlQ29udmVyc2F0aW9uU2Vzc2lvbiIsImV4aXN0aW5nSW5kZXgiLCJuZXdTZXNzaW9uIiwidHVybnMiLCJjdXJyZW50VG9waWMiLCJ1bmRlZmluZWQiLCJjdXJyZW50U3ViamVjdCIsInBlbmRpbmdUYXNrcyIsImxhc3RVcGRhdGUiLCJ1cGRhdGVDb252ZXJzYXRpb25TZXNzaW9uIiwiaW5kZXgiLCJzIiwiYWRkQ29udmVyc2F0aW9uVHVybiIsImNvbnRlbnQiLCJtZXRhZGF0YSIsInR1cm4iLCJNYXRoIiwicmFuZG9tIiwic3Vic3RyIiwidGltZXN0YW1wIiwic2xpY2UiLCJhZGRQZW5kaW5nVGFzayIsInR5cGUiLCJkZXNjcmlwdGlvbiIsImRhdGEiLCJ0YXNrIiwiY29tcGxldGVkIiwiY3JlYXRlZEF0IiwibWFya1Rhc2tDb21wbGV0ZWQiLCJ0YXNrSWQiLCJyZXN1bHQiLCJ0IiwiZ2V0UGVuZGluZ1Rhc2tzIiwiZ2V0Q29udmVyc2F0aW9uSGlzdG9yeSIsImxpbWl0IiwiZ2V0VXNlckFjdGl2ZVNlc3Npb25zIiwib25lSG91ckFnbyIsImNsZWFudXBPbGRDb252ZXJzYXRpb25zIiwic2l4SG91cnNBZ28iLCJiZWZvcmUiLCJpIiwiYWZ0ZXIiLCJiY3J5cHQiLCJpbml0RGVmYXVsdFVzZXJzIiwic3R1ZGVudEV4aXN0cyIsImluc3RydWN0b3JFeGlzdHMiLCJoYXNoZWRQYXNzd29yZCIsImhhc2hTeW5jIiwibmFtZSIsInBhc3N3b3JkIiwiZW5yb2xsbWVudFllYXIiLCJhY2FkZW1pY1llYXIiLCJwaG9uZU51bWJlciIsImRhdGVPZkJpcnRoIiwiYWRkcmVzcyIsImVtZXJnZW5jeUNvbnRhY3QiLCJwaG9uZSIsInJlbGF0aW9uc2hpcCIsImluaXRTYW1wbGVSZXBvcnRzIiwiZXhpc3RpbmdTYW1wbGVSZXBvcnRzIiwiY3VycmVudFdlZWsiLCJjdXJyZW50V2Vla0VuZCIsInByZXZXZWVrIiwicHJldldlZWtFbmQiLCJzdWJtaXR0ZWRBdCIsInJlc3BvbnNlcyIsInRlbWFzWURvbWluaW8iLCJldmlkZW5jaWFBcHJlbmRpemFqZSIsImRpZmljdWx0YWRlc0VzdHJhdGVnaWFzIiwiY29uZXhpb25lc0FwbGljYWNpb24iLCJjb21lbnRhcmlvc0FkaWNpb25hbGVzIiwidHdvV2Vla3NBZ28iLCJ0d29XZWVrc0Fnb0VuZCIsInNldEludGVydmFsIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/temp-storage.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/visual-learning-engine.ts":
/*!*******************************************!*\
  !*** ./src/lib/visual-learning-engine.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   VisualLearningEngine: () => (/* binding */ VisualLearningEngine),\n/* harmony export */   VisualType: () => (/* binding */ VisualType)\n/* harmony export */ });\n// Visual Learning Engine for Sara AI\n// Generates ASCII diagrams, conceptual maps, and visual representations for enhanced learning\nvar VisualType = /*#__PURE__*/ function(VisualType) {\n    VisualType[\"CONCEPT_MAP\"] = \"concept_map\";\n    VisualType[\"FLOWCHART\"] = \"flowchart\";\n    VisualType[\"HIERARCHY\"] = \"hierarchy\";\n    VisualType[\"TIMELINE\"] = \"timeline\";\n    VisualType[\"DIAGRAM\"] = \"diagram\";\n    VisualType[\"FORMULA_VISUALIZATION\"] = \"formula_visualization\";\n    VisualType[\"CHEMICAL_STRUCTURE\"] = \"chemical_structure\";\n    VisualType[\"MATH_GRAPH\"] = \"math_graph\";\n    VisualType[\"PROCESS_FLOW\"] = \"process_flow\";\n    return VisualType;\n}({});\nclass VisualLearningEngine {\n    /**\n   * Generates visual representation based on content and type\n   */ static generateVisual(content, type, subject) {\n        switch(type){\n            case \"concept_map\":\n                return this.generateConceptMap(content, subject);\n            case \"flowchart\":\n                return this.generateFlowchart(content);\n            case \"hierarchy\":\n                return this.generateHierarchy(content);\n            case \"timeline\":\n                return this.generateTimeline(content);\n            case \"formula_visualization\":\n                return this.generateFormulaVisualization(content);\n            case \"chemical_structure\":\n                return this.generateChemicalStructure(content);\n            case \"process_flow\":\n                return this.generateProcessFlow(content);\n            default:\n                return this.generateGenericDiagram(content);\n        }\n    }\n    /**\n   * Auto-detects the best visual type for content\n   */ static detectOptimalVisualType(content, subject) {\n        const contentLower = content.toLowerCase();\n        // Chemical formulas and structures\n        if (subject === 'chemistry' || subject === 'química' || /h2o|co2|nacl|ch4|formula|molecular|átomo|molécula/.test(contentLower)) {\n            return \"chemical_structure\";\n        }\n        // Mathematical formulas\n        if (subject === 'mathematics' || subject === 'matemáticas' || /ecuación|formula|función|derivada|integral|gráfica/.test(contentLower)) {\n            return \"formula_visualization\";\n        }\n        // Process or step-by-step content\n        if (/paso|step|proceso|luego|después|entonces|primero|segundo/.test(contentLower)) {\n            return \"process_flow\";\n        }\n        // Hierarchical content\n        if (/clasificación|categoría|tipo|nivel|jerarquía|superior|inferior/.test(contentLower)) {\n            return \"hierarchy\";\n        }\n        // Timeline content\n        if (/año|fecha|siglo|época|antes|después|historia|cronología/.test(contentLower)) {\n            return \"timeline\";\n        }\n        // Conceptual relationships\n        if (/relación|concepto|idea|conecta|vincula|asocia/.test(contentLower)) {\n            return \"concept_map\";\n        }\n        // Default to flowchart for general content\n        return \"flowchart\";\n    }\n    /**\n   * Generates concept map visualization\n   */ static generateConceptMap(content, subject) {\n        const concepts = this.extractConcepts(content);\n        const mainConcept = concepts[0] || 'Concepto Principal';\n        const relatedConcepts = concepts.slice(1, 5);\n        let ascii = `\n┌─────────────────────┐\n│   ${this.centerText(mainConcept, 17)}   │\n└─────────┬───────────┘\n          │\n    ┌─────┴─────┐\n    │           │`;\n        relatedConcepts.forEach((concept, index)=>{\n            if (index < 2) {\n                ascii += `\n┌──────────────┐    ┌──────────────┐\n│ ${this.centerText(concept, 12)} │    │              │\n└──────────────┘    └──────────────┘`;\n            }\n        });\n        if (relatedConcepts.length > 2) {\n            ascii += `\n    │           │\n┌───┴─────┐ ┌─────┴───┐`;\n            relatedConcepts.slice(2, 4).forEach((concept)=>{\n                ascii += `\n│ ${this.centerText(concept, 7)} │ │         │`;\n            });\n            ascii += `\n└─────────┘ └─────────┘`;\n        }\n        return {\n            type: \"concept_map\",\n            ascii: ascii,\n            description: `Mapa conceptual que muestra las relaciones entre ${mainConcept} y conceptos relacionados`,\n            elements: concepts.map((concept, index)=>({\n                    id: `concept_${index}`,\n                    type: \"concept_map\",\n                    title: concept,\n                    content: `Concepto: ${concept}`,\n                    connections: index === 0 ? relatedConcepts : [\n                        mainConcept\n                    ]\n                })),\n            instructions: [\n                'El concepto central aparece en la parte superior',\n                'Las líneas conectan conceptos relacionados',\n                'Los conceptos secundarios se ramifican del principal'\n            ]\n        };\n    }\n    /**\n   * Generates flowchart visualization\n   */ static generateFlowchart(content) {\n        const steps = this.extractSteps(content);\n        let ascii = `┌─────────────┐\\n│   INICIO    │\\n└──────┬──────┘\\n       │\\n       ▼`;\n        steps.forEach((step, index)=>{\n            const stepText = this.truncateText(step, 15);\n            ascii += `\n┌─────────────────┐\n│ ${this.centerText(stepText, 15)} │\n└─────────┬───────┘\n          │\n          ▼`;\n        });\n        ascii += `\n┌─────────────┐\n│    FIN      │\n└─────────────┘`;\n        return {\n            type: \"flowchart\",\n            ascii: ascii,\n            description: `Diagrama de flujo que muestra ${steps.length} pasos del proceso`,\n            elements: steps.map((step, index)=>({\n                    id: `step_${index}`,\n                    type: \"flowchart\",\n                    title: `Paso ${index + 1}`,\n                    content: step,\n                    connections: index < steps.length - 1 ? [\n                        `step_${index + 1}`\n                    ] : []\n                })),\n            instructions: [\n                'Sigue las flechas de arriba hacia abajo',\n                'Cada caja representa un paso del proceso',\n                'El flujo va desde INICIO hasta FIN'\n            ]\n        };\n    }\n    /**\n   * Generates hierarchy visualization\n   */ static generateHierarchy(content) {\n        const hierarchyItems = this.extractHierarchy(content);\n        const root = hierarchyItems[0] || 'Elemento Principal';\n        const children = hierarchyItems.slice(1, 4);\n        const grandchildren = hierarchyItems.slice(4, 8);\n        let ascii = `\n                    ┌──────────────────┐\n                    │ ${this.centerText(root, 16)} │\n                    └─────────┬────────┘\n                              │\n                 ┌────────────┼────────────┐`;\n        children.forEach((child, index)=>{\n            const spacing = index === 0 ? '     ' : index === 1 ? '           ' : '                 ';\n            ascii += `\n        ┌─────────────┐${spacing}┌─────────────┐\n        │ ${this.centerText(child, 11)} │${spacing}│             │\n        └─────────────┘${spacing}└─────────────┘`;\n        });\n        if (grandchildren.length > 0) {\n            ascii += `\n              │                     │\n        ┌─────┴─────┐         ┌─────┴─────┐`;\n            grandchildren.slice(0, 2).forEach((item)=>{\n                ascii += `\n        │ ${this.centerText(item, 9)} │         │           │`;\n            });\n            ascii += `\n        └───────────┘         └───────────┘`;\n        }\n        return {\n            type: \"hierarchy\",\n            ascii: ascii,\n            description: `Jerarquía que muestra la estructura de ${root} con ${children.length} niveles`,\n            elements: hierarchyItems.map((item, index)=>({\n                    id: `hierarchy_${index}`,\n                    type: \"hierarchy\",\n                    title: item,\n                    content: `Elemento de jerarquía: ${item}`,\n                    connections: index === 0 ? children : []\n                })),\n            instructions: [\n                'El elemento principal está en la parte superior',\n                'Los elementos secundarios se conectan hacia abajo',\n                'Cada nivel representa una subdivisión'\n            ]\n        };\n    }\n    /**\n   * Generates timeline visualization\n   */ static generateTimeline(content) {\n        const timeEvents = this.extractTimelineEvents(content);\n        let ascii = `━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\\n`;\n        timeEvents.forEach((event, index)=>{\n            const eventText = this.truncateText(event.event, 20);\n            const timeText = event.time || `T${index + 1}`;\n            if (index % 2 === 0) {\n                // Event above timeline\n                ascii += `┌─────────────────────┐\\n│ ${this.centerText(eventText, 19)} │\\n└──────────┬──────────┘\\n           │\\n`;\n                ascii += `━━━━━━━━━━━┿━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\\n`;\n                ascii += `           ${timeText}\\n\\n`;\n            } else {\n                // Event below timeline\n                ascii += `           │\\n           ┼\\n┌──────────┴──────────┐\\n│ ${this.centerText(eventText, 19)} │\\n└─────────────────────┘\\n`;\n            }\n        });\n        return {\n            type: \"timeline\",\n            ascii: ascii,\n            description: `Línea de tiempo con ${timeEvents.length} eventos cronológicos`,\n            elements: timeEvents.map((event, index)=>({\n                    id: `event_${index}`,\n                    type: \"timeline\",\n                    title: event.time || `Evento ${index + 1}`,\n                    content: event.event,\n                    connections: []\n                })),\n            instructions: [\n                'Los eventos se muestran en orden cronológico',\n                'La línea horizontal representa el tiempo',\n                'Los eventos alternos aparecen arriba y abajo de la línea'\n            ]\n        };\n    }\n    /**\n   * Generates formula visualization\n   */ static generateFormulaVisualization(content) {\n        const formula = this.extractFormula(content);\n        const variables = this.extractVariables(content);\n        let ascii = `\n╔═══════════════════════════════════╗\n║         FÓRMULA MATEMÁTICA        ║\n╠═══════════════════════════════════╣\n║                                   ║\n║         ${this.centerText(formula, 19)}         ║\n║                                   ║\n╠═══════════════════════════════════╣\n║           VARIABLES:              ║`;\n        variables.forEach((variable)=>{\n            ascii += `\n║  ${variable.symbol} = ${this.truncateText(variable.description, 20)}    ║`;\n        });\n        ascii += `\n║                                   ║\n╚═══════════════════════════════════╝\n\n    Representación visual:\n    \n         ${formula}\n         ↙     ↘\n    Variable   Resultado\n      ${variables[0]?.symbol || 'x'}         y`;\n        return {\n            type: \"formula_visualization\",\n            ascii: ascii,\n            description: `Visualización de la fórmula ${formula} con ${variables.length} variables`,\n            elements: [\n                {\n                    id: 'formula_main',\n                    type: \"formula_visualization\",\n                    title: 'Fórmula Principal',\n                    content: formula,\n                    connections: variables.map((_, index)=>`var_${index}`)\n                }\n            ].concat(variables.map((variable, index)=>({\n                    id: `var_${index}`,\n                    type: \"formula_visualization\",\n                    title: variable.symbol,\n                    content: variable.description,\n                    connections: []\n                }))),\n            instructions: [\n                'La fórmula principal se muestra en el centro',\n                'Las variables se definen en la tabla inferior',\n                'Sustituye los valores para resolver'\n            ]\n        };\n    }\n    /**\n   * Generates chemical structure visualization\n   */ static generateChemicalStructure(content) {\n        const molecule = this.extractMolecule(content);\n        const atoms = this.extractAtoms(content);\n        let ascii = '';\n        // Simple molecular representations\n        if (molecule.toLowerCase().includes('h2o') || molecule.toLowerCase().includes('agua')) {\n            ascii = `\n        Estructura del Agua (H₂O)\n        \n            H\n            │\n        H─O─H    o    H─O─H\n            \n        Representación angular:\n        \n            H\n             \\\\\n              O\n             /\n            H\n              \n        Ángulo H-O-H: 104.5°`;\n        } else if (molecule.toLowerCase().includes('co2')) {\n            ascii = `\n        Estructura del CO₂\n        \n        O═C═O\n        \n        Lineal, 180°\n        \n        Enlaces dobles:\n        O ══ C ══ O`;\n        } else if (molecule.toLowerCase().includes('ch4') || molecule.toLowerCase().includes('metano')) {\n            ascii = `\n        Estructura del Metano (CH₄)\n        \n           H\n           │\n        H─C─H\n           │\n           H\n           \n        Tetraédrica\n        Ángulo H-C-H: 109.5°`;\n        } else {\n            ascii = `\n        Estructura Molecular\n        \n        ${molecule}\n        \n        Átomos identificados:\n        ${atoms.map((atom)=>`• ${atom}`).join('\\n        ')}\n        \n        Representación esquemática:\n        \n        [Átomo1]─[Átomo2]─[Átomo3]`;\n        }\n        return {\n            type: \"chemical_structure\",\n            ascii: ascii,\n            description: `Estructura química de ${molecule} mostrando ${atoms.length} tipos de átomos`,\n            elements: [\n                {\n                    id: 'molecule_main',\n                    type: \"chemical_structure\",\n                    title: molecule,\n                    content: `Molécula: ${molecule}`,\n                    connections: atoms.map((_, index)=>`atom_${index}`)\n                }\n            ].concat(atoms.map((atom, index)=>({\n                    id: `atom_${index}`,\n                    type: \"chemical_structure\",\n                    title: atom,\n                    content: `Átomo: ${atom}`,\n                    connections: []\n                }))),\n            instructions: [\n                'Los átomos se representan con sus símbolos',\n                'Las líneas representan enlaces químicos',\n                'Los ángulos muestran la geometría molecular'\n            ]\n        };\n    }\n    /**\n   * Generates process flow visualization\n   */ static generateProcessFlow(content) {\n        const processes = this.extractProcesses(content);\n        let ascii = `\n    FLUJO DEL PROCESO\n    \n    ┌─────────────┐`;\n        processes.forEach((process, index)=>{\n            const processText = this.truncateText(process, 15);\n            if (index === 0) {\n                ascii += `\n    │   ${this.centerText(processText, 9)}   │\n    └─────┬───────┘\n          │\n          ▼`;\n            } else {\n                ascii += `\n    ┌─────────────┐\n    │   ${this.centerText(processText, 9)}   │\n    └─────┬───────┘\n          │\n          ▼`;\n            }\n        });\n        ascii += `\n    ┌─────────────┐\n    │   FINAL     │\n    └─────────────┘`;\n        return {\n            type: \"process_flow\",\n            ascii: ascii,\n            description: `Flujo de proceso con ${processes.length} etapas secuenciales`,\n            elements: processes.map((process, index)=>({\n                    id: `process_${index}`,\n                    type: \"process_flow\",\n                    title: `Proceso ${index + 1}`,\n                    content: process,\n                    connections: index < processes.length - 1 ? [\n                        `process_${index + 1}`\n                    ] : []\n                })),\n            instructions: [\n                'Sigue el flujo de arriba hacia abajo',\n                'Cada caja representa una etapa del proceso',\n                'Las flechas indican la secuencia'\n            ]\n        };\n    }\n    /**\n   * Generates generic diagram\n   */ static generateGenericDiagram(content) {\n        const keyPoints = this.extractKeyPoints(content, 4);\n        let ascii = `\n    ╭─────────────────────────────────╮\n    │        DIAGRAMA GENERAL         │\n    ╰─────────────┬───────────────────╯\n                  │`;\n        keyPoints.forEach((point, index)=>{\n            const pointText = this.truncateText(point, 20);\n            ascii += `\n                  ▼\n    ┌─────────────────────────────┐\n    │ ${index + 1}. ${this.leftAlign(pointText, 23)} │\n    └─────────────────────────────┘`;\n        });\n        return {\n            type: \"diagram\",\n            ascii: ascii,\n            description: `Diagrama general con ${keyPoints.length} elementos principales`,\n            elements: keyPoints.map((point, index)=>({\n                    id: `point_${index}`,\n                    type: \"diagram\",\n                    title: `Punto ${index + 1}`,\n                    content: point,\n                    connections: []\n                })),\n            instructions: [\n                'Cada elemento se presenta de forma secuencial',\n                'Los números indican el orden de importancia',\n                'Revisa cada punto para comprensión completa'\n            ]\n        };\n    }\n    // ===== UTILITY FUNCTIONS =====\n    /**\n   * Extracts main concepts from content\n   */ static extractConcepts(content) {\n        const sentences = content.split(/[.!?]+/);\n        const concepts = [];\n        for (const sentence of sentences){\n            const words = sentence.trim().split(' ');\n            const importantWords = words.filter((word)=>word.length > 4 && ![\n                    'este',\n                    'esta',\n                    'estos',\n                    'estas',\n                    'cuando',\n                    'donde',\n                    'porque'\n                ].includes(word.toLowerCase()));\n            if (importantWords.length > 0) {\n                concepts.push(importantWords[0]);\n            }\n            if (concepts.length >= 5) break;\n        }\n        return concepts.length > 0 ? concepts : [\n            'Concepto Principal'\n        ];\n    }\n    /**\n   * Extracts steps from content\n   */ static extractSteps(content) {\n        // Look for numbered steps or sequential indicators\n        const stepPatterns = [\n            /\\d+[.)]\\s*([^.!?]+)/g,\n            /paso \\d+:?\\s*([^.!?]+)/gi,\n            /(primero|segundo|tercero|luego|después|finalmente)[,:]?\\s*([^.!?]+)/gi\n        ];\n        const steps = [];\n        for (const pattern of stepPatterns){\n            let match;\n            while((match = pattern.exec(content)) !== null && steps.length < 6){\n                const step = match[1] || match[2];\n                if (step && step.trim().length > 5) {\n                    steps.push(step.trim());\n                }\n            }\n        }\n        if (steps.length === 0) {\n            // Fallback: split by sentences\n            const sentences = content.split(/[.!?]+/);\n            steps.push(...sentences.slice(0, 4).filter((s)=>s.trim().length > 10));\n        }\n        return steps.slice(0, 5);\n    }\n    /**\n   * Extracts hierarchy items\n   */ static extractHierarchy(content) {\n        const hierarchyWords = [\n            'principal',\n            'secundario',\n            'tipo',\n            'categoría',\n            'clase',\n            'grupo'\n        ];\n        const items = [];\n        const sentences = content.split(/[.!?]+/);\n        for (const sentence of sentences){\n            for (const word of hierarchyWords){\n                if (sentence.toLowerCase().includes(word)) {\n                    const cleanSentence = sentence.replace(/^\\s*\\d+[.)]\\s*/, '').trim();\n                    if (cleanSentence.length > 5) {\n                        items.push(cleanSentence);\n                        break;\n                    }\n                }\n            }\n            if (items.length >= 6) break;\n        }\n        return items.length > 0 ? items : [\n            'Elemento Principal',\n            'Subelemento 1',\n            'Subelemento 2'\n        ];\n    }\n    /**\n   * Extracts timeline events\n   */ static extractTimelineEvents(content) {\n        const timePattern = /(\\d{4}|\\d{1,2}:\\d{2}|siglo \\w+|era \\w+)/gi;\n        const events = [];\n        const sentences = content.split(/[.!?]+/);\n        for (const sentence of sentences){\n            const timeMatch = sentence.match(timePattern);\n            if (timeMatch) {\n                events.push({\n                    time: timeMatch[0],\n                    event: sentence.replace(timePattern, '').trim()\n                });\n            }\n        }\n        if (events.length === 0) {\n            // Fallback timeline\n            const keyEvents = sentences.slice(0, 3).filter((s)=>s.trim().length > 10);\n            keyEvents.forEach((event, index)=>{\n                events.push({\n                    time: `T${index + 1}`,\n                    event: event.trim()\n                });\n            });\n        }\n        return events.slice(0, 5);\n    }\n    /**\n   * Extracts formula from content\n   */ static extractFormula(content) {\n        // Look for mathematical expressions\n        const formulaPatterns = [\n            /([a-zA-Z]\\s*[=]\\s*[^.!?]+)/,\n            /([a-zA-Z]+\\s*\\(\\s*[a-zA-Z,\\s]+\\s*\\))/,\n            /(f\\([x-z]\\)\\s*=\\s*[^.!?]+)/i,\n            /([xy]\\s*=\\s*[^.!?]+)/\n        ];\n        for (const pattern of formulaPatterns){\n            const match = content.match(pattern);\n            if (match) {\n                return match[1].trim();\n            }\n        }\n        // Fallback\n        if (content.includes('=')) {\n            const parts = content.split('=');\n            if (parts.length >= 2) {\n                return `${parts[0].trim()} = ${parts[1].split(/[.!?]/)[0].trim()}`;\n            }\n        }\n        return 'y = f(x)';\n    }\n    /**\n   * Extracts variables from content\n   */ static extractVariables(content) {\n        const variables = [];\n        // Look for variable definitions like \"donde x es...\"\n        const varPattern = /([a-zA-Z])\\s+es\\s+([^.!?]+)/gi;\n        let match;\n        while((match = varPattern.exec(content)) !== null && variables.length < 4){\n            variables.push({\n                symbol: match[1],\n                description: match[2].trim()\n            });\n        }\n        if (variables.length === 0) {\n            variables.push({\n                symbol: 'x',\n                description: 'variable independiente'\n            }, {\n                symbol: 'y',\n                description: 'variable dependiente'\n            });\n        }\n        return variables;\n    }\n    /**\n   * Extracts molecule information\n   */ static extractMolecule(content) {\n        const moleculePatterns = [\n            /([A-Z][a-z]?\\d*)+/g,\n            /(agua|metano|dióxido|carbono|oxígeno|hidrógeno)/i\n        ];\n        for (const pattern of moleculePatterns){\n            const match = content.match(pattern);\n            if (match) {\n                return match[0];\n            }\n        }\n        return 'Molécula';\n    }\n    /**\n   * Extracts atoms from content\n   */ static extractAtoms(content) {\n        const atomSymbols = content.match(/[A-Z][a-z]?/g) || [];\n        const uniqueAtoms = [\n            ...new Set(atomSymbols)\n        ];\n        if (uniqueAtoms.length === 0) {\n            return [\n                'C',\n                'H',\n                'O'\n            ];\n        }\n        return uniqueAtoms.slice(0, 5);\n    }\n    /**\n   * Extracts processes from content\n   */ static extractProcesses(content) {\n        const processes = this.extractSteps(content);\n        return processes.length > 0 ? processes : [\n            'Proceso 1',\n            'Proceso 2',\n            'Proceso 3'\n        ];\n    }\n    /**\n   * Extracts key points from content\n   */ static extractKeyPoints(content, limit = 4) {\n        const sentences = content.split(/[.!?]+/);\n        return sentences.filter((s)=>s.trim().length > 10).slice(0, limit).map((s)=>s.trim());\n    }\n    // ===== TEXT FORMATTING UTILITIES =====\n    /**\n   * Centers text in a fixed width\n   */ static centerText(text, width) {\n        const truncated = this.truncateText(text, width);\n        const padding = Math.max(0, width - truncated.length);\n        const leftPad = Math.floor(padding / 2);\n        const rightPad = padding - leftPad;\n        return ' '.repeat(leftPad) + truncated + ' '.repeat(rightPad);\n    }\n    /**\n   * Left aligns text in a fixed width\n   */ static leftAlign(text, width) {\n        const truncated = this.truncateText(text, width);\n        const padding = Math.max(0, width - truncated.length);\n        return truncated + ' '.repeat(padding);\n    }\n    /**\n   * Truncates text to fit width\n   */ static truncateText(text, maxWidth) {\n        if (text.length <= maxWidth) {\n            return text;\n        }\n        return text.substring(0, maxWidth - 3) + '...';\n    }\n    /**\n   * Main entry point - analyzes content and generates appropriate visual\n   */ static generateOptimalVisual(content, subject) {\n        const optimalType = this.detectOptimalVisualType(content, subject);\n        return this.generateVisual(content, optimalType, subject);\n    }\n    /**\n   * Generates multiple visual options for user to choose from\n   */ static generateVisualOptions(content, subject) {\n        const primaryType = this.detectOptimalVisualType(content, subject);\n        const options = [\n            this.generateVisual(content, primaryType, subject)\n        ];\n        // Add alternative visualizations\n        const alternativeTypes = [\n            \"concept_map\",\n            \"flowchart\",\n            \"diagram\"\n        ];\n        for (const type of alternativeTypes){\n            if (type !== primaryType && options.length < 3) {\n                options.push(this.generateVisual(content, type, subject));\n            }\n        }\n        return options;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQ0MsU0FBU0MsTUFBTUM7WUFDbEQ7UUFDRjtRQUVBLE9BQU93SDtJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2RyaWdvZGliZXJuYXJkbzMzZ21haWwuY29tL0RvY3VtZW50cy9BcHAgRGV2ZWxvcG1lbnQgUHJveWVjdHMvSW50ZWxsZWdvIFBsYXRmb3JtL3NyYy9saWIvdmlzdWFsLWxlYXJuaW5nLWVuZ2luZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBWaXN1YWwgTGVhcm5pbmcgRW5naW5lIGZvciBTYXJhIEFJXG4vLyBHZW5lcmF0ZXMgQVNDSUkgZGlhZ3JhbXMsIGNvbmNlcHR1YWwgbWFwcywgYW5kIHZpc3VhbCByZXByZXNlbnRhdGlvbnMgZm9yIGVuaGFuY2VkIGxlYXJuaW5nXG5cbmV4cG9ydCBlbnVtIFZpc3VhbFR5cGUge1xuICBDT05DRVBUX01BUCA9ICdjb25jZXB0X21hcCcsXG4gIEZMT1dDSEFSVCA9ICdmbG93Y2hhcnQnLFxuICBISUVSQVJDSFkgPSAnaGllcmFyY2h5JyxcbiAgVElNRUxJTkUgPSAndGltZWxpbmUnLFxuICBESUFHUkFNID0gJ2RpYWdyYW0nLFxuICBGT1JNVUxBX1ZJU1VBTElaQVRJT04gPSAnZm9ybXVsYV92aXN1YWxpemF0aW9uJyxcbiAgQ0hFTUlDQUxfU1RSVUNUVVJFID0gJ2NoZW1pY2FsX3N0cnVjdHVyZScsXG4gIE1BVEhfR1JBUEggPSAnbWF0aF9ncmFwaCcsXG4gIFBST0NFU1NfRkxPVyA9ICdwcm9jZXNzX2Zsb3cnXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVmlzdWFsRWxlbWVudCB7XG4gIGlkOiBzdHJpbmdcbiAgdHlwZTogVmlzdWFsVHlwZVxuICB0aXRsZTogc3RyaW5nXG4gIGNvbnRlbnQ6IHN0cmluZ1xuICBjb25uZWN0aW9ucz86IHN0cmluZ1tdXG4gIG1ldGFkYXRhPzoge1xuICAgIHN1YmplY3Q/OiBzdHJpbmdcbiAgICBkaWZmaWN1bHR5PzogJ2Jhc2ljJyB8ICdpbnRlcm1lZGlhdGUnIHwgJ2FkdmFuY2VkJ1xuICAgIGtleXdvcmRzPzogc3RyaW5nW11cbiAgfVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFZpc3VhbFJlcHJlc2VudGF0aW9uIHtcbiAgdHlwZTogVmlzdWFsVHlwZVxuICBhc2NpaTogc3RyaW5nXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmdcbiAgZWxlbWVudHM6IFZpc3VhbEVsZW1lbnRbXVxuICBpbnN0cnVjdGlvbnM6IHN0cmluZ1tdXG59XG5cbmV4cG9ydCBjbGFzcyBWaXN1YWxMZWFybmluZ0VuZ2luZSB7XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyB2aXN1YWwgcmVwcmVzZW50YXRpb24gYmFzZWQgb24gY29udGVudCBhbmQgdHlwZVxuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlVmlzdWFsKGNvbnRlbnQ6IHN0cmluZywgdHlwZTogVmlzdWFsVHlwZSwgc3ViamVjdD86IHN0cmluZyk6IFZpc3VhbFJlcHJlc2VudGF0aW9uIHtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgIGNhc2UgVmlzdWFsVHlwZS5DT05DRVBUX01BUDpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVDb25jZXB0TWFwKGNvbnRlbnQsIHN1YmplY3QpXG4gICAgICBjYXNlIFZpc3VhbFR5cGUuRkxPV0NIQVJUOlxuICAgICAgICByZXR1cm4gdGhpcy5nZW5lcmF0ZUZsb3djaGFydChjb250ZW50KVxuICAgICAgY2FzZSBWaXN1YWxUeXBlLkhJRVJBUkNIWTpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVIaWVyYXJjaHkoY29udGVudClcbiAgICAgIGNhc2UgVmlzdWFsVHlwZS5USU1FTElORTpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVUaW1lbGluZShjb250ZW50KVxuICAgICAgY2FzZSBWaXN1YWxUeXBlLkZPUk1VTEFfVklTVUFMSVpBVElPTjpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVGb3JtdWxhVmlzdWFsaXphdGlvbihjb250ZW50KVxuICAgICAgY2FzZSBWaXN1YWxUeXBlLkNIRU1JQ0FMX1NUUlVDVFVSRTpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVDaGVtaWNhbFN0cnVjdHVyZShjb250ZW50KVxuICAgICAgY2FzZSBWaXN1YWxUeXBlLlBST0NFU1NfRkxPVzpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVQcm9jZXNzRmxvdyhjb250ZW50KVxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVHZW5lcmljRGlhZ3JhbShjb250ZW50KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBdXRvLWRldGVjdHMgdGhlIGJlc3QgdmlzdWFsIHR5cGUgZm9yIGNvbnRlbnRcbiAgICovXG4gIHN0YXRpYyBkZXRlY3RPcHRpbWFsVmlzdWFsVHlwZShjb250ZW50OiBzdHJpbmcsIHN1YmplY3Q/OiBzdHJpbmcpOiBWaXN1YWxUeXBlIHtcbiAgICBjb25zdCBjb250ZW50TG93ZXIgPSBjb250ZW50LnRvTG93ZXJDYXNlKClcblxuICAgIC8vIENoZW1pY2FsIGZvcm11bGFzIGFuZCBzdHJ1Y3R1cmVzXG4gICAgaWYgKHN1YmplY3QgPT09ICdjaGVtaXN0cnknIHx8IHN1YmplY3QgPT09ICdxdcOtbWljYScgfHwgXG4gICAgICAgIC9oMm98Y28yfG5hY2x8Y2g0fGZvcm11bGF8bW9sZWN1bGFyfMOhdG9tb3xtb2zDqWN1bGEvLnRlc3QoY29udGVudExvd2VyKSkge1xuICAgICAgcmV0dXJuIFZpc3VhbFR5cGUuQ0hFTUlDQUxfU1RSVUNUVVJFXG4gICAgfVxuXG4gICAgLy8gTWF0aGVtYXRpY2FsIGZvcm11bGFzXG4gICAgaWYgKHN1YmplY3QgPT09ICdtYXRoZW1hdGljcycgfHwgc3ViamVjdCA9PT0gJ21hdGVtw6F0aWNhcycgfHwgXG4gICAgICAgIC9lY3VhY2nDs258Zm9ybXVsYXxmdW5jacOzbnxkZXJpdmFkYXxpbnRlZ3JhbHxncsOhZmljYS8udGVzdChjb250ZW50TG93ZXIpKSB7XG4gICAgICByZXR1cm4gVmlzdWFsVHlwZS5GT1JNVUxBX1ZJU1VBTElaQVRJT05cbiAgICB9XG5cbiAgICAvLyBQcm9jZXNzIG9yIHN0ZXAtYnktc3RlcCBjb250ZW50XG4gICAgaWYgKC9wYXNvfHN0ZXB8cHJvY2Vzb3xsdWVnb3xkZXNwdcOpc3xlbnRvbmNlc3xwcmltZXJvfHNlZ3VuZG8vLnRlc3QoY29udGVudExvd2VyKSkge1xuICAgICAgcmV0dXJuIFZpc3VhbFR5cGUuUFJPQ0VTU19GTE9XXG4gICAgfVxuXG4gICAgLy8gSGllcmFyY2hpY2FsIGNvbnRlbnRcbiAgICBpZiAoL2NsYXNpZmljYWNpw7NufGNhdGVnb3LDrWF8dGlwb3xuaXZlbHxqZXJhcnF1w61hfHN1cGVyaW9yfGluZmVyaW9yLy50ZXN0KGNvbnRlbnRMb3dlcikpIHtcbiAgICAgIHJldHVybiBWaXN1YWxUeXBlLkhJRVJBUkNIWVxuICAgIH1cblxuICAgIC8vIFRpbWVsaW5lIGNvbnRlbnRcbiAgICBpZiAoL2HDsW98ZmVjaGF8c2lnbG98w6lwb2NhfGFudGVzfGRlc3B1w6lzfGhpc3RvcmlhfGNyb25vbG9nw61hLy50ZXN0KGNvbnRlbnRMb3dlcikpIHtcbiAgICAgIHJldHVybiBWaXN1YWxUeXBlLlRJTUVMSU5FXG4gICAgfVxuXG4gICAgLy8gQ29uY2VwdHVhbCByZWxhdGlvbnNoaXBzXG4gICAgaWYgKC9yZWxhY2nDs258Y29uY2VwdG98aWRlYXxjb25lY3RhfHZpbmN1bGF8YXNvY2lhLy50ZXN0KGNvbnRlbnRMb3dlcikpIHtcbiAgICAgIHJldHVybiBWaXN1YWxUeXBlLkNPTkNFUFRfTUFQXG4gICAgfVxuXG4gICAgLy8gRGVmYXVsdCB0byBmbG93Y2hhcnQgZm9yIGdlbmVyYWwgY29udGVudFxuICAgIHJldHVybiBWaXN1YWxUeXBlLkZMT1dDSEFSVFxuICB9XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlcyBjb25jZXB0IG1hcCB2aXN1YWxpemF0aW9uXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGVDb25jZXB0TWFwKGNvbnRlbnQ6IHN0cmluZywgc3ViamVjdD86IHN0cmluZyk6IFZpc3VhbFJlcHJlc2VudGF0aW9uIHtcbiAgICBjb25zdCBjb25jZXB0cyA9IHRoaXMuZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQpXG4gICAgY29uc3QgbWFpbkNvbmNlcHQgPSBjb25jZXB0c1swXSB8fCAnQ29uY2VwdG8gUHJpbmNpcGFsJ1xuICAgIGNvbnN0IHJlbGF0ZWRDb25jZXB0cyA9IGNvbmNlcHRzLnNsaWNlKDEsIDUpXG5cbiAgICBsZXQgYXNjaWkgPSBgXG7ilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcbuKUgiAgICR7dGhpcy5jZW50ZXJUZXh0KG1haW5Db25jZXB0LCAxNyl9ICAg4pSCXG7ilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilKzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJhcbiAgICAgICAgICDilIJcbiAgICDilIzilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilJBcbiAgICDilIIgICAgICAgICAgIOKUgmBcblxuICAgIHJlbGF0ZWRDb25jZXB0cy5mb3JFYWNoKChjb25jZXB0LCBpbmRleCkgPT4ge1xuICAgICAgaWYgKGluZGV4IDwgMikge1xuICAgICAgICBhc2NpaSArPSBgXG7ilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJAgICAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG7ilIIgJHt0aGlzLmNlbnRlclRleHQoY29uY2VwdCwgMTIpfSDilIIgICAg4pSCICAgICAgICAgICAgICDilIJcbuKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmCAgICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJhgXG4gICAgICB9XG4gICAgfSlcblxuICAgIGlmIChyZWxhdGVkQ29uY2VwdHMubGVuZ3RoID4gMikge1xuICAgICAgYXNjaWkgKz0gYFxuICAgIOKUgiAgICAgICAgICAg4pSCXG7ilIzilIDilIDilIDilLTilIDilIDilIDilIDilIDilJAg4pSM4pSA4pSA4pSA4pSA4pSA4pS04pSA4pSA4pSA4pSQYFxuICAgICAgcmVsYXRlZENvbmNlcHRzLnNsaWNlKDIsIDQpLmZvckVhY2goY29uY2VwdCA9PiB7XG4gICAgICAgIGFzY2lpICs9IGBcbuKUgiAke3RoaXMuY2VudGVyVGV4dChjb25jZXB0LCA3KX0g4pSCIOKUgiAgICAgICAgIOKUgmBcbiAgICAgIH0pXG4gICAgICBhc2NpaSArPSBgXG7ilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYYFxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBWaXN1YWxUeXBlLkNPTkNFUFRfTUFQLFxuICAgICAgYXNjaWk6IGFzY2lpLFxuICAgICAgZGVzY3JpcHRpb246IGBNYXBhIGNvbmNlcHR1YWwgcXVlIG11ZXN0cmEgbGFzIHJlbGFjaW9uZXMgZW50cmUgJHttYWluQ29uY2VwdH0geSBjb25jZXB0b3MgcmVsYWNpb25hZG9zYCxcbiAgICAgIGVsZW1lbnRzOiBjb25jZXB0cy5tYXAoKGNvbmNlcHQsIGluZGV4KSA9PiAoe1xuICAgICAgICBpZDogYGNvbmNlcHRfJHtpbmRleH1gLFxuICAgICAgICB0eXBlOiBWaXN1YWxUeXBlLkNPTkNFUFRfTUFQLFxuICAgICAgICB0aXRsZTogY29uY2VwdCxcbiAgICAgICAgY29udGVudDogYENvbmNlcHRvOiAke2NvbmNlcHR9YCxcbiAgICAgICAgY29ubmVjdGlvbnM6IGluZGV4ID09PSAwID8gcmVsYXRlZENvbmNlcHRzIDogW21haW5Db25jZXB0XVxuICAgICAgfSkpLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBbXG4gICAgICAgICdFbCBjb25jZXB0byBjZW50cmFsIGFwYXJlY2UgZW4gbGEgcGFydGUgc3VwZXJpb3InLFxuICAgICAgICAnTGFzIGzDrW5lYXMgY29uZWN0YW4gY29uY2VwdG9zIHJlbGFjaW9uYWRvcycsXG4gICAgICAgICdMb3MgY29uY2VwdG9zIHNlY3VuZGFyaW9zIHNlIHJhbWlmaWNhbiBkZWwgcHJpbmNpcGFsJ1xuICAgICAgXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgZmxvd2NoYXJ0IHZpc3VhbGl6YXRpb25cbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZUZsb3djaGFydChjb250ZW50OiBzdHJpbmcpOiBWaXN1YWxSZXByZXNlbnRhdGlvbiB7XG4gICAgY29uc3Qgc3RlcHMgPSB0aGlzLmV4dHJhY3RTdGVwcyhjb250ZW50KVxuICAgIFxuICAgIGxldCBhc2NpaSA9IGDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcXG7ilIIgICBJTklDSU8gICAg4pSCXFxu4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSs4pSA4pSA4pSA4pSA4pSA4pSA4pSYXFxuICAgICAgIOKUglxcbiAgICAgICDilrxgXG5cbiAgICBzdGVwcy5mb3JFYWNoKChzdGVwLCBpbmRleCkgPT4ge1xuICAgICAgY29uc3Qgc3RlcFRleHQgPSB0aGlzLnRydW5jYXRlVGV4dChzdGVwLCAxNSlcbiAgICAgIGFzY2lpICs9IGBcbuKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxu4pSCICR7dGhpcy5jZW50ZXJUZXh0KHN0ZXBUZXh0LCAxNSl9IOKUglxu4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSs4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gICAgICAgICAg4pSCXG4gICAgICAgICAg4pa8YFxuICAgIH0pXG5cbiAgICBhc2NpaSArPSBgXG7ilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcbuKUgiAgICBGSU4gICAgICDilIJcbuKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmGBcblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBWaXN1YWxUeXBlLkZMT1dDSEFSVCxcbiAgICAgIGFzY2lpOiBhc2NpaSxcbiAgICAgIGRlc2NyaXB0aW9uOiBgRGlhZ3JhbWEgZGUgZmx1am8gcXVlIG11ZXN0cmEgJHtzdGVwcy5sZW5ndGh9IHBhc29zIGRlbCBwcm9jZXNvYCxcbiAgICAgIGVsZW1lbnRzOiBzdGVwcy5tYXAoKHN0ZXAsIGluZGV4KSA9PiAoe1xuICAgICAgICBpZDogYHN0ZXBfJHtpbmRleH1gLFxuICAgICAgICB0eXBlOiBWaXN1YWxUeXBlLkZMT1dDSEFSVCxcbiAgICAgICAgdGl0bGU6IGBQYXNvICR7aW5kZXggKyAxfWAsXG4gICAgICAgIGNvbnRlbnQ6IHN0ZXAsXG4gICAgICAgIGNvbm5lY3Rpb25zOiBpbmRleCA8IHN0ZXBzLmxlbmd0aCAtIDEgPyBbYHN0ZXBfJHtpbmRleCArIDF9YF0gOiBbXVxuICAgICAgfSkpLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBbXG4gICAgICAgICdTaWd1ZSBsYXMgZmxlY2hhcyBkZSBhcnJpYmEgaGFjaWEgYWJham8nLFxuICAgICAgICAnQ2FkYSBjYWphIHJlcHJlc2VudGEgdW4gcGFzbyBkZWwgcHJvY2VzbycsXG4gICAgICAgICdFbCBmbHVqbyB2YSBkZXNkZSBJTklDSU8gaGFzdGEgRklOJ1xuICAgICAgXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgaGllcmFyY2h5IHZpc3VhbGl6YXRpb25cbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZUhpZXJhcmNoeShjb250ZW50OiBzdHJpbmcpOiBWaXN1YWxSZXByZXNlbnRhdGlvbiB7XG4gICAgY29uc3QgaGllcmFyY2h5SXRlbXMgPSB0aGlzLmV4dHJhY3RIaWVyYXJjaHkoY29udGVudClcbiAgICBjb25zdCByb290ID0gaGllcmFyY2h5SXRlbXNbMF0gfHwgJ0VsZW1lbnRvIFByaW5jaXBhbCdcbiAgICBjb25zdCBjaGlsZHJlbiA9IGhpZXJhcmNoeUl0ZW1zLnNsaWNlKDEsIDQpXG4gICAgY29uc3QgZ3JhbmRjaGlsZHJlbiA9IGhpZXJhcmNoeUl0ZW1zLnNsaWNlKDQsIDgpXG5cbiAgICBsZXQgYXNjaWkgPSBgXG4gICAgICAgICAgICAgICAgICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICAgICAgICAgICAgICAgICAgICDilIIgJHt0aGlzLmNlbnRlclRleHQocm9vdCwgMTYpfSDilIJcbiAgICAgICAgICAgICAgICAgICAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSs4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilIJcbiAgICAgICAgICAgICAgICAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pS84pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQYFxuXG4gICAgY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBzcGFjaW5nID0gaW5kZXggPT09IDAgPyAnICAgICAnIDogaW5kZXggPT09IDEgPyAnICAgICAgICAgICAnIDogJyAgICAgICAgICAgICAgICAgJ1xuICAgICAgYXNjaWkgKz0gYFxuICAgICAgICDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJAke3NwYWNpbmd94pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQXG4gICAgICAgIOKUgiAke3RoaXMuY2VudGVyVGV4dChjaGlsZCwgMTEpfSDilIIke3NwYWNpbmd94pSCICAgICAgICAgICAgIOKUglxuICAgICAgICDilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgke3NwYWNpbmd94pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYYFxuICAgIH0pXG5cbiAgICBpZiAoZ3JhbmRjaGlsZHJlbi5sZW5ndGggPiAwKSB7XG4gICAgICBhc2NpaSArPSBgXG4gICAgICAgICAgICAgIOKUgiAgICAgICAgICAgICAgICAgICAgIOKUglxuICAgICAgICDilIzilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilJAgICAgICAgICDilIzilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilJBgXG4gICAgICBncmFuZGNoaWxkcmVuLnNsaWNlKDAsIDIpLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgIGFzY2lpICs9IGBcbiAgICAgICAg4pSCICR7dGhpcy5jZW50ZXJUZXh0KGl0ZW0sIDkpfSDilIIgICAgICAgICDilIIgICAgICAgICAgIOKUgmBcbiAgICAgIH0pXG4gICAgICBhc2NpaSArPSBgXG4gICAgICAgIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmCAgICAgICAgIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmGBcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogVmlzdWFsVHlwZS5ISUVSQVJDSFksXG4gICAgICBhc2NpaTogYXNjaWksXG4gICAgICBkZXNjcmlwdGlvbjogYEplcmFycXXDrWEgcXVlIG11ZXN0cmEgbGEgZXN0cnVjdHVyYSBkZSAke3Jvb3R9IGNvbiAke2NoaWxkcmVuLmxlbmd0aH0gbml2ZWxlc2AsXG4gICAgICBlbGVtZW50czogaGllcmFyY2h5SXRlbXMubWFwKChpdGVtLCBpbmRleCkgPT4gKHtcbiAgICAgICAgaWQ6IGBoaWVyYXJjaHlfJHtpbmRleH1gLFxuICAgICAgICB0eXBlOiBWaXN1YWxUeXBlLkhJRVJBUkNIWSxcbiAgICAgICAgdGl0bGU6IGl0ZW0sXG4gICAgICAgIGNvbnRlbnQ6IGBFbGVtZW50byBkZSBqZXJhcnF1w61hOiAke2l0ZW19YCxcbiAgICAgICAgY29ubmVjdGlvbnM6IGluZGV4ID09PSAwID8gY2hpbGRyZW4gOiBbXVxuICAgICAgfSkpLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBbXG4gICAgICAgICdFbCBlbGVtZW50byBwcmluY2lwYWwgZXN0w6EgZW4gbGEgcGFydGUgc3VwZXJpb3InLFxuICAgICAgICAnTG9zIGVsZW1lbnRvcyBzZWN1bmRhcmlvcyBzZSBjb25lY3RhbiBoYWNpYSBhYmFqbycsXG4gICAgICAgICdDYWRhIG5pdmVsIHJlcHJlc2VudGEgdW5hIHN1YmRpdmlzacOzbidcbiAgICAgIF1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIHRpbWVsaW5lIHZpc3VhbGl6YXRpb25cbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZVRpbWVsaW5lKGNvbnRlbnQ6IHN0cmluZyk6IFZpc3VhbFJlcHJlc2VudGF0aW9uIHtcbiAgICBjb25zdCB0aW1lRXZlbnRzID0gdGhpcy5leHRyYWN0VGltZWxpbmVFdmVudHMoY29udGVudClcbiAgICBcbiAgICBsZXQgYXNjaWkgPSBg4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSB4pSBXFxuYFxuICAgIFxuICAgIHRpbWVFdmVudHMuZm9yRWFjaCgoZXZlbnQsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBldmVudFRleHQgPSB0aGlzLnRydW5jYXRlVGV4dChldmVudC5ldmVudCwgMjApXG4gICAgICBjb25zdCB0aW1lVGV4dCA9IGV2ZW50LnRpbWUgfHwgYFQke2luZGV4ICsgMX1gXG4gICAgICBcbiAgICAgIGlmIChpbmRleCAlIDIgPT09IDApIHtcbiAgICAgICAgLy8gRXZlbnQgYWJvdmUgdGltZWxpbmVcbiAgICAgICAgYXNjaWkgKz0gYOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxcbuKUgiAke3RoaXMuY2VudGVyVGV4dChldmVudFRleHQsIDE5KX0g4pSCXFxu4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSs4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXFxuICAgICAgICAgICDilIJcXG5gXG4gICAgICAgIGFzY2lpICs9IGDilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilL/ilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIHilIFcXG5gXG4gICAgICAgIGFzY2lpICs9IGAgICAgICAgICAgICR7dGltZVRleHR9XFxuXFxuYFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRXZlbnQgYmVsb3cgdGltZWxpbmVcbiAgICAgICAgYXNjaWkgKz0gYCAgICAgICAgICAg4pSCXFxuICAgICAgICAgICDilLxcXG7ilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilLTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcXG7ilIIgJHt0aGlzLmNlbnRlclRleHQoZXZlbnRUZXh0LCAxOSl9IOKUglxcbuKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmFxcbmBcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFZpc3VhbFR5cGUuVElNRUxJTkUsXG4gICAgICBhc2NpaTogYXNjaWksXG4gICAgICBkZXNjcmlwdGlvbjogYEzDrW5lYSBkZSB0aWVtcG8gY29uICR7dGltZUV2ZW50cy5sZW5ndGh9IGV2ZW50b3MgY3Jvbm9sw7NnaWNvc2AsXG4gICAgICBlbGVtZW50czogdGltZUV2ZW50cy5tYXAoKGV2ZW50LCBpbmRleCkgPT4gKHtcbiAgICAgICAgaWQ6IGBldmVudF8ke2luZGV4fWAsXG4gICAgICAgIHR5cGU6IFZpc3VhbFR5cGUuVElNRUxJTkUsXG4gICAgICAgIHRpdGxlOiBldmVudC50aW1lIHx8IGBFdmVudG8gJHtpbmRleCArIDF9YCxcbiAgICAgICAgY29udGVudDogZXZlbnQuZXZlbnQsXG4gICAgICAgIGNvbm5lY3Rpb25zOiBbXVxuICAgICAgfSkpLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBbXG4gICAgICAgICdMb3MgZXZlbnRvcyBzZSBtdWVzdHJhbiBlbiBvcmRlbiBjcm9ub2zDs2dpY28nLFxuICAgICAgICAnTGEgbMOtbmVhIGhvcml6b250YWwgcmVwcmVzZW50YSBlbCB0aWVtcG8nLFxuICAgICAgICAnTG9zIGV2ZW50b3MgYWx0ZXJub3MgYXBhcmVjZW4gYXJyaWJhIHkgYWJham8gZGUgbGEgbMOtbmVhJ1xuICAgICAgXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgZm9ybXVsYSB2aXN1YWxpemF0aW9uXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGVGb3JtdWxhVmlzdWFsaXphdGlvbihjb250ZW50OiBzdHJpbmcpOiBWaXN1YWxSZXByZXNlbnRhdGlvbiB7XG4gICAgY29uc3QgZm9ybXVsYSA9IHRoaXMuZXh0cmFjdEZvcm11bGEoY29udGVudClcbiAgICBjb25zdCB2YXJpYWJsZXMgPSB0aGlzLmV4dHJhY3RWYXJpYWJsZXMoY29udGVudClcbiAgICBcbiAgICBsZXQgYXNjaWkgPSBgXG7ilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZdcbuKVkSAgICAgICAgIEbDk1JNVUxBIE1BVEVNw4FUSUNBICAgICAgICDilZFcbuKVoOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVo1xu4pWRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZFcbuKVkSAgICAgICAgICR7dGhpcy5jZW50ZXJUZXh0KGZvcm11bGEsIDE5KX0gICAgICAgICDilZFcbuKVkSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pWRXG7ilaDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilaNcbuKVkSAgICAgICAgICAgVkFSSUFCTEVTOiAgICAgICAgICAgICAg4pWRYFxuXG4gICAgdmFyaWFibGVzLmZvckVhY2godmFyaWFibGUgPT4ge1xuICAgICAgYXNjaWkgKz0gYFxu4pWRICAke3ZhcmlhYmxlLnN5bWJvbH0gPSAke3RoaXMudHJ1bmNhdGVUZXh0KHZhcmlhYmxlLmRlc2NyaXB0aW9uLCAyMCl9ICAgIOKVkWBcbiAgICB9KVxuXG4gICAgYXNjaWkgKz0gYFxu4pWRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZFcbuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnVxuXG4gICAgUmVwcmVzZW50YWNpw7NuIHZpc3VhbDpcbiAgICBcbiAgICAgICAgICR7Zm9ybXVsYX1cbiAgICAgICAgIOKGmSAgICAg4oaYXG4gICAgVmFyaWFibGUgICBSZXN1bHRhZG9cbiAgICAgICR7dmFyaWFibGVzWzBdPy5zeW1ib2wgfHwgJ3gnfSAgICAgICAgIHlgXG5cbiAgICByZXR1cm4ge1xuICAgICAgdHlwZTogVmlzdWFsVHlwZS5GT1JNVUxBX1ZJU1VBTElaQVRJT04sXG4gICAgICBhc2NpaTogYXNjaWksXG4gICAgICBkZXNjcmlwdGlvbjogYFZpc3VhbGl6YWNpw7NuIGRlIGxhIGbDs3JtdWxhICR7Zm9ybXVsYX0gY29uICR7dmFyaWFibGVzLmxlbmd0aH0gdmFyaWFibGVzYCxcbiAgICAgIGVsZW1lbnRzOiBbe1xuICAgICAgICBpZDogJ2Zvcm11bGFfbWFpbicsXG4gICAgICAgIHR5cGU6IFZpc3VhbFR5cGUuRk9STVVMQV9WSVNVQUxJWkFUSU9OLFxuICAgICAgICB0aXRsZTogJ0bDs3JtdWxhIFByaW5jaXBhbCcsXG4gICAgICAgIGNvbnRlbnQ6IGZvcm11bGEsXG4gICAgICAgIGNvbm5lY3Rpb25zOiB2YXJpYWJsZXMubWFwKChfLCBpbmRleCkgPT4gYHZhcl8ke2luZGV4fWApXG4gICAgICB9XS5jb25jYXQodmFyaWFibGVzLm1hcCgodmFyaWFibGUsIGluZGV4KSA9PiAoe1xuICAgICAgICBpZDogYHZhcl8ke2luZGV4fWAsXG4gICAgICAgIHR5cGU6IFZpc3VhbFR5cGUuRk9STVVMQV9WSVNVQUxJWkFUSU9OLFxuICAgICAgICB0aXRsZTogdmFyaWFibGUuc3ltYm9sLFxuICAgICAgICBjb250ZW50OiB2YXJpYWJsZS5kZXNjcmlwdGlvbixcbiAgICAgICAgY29ubmVjdGlvbnM6IFtdXG4gICAgICB9KSkpLFxuICAgICAgaW5zdHJ1Y3Rpb25zOiBbXG4gICAgICAgICdMYSBmw7NybXVsYSBwcmluY2lwYWwgc2UgbXVlc3RyYSBlbiBlbCBjZW50cm8nLFxuICAgICAgICAnTGFzIHZhcmlhYmxlcyBzZSBkZWZpbmVuIGVuIGxhIHRhYmxhIGluZmVyaW9yJyxcbiAgICAgICAgJ1N1c3RpdHV5ZSBsb3MgdmFsb3JlcyBwYXJhIHJlc29sdmVyJ1xuICAgICAgXVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZW5lcmF0ZXMgY2hlbWljYWwgc3RydWN0dXJlIHZpc3VhbGl6YXRpb25cbiAgICovXG4gIHN0YXRpYyBnZW5lcmF0ZUNoZW1pY2FsU3RydWN0dXJlKGNvbnRlbnQ6IHN0cmluZyk6IFZpc3VhbFJlcHJlc2VudGF0aW9uIHtcbiAgICBjb25zdCBtb2xlY3VsZSA9IHRoaXMuZXh0cmFjdE1vbGVjdWxlKGNvbnRlbnQpXG4gICAgY29uc3QgYXRvbXMgPSB0aGlzLmV4dHJhY3RBdG9tcyhjb250ZW50KVxuICAgIFxuICAgIGxldCBhc2NpaSA9ICcnXG5cbiAgICAvLyBTaW1wbGUgbW9sZWN1bGFyIHJlcHJlc2VudGF0aW9uc1xuICAgIGlmIChtb2xlY3VsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdoMm8nKSB8fCBtb2xlY3VsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdhZ3VhJykpIHtcbiAgICAgIGFzY2lpID0gYFxuICAgICAgICBFc3RydWN0dXJhIGRlbCBBZ3VhIChI4oKCTylcbiAgICAgICAgXG4gICAgICAgICAgICBIXG4gICAgICAgICAgICDilIJcbiAgICAgICAgSOKUgE/ilIBIICAgIG8gICAgSOKUgE/ilIBIXG4gICAgICAgICAgICBcbiAgICAgICAgUmVwcmVzZW50YWNpw7NuIGFuZ3VsYXI6XG4gICAgICAgIFxuICAgICAgICAgICAgSFxuICAgICAgICAgICAgIFxcXFxcbiAgICAgICAgICAgICAgT1xuICAgICAgICAgICAgIC9cbiAgICAgICAgICAgIEhcbiAgICAgICAgICAgICAgXG4gICAgICAgIMOBbmd1bG8gSC1PLUg6IDEwNC41wrBgXG4gICAgfSBlbHNlIGlmIChtb2xlY3VsZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdjbzInKSkge1xuICAgICAgYXNjaWkgPSBgXG4gICAgICAgIEVzdHJ1Y3R1cmEgZGVsIENP4oKCXG4gICAgICAgIFxuICAgICAgICBP4pWQQ+KVkE9cbiAgICAgICAgXG4gICAgICAgIExpbmVhbCwgMTgwwrBcbiAgICAgICAgXG4gICAgICAgIEVubGFjZXMgZG9ibGVzOlxuICAgICAgICBPIOKVkOKVkCBDIOKVkOKVkCBPYFxuICAgIH0gZWxzZSBpZiAobW9sZWN1bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY2g0JykgfHwgbW9sZWN1bGUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnbWV0YW5vJykpIHtcbiAgICAgIGFzY2lpID0gYFxuICAgICAgICBFc3RydWN0dXJhIGRlbCBNZXRhbm8gKENI4oKEKVxuICAgICAgICBcbiAgICAgICAgICAgSFxuICAgICAgICAgICDilIJcbiAgICAgICAgSOKUgEPilIBIXG4gICAgICAgICAgIOKUglxuICAgICAgICAgICBIXG4gICAgICAgICAgIFxuICAgICAgICBUZXRyYcOpZHJpY2FcbiAgICAgICAgw4FuZ3VsbyBILUMtSDogMTA5LjXCsGBcbiAgICB9IGVsc2Uge1xuICAgICAgYXNjaWkgPSBgXG4gICAgICAgIEVzdHJ1Y3R1cmEgTW9sZWN1bGFyXG4gICAgICAgIFxuICAgICAgICAke21vbGVjdWxlfVxuICAgICAgICBcbiAgICAgICAgw4F0b21vcyBpZGVudGlmaWNhZG9zOlxuICAgICAgICAke2F0b21zLm1hcChhdG9tID0+IGDigKIgJHthdG9tfWApLmpvaW4oJ1xcbiAgICAgICAgJyl9XG4gICAgICAgIFxuICAgICAgICBSZXByZXNlbnRhY2nDs24gZXNxdWVtw6F0aWNhOlxuICAgICAgICBcbiAgICAgICAgW8OBdG9tbzFd4pSAW8OBdG9tbzJd4pSAW8OBdG9tbzNdYFxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBWaXN1YWxUeXBlLkNIRU1JQ0FMX1NUUlVDVFVSRSxcbiAgICAgIGFzY2lpOiBhc2NpaSxcbiAgICAgIGRlc2NyaXB0aW9uOiBgRXN0cnVjdHVyYSBxdcOtbWljYSBkZSAke21vbGVjdWxlfSBtb3N0cmFuZG8gJHthdG9tcy5sZW5ndGh9IHRpcG9zIGRlIMOhdG9tb3NgLFxuICAgICAgZWxlbWVudHM6IFt7XG4gICAgICAgIGlkOiAnbW9sZWN1bGVfbWFpbicsXG4gICAgICAgIHR5cGU6IFZpc3VhbFR5cGUuQ0hFTUlDQUxfU1RSVUNUVVJFLFxuICAgICAgICB0aXRsZTogbW9sZWN1bGUsXG4gICAgICAgIGNvbnRlbnQ6IGBNb2zDqWN1bGE6ICR7bW9sZWN1bGV9YCxcbiAgICAgICAgY29ubmVjdGlvbnM6IGF0b21zLm1hcCgoXywgaW5kZXgpID0+IGBhdG9tXyR7aW5kZXh9YClcbiAgICAgIH1dLmNvbmNhdChhdG9tcy5tYXAoKGF0b20sIGluZGV4KSA9PiAoe1xuICAgICAgICBpZDogYGF0b21fJHtpbmRleH1gLFxuICAgICAgICB0eXBlOiBWaXN1YWxUeXBlLkNIRU1JQ0FMX1NUUlVDVFVSRSxcbiAgICAgICAgdGl0bGU6IGF0b20sXG4gICAgICAgIGNvbnRlbnQ6IGDDgXRvbW86ICR7YXRvbX1gLFxuICAgICAgICBjb25uZWN0aW9uczogW11cbiAgICAgIH0pKSksXG4gICAgICBpbnN0cnVjdGlvbnM6IFtcbiAgICAgICAgJ0xvcyDDoXRvbW9zIHNlIHJlcHJlc2VudGFuIGNvbiBzdXMgc8OtbWJvbG9zJyxcbiAgICAgICAgJ0xhcyBsw61uZWFzIHJlcHJlc2VudGFuIGVubGFjZXMgcXXDrW1pY29zJyxcbiAgICAgICAgJ0xvcyDDoW5ndWxvcyBtdWVzdHJhbiBsYSBnZW9tZXRyw61hIG1vbGVjdWxhcidcbiAgICAgIF1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIHByb2Nlc3MgZmxvdyB2aXN1YWxpemF0aW9uXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGVQcm9jZXNzRmxvdyhjb250ZW50OiBzdHJpbmcpOiBWaXN1YWxSZXByZXNlbnRhdGlvbiB7XG4gICAgY29uc3QgcHJvY2Vzc2VzID0gdGhpcy5leHRyYWN0UHJvY2Vzc2VzKGNvbnRlbnQpXG4gICAgXG4gICAgbGV0IGFzY2lpID0gYFxuICAgIEZMVUpPIERFTCBQUk9DRVNPXG4gICAgXG4gICAg4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQYFxuXG4gICAgcHJvY2Vzc2VzLmZvckVhY2goKHByb2Nlc3MsIGluZGV4KSA9PiB7XG4gICAgICBjb25zdCBwcm9jZXNzVGV4dCA9IHRoaXMudHJ1bmNhdGVUZXh0KHByb2Nlc3MsIDE1KVxuICAgICAgaWYgKGluZGV4ID09PSAwKSB7XG4gICAgICAgIGFzY2lpICs9IGBcbiAgICDilIIgICAke3RoaXMuY2VudGVyVGV4dChwcm9jZXNzVGV4dCwgOSl9ICAg4pSCXG4gICAg4pSU4pSA4pSA4pSA4pSA4pSA4pSs4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYXG4gICAgICAgICAg4pSCXG4gICAgICAgICAg4pa8YFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXNjaWkgKz0gYFxuICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICAgIOKUgiAgICR7dGhpcy5jZW50ZXJUZXh0KHByb2Nlc3NUZXh0LCA5KX0gICDilIJcbiAgICDilJTilIDilIDilIDilIDilIDilKzilIDilIDilIDilIDilIDilIDilIDilJhcbiAgICAgICAgICDilIJcbiAgICAgICAgICDilrxgXG4gICAgICB9XG4gICAgfSlcblxuICAgIGFzY2lpICs9IGBcbiAgICDilIzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJBcbiAgICDilIIgICBGSU5BTCAgICAg4pSCXG4gICAg4pSU4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSYYFxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFZpc3VhbFR5cGUuUFJPQ0VTU19GTE9XLFxuICAgICAgYXNjaWk6IGFzY2lpLFxuICAgICAgZGVzY3JpcHRpb246IGBGbHVqbyBkZSBwcm9jZXNvIGNvbiAke3Byb2Nlc3Nlcy5sZW5ndGh9IGV0YXBhcyBzZWN1ZW5jaWFsZXNgLFxuICAgICAgZWxlbWVudHM6IHByb2Nlc3Nlcy5tYXAoKHByb2Nlc3MsIGluZGV4KSA9PiAoe1xuICAgICAgICBpZDogYHByb2Nlc3NfJHtpbmRleH1gLFxuICAgICAgICB0eXBlOiBWaXN1YWxUeXBlLlBST0NFU1NfRkxPVyxcbiAgICAgICAgdGl0bGU6IGBQcm9jZXNvICR7aW5kZXggKyAxfWAsXG4gICAgICAgIGNvbnRlbnQ6IHByb2Nlc3MsXG4gICAgICAgIGNvbm5lY3Rpb25zOiBpbmRleCA8IHByb2Nlc3Nlcy5sZW5ndGggLSAxID8gW2Bwcm9jZXNzXyR7aW5kZXggKyAxfWBdIDogW11cbiAgICAgIH0pKSxcbiAgICAgIGluc3RydWN0aW9uczogW1xuICAgICAgICAnU2lndWUgZWwgZmx1am8gZGUgYXJyaWJhIGhhY2lhIGFiYWpvJyxcbiAgICAgICAgJ0NhZGEgY2FqYSByZXByZXNlbnRhIHVuYSBldGFwYSBkZWwgcHJvY2VzbycsXG4gICAgICAgICdMYXMgZmxlY2hhcyBpbmRpY2FuIGxhIHNlY3VlbmNpYSdcbiAgICAgIF1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIGdlbmVyaWMgZGlhZ3JhbVxuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlR2VuZXJpY0RpYWdyYW0oY29udGVudDogc3RyaW5nKTogVmlzdWFsUmVwcmVzZW50YXRpb24ge1xuICAgIGNvbnN0IGtleVBvaW50cyA9IHRoaXMuZXh0cmFjdEtleVBvaW50cyhjb250ZW50LCA0KVxuICAgIFxuICAgIGxldCBhc2NpaSA9IGBcbiAgICDila3ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila5cbiAgICDilIIgICAgICAgIERJQUdSQU1BIEdFTkVSQUwgICAgICAgICDilIJcbiAgICDilbDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilKzilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila9cbiAgICAgICAgICAgICAgICAgIOKUgmBcblxuICAgIGtleVBvaW50cy5mb3JFYWNoKChwb2ludCwgaW5kZXgpID0+IHtcbiAgICAgIGNvbnN0IHBvaW50VGV4dCA9IHRoaXMudHJ1bmNhdGVUZXh0KHBvaW50LCAyMClcbiAgICAgIGFzY2lpICs9IGBcbiAgICAgICAgICAgICAgICAgIOKWvFxuICAgIOKUjOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUkFxuICAgIOKUgiAke2luZGV4ICsgMX0uICR7dGhpcy5sZWZ0QWxpZ24ocG9pbnRUZXh0LCAyMyl9IOKUglxuICAgIOKUlOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUmGBcbiAgICB9KVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFZpc3VhbFR5cGUuRElBR1JBTSxcbiAgICAgIGFzY2lpOiBhc2NpaSxcbiAgICAgIGRlc2NyaXB0aW9uOiBgRGlhZ3JhbWEgZ2VuZXJhbCBjb24gJHtrZXlQb2ludHMubGVuZ3RofSBlbGVtZW50b3MgcHJpbmNpcGFsZXNgLFxuICAgICAgZWxlbWVudHM6IGtleVBvaW50cy5tYXAoKHBvaW50LCBpbmRleCkgPT4gKHtcbiAgICAgICAgaWQ6IGBwb2ludF8ke2luZGV4fWAsXG4gICAgICAgIHR5cGU6IFZpc3VhbFR5cGUuRElBR1JBTSxcbiAgICAgICAgdGl0bGU6IGBQdW50byAke2luZGV4ICsgMX1gLFxuICAgICAgICBjb250ZW50OiBwb2ludCxcbiAgICAgICAgY29ubmVjdGlvbnM6IFtdXG4gICAgICB9KSksXG4gICAgICBpbnN0cnVjdGlvbnM6IFtcbiAgICAgICAgJ0NhZGEgZWxlbWVudG8gc2UgcHJlc2VudGEgZGUgZm9ybWEgc2VjdWVuY2lhbCcsXG4gICAgICAgICdMb3MgbsO6bWVyb3MgaW5kaWNhbiBlbCBvcmRlbiBkZSBpbXBvcnRhbmNpYScsXG4gICAgICAgICdSZXZpc2EgY2FkYSBwdW50byBwYXJhIGNvbXByZW5zacOzbiBjb21wbGV0YSdcbiAgICAgIF1cbiAgICB9XG4gIH1cblxuICAvLyA9PT09PSBVVElMSVRZIEZVTkNUSU9OUyA9PT09PVxuXG4gIC8qKlxuICAgKiBFeHRyYWN0cyBtYWluIGNvbmNlcHRzIGZyb20gY29udGVudFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdENvbmNlcHRzKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBjb250ZW50LnNwbGl0KC9bLiE/XSsvKVxuICAgIGNvbnN0IGNvbmNlcHRzOiBzdHJpbmdbXSA9IFtdXG4gICAgXG4gICAgZm9yIChjb25zdCBzZW50ZW5jZSBvZiBzZW50ZW5jZXMpIHtcbiAgICAgIGNvbnN0IHdvcmRzID0gc2VudGVuY2UudHJpbSgpLnNwbGl0KCcgJylcbiAgICAgIGNvbnN0IGltcG9ydGFudFdvcmRzID0gd29yZHMuZmlsdGVyKHdvcmQgPT4gXG4gICAgICAgIHdvcmQubGVuZ3RoID4gNCAmJiBcbiAgICAgICAgIVsnZXN0ZScsICdlc3RhJywgJ2VzdG9zJywgJ2VzdGFzJywgJ2N1YW5kbycsICdkb25kZScsICdwb3JxdWUnXS5pbmNsdWRlcyh3b3JkLnRvTG93ZXJDYXNlKCkpXG4gICAgICApXG4gICAgICBcbiAgICAgIGlmIChpbXBvcnRhbnRXb3Jkcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbmNlcHRzLnB1c2goaW1wb3J0YW50V29yZHNbMF0pXG4gICAgICB9XG4gICAgICBcbiAgICAgIGlmIChjb25jZXB0cy5sZW5ndGggPj0gNSkgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGNvbmNlcHRzLmxlbmd0aCA+IDAgPyBjb25jZXB0cyA6IFsnQ29uY2VwdG8gUHJpbmNpcGFsJ11cbiAgfVxuXG4gIC8qKlxuICAgKiBFeHRyYWN0cyBzdGVwcyBmcm9tIGNvbnRlbnRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RTdGVwcyhjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgLy8gTG9vayBmb3IgbnVtYmVyZWQgc3RlcHMgb3Igc2VxdWVudGlhbCBpbmRpY2F0b3JzXG4gICAgY29uc3Qgc3RlcFBhdHRlcm5zID0gW1xuICAgICAgL1xcZCtbLildXFxzKihbXi4hP10rKS9nLFxuICAgICAgL3Bhc28gXFxkKzo/XFxzKihbXi4hP10rKS9naSxcbiAgICAgIC8ocHJpbWVyb3xzZWd1bmRvfHRlcmNlcm98bHVlZ298ZGVzcHXDqXN8ZmluYWxtZW50ZSlbLDpdP1xccyooW14uIT9dKykvZ2lcbiAgICBdXG4gICAgXG4gICAgY29uc3Qgc3RlcHM6IHN0cmluZ1tdID0gW11cbiAgICBcbiAgICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygc3RlcFBhdHRlcm5zKSB7XG4gICAgICBsZXQgbWF0Y2hcbiAgICAgIHdoaWxlICgobWF0Y2ggPSBwYXR0ZXJuLmV4ZWMoY29udGVudCkpICE9PSBudWxsICYmIHN0ZXBzLmxlbmd0aCA8IDYpIHtcbiAgICAgICAgY29uc3Qgc3RlcCA9IG1hdGNoWzFdIHx8IG1hdGNoWzJdXG4gICAgICAgIGlmIChzdGVwICYmIHN0ZXAudHJpbSgpLmxlbmd0aCA+IDUpIHtcbiAgICAgICAgICBzdGVwcy5wdXNoKHN0ZXAudHJpbSgpKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGlmIChzdGVwcy5sZW5ndGggPT09IDApIHtcbiAgICAgIC8vIEZhbGxiYWNrOiBzcGxpdCBieSBzZW50ZW5jZXNcbiAgICAgIGNvbnN0IHNlbnRlbmNlcyA9IGNvbnRlbnQuc3BsaXQoL1suIT9dKy8pXG4gICAgICBzdGVwcy5wdXNoKC4uLnNlbnRlbmNlcy5zbGljZSgwLCA0KS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMCkpXG4gICAgfVxuICAgIFxuICAgIHJldHVybiBzdGVwcy5zbGljZSgwLCA1KVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3RzIGhpZXJhcmNoeSBpdGVtc1xuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdEhpZXJhcmNoeShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgY29uc3QgaGllcmFyY2h5V29yZHMgPSBbJ3ByaW5jaXBhbCcsICdzZWN1bmRhcmlvJywgJ3RpcG8nLCAnY2F0ZWdvcsOtYScsICdjbGFzZScsICdncnVwbyddXG4gICAgY29uc3QgaXRlbXM6IHN0cmluZ1tdID0gW11cbiAgICBjb25zdCBzZW50ZW5jZXMgPSBjb250ZW50LnNwbGl0KC9bLiE/XSsvKVxuICAgIFxuICAgIGZvciAoY29uc3Qgc2VudGVuY2Ugb2Ygc2VudGVuY2VzKSB7XG4gICAgICBmb3IgKGNvbnN0IHdvcmQgb2YgaGllcmFyY2h5V29yZHMpIHtcbiAgICAgICAgaWYgKHNlbnRlbmNlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMod29yZCkpIHtcbiAgICAgICAgICBjb25zdCBjbGVhblNlbnRlbmNlID0gc2VudGVuY2UucmVwbGFjZSgvXlxccypcXGQrWy4pXVxccyovLCAnJykudHJpbSgpXG4gICAgICAgICAgaWYgKGNsZWFuU2VudGVuY2UubGVuZ3RoID4gNSkge1xuICAgICAgICAgICAgaXRlbXMucHVzaChjbGVhblNlbnRlbmNlKVxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChpdGVtcy5sZW5ndGggPj0gNikgYnJlYWtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGl0ZW1zLmxlbmd0aCA+IDAgPyBpdGVtcyA6IFsnRWxlbWVudG8gUHJpbmNpcGFsJywgJ1N1YmVsZW1lbnRvIDEnLCAnU3ViZWxlbWVudG8gMiddXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgdGltZWxpbmUgZXZlbnRzXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0VGltZWxpbmVFdmVudHMoY29udGVudDogc3RyaW5nKTogQXJyYXk8e3RpbWU6IHN0cmluZywgZXZlbnQ6IHN0cmluZ30+IHtcbiAgICBjb25zdCB0aW1lUGF0dGVybiA9IC8oXFxkezR9fFxcZHsxLDJ9OlxcZHsyfXxzaWdsbyBcXHcrfGVyYSBcXHcrKS9naVxuICAgIGNvbnN0IGV2ZW50czogQXJyYXk8e3RpbWU6IHN0cmluZywgZXZlbnQ6IHN0cmluZ30+ID0gW11cbiAgICBjb25zdCBzZW50ZW5jZXMgPSBjb250ZW50LnNwbGl0KC9bLiE/XSsvKVxuICAgIFxuICAgIGZvciAoY29uc3Qgc2VudGVuY2Ugb2Ygc2VudGVuY2VzKSB7XG4gICAgICBjb25zdCB0aW1lTWF0Y2ggPSBzZW50ZW5jZS5tYXRjaCh0aW1lUGF0dGVybilcbiAgICAgIGlmICh0aW1lTWF0Y2gpIHtcbiAgICAgICAgZXZlbnRzLnB1c2goe1xuICAgICAgICAgIHRpbWU6IHRpbWVNYXRjaFswXSxcbiAgICAgICAgICBldmVudDogc2VudGVuY2UucmVwbGFjZSh0aW1lUGF0dGVybiwgJycpLnRyaW0oKVxuICAgICAgICB9KVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBpZiAoZXZlbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgLy8gRmFsbGJhY2sgdGltZWxpbmVcbiAgICAgIGNvbnN0IGtleUV2ZW50cyA9IHNlbnRlbmNlcy5zbGljZSgwLCAzKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICAgIGtleUV2ZW50cy5mb3JFYWNoKChldmVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgZXZlbnRzLnB1c2goe1xuICAgICAgICAgIHRpbWU6IGBUJHtpbmRleCArIDF9YCxcbiAgICAgICAgICBldmVudDogZXZlbnQudHJpbSgpXG4gICAgICAgIH0pXG4gICAgICB9KVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZXZlbnRzLnNsaWNlKDAsIDUpXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgZm9ybXVsYSBmcm9tIGNvbnRlbnRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RGb3JtdWxhKGNvbnRlbnQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgLy8gTG9vayBmb3IgbWF0aGVtYXRpY2FsIGV4cHJlc3Npb25zXG4gICAgY29uc3QgZm9ybXVsYVBhdHRlcm5zID0gW1xuICAgICAgLyhbYS16QS1aXVxccypbPV1cXHMqW14uIT9dKykvLFxuICAgICAgLyhbYS16QS1aXStcXHMqXFwoXFxzKlthLXpBLVosXFxzXStcXHMqXFwpKS8sXG4gICAgICAvKGZcXChbeC16XVxcKVxccyo9XFxzKlteLiE/XSspL2ksXG4gICAgICAvKFt4eV1cXHMqPVxccypbXi4hP10rKS9cbiAgICBdXG4gICAgXG4gICAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGZvcm11bGFQYXR0ZXJucykge1xuICAgICAgY29uc3QgbWF0Y2ggPSBjb250ZW50Lm1hdGNoKHBhdHRlcm4pXG4gICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoWzFdLnRyaW0oKVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBGYWxsYmFja1xuICAgIGlmIChjb250ZW50LmluY2x1ZGVzKCc9JykpIHtcbiAgICAgIGNvbnN0IHBhcnRzID0gY29udGVudC5zcGxpdCgnPScpXG4gICAgICBpZiAocGFydHMubGVuZ3RoID49IDIpIHtcbiAgICAgICAgcmV0dXJuIGAke3BhcnRzWzBdLnRyaW0oKX0gPSAke3BhcnRzWzFdLnNwbGl0KC9bLiE/XS8pWzBdLnRyaW0oKX1gXG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiAneSA9IGYoeCknXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgdmFyaWFibGVzIGZyb20gY29udGVudFxuICAgKi9cbiAgcHJpdmF0ZSBzdGF0aWMgZXh0cmFjdFZhcmlhYmxlcyhjb250ZW50OiBzdHJpbmcpOiBBcnJheTx7c3ltYm9sOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmd9PiB7XG4gICAgY29uc3QgdmFyaWFibGVzOiBBcnJheTx7c3ltYm9sOiBzdHJpbmcsIGRlc2NyaXB0aW9uOiBzdHJpbmd9PiA9IFtdXG4gICAgXG4gICAgLy8gTG9vayBmb3IgdmFyaWFibGUgZGVmaW5pdGlvbnMgbGlrZSBcImRvbmRlIHggZXMuLi5cIlxuICAgIGNvbnN0IHZhclBhdHRlcm4gPSAvKFthLXpBLVpdKVxccytlc1xccysoW14uIT9dKykvZ2lcbiAgICBsZXQgbWF0Y2hcbiAgICBcbiAgICB3aGlsZSAoKG1hdGNoID0gdmFyUGF0dGVybi5leGVjKGNvbnRlbnQpKSAhPT0gbnVsbCAmJiB2YXJpYWJsZXMubGVuZ3RoIDwgNCkge1xuICAgICAgdmFyaWFibGVzLnB1c2goe1xuICAgICAgICBzeW1ib2w6IG1hdGNoWzFdLFxuICAgICAgICBkZXNjcmlwdGlvbjogbWF0Y2hbMl0udHJpbSgpXG4gICAgICB9KVxuICAgIH1cbiAgICBcbiAgICBpZiAodmFyaWFibGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgdmFyaWFibGVzLnB1c2goXG4gICAgICAgIHsgc3ltYm9sOiAneCcsIGRlc2NyaXB0aW9uOiAndmFyaWFibGUgaW5kZXBlbmRpZW50ZScgfSxcbiAgICAgICAgeyBzeW1ib2w6ICd5JywgZGVzY3JpcHRpb246ICd2YXJpYWJsZSBkZXBlbmRpZW50ZScgfVxuICAgICAgKVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdmFyaWFibGVzXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgbW9sZWN1bGUgaW5mb3JtYXRpb25cbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RNb2xlY3VsZShjb250ZW50OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIGNvbnN0IG1vbGVjdWxlUGF0dGVybnMgPSBbXG4gICAgICAvKFtBLVpdW2Etel0/XFxkKikrL2csICAvLyBDaGVtaWNhbCBmb3JtdWxhIHBhdHRlcm5cbiAgICAgIC8oYWd1YXxtZXRhbm98ZGnDs3hpZG98Y2FyYm9ub3xveMOtZ2Vub3xoaWRyw7NnZW5vKS9pXG4gICAgXVxuICAgIFxuICAgIGZvciAoY29uc3QgcGF0dGVybiBvZiBtb2xlY3VsZVBhdHRlcm5zKSB7XG4gICAgICBjb25zdCBtYXRjaCA9IGNvbnRlbnQubWF0Y2gocGF0dGVybilcbiAgICAgIGlmIChtYXRjaCkge1xuICAgICAgICByZXR1cm4gbWF0Y2hbMF1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuICdNb2zDqWN1bGEnXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMgYXRvbXMgZnJvbSBjb250ZW50XG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBleHRyYWN0QXRvbXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IGF0b21TeW1ib2xzID0gY29udGVudC5tYXRjaCgvW0EtWl1bYS16XT8vZykgfHwgW11cbiAgICBjb25zdCB1bmlxdWVBdG9tcyA9IFsuLi5uZXcgU2V0KGF0b21TeW1ib2xzKV1cbiAgICBcbiAgICBpZiAodW5pcXVlQXRvbXMubGVuZ3RoID09PSAwKSB7XG4gICAgICByZXR1cm4gWydDJywgJ0gnLCAnTyddXG4gICAgfVxuICAgIFxuICAgIHJldHVybiB1bmlxdWVBdG9tcy5zbGljZSgwLCA1KVxuICB9XG5cbiAgLyoqXG4gICAqIEV4dHJhY3RzIHByb2Nlc3NlcyBmcm9tIGNvbnRlbnRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RQcm9jZXNzZXMoY29udGVudDogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHByb2Nlc3NlcyA9IHRoaXMuZXh0cmFjdFN0ZXBzKGNvbnRlbnQpXG4gICAgcmV0dXJuIHByb2Nlc3Nlcy5sZW5ndGggPiAwID8gcHJvY2Vzc2VzIDogWydQcm9jZXNvIDEnLCAnUHJvY2VzbyAyJywgJ1Byb2Nlc28gMyddXG4gIH1cblxuICAvKipcbiAgICogRXh0cmFjdHMga2V5IHBvaW50cyBmcm9tIGNvbnRlbnRcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGV4dHJhY3RLZXlQb2ludHMoY29udGVudDogc3RyaW5nLCBsaW1pdDogbnVtYmVyID0gNCk6IHN0cmluZ1tdIHtcbiAgICBjb25zdCBzZW50ZW5jZXMgPSBjb250ZW50LnNwbGl0KC9bLiE/XSsvKVxuICAgIHJldHVybiBzZW50ZW5jZXNcbiAgICAgIC5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAxMClcbiAgICAgIC5zbGljZSgwLCBsaW1pdClcbiAgICAgIC5tYXAocyA9PiBzLnRyaW0oKSlcbiAgfVxuXG4gIC8vID09PT09IFRFWFQgRk9STUFUVElORyBVVElMSVRJRVMgPT09PT1cblxuICAvKipcbiAgICogQ2VudGVycyB0ZXh0IGluIGEgZml4ZWQgd2lkdGhcbiAgICovXG4gIHByaXZhdGUgc3RhdGljIGNlbnRlclRleHQodGV4dDogc3RyaW5nLCB3aWR0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB0cnVuY2F0ZWQgPSB0aGlzLnRydW5jYXRlVGV4dCh0ZXh0LCB3aWR0aClcbiAgICBjb25zdCBwYWRkaW5nID0gTWF0aC5tYXgoMCwgd2lkdGggLSB0cnVuY2F0ZWQubGVuZ3RoKVxuICAgIGNvbnN0IGxlZnRQYWQgPSBNYXRoLmZsb29yKHBhZGRpbmcgLyAyKVxuICAgIGNvbnN0IHJpZ2h0UGFkID0gcGFkZGluZyAtIGxlZnRQYWRcbiAgICByZXR1cm4gJyAnLnJlcGVhdChsZWZ0UGFkKSArIHRydW5jYXRlZCArICcgJy5yZXBlYXQocmlnaHRQYWQpXG4gIH1cblxuICAvKipcbiAgICogTGVmdCBhbGlnbnMgdGV4dCBpbiBhIGZpeGVkIHdpZHRoXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyBsZWZ0QWxpZ24odGV4dDogc3RyaW5nLCB3aWR0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCB0cnVuY2F0ZWQgPSB0aGlzLnRydW5jYXRlVGV4dCh0ZXh0LCB3aWR0aClcbiAgICBjb25zdCBwYWRkaW5nID0gTWF0aC5tYXgoMCwgd2lkdGggLSB0cnVuY2F0ZWQubGVuZ3RoKVxuICAgIHJldHVybiB0cnVuY2F0ZWQgKyAnICcucmVwZWF0KHBhZGRpbmcpXG4gIH1cblxuICAvKipcbiAgICogVHJ1bmNhdGVzIHRleHQgdG8gZml0IHdpZHRoXG4gICAqL1xuICBwcml2YXRlIHN0YXRpYyB0cnVuY2F0ZVRleHQodGV4dDogc3RyaW5nLCBtYXhXaWR0aDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBpZiAodGV4dC5sZW5ndGggPD0gbWF4V2lkdGgpIHtcbiAgICAgIHJldHVybiB0ZXh0XG4gICAgfVxuICAgIHJldHVybiB0ZXh0LnN1YnN0cmluZygwLCBtYXhXaWR0aCAtIDMpICsgJy4uLidcbiAgfVxuXG4gIC8qKlxuICAgKiBNYWluIGVudHJ5IHBvaW50IC0gYW5hbHl6ZXMgY29udGVudCBhbmQgZ2VuZXJhdGVzIGFwcHJvcHJpYXRlIHZpc3VhbFxuICAgKi9cbiAgc3RhdGljIGdlbmVyYXRlT3B0aW1hbFZpc3VhbChjb250ZW50OiBzdHJpbmcsIHN1YmplY3Q/OiBzdHJpbmcpOiBWaXN1YWxSZXByZXNlbnRhdGlvbiB7XG4gICAgY29uc3Qgb3B0aW1hbFR5cGUgPSB0aGlzLmRldGVjdE9wdGltYWxWaXN1YWxUeXBlKGNvbnRlbnQsIHN1YmplY3QpXG4gICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVWaXN1YWwoY29udGVudCwgb3B0aW1hbFR5cGUsIHN1YmplY3QpXG4gIH1cblxuICAvKipcbiAgICogR2VuZXJhdGVzIG11bHRpcGxlIHZpc3VhbCBvcHRpb25zIGZvciB1c2VyIHRvIGNob29zZSBmcm9tXG4gICAqL1xuICBzdGF0aWMgZ2VuZXJhdGVWaXN1YWxPcHRpb25zKGNvbnRlbnQ6IHN0cmluZywgc3ViamVjdD86IHN0cmluZyk6IFZpc3VhbFJlcHJlc2VudGF0aW9uW10ge1xuICAgIGNvbnN0IHByaW1hcnlUeXBlID0gdGhpcy5kZXRlY3RPcHRpbWFsVmlzdWFsVHlwZShjb250ZW50LCBzdWJqZWN0KVxuICAgIGNvbnN0IG9wdGlvbnM6IFZpc3VhbFJlcHJlc2VudGF0aW9uW10gPSBbXG4gICAgICB0aGlzLmdlbmVyYXRlVmlzdWFsKGNvbnRlbnQsIHByaW1hcnlUeXBlLCBzdWJqZWN0KVxuICAgIF1cblxuICAgIC8vIEFkZCBhbHRlcm5hdGl2ZSB2aXN1YWxpemF0aW9uc1xuICAgIGNvbnN0IGFsdGVybmF0aXZlVHlwZXMgPSBbVmlzdWFsVHlwZS5DT05DRVBUX01BUCwgVmlzdWFsVHlwZS5GTE9XQ0hBUlQsIFZpc3VhbFR5cGUuRElBR1JBTV1cbiAgICBcbiAgICBmb3IgKGNvbnN0IHR5cGUgb2YgYWx0ZXJuYXRpdmVUeXBlcykge1xuICAgICAgaWYgKHR5cGUgIT09IHByaW1hcnlUeXBlICYmIG9wdGlvbnMubGVuZ3RoIDwgMykge1xuICAgICAgICBvcHRpb25zLnB1c2godGhpcy5nZW5lcmF0ZVZpc3VhbChjb250ZW50LCB0eXBlLCBzdWJqZWN0KSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gb3B0aW9uc1xuICB9XG59Il0sIm5hbWVzIjpbIlZpc3VhbFR5cGUiLCJWaXN1YWxMZWFybmluZ0VuZ2luZSIsImdlbmVyYXRlVmlzdWFsIiwiY29udGVudCIsInR5cGUiLCJzdWJqZWN0IiwiZ2VuZXJhdGVDb25jZXB0TWFwIiwiZ2VuZXJhdGVGbG93Y2hhcnQiLCJnZW5lcmF0ZUhpZXJhcmNoeSIsImdlbmVyYXRlVGltZWxpbmUiLCJnZW5lcmF0ZUZvcm11bGFWaXN1YWxpemF0aW9uIiwiZ2VuZXJhdGVDaGVtaWNhbFN0cnVjdHVyZSIsImdlbmVyYXRlUHJvY2Vzc0Zsb3ciLCJnZW5lcmF0ZUdlbmVyaWNEaWFncmFtIiwiZGV0ZWN0T3B0aW1hbFZpc3VhbFR5cGUiLCJjb250ZW50TG93ZXIiLCJ0b0xvd2VyQ2FzZSIsInRlc3QiLCJjb25jZXB0cyIsImV4dHJhY3RDb25jZXB0cyIsIm1haW5Db25jZXB0IiwicmVsYXRlZENvbmNlcHRzIiwic2xpY2UiLCJhc2NpaSIsImNlbnRlclRleHQiLCJmb3JFYWNoIiwiY29uY2VwdCIsImluZGV4IiwibGVuZ3RoIiwiZGVzY3JpcHRpb24iLCJlbGVtZW50cyIsIm1hcCIsImlkIiwidGl0bGUiLCJjb25uZWN0aW9ucyIsImluc3RydWN0aW9ucyIsInN0ZXBzIiwiZXh0cmFjdFN0ZXBzIiwic3RlcCIsInN0ZXBUZXh0IiwidHJ1bmNhdGVUZXh0IiwiaGllcmFyY2h5SXRlbXMiLCJleHRyYWN0SGllcmFyY2h5Iiwicm9vdCIsImNoaWxkcmVuIiwiZ3JhbmRjaGlsZHJlbiIsImNoaWxkIiwic3BhY2luZyIsIml0ZW0iLCJ0aW1lRXZlbnRzIiwiZXh0cmFjdFRpbWVsaW5lRXZlbnRzIiwiZXZlbnQiLCJldmVudFRleHQiLCJ0aW1lVGV4dCIsInRpbWUiLCJmb3JtdWxhIiwiZXh0cmFjdEZvcm11bGEiLCJ2YXJpYWJsZXMiLCJleHRyYWN0VmFyaWFibGVzIiwidmFyaWFibGUiLCJzeW1ib2wiLCJfIiwiY29uY2F0IiwibW9sZWN1bGUiLCJleHRyYWN0TW9sZWN1bGUiLCJhdG9tcyIsImV4dHJhY3RBdG9tcyIsImluY2x1ZGVzIiwiYXRvbSIsImpvaW4iLCJwcm9jZXNzZXMiLCJleHRyYWN0UHJvY2Vzc2VzIiwicHJvY2VzcyIsInByb2Nlc3NUZXh0Iiwia2V5UG9pbnRzIiwiZXh0cmFjdEtleVBvaW50cyIsInBvaW50IiwicG9pbnRUZXh0IiwibGVmdEFsaWduIiwic2VudGVuY2VzIiwic3BsaXQiLCJzZW50ZW5jZSIsIndvcmRzIiwidHJpbSIsImltcG9ydGFudFdvcmRzIiwiZmlsdGVyIiwid29yZCIsInB1c2giLCJzdGVwUGF0dGVybnMiLCJwYXR0ZXJuIiwibWF0Y2giLCJleGVjIiwicyIsImhpZXJhcmNoeVdvcmRzIiwiaXRlbXMiLCJjbGVhblNlbnRlbmNlIiwicmVwbGFjZSIsInRpbWVQYXR0ZXJuIiwiZXZlbnRzIiwidGltZU1hdGNoIiwia2V5RXZlbnRzIiwiZm9ybXVsYVBhdHRlcm5zIiwicGFydHMiLCJ2YXJQYXR0ZXJuIiwibW9sZWN1bGVQYXR0ZXJucyIsImF0b21TeW1ib2xzIiwidW5pcXVlQXRvbXMiLCJTZXQiLCJsaW1pdCIsInRleHQiLCJ3aWR0aCIsInRydW5jYXRlZCIsInBhZGRpbmciLCJNYXRoIiwibWF4IiwibGVmdFBhZCIsImZsb29yIiwicmlnaHRQYWQiLCJyZXBlYXQiLCJtYXhXaWR0aCIsInN1YnN0cmluZyIsImdlbmVyYXRlT3B0aW1hbFZpc3VhbCIsIm9wdGltYWxUeXBlIiwiZ2VuZXJhdGVWaXN1YWxPcHRpb25zIiwicHJpbWFyeVR5cGUiLCJvcHRpb25zIiwiYWx0ZXJuYXRpdmVUeXBlcyJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/visual-learning-engine.ts\n");

/***/ }),

/***/ "(ssr)/./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!******************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \******************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "../app-render/work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "@xenova/transformers":
/*!***************************************!*\
  !*** external "@xenova/transformers" ***!
  \***************************************/
/***/ ((module) => {

"use strict";
module.exports = import("@xenova/transformers");;

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

"use strict";
module.exports = require("https");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

"use strict";
module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

"use strict";
module.exports = require("zlib");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/jose","vendor-chunks/next-auth","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/@babel","vendor-chunks/oauth","vendor-chunks/preact","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/preact-render-to-string","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&page=%2Fapi%2Fai-chat%2Fenhanced-message%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai-chat%2Fenhanced-message%2Froute.ts&appDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Frodrigodibernardo33gmail.com%2FDocuments%2FApp%20Development%20Proyects%2FIntellego%20Platform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();